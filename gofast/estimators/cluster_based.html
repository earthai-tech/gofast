<!DOCTYPE html>
<!-- Generated by Cython 3.0.9 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: cluster_based.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { color: #000000; margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 3.0.9</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="cluster_based.c">cluster_based.c</a></p>
<div class="cython"><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: # -*- coding: utf-8 -*-</pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(1,0,<span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_KMFClassifier_predict_line_232, __pyx_kp_u_Predict_class_labels_for_sample) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_KMFClassifier_predict_proba_line, __pyx_kp_u_Predict_class_probabilities_for) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_KMFRegressor_score_line_590, __pyx_kp_u_Return_the_coefficient_of_deter) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: #   License: BSD-3-Clause</pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: #   Author: LKouadio &lt;etanoyau@gmail.com&gt;</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: """</pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: `cluster_based` module offers cluster-based machine learning models</pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: leveraging clustering techniques to enhance predictive performance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: """</pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">009</span>: from sklearn.base import ClassifierMixin, RegressorMixin</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(9,0,<span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ClassifierMixin);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ClassifierMixin);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_ClassifierMixin)) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_RegressorMixin);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_RegressorMixin);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_RegressorMixin)) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_base, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_ClassifierMixin);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ClassifierMixin, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_RegressorMixin);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_RegressorMixin, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">010</span>: from sklearn.metrics import r2_score</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(10,0,<span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_r2_score);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_r2_score);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_r2_score)) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_metrics, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_r2_score);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_r2_score, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">011</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">012</span>: from ..tools.validator import check_is_fitted</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(12,0,<span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_check_is_fitted);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_check_is_fitted);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_check_is_fitted)) <span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_tools_validator, __pyx_t_2, 2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_check_is_fitted);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_is_fitted, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">013</span>: from ._cluster_based import BaseKMF</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(13,0,<span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_BaseKMF);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_BaseKMF);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_BaseKMF)) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_cluster_based, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_BaseKMF);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_BaseKMF, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">014</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">015</span>: __all__=["KMFClassifier", "KMFRegressor"]</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(15,0,<span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_KMFClassifier);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_KMFClassifier);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_KMFClassifier)) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_KMFRegressor);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_KMFRegressor);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_u_KMFRegressor)) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_all, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">016</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: </pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>: class KMFClassifier(BaseKMF, ClassifierMixin):</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(18,0,<span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_BaseKMF);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_ClassifierMixin);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PEP560_update_bases(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CalculateMetaclass</span>(NULL, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_3, __pyx_n_s_KMFClassifier, __pyx_n_s_KMFClassifier, (PyObject *) NULL, __pyx_n_s_gofast_estimators_cluster_based, __pyx_kp_s_KMeans_Featurizer_Classifier_KM);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (__pyx_t_3 != __pyx_t_4) {
    if (unlikely((<span class='py_c_api'>PyDict_SetItemString</span>(__pyx_t_5, "__orig_bases__", __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(18,0,<span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>)
  __pyx_t_6 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_KMFClassifier, __pyx_t_3, __pyx_t_5, NULL, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_CyFunction_InitClassCell</span>(__pyx_t_4, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_KMFClassifier, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">019</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>:     KMeans Featurizer Classifier (KMFClassifier).</pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>:     A classifier that integrates k-means clustering with a base machine</pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>:     learning estimator. The `KMFClassifier` first employs the</pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>:     `KMeansFeaturizer` algorithm to transform the input data into cluster</pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>:     memberships based on k-means clustering [1]_. Each data point is</pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>:     represented by its closest cluster center. This transformed data,</pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>:     capturing the inherent clustering structure, is then used to train a</pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>:     specified base estimator [2]_. The approach aims to enhance the</pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>:     performance of the base estimator by leveraging the additional structure</pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>:     introduced by the clustering process.</pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>:     See more in :ref:`User Guide`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>:     n_clusters : int, default=3</pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>:         The number of clusters to form in the k-means clustering process. This</pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>:         parameter controls the granularity of the clustering and can</pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>:         significantly impact the model performance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>:     target_scale : float, default=1.0</pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>:         Scaling factor for the target variable when included in the k-means</pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>:         clustering process. This is used to adjust the influence of the target</pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>:         variable in the clustering process. A higher value increases the</pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>:         impact of the target variable.</pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>:     random_state : int, RandomState instance or None, default=None</pre>
<pre class="cython line score-0">&#xA0;<span class="">048</span>:         Controls the randomness of the centroid initialization and data</pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>:         shuffling, ensuring reproducibility of the results. If an int is</pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>:         provided, it is used as the seed for the random number generator.</pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>:     n_components : int, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>:         Number of principal components to retain for dimensionality reduction</pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>:         before applying k-means clustering. If not set, no dimensionality</pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>:         reduction is performed. This helps in reducing the complexity of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>:         input data and can improve clustering performance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>:     init : str, callable or array-like, default='k-means++'</pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>:         Method for initialization of the k-means centroids. Options include:</pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>:         - 'k-means++': selects initial cluster centers in a smart way to speed</pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>:           up convergence.</pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>:         - 'random': chooses `n_clusters` observations (rows) at random from the</pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>:           data for the initial centroids.</pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>:     n_init : int or 'auto', default='auto'</pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>:         Number of times the k-means algorithm will be run with different</pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>:         centroid seeds. The best output in terms of inertia is chosen. Setting</pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>:         this to a higher value increases the robustness of the clustering.</pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>:     max_iter : int, default=300</pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>:         Maximum number of iterations of the k-means algorithm for a single run.</pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>:         This controls the convergence of the algorithm. If the algorithm does</pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>:         not converge within the specified number of iterations, it stops.</pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>:     tol : float, default=1e-4</pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>:         Relative tolerance with regards to the Frobenius norm of the difference</pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>:         in the cluster centers to declare convergence. This determines the</pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>:         stopping criterion of the k-means algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>:     copy_x : bool, default=True</pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>:         If True, the input data is centered before computation. Centering the</pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>:         data is known to improve the numerical stability of the k-means</pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>:         algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>:     verbose : int, default=0</pre>
<pre class="cython line score-0">&#xA0;<span class="">086</span>:         Verbosity mode for logging the process of the k-means algorithm. Higher</pre>
<pre class="cython line score-0">&#xA0;<span class="">087</span>:         values result in more detailed logging.</pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">089</span>:     algorithm : str, default='lloyd'</pre>
<pre class="cython line score-0">&#xA0;<span class="">090</span>:         K-means algorithm variant to use. The options include:</pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>:         - 'lloyd': standard k-means algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>:         - 'elkan': more efficient variant using the triangle inequality.</pre>
<pre class="cython line score-0">&#xA0;<span class="">093</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">094</span>:     estimator : estimator object, default=None</pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>:         The base machine learning estimator to fit on the transformed data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>:         This estimator should follow the scikit-learn estimator interface. If</pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>:         None, a default `DecisionTreeClassifier` is used.</pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>:     to_sparse : bool, default=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>:         If True, the input data `X` will be converted to a sparse matrix before</pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>:         applying the transformation. This is useful for handling large datasets</pre>
<pre class="cython line score-0">&#xA0;<span class="">102</span>:         more efficiently. If False, the data format of `X` is preserved.</pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>:      encoding : {'onehot', 'bin-counting', 'label', 'frequency', 'mean_target'},\</pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>:          default='onehot'</pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>:          Encoding strategy for cluster labels:</pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>:          - 'onehot': One-hot encoding of the categorical variables. This creates</pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>:            a binary column for each category and assigns a 1 or 0 based on</pre>
<pre class="cython line score-0">&#xA0;<span class="">109</span>:            whether the category is present in the sample.</pre>
<pre class="cython line score-0">&#xA0;<span class="">110</span>:          - 'bin-counting': Probabilistic bin-counting encoding. This converts</pre>
<pre class="cython line score-0">&#xA0;<span class="">111</span>:            categorical values into probabilities based on their frequency of</pre>
<pre class="cython line score-0">&#xA0;<span class="">112</span>:            occurrence in the dataset.</pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>:          - 'label': Label encoding of the categorical variables. This assigns</pre>
<pre class="cython line score-0">&#xA0;<span class="">114</span>:            a unique integer to each category.</pre>
<pre class="cython line score-0">&#xA0;<span class="">115</span>:          - 'frequency': Frequency encoding of the categorical variables. This</pre>
<pre class="cython line score-0">&#xA0;<span class="">116</span>:            assigns the frequency of each category's occurrence in the dataset</pre>
<pre class="cython line score-0">&#xA0;<span class="">117</span>:            as the encoded value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">118</span>:          - 'mean_target': Mean target encoding based on target values provided</pre>
<pre class="cython line score-0">&#xA0;<span class="">119</span>:            during fit. This assigns the mean of the target variable for each</pre>
<pre class="cython line score-0">&#xA0;<span class="">120</span>:            category.</pre>
<pre class="cython line score-0">&#xA0;<span class="">121</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">122</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">123</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">124</span>:     - The effectiveness of the KMFClassifier depends on the choice of the base</pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>:       estimator and the suitability of k-means clustering for the given</pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>:       dataset.</pre>
<pre class="cython line score-0">&#xA0;<span class="">127</span>:     - The KMeansFeaturizer can optionally scale the target variable and</pre>
<pre class="cython line score-0">&#xA0;<span class="">128</span>:       perform PCA for dimensionality reduction, which can significantly affect</pre>
<pre class="cython line score-0">&#xA0;<span class="">129</span>:       the clustering results and hence the final prediction accuracy.</pre>
<pre class="cython line score-0">&#xA0;<span class="">130</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">131</span>:     The k-means clustering algorithm involves minimizing the inertia, or</pre>
<pre class="cython line score-0">&#xA0;<span class="">132</span>:     within-cluster sum-of-squares criterion:</pre>
<pre class="cython line score-0">&#xA0;<span class="">133</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">134</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">135</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">136</span>:         \text{Inertia} = \sum_{i=1}^{n} (x_i - \mu_k)^2</pre>
<pre class="cython line score-0">&#xA0;<span class="">137</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">138</span>:     where :math:`x_i` represents a data point, :math:`\mu_k` is the centroid</pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>:     of the cluster k, and the sum is taken over all the data points in the</pre>
<pre class="cython line score-0">&#xA0;<span class="">140</span>:     cluster.</pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>:     When the target variable `y` is included, the feature space is augmented</pre>
<pre class="cython line score-0">&#xA0;<span class="">143</span>:     by stacking `y` with `X`. The KMeansFeaturizer then minimizes a modified</pre>
<pre class="cython line score-0">&#xA0;<span class="">144</span>:     objective function:</pre>
<pre class="cython line score-0">&#xA0;<span class="">145</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">146</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">147</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>:         \min_{C_1,\cdots,C_k, \mu'_1,\cdots,\mu'_k} \sum_{i=1}^{k}\\</pre>
<pre class="cython line score-0">&#xA0;<span class="">149</span>:             \left( \sum_{x y \in C_i} \|x y - \mu'_i \|_2^2 \right)</pre>
<pre class="cython line score-0">&#xA0;<span class="">150</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">151</span>:     where:</pre>
<pre class="cython line score-0">&#xA0;<span class="">152</span>:     - :math:`x y` denotes the augmented data point, a combination of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">153</span>:       feature vector `x` and the target `y`. This combination guides the</pre>
<pre class="cython line score-0">&#xA0;<span class="">154</span>:       clustering process by considering both feature characteristics and</pre>
<pre class="cython line score-0">&#xA0;<span class="">155</span>:       target variable information.</pre>
<pre class="cython line score-0">&#xA0;<span class="">156</span>:     - :math:`\mu'_i` is the centroid of the augmented data points in the</pre>
<pre class="cython line score-0">&#xA0;<span class="">157</span>:       cluster :math:`C_i`, including target variable information, aligning</pre>
<pre class="cython line score-0">&#xA0;<span class="">158</span>:       the clusters with the underlying class structure.</pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>:     - The first summation :math:`\sum_{i=1}^{k}` sums over all k-clusters,</pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>:       focusing on minimizing the variance within each cluster.</pre>
<pre class="cython line score-0">&#xA0;<span class="">161</span>:     - The inner summation :math:`\sum_{x y \in C_i}` represents the sum over</pre>
<pre class="cython line score-0">&#xA0;<span class="">162</span>:       all augmented data points :math:`x y` in the cluster :math:`C_i`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">163</span>:     - :math:`\|x y - \mu'_i \|_2^2` is the squared Euclidean distance between</pre>
<pre class="cython line score-0">&#xA0;<span class="">164</span>:       each augmented data point :math:`x y` and its cluster centroid</pre>
<pre class="cython line score-0">&#xA0;<span class="">165</span>:       :math:`\mu'_i`. Minimizing this distance ensures points are as close as</pre>
<pre class="cython line score-0">&#xA0;<span class="">166</span>:       possible to their cluster center.</pre>
<pre class="cython line score-0">&#xA0;<span class="">167</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">170</span>:     &gt;&gt;&gt; from gofast.estimators.cluster_based import KMFClassifier</pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>:     &gt;&gt;&gt; from sklearn.datasets import make_classification</pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>:     &gt;&gt;&gt; from sklearn.model_selection import train_test_split</pre>
<pre class="cython line score-0">&#xA0;<span class="">173</span>:     &gt;&gt;&gt; X, y = make_classification(n_samples=100, n_features=20, random_state=42)</pre>
<pre class="cython line score-0">&#xA0;<span class="">174</span>:     &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X, y)</pre>
<pre class="cython line score-0">&#xA0;<span class="">175</span>:     &gt;&gt;&gt; kmf_classifier = KMFClassifier(n_clusters=5)</pre>
<pre class="cython line score-0">&#xA0;<span class="">176</span>:     &gt;&gt;&gt; kmf_classifier.fit(X_train, y_train)</pre>
<pre class="cython line score-0">&#xA0;<span class="">177</span>:     &gt;&gt;&gt; y_pred = kmf_classifier.predict(X_test)</pre>
<pre class="cython line score-0">&#xA0;<span class="">178</span>:     &gt;&gt;&gt; kmf_classifier.score (X_test, y_test)</pre>
<pre class="cython line score-0">&#xA0;<span class="">179</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">180</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">181</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">182</span>:     sklearn.cluster.KMeans : The k-means clustering implementation used.</pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>:     sklearn.base.BaseEstimator : The base class for all estimators in</pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>:         scikit-learn.</pre>
<pre class="cython line score-0">&#xA0;<span class="">185</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">188</span>:     .. [1] Kouadio, K.L., Liu, J., Liu, R., Wang, Y., Liu, W., 2024.</pre>
<pre class="cython line score-0">&#xA0;<span class="">189</span>:            K-Means Featurizer: A booster for intricate datasets. Earth Sci.</pre>
<pre class="cython line score-0">&#xA0;<span class="">190</span>:            Informatics 17, 1203–1228. https://doi.org/10.1007/s12145-024-01236-3</pre>
<pre class="cython line score-0">&#xA0;<span class="">191</span>:     .. [2] MacQueen, J. (1967). Some methods for classification and analysis of</pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>:            multivariate observations. Proceedings of the 5th Berkeley Symposium</pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>:            on Mathematical Statistics and Probability. 1:281-297.</pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>:     .. [3] Pedregosa, F. et al. (2011). Scikit-learn: Machine Learning in</pre>
<pre class="cython line score-0">&#xA0;<span class="">195</span>:            Python. Journal of Machine Learning Research. 12:2825-2830.</pre>
<pre class="cython line score-0">&#xA0;<span class="">196</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">197</span>: </pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:     def __init__(</pre>
<pre class='cython code score-45 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_10estimators_13cluster_based_13KMFClassifier_1__init__(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_10estimators_13cluster_based_13KMFClassifier_1__init__ = {"__init__", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_10estimators_13cluster_based_13KMFClassifier_1__init__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_10estimators_13cluster_based_13KMFClassifier_1__init__(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_n_clusters = 0;
  PyObject *__pyx_v_target_scale = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_n_components = 0;
  PyObject *__pyx_v_init = 0;
  PyObject *__pyx_v_n_init = 0;
  PyObject *__pyx_v_max_iter = 0;
  PyObject *__pyx_v_tol = 0;
  PyObject *__pyx_v_copy_x = 0;
  PyObject *__pyx_v_verbose = 0;
  PyObject *__pyx_v_algorithm = 0;
  PyObject *__pyx_v_estimator = 0;
  PyObject *__pyx_v_to_sparse = 0;
  PyObject *__pyx_v_encoding = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,&amp;__pyx_n_s_n_clusters,&amp;__pyx_n_s_target_scale,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_n_components,&amp;__pyx_n_s_init,&amp;__pyx_n_s_n_init,&amp;__pyx_n_s_max_iter,&amp;__pyx_n_s_tol,&amp;__pyx_n_s_copy_x,&amp;__pyx_n_s_verbose,&amp;__pyx_n_s_algorithm,&amp;__pyx_n_s_estimator,&amp;__pyx_n_s_to_sparse,&amp;__pyx_n_s_encoding,0};
  PyObject* values[15] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_3)));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1_0)));
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_10estimators_13cluster_based_13KMFClassifier___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_n_clusters, PyObject *__pyx_v_target_scale, PyObject *__pyx_v_random_state, PyObject *__pyx_v_n_components, PyObject *__pyx_v_init, PyObject *__pyx_v_n_init, PyObject *__pyx_v_max_iter, PyObject *__pyx_v_tol, PyObject *__pyx_v_copy_x, PyObject *__pyx_v_verbose, PyObject *__pyx_v_algorithm, PyObject *__pyx_v_estimator, PyObject *__pyx_v_to_sparse, PyObject *__pyx_v_encoding) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj_)
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 198, 0, <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.estimators.cluster_based.KMFClassifier.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(15, __pyx_n_s_self, __pyx_n_s_n_clusters, __pyx_n_s_target_scale, __pyx_n_s_random_state, __pyx_n_s_n_components, __pyx_n_s_init, __pyx_n_s_n_init, __pyx_n_s_max_iter, __pyx_n_s_tol, __pyx_n_s_copy_x, __pyx_n_s_verbose, __pyx_n_s_algorithm, __pyx_n_s_estimator, __pyx_n_s_to_sparse, __pyx_n_s_encoding);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
  __pyx_codeobj_ = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(15, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__7, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_estimators_cluster_based_2, __pyx_n_s_init_2, 198, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj_)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(198,0,<span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_10estimators_13cluster_based_13KMFClassifier_1__init__, 0, __pyx_n_s_KMFClassifier___init, NULL, __pyx_n_s_gofast_estimators_cluster_based, __pyx_d, ((PyObject *)__pyx_codeobj_));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
  <span class='py_c_api'>PyList_Append</span>(__pyx_t_4, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_6, __pyx_tuple__8);
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_5, __pyx_n_s_init_2, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(14, ((PyObject *)__pyx_int_3), ((PyObject*)__pyx_float_1_0), Py_None, Py_None, ((PyObject*)__pyx_kp_u_k_means), ((PyObject*)__pyx_n_u_auto), ((PyObject *)__pyx_int_300), ((PyObject*)__pyx_float_1eneg_4), ((PyObject *)Py_True), ((PyObject *)__pyx_int_0), ((PyObject*)__pyx_n_u_lloyd), Py_None, ((PyObject *)Py_False), Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class="cython line score-0">&#xA0;<span class="">199</span>:         self,</pre>
<pre class="cython line score-0">&#xA0;<span class="">200</span>:         n_clusters=3,</pre>
<pre class="cython line score-0">&#xA0;<span class="">201</span>:         target_scale=1.0,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:         random_state=None,</pre>
<pre class='cython code score-2 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:         n_components=None,</pre>
<pre class='cython code score-10 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_kp_u_k_means)));
    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_auto)));
    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_300)));
    values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_4)));
</pre><pre class="cython line score-0">&#xA0;<span class="">204</span>:         init='k-means++',</pre>
<pre class="cython line score-0">&#xA0;<span class="">205</span>:         n_init="auto",</pre>
<pre class="cython line score-0">&#xA0;<span class="">206</span>:         max_iter=300,</pre>
<pre class="cython line score-0">&#xA0;<span class="">207</span>:         tol=1e-4,</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:         copy_x=True,</pre>
<pre class='cython code score-6 '>    values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_0)));
    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_lloyd)));
</pre><pre class="cython line score-0">&#xA0;<span class="">209</span>:         verbose=0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">210</span>:         algorithm='lloyd',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:         estimator=None,</pre>
<pre class='cython code score-2 '>    values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">212</span>:         to_sparse=False,</pre>
<pre class='cython code score-2 '>    values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-207" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>:         encoding=None</pre>
<pre class='cython code score-207 '>    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_self)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_clusters);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_target_scale);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_components);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_init);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_init);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_iter);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_tol);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_copy_x);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_verbose);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_algorithm);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_estimator);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_to_sparse);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_encoding);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_self = values[0];
    __pyx_v_n_clusters = values[1];
    __pyx_v_target_scale = values[2];
    __pyx_v_random_state = values[3];
    __pyx_v_n_components = values[4];
    __pyx_v_init = values[5];
    __pyx_v_n_init = values[6];
    __pyx_v_max_iter = values[7];
    __pyx_v_tol = values[8];
    __pyx_v_copy_x = values[9];
    __pyx_v_verbose = values[10];
    __pyx_v_algorithm = values[11];
    __pyx_v_estimator = values[12];
    __pyx_v_to_sparse = values[13];
    __pyx_v_encoding = values[14];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 15, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 198, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.estimators.cluster_based.KMFClassifier.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_10estimators_13cluster_based_13KMFClassifier___init__(__pyx_self, __pyx_v_self, __pyx_v_n_clusters, __pyx_v_target_scale, __pyx_v_random_state, __pyx_v_n_components, __pyx_v_init, __pyx_v_n_init, __pyx_v_max_iter, __pyx_v_tol, __pyx_v_copy_x, __pyx_v_verbose, __pyx_v_algorithm, __pyx_v_estimator, __pyx_v_to_sparse, __pyx_v_encoding);
</pre><pre class="cython line score-0">&#xA0;<span class="">214</span>:     ):</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:         super().__init__(</pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(215,0,<span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_GetClassObj</span>(__pyx_self);
  if (!__pyx_t_1) { <span class='py_c_api'>PyErr_SetString</span>(PyExc_SystemError, "super(): empty __class__ cell"); <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_self)) <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_init_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(215,0,<span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">216</span>:             n_clusters=n_clusters,</pre>
<pre class='cython code score-7 '>  <span class='trace'>__Pyx_TraceLine</span>(216,0,<span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 216, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_n_clusters, __pyx_v_n_clusters) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:             target_scale=target_scale,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(217,0,<span class='error_goto'>__PYX_ERR(0, 217, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_target_scale, __pyx_v_target_scale) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">218</span>:             random_state=random_state,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(218,0,<span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_random_state, __pyx_v_random_state) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:             n_components=n_components,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(219,0,<span class='error_goto'>__PYX_ERR(0, 219, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_n_components, __pyx_v_n_components) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">220</span>:             init=init,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(220,0,<span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_init, __pyx_v_init) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:             n_init=n_init,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(221,0,<span class='error_goto'>__PYX_ERR(0, 221, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_n_init, __pyx_v_n_init) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:             max_iter=max_iter,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(222,0,<span class='error_goto'>__PYX_ERR(0, 222, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_max_iter, __pyx_v_max_iter) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:             tol=tol,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(223,0,<span class='error_goto'>__PYX_ERR(0, 223, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_tol, __pyx_v_tol) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:             copy_x=copy_x,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(224,0,<span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_copy_x, __pyx_v_copy_x) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:             verbose=verbose,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(225,0,<span class='error_goto'>__PYX_ERR(0, 225, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_verbose, __pyx_v_verbose) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:             algorithm=algorithm,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(226,0,<span class='error_goto'>__PYX_ERR(0, 226, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_algorithm, __pyx_v_algorithm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">227</span>:             estimator=estimator,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(227,0,<span class='error_goto'>__PYX_ERR(0, 227, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_estimator, __pyx_v_estimator) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:             to_sparse=to_sparse,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(228,0,<span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_to_sparse, __pyx_v_to_sparse) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:             encoding =encoding</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(229,0,<span class='error_goto'>__PYX_ERR(0, 229, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_encoding, __pyx_v_encoding) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">230</span>:         )</pre>
<pre class="cython line score-0">&#xA0;<span class="">231</span>: </pre>
<pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:     def predict(self, X):</pre>
<pre class='cython code score-68 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_10estimators_13cluster_based_13KMFClassifier_3predict(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_10estimators_13cluster_based_13KMFClassifier_2predict, "\n        Predict class labels for samples in `X`.\n    \n        The `predict` method transforms the input data using the \n        `KMeansFeaturizer` and then applies the base classifier to predict the \n        class labels.\n    \n        Parameters\n        ----------\n        X : array-like of shape (n_samples, n_features)\n            Input samples. Each row corresponds to a single sample, and each \n            column corresponds to a feature.\n    \n        Returns\n        -------\n        y_pred : array-like of shape (n_samples,)\n            Predicted class labels for each sample.\n    \n        Notes\n        -----\n        - Ensure that the `fit` method has been called before invoking `predict`.\n        - The performance of the predictions depends on both the clustering \n          quality and the effectiveness of the base classifier.\n\n        The prediction process involves two main steps:\n        1. **Transformation**:\n           The input data `X` is transformed into cluster memberships using the \n           k-means clustering algorithm:\n           .. math::\n               \text{Cluster Assignments} = \007rg\\min_k \\| x_i - \\mu_k \\|_2\n           where :math:`x_i` is a data point, and :math:`\\mu_k` is the centroid \n           of cluster `k`.\n    \n        2. **Prediction**:\n           The transformed data is used to predict the class labels using the \n           base classifier:\n           .. math::\n               \\hat{y} = \text{BaseClassifier}(\text{Transformed Data})\n    \n        Examples\n        --------\n        &gt;&gt;&gt; from gofast.estimators.cluster_based import KMFClassifier\n        &gt;&gt;&gt; from sklearn.datasets import make_classification\n        &gt;&gt;&gt; from sklearn.model_selection import train_test_split\n        &gt;&gt;&gt; X, y = make_classification(n_samples=100, n_features=20, \n                                       random_state=42)\n        &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X, y)\n        &gt;&gt;&gt; kmf_classifier ="" KMFClassifier(n_clusters=5)\n        &gt;&gt;&gt; kmf_classifier.fit(X_train, y_train)\n        &gt;&gt;&gt; y_pred = kmf_classifier.predict(X_test)\n    \n        See Also\n        --------\n        KMFClassifier.predict_proba : Predict class probabilities for samples in `X`.\n    \n        References\n        ----------\n        .. [1] Kouadio, K.L., Liu, J., Liu, R., Wang, Y., Liu, W., 2024. \n               K-Means Featurizer: A booster for intricate datasets. Earth Sci. \n               Informatics 17, 1203\342\200\2231228. https://doi.org/10.1007/s12145-024-01236-3\n        .. [2] Pedregosa, F. et al. (2011). Scikit-learn: Machine Learning in \n               Python. Journal of Machine Learning Research. 12:2825-2830.\n        ");
static PyMethodDef __pyx_mdef_6gofast_10estimators_13cluster_based_13KMFClassifier_3predict = {"predict", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_10estimators_13cluster_based_13KMFClassifier_3predict, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_10estimators_13cluster_based_13KMFClassifier_2predict};
static PyObject *__pyx_pw_6gofast_10estimators_13cluster_based_13KMFClassifier_3predict(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_X = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("predict (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,&amp;__pyx_n_s_X,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_self)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("predict", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "predict") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_X = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("predict", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.estimators.cluster_based.KMFClassifier.predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_10estimators_13cluster_based_13KMFClassifier_2predict(__pyx_self, __pyx_v_self, __pyx_v_X);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_10estimators_13cluster_based_13KMFClassifier_2predict(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_X) {
  PyObject *__pyx_v_X_transformed = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__2)
  <span class='trace'>__Pyx_TraceCall</span>("predict", __pyx_f[0], 232, 0, <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.estimators.cluster_based.KMFClassifier.predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X_transformed);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_self, __pyx_n_s_X, __pyx_n_s_X_transformed);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(232,0,<span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_10estimators_13cluster_based_13KMFClassifier_3predict, 0, __pyx_n_s_KMFClassifier_predict, NULL, __pyx_n_s_gofast_estimators_cluster_based, __pyx_d, ((PyObject *)__pyx_codeobj__2));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_5, __pyx_n_s_predict, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_codeobj__2 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__9, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_estimators_cluster_based_2, __pyx_n_s_predict, 232, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__2)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">233</span>:         """</pre>
<pre class="cython line score-0">&#xA0;<span class="">234</span>:         Predict class labels for samples in `X`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">235</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">236</span>:         The `predict` method transforms the input data using the</pre>
<pre class="cython line score-0">&#xA0;<span class="">237</span>:         `KMeansFeaturizer` and then applies the base classifier to predict the</pre>
<pre class="cython line score-0">&#xA0;<span class="">238</span>:         class labels.</pre>
<pre class="cython line score-0">&#xA0;<span class="">239</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">240</span>:         Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">241</span>:         ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">242</span>:         X : array-like of shape (n_samples, n_features)</pre>
<pre class="cython line score-0">&#xA0;<span class="">243</span>:             Input samples. Each row corresponds to a single sample, and each</pre>
<pre class="cython line score-0">&#xA0;<span class="">244</span>:             column corresponds to a feature.</pre>
<pre class="cython line score-0">&#xA0;<span class="">245</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">246</span>:         Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">247</span>:         -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">248</span>:         y_pred : array-like of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">249</span>:             Predicted class labels for each sample.</pre>
<pre class="cython line score-0">&#xA0;<span class="">250</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">251</span>:         Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">252</span>:         -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">253</span>:         - Ensure that the `fit` method has been called before invoking `predict`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">254</span>:         - The performance of the predictions depends on both the clustering</pre>
<pre class="cython line score-0">&#xA0;<span class="">255</span>:           quality and the effectiveness of the base classifier.</pre>
<pre class="cython line score-0">&#xA0;<span class="">256</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">257</span>:         The prediction process involves two main steps:</pre>
<pre class="cython line score-0">&#xA0;<span class="">258</span>:         1. **Transformation**:</pre>
<pre class="cython line score-0">&#xA0;<span class="">259</span>:            The input data `X` is transformed into cluster memberships using the</pre>
<pre class="cython line score-0">&#xA0;<span class="">260</span>:            k-means clustering algorithm:</pre>
<pre class="cython line score-0">&#xA0;<span class="">261</span>:            .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">262</span>:                \text{Cluster Assignments} = \arg\min_k \| x_i - \mu_k \|_2</pre>
<pre class="cython line score-0">&#xA0;<span class="">263</span>:            where :math:`x_i` is a data point, and :math:`\mu_k` is the centroid</pre>
<pre class="cython line score-0">&#xA0;<span class="">264</span>:            of cluster `k`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">265</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">266</span>:         2. **Prediction**:</pre>
<pre class="cython line score-0">&#xA0;<span class="">267</span>:            The transformed data is used to predict the class labels using the</pre>
<pre class="cython line score-0">&#xA0;<span class="">268</span>:            base classifier:</pre>
<pre class="cython line score-0">&#xA0;<span class="">269</span>:            .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">270</span>:                \hat{y} = \text{BaseClassifier}(\text{Transformed Data})</pre>
<pre class="cython line score-0">&#xA0;<span class="">271</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">272</span>:         Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">273</span>:         --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">274</span>:         &gt;&gt;&gt; from gofast.estimators.cluster_based import KMFClassifier</pre>
<pre class="cython line score-0">&#xA0;<span class="">275</span>:         &gt;&gt;&gt; from sklearn.datasets import make_classification</pre>
<pre class="cython line score-0">&#xA0;<span class="">276</span>:         &gt;&gt;&gt; from sklearn.model_selection import train_test_split</pre>
<pre class="cython line score-0">&#xA0;<span class="">277</span>:         &gt;&gt;&gt; X, y = make_classification(n_samples=100, n_features=20,</pre>
<pre class="cython line score-0">&#xA0;<span class="">278</span>:                                        random_state=42)</pre>
<pre class="cython line score-0">&#xA0;<span class="">279</span>:         &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X, y)</pre>
<pre class="cython line score-0">&#xA0;<span class="">280</span>:         &gt;&gt;&gt; kmf_classifier = KMFClassifier(n_clusters=5)</pre>
<pre class="cython line score-0">&#xA0;<span class="">281</span>:         &gt;&gt;&gt; kmf_classifier.fit(X_train, y_train)</pre>
<pre class="cython line score-0">&#xA0;<span class="">282</span>:         &gt;&gt;&gt; y_pred = kmf_classifier.predict(X_test)</pre>
<pre class="cython line score-0">&#xA0;<span class="">283</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">284</span>:         See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">285</span>:         --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">286</span>:         KMFClassifier.predict_proba : Predict class probabilities for samples in `X`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">287</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">288</span>:         References</pre>
<pre class="cython line score-0">&#xA0;<span class="">289</span>:         ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">290</span>:         .. [1] Kouadio, K.L., Liu, J., Liu, R., Wang, Y., Liu, W., 2024.</pre>
<pre class="cython line score-0">&#xA0;<span class="">291</span>:                K-Means Featurizer: A booster for intricate datasets. Earth Sci.</pre>
<pre class="cython line score-0">&#xA0;<span class="">292</span>:                Informatics 17, 1203–1228. https://doi.org/10.1007/s12145-024-01236-3</pre>
<pre class="cython line score-0">&#xA0;<span class="">293</span>:         .. [2] Pedregosa, F. et al. (2011). Scikit-learn: Machine Learning in</pre>
<pre class="cython line score-0">&#xA0;<span class="">294</span>:                Python. Journal of Machine Learning Research. 12:2825-2830.</pre>
<pre class="cython line score-0">&#xA0;<span class="">295</span>:         """</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:         check_is_fitted(self, ["estimator_", "featurizer_"])</pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(296,0,<span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_check_is_fitted);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_estimator_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_estimator_2);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_u_estimator_2)) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_featurizer);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_featurizer);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_u_featurizer)) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>;
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_v_self, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">297</span>:         X_transformed = self.featurizer_.transform(X)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(297,0,<span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_featurizer);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_transform);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_X};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_X_transformed = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>:         return self.estimator_.predict(X_transformed)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(298,0,<span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_estimator_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_predict);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_X_transformed};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">299</span>: </pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">300</span>:     def predict_proba(self, X):</pre>
<pre class='cython code score-63 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_10estimators_13cluster_based_13KMFClassifier_5predict_proba(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_10estimators_13cluster_based_13KMFClassifier_4predict_proba, "\n        Predict class probabilities for samples in `X`.\n    \n        The `predict_proba` method transforms the input data using the \n        `KMeansFeaturizer` and then applies the base classifier to predict the \n        class probabilities.\n    \n        Parameters\n        ----------\n        X : array-like of shape (n_samples, n_features)\n            Input samples. Each row corresponds to a single sample, and each \n            column corresponds to a feature.\n    \n        Returns\n        -------\n        y_prob : array-like of shape (n_samples, n_classes)\n            Predicted class probabilities for each sample. The columns correspond \n            to the probability of each class.\n    \n        Notes\n        -----\n        - Ensure that the `fit` method has been called before invoking \n          `predict_proba`.\n        - The base classifier must support the `predict_proba` method. If the base \n          classifier does not support probability predictions, a \n          `NotImplementedError` is raised.\n\n        The probability prediction process involves two main steps:\n        1. **Transformation**:\n           The input data `X` is transformed into cluster memberships using the \n           k-means clustering algorithm:\n           .. math::\n               \text{Cluster Assignments} = \007rg\\min_k \\| x_i - \\mu_k \\|_2\n           where :math:`x_i` is a data point, and :math:`\\mu_k` is the centroid \n           of cluster `k`.\n    \n        2. **Probability Prediction**:\n           The transformed data is used to predict the class probabilities using \n           the base classifier:\n           .. math::\n               P(\\hat{y} = c | x_i) = \text{BaseClassifier.predict_proba}(\text{Transformed Data})\n    \n        Examples\n        --------\n        &gt;&gt;&gt; from gofast.estimators.cluster_based import KMFClassifier\n        &gt;&gt;&gt; from sklearn.datasets import make_classification\n        &gt;&gt;&gt; from sklearn.model_selection import train_te""st_split\n        &gt;&gt;&gt; X, y = make_classification(n_samples=100, n_features=20, \n                                       random_state=42)\n        &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X, y)\n        &gt;&gt;&gt; kmf_classifier = KMFClassifier(n_clusters=5)\n        &gt;&gt;&gt; kmf_classifier.fit(X_train, y_train)\n        &gt;&gt;&gt; y_prob = kmf_classifier.predict_proba(X_test)\n    \n        \n        See Also\n        --------\n        KMFClassifier.predict : Predict class labels for samples in `X`.\n    \n        References\n        ----------\n        .. [1] Kouadio, K.L., Liu, J., Liu, R., Wang, Y., Liu, W., 2024. \n               K-Means Featurizer: A booster for intricate datasets. Earth Sci. \n               Informatics 17, 1203\342\200\2231228. https://doi.org/10.1007/s12145-024-01236-3\n        .. [2] Pedregosa, F. et al. (2011). Scikit-learn: Machine Learning in \n               Python. Journal of Machine Learning Research. 12:2825-2830.\n        ");
static PyMethodDef __pyx_mdef_6gofast_10estimators_13cluster_based_13KMFClassifier_5predict_proba = {"predict_proba", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_10estimators_13cluster_based_13KMFClassifier_5predict_proba, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_10estimators_13cluster_based_13KMFClassifier_4predict_proba};
static PyObject *__pyx_pw_6gofast_10estimators_13cluster_based_13KMFClassifier_5predict_proba(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_X = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("predict_proba (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,&amp;__pyx_n_s_X,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_self)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("predict_proba", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "predict_proba") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_self = values[0];
    __pyx_v_X = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("predict_proba", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.estimators.cluster_based.KMFClassifier.predict_proba", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_10estimators_13cluster_based_13KMFClassifier_4predict_proba(__pyx_self, __pyx_v_self, __pyx_v_X);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_10estimators_13cluster_based_13KMFClassifier_4predict_proba(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_X) {
  PyObject *__pyx_v_X_transformed = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__3)
  <span class='trace'>__Pyx_TraceCall</span>("predict_proba", __pyx_f[0], 300, 0, <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.estimators.cluster_based.KMFClassifier.predict_proba", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X_transformed);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(300,0,<span class='error_goto'>__PYX_ERR(0, 300, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_10estimators_13cluster_based_13KMFClassifier_5predict_proba, 0, __pyx_n_s_KMFClassifier_predict_proba, NULL, __pyx_n_s_gofast_estimators_cluster_based, __pyx_d, ((PyObject *)__pyx_codeobj__3));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_5, __pyx_n_s_predict_proba, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
  __pyx_codeobj__3 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__9, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_estimators_cluster_based_2, __pyx_n_s_predict_proba, 300, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__3)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">301</span>:         """</pre>
<pre class="cython line score-0">&#xA0;<span class="">302</span>:         Predict class probabilities for samples in `X`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">304</span>:         The `predict_proba` method transforms the input data using the</pre>
<pre class="cython line score-0">&#xA0;<span class="">305</span>:         `KMeansFeaturizer` and then applies the base classifier to predict the</pre>
<pre class="cython line score-0">&#xA0;<span class="">306</span>:         class probabilities.</pre>
<pre class="cython line score-0">&#xA0;<span class="">307</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">308</span>:         Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">309</span>:         ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">310</span>:         X : array-like of shape (n_samples, n_features)</pre>
<pre class="cython line score-0">&#xA0;<span class="">311</span>:             Input samples. Each row corresponds to a single sample, and each</pre>
<pre class="cython line score-0">&#xA0;<span class="">312</span>:             column corresponds to a feature.</pre>
<pre class="cython line score-0">&#xA0;<span class="">313</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">314</span>:         Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">315</span>:         -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">316</span>:         y_prob : array-like of shape (n_samples, n_classes)</pre>
<pre class="cython line score-0">&#xA0;<span class="">317</span>:             Predicted class probabilities for each sample. The columns correspond</pre>
<pre class="cython line score-0">&#xA0;<span class="">318</span>:             to the probability of each class.</pre>
<pre class="cython line score-0">&#xA0;<span class="">319</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">320</span>:         Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">321</span>:         -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">322</span>:         - Ensure that the `fit` method has been called before invoking</pre>
<pre class="cython line score-0">&#xA0;<span class="">323</span>:           `predict_proba`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">324</span>:         - The base classifier must support the `predict_proba` method. If the base</pre>
<pre class="cython line score-0">&#xA0;<span class="">325</span>:           classifier does not support probability predictions, a</pre>
<pre class="cython line score-0">&#xA0;<span class="">326</span>:           `NotImplementedError` is raised.</pre>
<pre class="cython line score-0">&#xA0;<span class="">327</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">328</span>:         The probability prediction process involves two main steps:</pre>
<pre class="cython line score-0">&#xA0;<span class="">329</span>:         1. **Transformation**:</pre>
<pre class="cython line score-0">&#xA0;<span class="">330</span>:            The input data `X` is transformed into cluster memberships using the</pre>
<pre class="cython line score-0">&#xA0;<span class="">331</span>:            k-means clustering algorithm:</pre>
<pre class="cython line score-0">&#xA0;<span class="">332</span>:            .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">333</span>:                \text{Cluster Assignments} = \arg\min_k \| x_i - \mu_k \|_2</pre>
<pre class="cython line score-0">&#xA0;<span class="">334</span>:            where :math:`x_i` is a data point, and :math:`\mu_k` is the centroid</pre>
<pre class="cython line score-0">&#xA0;<span class="">335</span>:            of cluster `k`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">336</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">337</span>:         2. **Probability Prediction**:</pre>
<pre class="cython line score-0">&#xA0;<span class="">338</span>:            The transformed data is used to predict the class probabilities using</pre>
<pre class="cython line score-0">&#xA0;<span class="">339</span>:            the base classifier:</pre>
<pre class="cython line score-0">&#xA0;<span class="">340</span>:            .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">341</span>:                P(\hat{y} = c | x_i) = \text{BaseClassifier.predict_proba}(\text{Transformed Data})</pre>
<pre class="cython line score-0">&#xA0;<span class="">342</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">343</span>:         Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">344</span>:         --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">345</span>:         &gt;&gt;&gt; from gofast.estimators.cluster_based import KMFClassifier</pre>
<pre class="cython line score-0">&#xA0;<span class="">346</span>:         &gt;&gt;&gt; from sklearn.datasets import make_classification</pre>
<pre class="cython line score-0">&#xA0;<span class="">347</span>:         &gt;&gt;&gt; from sklearn.model_selection import train_test_split</pre>
<pre class="cython line score-0">&#xA0;<span class="">348</span>:         &gt;&gt;&gt; X, y = make_classification(n_samples=100, n_features=20,</pre>
<pre class="cython line score-0">&#xA0;<span class="">349</span>:                                        random_state=42)</pre>
<pre class="cython line score-0">&#xA0;<span class="">350</span>:         &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X, y)</pre>
<pre class="cython line score-0">&#xA0;<span class="">351</span>:         &gt;&gt;&gt; kmf_classifier = KMFClassifier(n_clusters=5)</pre>
<pre class="cython line score-0">&#xA0;<span class="">352</span>:         &gt;&gt;&gt; kmf_classifier.fit(X_train, y_train)</pre>
<pre class="cython line score-0">&#xA0;<span class="">353</span>:         &gt;&gt;&gt; y_prob = kmf_classifier.predict_proba(X_test)</pre>
<pre class="cython line score-0">&#xA0;<span class="">354</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">355</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">356</span>:         See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">357</span>:         --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">358</span>:         KMFClassifier.predict : Predict class labels for samples in `X`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">359</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">360</span>:         References</pre>
<pre class="cython line score-0">&#xA0;<span class="">361</span>:         ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">362</span>:         .. [1] Kouadio, K.L., Liu, J., Liu, R., Wang, Y., Liu, W., 2024.</pre>
<pre class="cython line score-0">&#xA0;<span class="">363</span>:                K-Means Featurizer: A booster for intricate datasets. Earth Sci.</pre>
<pre class="cython line score-0">&#xA0;<span class="">364</span>:                Informatics 17, 1203–1228. https://doi.org/10.1007/s12145-024-01236-3</pre>
<pre class="cython line score-0">&#xA0;<span class="">365</span>:         .. [2] Pedregosa, F. et al. (2011). Scikit-learn: Machine Learning in</pre>
<pre class="cython line score-0">&#xA0;<span class="">366</span>:                Python. Journal of Machine Learning Research. 12:2825-2830.</pre>
<pre class="cython line score-0">&#xA0;<span class="">367</span>:         """</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>:         check_is_fitted(self, ["estimator_", "featurizer_"])</pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(368,0,<span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_check_is_fitted);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_estimator_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_estimator_2);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_u_estimator_2)) <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_featurizer);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_featurizer);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_u_featurizer)) <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>;
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_v_self, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:         if hasattr(self.estimator_, "predict_proba"):</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(369,0,<span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_estimator_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(__pyx_t_1, __pyx_n_u_predict_proba);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>:             X_transformed = self.featurizer_.transform(X)</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(370,0,<span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_featurizer);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_transform);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_X};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_v_X_transformed = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>:             return self.estimator_.predict_proba(X_transformed)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(371,0,<span class='error_goto'>__PYX_ERR(0, 371, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_estimator_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_predict_proba);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_X_transformed};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 371, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">372</span>:         else:</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">373</span>:             raise NotImplementedError(</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(373,0,<span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>)
  /*else*/ {
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(373,0,<span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_NotImplementedError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 373, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">374</span>:                 f"{self.estimator_.__class__.__name__} does not support predict_proba"</pre>
<pre class='cython code score-14 '>    <span class='trace'>__Pyx_TraceLine</span>(374,0,<span class='error_goto'>__PYX_ERR(0, 374, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_estimator_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_class);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 374, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 374, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_2, __pyx_kp_u_does_not_support_predict_proba);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">375</span>:             )</pre>
<pre class="cython line score-0">&#xA0;<span class="">376</span>: </pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">377</span>: class KMFRegressor(BaseKMF, RegressorMixin):</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(377,0,<span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_BaseKMF);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_RegressorMixin);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PEP560_update_bases(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CalculateMetaclass</span>(NULL, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = __Pyx_Py3MetaclassPrepare(__pyx_t_3, __pyx_t_2, __pyx_n_s_KMFRegressor, __pyx_n_s_KMFRegressor, (PyObject *) NULL, __pyx_n_s_gofast_estimators_cluster_based, __pyx_kp_s_K_Means_Featurizer_Regressor_KM);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (__pyx_t_2 != __pyx_t_5) {
    if (unlikely((<span class='py_c_api'>PyDict_SetItemString</span>(__pyx_t_6, "__orig_bases__", __pyx_t_5) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(377,0,<span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>)
  __pyx_t_4 = __Pyx_Py3ClassCreate(__pyx_t_3, __pyx_n_s_KMFRegressor, __pyx_t_2, __pyx_t_6, NULL, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_CyFunction_InitClassCell</span>(__pyx_t_5, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_KMFRegressor, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">378</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">379</span>:     K-Means Featurizer Regressor (KMFRegressor).</pre>
<pre class="cython line score-0">&#xA0;<span class="">380</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">381</span>:     A regressor that integrates k-means clustering with a base machine</pre>
<pre class="cython line score-0">&#xA0;<span class="">382</span>:     learning estimator. The `KMFRegressor` first employs the</pre>
<pre class="cython line score-0">&#xA0;<span class="">383</span>:     `KMeansFeaturizer` algorithm to transform the input data into cluster</pre>
<pre class="cython line score-0">&#xA0;<span class="">384</span>:     memberships based on k-means clustering [1]_. Each data point is</pre>
<pre class="cython line score-0">&#xA0;<span class="">385</span>:     represented by its closest cluster center. This transformed data,</pre>
<pre class="cython line score-0">&#xA0;<span class="">386</span>:     capturing the inherent clustering structure, is then used to train a</pre>
<pre class="cython line score-0">&#xA0;<span class="">387</span>:     specified base estimator [2]_. The approach aims to enhance the</pre>
<pre class="cython line score-0">&#xA0;<span class="">388</span>:     performance of the base estimator by leveraging the additional structure</pre>
<pre class="cython line score-0">&#xA0;<span class="">389</span>:     introduced by the clustering process.</pre>
<pre class="cython line score-0">&#xA0;<span class="">390</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">391</span>:     See More in :ref:`User Guide`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">392</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">393</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">394</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">395</span>:     n_clusters : int, default=3</pre>
<pre class="cython line score-0">&#xA0;<span class="">396</span>:         The number of clusters to form in the k-means clustering process. This</pre>
<pre class="cython line score-0">&#xA0;<span class="">397</span>:         parameter controls the granularity of the clustering and can</pre>
<pre class="cython line score-0">&#xA0;<span class="">398</span>:         significantly impact the model performance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">399</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">400</span>:     target_scale : float, default=1.0</pre>
<pre class="cython line score-0">&#xA0;<span class="">401</span>:         Scaling factor for the target variable when included in the k-means</pre>
<pre class="cython line score-0">&#xA0;<span class="">402</span>:         clustering process. This is used to adjust the influence of the target</pre>
<pre class="cython line score-0">&#xA0;<span class="">403</span>:         variable in the clustering process. A higher value increases the</pre>
<pre class="cython line score-0">&#xA0;<span class="">404</span>:         impact of the target variable.</pre>
<pre class="cython line score-0">&#xA0;<span class="">405</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">406</span>:     random_state : int, RandomState instance or None, default=None</pre>
<pre class="cython line score-0">&#xA0;<span class="">407</span>:         Controls the randomness of the centroid initialization and data</pre>
<pre class="cython line score-0">&#xA0;<span class="">408</span>:         shuffling, ensuring reproducibility of the results. If an int is</pre>
<pre class="cython line score-0">&#xA0;<span class="">409</span>:         provided, it is used as the seed for the random number generator.</pre>
<pre class="cython line score-0">&#xA0;<span class="">410</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">411</span>:     n_components : int, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">412</span>:         Number of principal components to retain for dimensionality reduction</pre>
<pre class="cython line score-0">&#xA0;<span class="">413</span>:         before applying k-means clustering. If not set, no dimensionality</pre>
<pre class="cython line score-0">&#xA0;<span class="">414</span>:         reduction is performed. This helps in reducing the complexity of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">415</span>:         input data and can improve clustering performance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">416</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">417</span>:     init : str, callable or array-like, default='k-means++'</pre>
<pre class="cython line score-0">&#xA0;<span class="">418</span>:         Method for initialization of the k-means centroids. Options include:</pre>
<pre class="cython line score-0">&#xA0;<span class="">419</span>:         - 'k-means++': selects initial cluster centers in a smart way to speed</pre>
<pre class="cython line score-0">&#xA0;<span class="">420</span>:           up convergence.</pre>
<pre class="cython line score-0">&#xA0;<span class="">421</span>:         - 'random': chooses `n_clusters` observations (rows) at random from the</pre>
<pre class="cython line score-0">&#xA0;<span class="">422</span>:           data for the initial centroids.</pre>
<pre class="cython line score-0">&#xA0;<span class="">423</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">424</span>:     n_init : int or 'auto', default='auto'</pre>
<pre class="cython line score-0">&#xA0;<span class="">425</span>:         Number of times the k-means algorithm will be run with different</pre>
<pre class="cython line score-0">&#xA0;<span class="">426</span>:         centroid seeds. The best output in terms of inertia is chosen. Setting</pre>
<pre class="cython line score-0">&#xA0;<span class="">427</span>:         this to a higher value increases the robustness of the clustering.</pre>
<pre class="cython line score-0">&#xA0;<span class="">428</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">429</span>:     max_iter : int, default=300</pre>
<pre class="cython line score-0">&#xA0;<span class="">430</span>:         Maximum number of iterations of the k-means algorithm for a single run.</pre>
<pre class="cython line score-0">&#xA0;<span class="">431</span>:         This controls the convergence of the algorithm. If the algorithm does</pre>
<pre class="cython line score-0">&#xA0;<span class="">432</span>:         not converge within the specified number of iterations, it stops.</pre>
<pre class="cython line score-0">&#xA0;<span class="">433</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">434</span>:     tol : float, default=1e-4</pre>
<pre class="cython line score-0">&#xA0;<span class="">435</span>:         Relative tolerance with regards to the Frobenius norm of the difference</pre>
<pre class="cython line score-0">&#xA0;<span class="">436</span>:         in the cluster centers to declare convergence. This determines the</pre>
<pre class="cython line score-0">&#xA0;<span class="">437</span>:         stopping criterion of the k-means algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">438</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">439</span>:     copy_x : bool, default=True</pre>
<pre class="cython line score-0">&#xA0;<span class="">440</span>:         If True, the input data is centered before computation. Centering the</pre>
<pre class="cython line score-0">&#xA0;<span class="">441</span>:         data is known to improve the numerical stability of the k-means</pre>
<pre class="cython line score-0">&#xA0;<span class="">442</span>:         algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">443</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">444</span>:     verbose : int, default=0</pre>
<pre class="cython line score-0">&#xA0;<span class="">445</span>:         Verbosity mode for logging the process of the k-means algorithm. Higher</pre>
<pre class="cython line score-0">&#xA0;<span class="">446</span>:         values result in more detailed logging.</pre>
<pre class="cython line score-0">&#xA0;<span class="">447</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">448</span>:     algorithm : str, default='lloyd'</pre>
<pre class="cython line score-0">&#xA0;<span class="">449</span>:         K-means algorithm variant to use. The options include:</pre>
<pre class="cython line score-0">&#xA0;<span class="">450</span>:         - 'lloyd': standard k-means algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">451</span>:         - 'elkan': more efficient variant using the triangle inequality.</pre>
<pre class="cython line score-0">&#xA0;<span class="">452</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">453</span>:     estimator : estimator object, default=None</pre>
<pre class="cython line score-0">&#xA0;<span class="">454</span>:         The base machine learning estimator to fit on the transformed data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">455</span>:         This estimator should follow the scikit-learn estimator interface. If</pre>
<pre class="cython line score-0">&#xA0;<span class="">456</span>:         None, a default `DecisionTreeRegressor` is used.</pre>
<pre class="cython line score-0">&#xA0;<span class="">457</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">458</span>:     to_sparse : bool, default=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">459</span>:         If True, the input data `X` will be converted to a sparse matrix before</pre>
<pre class="cython line score-0">&#xA0;<span class="">460</span>:         applying the transformation. This is useful for handling large datasets</pre>
<pre class="cython line score-0">&#xA0;<span class="">461</span>:         more efficiently. If False, the data format of `X` is preserved.</pre>
<pre class="cython line score-0">&#xA0;<span class="">462</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">463</span>:     encoding : {'onehot', 'bin-counting', 'label', 'frequency', 'mean_target'},\</pre>
<pre class="cython line score-0">&#xA0;<span class="">464</span>:         default='onehot'</pre>
<pre class="cython line score-0">&#xA0;<span class="">465</span>:         Encoding strategy for cluster labels:</pre>
<pre class="cython line score-0">&#xA0;<span class="">466</span>:         - 'onehot': One-hot encoding of the categorical variables. This creates</pre>
<pre class="cython line score-0">&#xA0;<span class="">467</span>:           a binary column for each category and assigns a 1 or 0 based on</pre>
<pre class="cython line score-0">&#xA0;<span class="">468</span>:           whether the category is present in the sample.</pre>
<pre class="cython line score-0">&#xA0;<span class="">469</span>:         - 'bin-counting': Probabilistic bin-counting encoding. This converts</pre>
<pre class="cython line score-0">&#xA0;<span class="">470</span>:           categorical values into probabilities based on their frequency of</pre>
<pre class="cython line score-0">&#xA0;<span class="">471</span>:           occurrence in the dataset.</pre>
<pre class="cython line score-0">&#xA0;<span class="">472</span>:         - 'label': Label encoding of the categorical variables. This assigns</pre>
<pre class="cython line score-0">&#xA0;<span class="">473</span>:           a unique integer to each category.</pre>
<pre class="cython line score-0">&#xA0;<span class="">474</span>:         - 'frequency': Frequency encoding of the categorical variables. This</pre>
<pre class="cython line score-0">&#xA0;<span class="">475</span>:           assigns the frequency of each category's occurrence in the dataset</pre>
<pre class="cython line score-0">&#xA0;<span class="">476</span>:           as the encoded value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">477</span>:         - 'mean_target': Mean target encoding based on target values provided</pre>
<pre class="cython line score-0">&#xA0;<span class="">478</span>:           during fit. This assigns the mean of the target variable for each</pre>
<pre class="cython line score-0">&#xA0;<span class="">479</span>:           category.</pre>
<pre class="cython line score-0">&#xA0;<span class="">480</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">481</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">482</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">483</span>:     - The effectiveness of the KMFRegressor depends on the choice of the base</pre>
<pre class="cython line score-0">&#xA0;<span class="">484</span>:       estimator and the suitability of k-means clustering for the given</pre>
<pre class="cython line score-0">&#xA0;<span class="">485</span>:       dataset.</pre>
<pre class="cython line score-0">&#xA0;<span class="">486</span>:     - The KMeansFeaturizer can optionally scale the target variable and</pre>
<pre class="cython line score-0">&#xA0;<span class="">487</span>:       perform PCA for dimensionality reduction, which can significantly affect</pre>
<pre class="cython line score-0">&#xA0;<span class="">488</span>:       the clustering results and hence the final prediction accuracy.</pre>
<pre class="cython line score-0">&#xA0;<span class="">489</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">490</span>:     The k-means clustering algorithm involves minimizing the inertia, or</pre>
<pre class="cython line score-0">&#xA0;<span class="">491</span>:     within-cluster sum-of-squares criterion:</pre>
<pre class="cython line score-0">&#xA0;<span class="">492</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">493</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">494</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">495</span>:         \text{Inertia} = \sum_{i=1}^{n} (x_i - \mu_k)^2</pre>
<pre class="cython line score-0">&#xA0;<span class="">496</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">497</span>:     where :math:`x_i` represents a data point, :math:`\mu_k` is the centroid</pre>
<pre class="cython line score-0">&#xA0;<span class="">498</span>:     of the cluster k, and the sum is taken over all the data points in the</pre>
<pre class="cython line score-0">&#xA0;<span class="">499</span>:     cluster.</pre>
<pre class="cython line score-0">&#xA0;<span class="">500</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">501</span>:     When the target variable `y` is included, the feature space is augmented</pre>
<pre class="cython line score-0">&#xA0;<span class="">502</span>:     by stacking `y` with `X`. The KMeansFeaturizer then minimizes a modified</pre>
<pre class="cython line score-0">&#xA0;<span class="">503</span>:     objective function:</pre>
<pre class="cython line score-0">&#xA0;<span class="">504</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">505</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">506</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">507</span>:         \min_{C_1,\cdots,C_k, \mu'_1,\cdots,\mu'_k} \sum_{i=1}^{k}\\</pre>
<pre class="cython line score-0">&#xA0;<span class="">508</span>:             \left( \sum_{x y \in C_i} \|x y - \mu'_i \|_2^2 \right)</pre>
<pre class="cython line score-0">&#xA0;<span class="">509</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">510</span>:     where:</pre>
<pre class="cython line score-0">&#xA0;<span class="">511</span>:     - :math:`x y` denotes the augmented data point, a combination of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">512</span>:       feature vector `x` and the target `y`. This combination guides the</pre>
<pre class="cython line score-0">&#xA0;<span class="">513</span>:       clustering process by considering both feature characteristics and</pre>
<pre class="cython line score-0">&#xA0;<span class="">514</span>:       target variable information.</pre>
<pre class="cython line score-0">&#xA0;<span class="">515</span>:     - :math:`\mu'_i` is the centroid of the augmented data points in the</pre>
<pre class="cython line score-0">&#xA0;<span class="">516</span>:       cluster :math:`C_i`, including target variable information, aligning</pre>
<pre class="cython line score-0">&#xA0;<span class="">517</span>:       the clusters with the underlying class structure.</pre>
<pre class="cython line score-0">&#xA0;<span class="">518</span>:     - The first summation :math:`\sum_{i=1}^{k}` sums over all k-clusters,</pre>
<pre class="cython line score-0">&#xA0;<span class="">519</span>:       focusing on minimizing the variance within each cluster.</pre>
<pre class="cython line score-0">&#xA0;<span class="">520</span>:     - The inner summation :math:`\sum_{x y \in C_i}` represents the sum over</pre>
<pre class="cython line score-0">&#xA0;<span class="">521</span>:       all augmented data points :math:`x y` in the cluster :math:`C_i`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">522</span>:     - :math:`\|x y - \mu'_i \|_2^2` is the squared Euclidean distance between</pre>
<pre class="cython line score-0">&#xA0;<span class="">523</span>:       each augmented data point :math:`x y` and its cluster centroid</pre>
<pre class="cython line score-0">&#xA0;<span class="">524</span>:       :math:`\mu'_i`. Minimizing this distance ensures points are as close as</pre>
<pre class="cython line score-0">&#xA0;<span class="">525</span>:       possible to their cluster center.</pre>
<pre class="cython line score-0">&#xA0;<span class="">526</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">527</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">528</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">529</span>:     &gt;&gt;&gt; from gofast.estimators.cluster_based import KMFRegressor</pre>
<pre class="cython line score-0">&#xA0;<span class="">530</span>:     &gt;&gt;&gt; from sklearn.datasets import make_regression</pre>
<pre class="cython line score-0">&#xA0;<span class="">531</span>:     &gt;&gt;&gt; from sklearn.model_selection import train_test_split</pre>
<pre class="cython line score-0">&#xA0;<span class="">532</span>:     &gt;&gt;&gt; X, y = make_regression(n_samples=100, n_features=20, random_state=42)</pre>
<pre class="cython line score-0">&#xA0;<span class="">533</span>:     &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X, y)</pre>
<pre class="cython line score-0">&#xA0;<span class="">534</span>:     &gt;&gt;&gt; kmf_regressor = KMFRegressor(n_clusters=5)</pre>
<pre class="cython line score-0">&#xA0;<span class="">535</span>:     &gt;&gt;&gt; kmf_regressor.fit(X_train, y_train)</pre>
<pre class="cython line score-0">&#xA0;<span class="">536</span>:     &gt;&gt;&gt; kmf_regressor.score (X_test, y_test)</pre>
<pre class="cython line score-0">&#xA0;<span class="">537</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">538</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">539</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">540</span>:     sklearn.cluster.KMeans : The k-means clustering implementation used.</pre>
<pre class="cython line score-0">&#xA0;<span class="">541</span>:     sklearn.base.BaseEstimator : The base class for all estimators in</pre>
<pre class="cython line score-0">&#xA0;<span class="">542</span>:         scikit-learn.</pre>
<pre class="cython line score-0">&#xA0;<span class="">543</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">544</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">545</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">546</span>:     .. [1] Kouadio, K.L., Liu, J., Liu, R., Wang, Y., Liu, W., 2024.</pre>
<pre class="cython line score-0">&#xA0;<span class="">547</span>:            K-Means Featurizer: A booster for intricate datasets. Earth Sci.</pre>
<pre class="cython line score-0">&#xA0;<span class="">548</span>:            Informatics 17, 1203–1228. https://doi.org/10.1007/s12145-024-01236-3</pre>
<pre class="cython line score-0">&#xA0;<span class="">549</span>:     .. [2] MacQueen, J. (1967). Some methods for classification and analysis of</pre>
<pre class="cython line score-0">&#xA0;<span class="">550</span>:            multivariate observations. Proceedings of the 5th Berkeley Symposium</pre>
<pre class="cython line score-0">&#xA0;<span class="">551</span>:            on Mathematical Statistics and Probability. 1:281-297.</pre>
<pre class="cython line score-0">&#xA0;<span class="">552</span>:     .. [3] Pedregosa, F. et al. (2011). Scikit-learn: Machine Learning in</pre>
<pre class="cython line score-0">&#xA0;<span class="">553</span>:            Python. Journal of Machine Learning Research. 12:2825-2830.</pre>
<pre class="cython line score-0">&#xA0;<span class="">554</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">555</span>: </pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">556</span>:     def __init__(</pre>
<pre class='cython code score-35 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_10estimators_13cluster_based_12KMFRegressor_1__init__(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_10estimators_13cluster_based_12KMFRegressor_1__init__ = {"__init__", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_10estimators_13cluster_based_12KMFRegressor_1__init__, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_10estimators_13cluster_based_12KMFRegressor_1__init__(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_n_clusters = 0;
  PyObject *__pyx_v_target_scale = 0;
  PyObject *__pyx_v_random_state = 0;
  PyObject *__pyx_v_n_components = 0;
  PyObject *__pyx_v_init = 0;
  PyObject *__pyx_v_n_init = 0;
  PyObject *__pyx_v_max_iter = 0;
  PyObject *__pyx_v_tol = 0;
  PyObject *__pyx_v_copy_x = 0;
  PyObject *__pyx_v_verbose = 0;
  PyObject *__pyx_v_algorithm = 0;
  PyObject *__pyx_v_estimator = 0;
  PyObject *__pyx_v_to_sparse = 0;
  PyObject *__pyx_v_encoding = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,&amp;__pyx_n_s_n_clusters,&amp;__pyx_n_s_target_scale,&amp;__pyx_n_s_random_state,&amp;__pyx_n_s_n_components,&amp;__pyx_n_s_init,&amp;__pyx_n_s_n_init,&amp;__pyx_n_s_max_iter,&amp;__pyx_n_s_tol,&amp;__pyx_n_s_copy_x,&amp;__pyx_n_s_verbose,&amp;__pyx_n_s_algorithm,&amp;__pyx_n_s_estimator,&amp;__pyx_n_s_to_sparse,&amp;__pyx_n_s_encoding,0};
  PyObject* values[15] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_3)));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1_0)));
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_10estimators_13cluster_based_12KMFRegressor___init__(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_n_clusters, PyObject *__pyx_v_target_scale, PyObject *__pyx_v_random_state, PyObject *__pyx_v_n_components, PyObject *__pyx_v_init, PyObject *__pyx_v_n_init, PyObject *__pyx_v_max_iter, PyObject *__pyx_v_tol, PyObject *__pyx_v_copy_x, PyObject *__pyx_v_verbose, PyObject *__pyx_v_algorithm, PyObject *__pyx_v_estimator, PyObject *__pyx_v_to_sparse, PyObject *__pyx_v_encoding) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__4)
  <span class='trace'>__Pyx_TraceCall</span>("__init__", __pyx_f[0], 556, 0, <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.estimators.cluster_based.KMFRegressor.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(556,0,<span class='error_goto'>__PYX_ERR(0, 556, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_10estimators_13cluster_based_12KMFRegressor_1__init__, 0, __pyx_n_s_KMFRegressor___init, NULL, __pyx_n_s_gofast_estimators_cluster_based, __pyx_d, ((PyObject *)__pyx_codeobj__4));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  <span class='py_c_api'>PyList_Append</span>(__pyx_t_5, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_tuple__8);
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_6, __pyx_n_s_init_2, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_codeobj__4 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(15, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__7, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_estimators_cluster_based_2, __pyx_n_s_init_2, 556, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__4)) __PYX_ERR(0, 556, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">557</span>:         self,</pre>
<pre class="cython line score-0">&#xA0;<span class="">558</span>:         n_clusters=3,</pre>
<pre class="cython line score-0">&#xA0;<span class="">559</span>:         target_scale=1.0,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">560</span>:         random_state=None,</pre>
<pre class='cython code score-2 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">561</span>:         n_components=None,</pre>
<pre class='cython code score-10 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_kp_u_k_means)));
    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_auto)));
    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_300)));
    values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_4)));
</pre><pre class="cython line score-0">&#xA0;<span class="">562</span>:         init='k-means++',</pre>
<pre class="cython line score-0">&#xA0;<span class="">563</span>:         n_init="auto",</pre>
<pre class="cython line score-0">&#xA0;<span class="">564</span>:         max_iter=300,</pre>
<pre class="cython line score-0">&#xA0;<span class="">565</span>:         tol=1e-4,</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">566</span>:         copy_x=True,</pre>
<pre class='cython code score-6 '>    values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_0)));
    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_lloyd)));
</pre><pre class="cython line score-0">&#xA0;<span class="">567</span>:         verbose=0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">568</span>:         algorithm='lloyd',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">569</span>:         estimator=None,</pre>
<pre class='cython code score-2 '>    values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">570</span>:         to_sparse=False,</pre>
<pre class='cython code score-2 '>    values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-207" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">571</span>:         encoding=None</pre>
<pre class='cython code score-207 '>    values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_self)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_clusters);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_target_scale);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_random_state);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_components);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_init);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_init);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_iter);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_tol);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_copy_x);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_verbose);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_algorithm);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 12:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_estimator);
          if (value) { values[12] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 13:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_to_sparse);
          if (value) { values[13] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 14:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_encoding);
          if (value) { values[14] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "__init__") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 15: values[14] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 14);
        CYTHON_FALLTHROUGH;
        case 14: values[13] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 13);
        CYTHON_FALLTHROUGH;
        case 13: values[12] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 12);
        CYTHON_FALLTHROUGH;
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_self = values[0];
    __pyx_v_n_clusters = values[1];
    __pyx_v_target_scale = values[2];
    __pyx_v_random_state = values[3];
    __pyx_v_n_components = values[4];
    __pyx_v_init = values[5];
    __pyx_v_n_init = values[6];
    __pyx_v_max_iter = values[7];
    __pyx_v_tol = values[8];
    __pyx_v_copy_x = values[9];
    __pyx_v_verbose = values[10];
    __pyx_v_algorithm = values[11];
    __pyx_v_estimator = values[12];
    __pyx_v_to_sparse = values[13];
    __pyx_v_encoding = values[14];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 1, 15, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 556, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.estimators.cluster_based.KMFRegressor.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_10estimators_13cluster_based_12KMFRegressor___init__(__pyx_self, __pyx_v_self, __pyx_v_n_clusters, __pyx_v_target_scale, __pyx_v_random_state, __pyx_v_n_components, __pyx_v_init, __pyx_v_n_init, __pyx_v_max_iter, __pyx_v_tol, __pyx_v_copy_x, __pyx_v_verbose, __pyx_v_algorithm, __pyx_v_estimator, __pyx_v_to_sparse, __pyx_v_encoding);
</pre><pre class="cython line score-0">&#xA0;<span class="">572</span>:     ):</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">573</span>:         super().__init__(</pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(573,0,<span class='error_goto'>__PYX_ERR(0, 573, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_GetClassObj</span>(__pyx_self);
  if (!__pyx_t_1) { <span class='py_c_api'>PyErr_SetString</span>(PyExc_SystemError, "super(): empty __class__ cell"); <span class='error_goto'>__PYX_ERR(0, 573, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 573, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_self)) <span class='error_goto'>__PYX_ERR(0, 573, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_init_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(573,0,<span class='error_goto'>__PYX_ERR(0, 573, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">574</span>:             n_clusters=n_clusters,</pre>
<pre class='cython code score-7 '>  <span class='trace'>__Pyx_TraceLine</span>(574,0,<span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_n_clusters, __pyx_v_n_clusters) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">575</span>:             target_scale=target_scale,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(575,0,<span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_target_scale, __pyx_v_target_scale) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">576</span>:             random_state=random_state,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(576,0,<span class='error_goto'>__PYX_ERR(0, 576, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_random_state, __pyx_v_random_state) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">577</span>:             n_components=n_components,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(577,0,<span class='error_goto'>__PYX_ERR(0, 577, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_n_components, __pyx_v_n_components) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">578</span>:             init=init,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(578,0,<span class='error_goto'>__PYX_ERR(0, 578, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_init, __pyx_v_init) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">579</span>:             n_init=n_init,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(579,0,<span class='error_goto'>__PYX_ERR(0, 579, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_n_init, __pyx_v_n_init) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">580</span>:             max_iter=max_iter,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(580,0,<span class='error_goto'>__PYX_ERR(0, 580, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_max_iter, __pyx_v_max_iter) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">581</span>:             tol=tol,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(581,0,<span class='error_goto'>__PYX_ERR(0, 581, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_tol, __pyx_v_tol) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">582</span>:             copy_x=copy_x,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(582,0,<span class='error_goto'>__PYX_ERR(0, 582, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_copy_x, __pyx_v_copy_x) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">583</span>:             verbose=verbose,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(583,0,<span class='error_goto'>__PYX_ERR(0, 583, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_verbose, __pyx_v_verbose) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">584</span>:             algorithm=algorithm,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(584,0,<span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_algorithm, __pyx_v_algorithm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">585</span>:             estimator=estimator,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(585,0,<span class='error_goto'>__PYX_ERR(0, 585, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_estimator, __pyx_v_estimator) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">586</span>:             to_sparse=to_sparse,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(586,0,<span class='error_goto'>__PYX_ERR(0, 586, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_to_sparse, __pyx_v_to_sparse) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">587</span>:             encoding=encoding</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(587,0,<span class='error_goto'>__PYX_ERR(0, 587, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_encoding, __pyx_v_encoding) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">588</span>:         )</pre>
<pre class="cython line score-0">&#xA0;<span class="">589</span>: </pre>
<pre class="cython line score-100" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">590</span>:     def score(self, X, y, sample_weight=None):</pre>
<pre class='cython code score-100 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_10estimators_13cluster_based_12KMFRegressor_3score(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_10estimators_13cluster_based_12KMFRegressor_2score, "\n        Return the coefficient of determination R^2 of the prediction.\n    \n        The `score` method computes the R^2 score, also known as the \n        coefficient of determination, which provides a measure of how well the \n        predicted values match the actual values. The best possible score is \n        1.0, which indicates perfect prediction. This method first makes \n        predictions on the input data `X` using the trained model and then \n        compares these predictions with the actual values `y` to compute the \n        R^2 score.\n    \n        Parameters\n        ----------\n        X : array-like of shape (n_samples, n_features)\n            Test samples, where `n_samples` is the number of samples and \n            `n_features` is the number of features. Each row corresponds to a \n            single sample, and each column corresponds to a feature.\n    \n        y : array-like of shape (n_samples,) or (n_samples, n_outputs)\n            True values for `X`. Each element in the array corresponds to the \n            actual value for a sample.\n    \n        Returns\n        -------\n        score : float\n            R^2 of `self.predict(X)` with respect to `y`. The R^2 score is a \n            statistical measure that represents the proportion of the variance \n            for a dependent variable that's explained by an independent variable \n            or variables in a regression model.\n    \n        Notes\n        -----\n        The R^2 score, or coefficient of determination, is computed as follows:\n    \n        .. math::\n    \n            R^2 = 1 - \\frac{\\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2}{\\sum_{i=1}^{n} (y_i - \\bar{y})^2}\n    \n        where:\n        - :math:`y_i` are the true values,\n        - :math:`\\hat{y}_i` are the predicted values,\n        - :math:`\\bar{y}` is the mean of the true values,\n        - :math:`n` is the number of samples.\n  \n        - The R^2 score used here is not a symmetric function and hence ""can be \n          negative if the model is worse than a simple mean predictor.\n        - The score method evaluates the performance of the model on the test \n          dataset. Higher scores indicate a model that better captures the \n          variability of the dataset.\n        - Ensure that the `fit` method has been called before invoking `score`.\n    \n        Examples\n        --------\n        &gt;&gt;&gt; from gofast.estimators.cluster_based import KMFRegressor\n        &gt;&gt;&gt; from sklearn.datasets import make_regression\n        &gt;&gt;&gt; from sklearn.model_selection import train_test_split\n        &gt;&gt;&gt; X, y = make_regression(n_samples=100, n_features=20, random_state=42)\n        &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X, y)\n        &gt;&gt;&gt; kmf_regressor = KMFRegressor(n_clusters=5)\n        &gt;&gt;&gt; kmf_regressor.fit(X_train, y_train)\n        &gt;&gt;&gt; r2 = kmf_regressor.score(X_test, y_test)\n    \n        See Also\n        --------\n        sklearn.metrics.r2_score : The function to compute the R^2 score.\n        KMFRegressor.fit : Fit the KMeansFeaturizer and the base estimator.\n        KMFRegressor.predict : Predict target values for samples in `X`.\n    \n        References\n        ----------\n        .. [1] Kouadio, K.L., Liu, J., Liu, R., Wang, Y., Liu, W., 2024. \n               K-Means Featurizer: A booster for intricate datasets. Earth Sci. \n               Informatics 17, 1203\342\200\2231228. https://doi.org/10.1007/s12145-024-01236-3\n        .. [2] Pedregosa, F. et al. (2011). Scikit-learn: Machine Learning in \n               Python. Journal of Machine Learning Research. 12:2825-2830.\n        ");
static PyMethodDef __pyx_mdef_6gofast_10estimators_13cluster_based_12KMFRegressor_3score = {"score", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_10estimators_13cluster_based_12KMFRegressor_3score, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_10estimators_13cluster_based_12KMFRegressor_2score};
static PyObject *__pyx_pw_6gofast_10estimators_13cluster_based_12KMFRegressor_3score(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_self = 0;
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_v_sample_weight = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("score (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_self,&amp;__pyx_n_s_X,&amp;__pyx_n_s_y,&amp;__pyx_n_s_sample_weight,0};
  PyObject* values[4] = {0,0,0,0};
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_self)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sample_weight);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "score") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_self = values[0];
    __pyx_v_X = values[1];
    __pyx_v_y = values[2];
    __pyx_v_sample_weight = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("score", 0, 3, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.estimators.cluster_based.KMFRegressor.score", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_10estimators_13cluster_based_12KMFRegressor_2score(__pyx_self, __pyx_v_self, __pyx_v_X, __pyx_v_y, __pyx_v_sample_weight);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_10estimators_13cluster_based_12KMFRegressor_2score(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self, PyObject *__pyx_v_X, PyObject *__pyx_v_y, PyObject *__pyx_v_sample_weight) {
  PyObject *__pyx_v_predictions = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__5)
  <span class='trace'>__Pyx_TraceCall</span>("score", __pyx_f[0], 590, 0, <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.estimators.cluster_based.KMFRegressor.score", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_predictions);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_self, __pyx_n_s_X, __pyx_n_s_y, __pyx_n_s_sample_weight, __pyx_n_s_predictions);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
  __pyx_codeobj__5 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__10, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_estimators_cluster_based_2, __pyx_n_s_score, 590, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__5)) __PYX_ERR(0, 590, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(590,0,<span class='error_goto'>__PYX_ERR(0, 590, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_10estimators_13cluster_based_12KMFRegressor_3score, 0, __pyx_n_s_KMFRegressor_score, NULL, __pyx_n_s_gofast_estimators_cluster_based, __pyx_d, ((PyObject *)__pyx_codeobj__5));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_tuple__11);
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_6, __pyx_n_s_score, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 590, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">591</span>:         """</pre>
<pre class="cython line score-0">&#xA0;<span class="">592</span>:         Return the coefficient of determination R^2 of the prediction.</pre>
<pre class="cython line score-0">&#xA0;<span class="">593</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">594</span>:         The `score` method computes the R^2 score, also known as the</pre>
<pre class="cython line score-0">&#xA0;<span class="">595</span>:         coefficient of determination, which provides a measure of how well the</pre>
<pre class="cython line score-0">&#xA0;<span class="">596</span>:         predicted values match the actual values. The best possible score is</pre>
<pre class="cython line score-0">&#xA0;<span class="">597</span>:         1.0, which indicates perfect prediction. This method first makes</pre>
<pre class="cython line score-0">&#xA0;<span class="">598</span>:         predictions on the input data `X` using the trained model and then</pre>
<pre class="cython line score-0">&#xA0;<span class="">599</span>:         compares these predictions with the actual values `y` to compute the</pre>
<pre class="cython line score-0">&#xA0;<span class="">600</span>:         R^2 score.</pre>
<pre class="cython line score-0">&#xA0;<span class="">601</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">602</span>:         Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">603</span>:         ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">604</span>:         X : array-like of shape (n_samples, n_features)</pre>
<pre class="cython line score-0">&#xA0;<span class="">605</span>:             Test samples, where `n_samples` is the number of samples and</pre>
<pre class="cython line score-0">&#xA0;<span class="">606</span>:             `n_features` is the number of features. Each row corresponds to a</pre>
<pre class="cython line score-0">&#xA0;<span class="">607</span>:             single sample, and each column corresponds to a feature.</pre>
<pre class="cython line score-0">&#xA0;<span class="">608</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">609</span>:         y : array-like of shape (n_samples,) or (n_samples, n_outputs)</pre>
<pre class="cython line score-0">&#xA0;<span class="">610</span>:             True values for `X`. Each element in the array corresponds to the</pre>
<pre class="cython line score-0">&#xA0;<span class="">611</span>:             actual value for a sample.</pre>
<pre class="cython line score-0">&#xA0;<span class="">612</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">613</span>:         Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">614</span>:         -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">615</span>:         score : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">616</span>:             R^2 of `self.predict(X)` with respect to `y`. The R^2 score is a</pre>
<pre class="cython line score-0">&#xA0;<span class="">617</span>:             statistical measure that represents the proportion of the variance</pre>
<pre class="cython line score-0">&#xA0;<span class="">618</span>:             for a dependent variable that's explained by an independent variable</pre>
<pre class="cython line score-0">&#xA0;<span class="">619</span>:             or variables in a regression model.</pre>
<pre class="cython line score-0">&#xA0;<span class="">620</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">621</span>:         Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">622</span>:         -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">623</span>:         The R^2 score, or coefficient of determination, is computed as follows:</pre>
<pre class="cython line score-0">&#xA0;<span class="">624</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">625</span>:         .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">626</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">627</span>:             R^2 = 1 - \\frac{\\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2}{\\sum_{i=1}^{n} (y_i - \\bar{y})^2}</pre>
<pre class="cython line score-0">&#xA0;<span class="">628</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">629</span>:         where:</pre>
<pre class="cython line score-0">&#xA0;<span class="">630</span>:         - :math:`y_i` are the true values,</pre>
<pre class="cython line score-0">&#xA0;<span class="">631</span>:         - :math:`\\hat{y}_i` are the predicted values,</pre>
<pre class="cython line score-0">&#xA0;<span class="">632</span>:         - :math:`\\bar{y}` is the mean of the true values,</pre>
<pre class="cython line score-0">&#xA0;<span class="">633</span>:         - :math:`n` is the number of samples.</pre>
<pre class="cython line score-0">&#xA0;<span class="">634</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">635</span>:         - The R^2 score used here is not a symmetric function and hence can be</pre>
<pre class="cython line score-0">&#xA0;<span class="">636</span>:           negative if the model is worse than a simple mean predictor.</pre>
<pre class="cython line score-0">&#xA0;<span class="">637</span>:         - The score method evaluates the performance of the model on the test</pre>
<pre class="cython line score-0">&#xA0;<span class="">638</span>:           dataset. Higher scores indicate a model that better captures the</pre>
<pre class="cython line score-0">&#xA0;<span class="">639</span>:           variability of the dataset.</pre>
<pre class="cython line score-0">&#xA0;<span class="">640</span>:         - Ensure that the `fit` method has been called before invoking `score`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">641</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">642</span>:         Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">643</span>:         --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">644</span>:         &gt;&gt;&gt; from gofast.estimators.cluster_based import KMFRegressor</pre>
<pre class="cython line score-0">&#xA0;<span class="">645</span>:         &gt;&gt;&gt; from sklearn.datasets import make_regression</pre>
<pre class="cython line score-0">&#xA0;<span class="">646</span>:         &gt;&gt;&gt; from sklearn.model_selection import train_test_split</pre>
<pre class="cython line score-0">&#xA0;<span class="">647</span>:         &gt;&gt;&gt; X, y = make_regression(n_samples=100, n_features=20, random_state=42)</pre>
<pre class="cython line score-0">&#xA0;<span class="">648</span>:         &gt;&gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X, y)</pre>
<pre class="cython line score-0">&#xA0;<span class="">649</span>:         &gt;&gt;&gt; kmf_regressor = KMFRegressor(n_clusters=5)</pre>
<pre class="cython line score-0">&#xA0;<span class="">650</span>:         &gt;&gt;&gt; kmf_regressor.fit(X_train, y_train)</pre>
<pre class="cython line score-0">&#xA0;<span class="">651</span>:         &gt;&gt;&gt; r2 = kmf_regressor.score(X_test, y_test)</pre>
<pre class="cython line score-0">&#xA0;<span class="">652</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">653</span>:         See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">654</span>:         --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">655</span>:         sklearn.metrics.r2_score : The function to compute the R^2 score.</pre>
<pre class="cython line score-0">&#xA0;<span class="">656</span>:         KMFRegressor.fit : Fit the KMeansFeaturizer and the base estimator.</pre>
<pre class="cython line score-0">&#xA0;<span class="">657</span>:         KMFRegressor.predict : Predict target values for samples in `X`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">658</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">659</span>:         References</pre>
<pre class="cython line score-0">&#xA0;<span class="">660</span>:         ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">661</span>:         .. [1] Kouadio, K.L., Liu, J., Liu, R., Wang, Y., Liu, W., 2024.</pre>
<pre class="cython line score-0">&#xA0;<span class="">662</span>:                K-Means Featurizer: A booster for intricate datasets. Earth Sci.</pre>
<pre class="cython line score-0">&#xA0;<span class="">663</span>:                Informatics 17, 1203–1228. https://doi.org/10.1007/s12145-024-01236-3</pre>
<pre class="cython line score-0">&#xA0;<span class="">664</span>:         .. [2] Pedregosa, F. et al. (2011). Scikit-learn: Machine Learning in</pre>
<pre class="cython line score-0">&#xA0;<span class="">665</span>:                Python. Journal of Machine Learning Research. 12:2825-2830.</pre>
<pre class="cython line score-0">&#xA0;<span class="">666</span>:         """</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">667</span>:         check_is_fitted(self, ["estimator_", "featurizer_"])</pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(667,0,<span class='error_goto'>__PYX_ERR(0, 667, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_check_is_fitted);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_estimator_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_estimator_2);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_u_estimator_2)) <span class='error_goto'>__PYX_ERR(0, 667, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_featurizer);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_featurizer);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_u_featurizer)) <span class='error_goto'>__PYX_ERR(0, 667, __pyx_L1_error)</span>;
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_v_self, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 667, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">668</span>:         predictions = self.predict(X)</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(668,0,<span class='error_goto'>__PYX_ERR(0, 668, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_predict);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 668, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_X};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 668, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_predictions = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">669</span>:         return r2_score(y, predictions, sample_weight= sample_weight )</pre>
<pre class='cython code score-26 '>  <span class='trace'>__Pyx_TraceLine</span>(669,0,<span class='error_goto'>__PYX_ERR(0, 669, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_r2_score);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 669, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_predictions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_predictions);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_predictions)) <span class='error_goto'>__PYX_ERR(0, 669, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 669, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">670</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">671</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">672</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">673</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">674</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">675</span>: </pre>
</div></body></html>
