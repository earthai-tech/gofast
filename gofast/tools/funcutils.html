<!DOCTYPE html>
<!-- Generated by Cython 3.0.9 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: funcutils.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { color: #000000; margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 3.0.9</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="funcutils.c">funcutils.c</a></p>
<div class="cython"><pre class="cython line score-163" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0001</span>: # -*- coding: utf-8 -*-</pre>
<pre class='cython code score-163 '>  <span class='trace'>__Pyx_TraceLine</span>(1,0,<span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(31);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_curry_line_60, __pyx_kp_u_Decorator_for_currying_a_functi) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_compose_line_134, __pyx_kp_u_A_hybrid_function_that_can_be_u) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_memoize_line_232, __pyx_kp_u_A_hybrid_decorator_for_memoizin) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_merge_dicts_line_326, __pyx_kp_u_Merges_multiple_dictionaries_in) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_retry_operation_line_403, __pyx_kp_u_Retries_a_specified_function_up) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_flatten_list_line_479, __pyx_kp_u_Flattens_a_nested_list_into_a_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_timeit_decorator_line_535, __pyx_kp_u_A_decorator_that_measures_the_e) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_conditional_decorator_line_584, __pyx_kp_u_Applies_a_decorator_to_a_functi) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_batch_processor_line_636, __pyx_kp_u_Process_a_batch_of_inputs_with) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_is_valid_if_line_695, __pyx_kp_u_A_decorator_to_verify_the_datat) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_install_package_line_782, __pyx_kp_u_Install_a_Python_package_using) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_ensure_pkg_line_910, __pyx_kp_u_Decorator_to_ensure_a_Python_pa) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_should_check_condition_line_104, __pyx_kp_u_Determines_whether_the_conditio) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_drop_nan_if_line_1121, __pyx_kp_u_A_decorator_that_preprocesses_t) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_conditional_apply_line_1190, __pyx_kp_u_Decorator_that_conditionally_ap) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_apply_transform_line_1235, __pyx_kp_u_Creates_a_callable_that_applies) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_make_data_dynamic_line_1269, __pyx_kp_u_A_decorator_for_preprocessing_d) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_add_dynamic_method_line_1399, __pyx_kp_u_Dynamically_adds_a_given_functi) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_preserve_input_type_line_1505, __pyx_kp_u_A_decorator_that_preserves_the) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_to_pandas_line_1678, __pyx_kp_u_Attempts_to_convert_input_data) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_flatten_data_if_line_1792, __pyx_kp_u_Checks_the_input_data_s_structu) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_update_series_index_line_1888, __pyx_kp_u_Updates_the_index_of_a_pandas_S) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_update_dataframe_index_line_2010, __pyx_kp_u_Updates_the_index_axis_0_or_col) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_convert_to_pandas_line_2123, __pyx_kp_u_Automatically_converts_input_da) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_update_index_line_2208, __pyx_kp_u_Updates_the_index_or_columns_of) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_convert_and_format_data_line_234, __pyx_kp_u_Converts_the_input_data_into_a) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_cast_numeric_line_2544, __pyx_kp_u_Checks_whether_a_given_value_is) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_series_naming_line_2613, __pyx_kp_u_Generates_a_condition_function) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_validate_years_line_2714, __pyx_kp_u_Validate_the_years_provided_to) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_check_year_range_line_2882, __pyx_kp_u_Validates_if_a_given_year_is_wi) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_kp_u_context_checker_line_2972, __pyx_kp_u_A_versatile_decorator_to_intros) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: `funcutils` is a utilities package providing various functionalities for</pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: functional programming tasks.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: """</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0006</span>: import sys</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(6,0,<span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_sys, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sys, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0007</span>: import time</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(7,0,<span class='error_goto'>__PYX_ERR(0, 7, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_time, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_time, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0008</span>: import functools</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(8,0,<span class='error_goto'>__PYX_ERR(0, 8, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_functools, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 8, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_functools, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 8, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0009</span>: import inspect</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(9,0,<span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>)
  __pyx_t_2 = __Pyx_patch_inspect(<span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_inspect, NULL));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_inspect, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0010</span>: import logging</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(10,0,<span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_logging, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_logging, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0011</span>: import warnings</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(11,0,<span class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_warnings, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_warnings, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0012</span>: import subprocess</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(12,0,<span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_subprocess, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_subprocess, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0013</span>: import threading</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(13,0,<span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_threading, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_threading, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0014</span>: from datetime import datetime</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(14,0,<span class='error_goto'>__PYX_ERR(0, 14, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_datetime);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_datetime);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_datetime)) <span class='error_goto'>__PYX_ERR(0, 14, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_datetime, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_datetime);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_datetime, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0015</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0016</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(16,0,<span class='error_goto'>__PYX_ERR(0, 16, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_numpy, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0017</span>: import pandas as pd</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(17,0,<span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_pandas, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pd, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0018</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0019</span>: from .._gofastlog import gofastlog</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(19,0,<span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_gofastlog_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_gofastlog_2);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_gofastlog_2)) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_gofastlog, __pyx_t_3, 2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_gofastlog_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gofastlog_2, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0020</span>: from ..api.types import _T, Dict, Any, Callable, List, Type</pre>
<pre class='cython code score-75 '>  <span class='trace'>__Pyx_TraceLine</span>(20,0,<span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_T);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_T);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_T)) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Dict);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Dict);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_Dict)) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Any);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Any);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_Any)) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Callable);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Callable);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_n_s_Callable)) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_List);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_List);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 4, __pyx_n_s_List)) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Type);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Type);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 5, __pyx_n_s_Type)) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_api_types, __pyx_t_2, 2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_T, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_Dict);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Dict, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_Any);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Any, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_Callable);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Callable, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_List);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_List, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_Type);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Type, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0021</span>: from ..api.types import  Optional, Tuple , Union</pre>
<pre class='cython code score-42 '>  <span class='trace'>__Pyx_TraceLine</span>(21,0,<span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Optional);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Optional);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_Optional)) <span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Tuple);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Tuple);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_Tuple)) <span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Union);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Union);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_s_Union)) <span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_api_types, __pyx_t_3, 2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Optional);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Optional, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Tuple);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Tuple, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Union);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Union, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0022</span>: from ..api.types import Series, DataFrame, ArrayLike, Array1D, LambdaType</pre>
<pre class='cython code score-64 '>  <span class='trace'>__Pyx_TraceLine</span>(22,0,<span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Series);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Series);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_Series)) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_DataFrame);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_DataFrame);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_DataFrame)) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ArrayLike);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ArrayLike);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_ArrayLike)) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Array1D);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Array1D);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_n_s_Array1D)) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_LambdaType);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_LambdaType);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 4, __pyx_n_s_LambdaType)) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_api_types, __pyx_t_2, 2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Series, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DataFrame, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_ArrayLike);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ArrayLike, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_Array1D);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Array1D, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_LambdaType);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_LambdaType, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0023</span>: from ._dependency import import_optional_dependency</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(23,0,<span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_import_optional_dependency);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_import_optional_dependency);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_import_optional_dependency)) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_dependency, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_import_optional_dependency);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_import_optional_dependency, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0024</span>: from .coreutils import to_numeric_dtypes, is_iterable</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(24,0,<span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_to_numeric_dtypes);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_to_numeric_dtypes);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_to_numeric_dtypes)) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_is_iterable);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_is_iterable);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_is_iterable)) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_coreutils, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_to_numeric_dtypes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_to_numeric_dtypes, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_is_iterable);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_is_iterable, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0025</span>: from .coreutils import get_installation_name, is_module_installed</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(25,0,<span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_get_installation_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_get_installation_name);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_get_installation_name)) <span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_is_module_installed);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_is_module_installed);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_is_module_installed)) <span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_coreutils, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_get_installation_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_installation_name, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_is_module_installed);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_is_module_installed, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 25, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0026</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0027</span>: # Configure  logging</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0028</span>: _logger=gofastlog.get_gofast_logger(__name__)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(28,0,<span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_gofastlog_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_get_gofast_logger);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_logger_2, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0029</span>: </pre>
<pre class="cython line score-92" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0030</span>: __all__=[</pre>
<pre class='cython code score-92 '>  <span class='trace'>__Pyx_TraceLine</span>(30,0,<span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(27);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_apply_transform);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_apply_transform);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_u_apply_transform)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_batch_processor);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_batch_processor);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_n_u_batch_processor)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_cast_numeric);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_cast_numeric);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_n_u_cast_numeric)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_compose);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_compose);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 3, __pyx_n_u_compose)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_conditional_apply);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_conditional_apply);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 4, __pyx_n_u_conditional_apply)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_conditional_decorator);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_conditional_decorator);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 5, __pyx_n_u_conditional_decorator)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_context_checker);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_context_checker);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 6, __pyx_n_u_context_checker)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_convert_and_format_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_convert_and_format_data);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 7, __pyx_n_u_convert_and_format_data)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_convert_to_pandas);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_convert_to_pandas);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 8, __pyx_n_u_convert_to_pandas)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_curry);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_curry);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 9, __pyx_n_u_curry)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_drop_nan_if);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_drop_nan_if);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 10, __pyx_n_u_drop_nan_if)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_ensure_pkg);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_ensure_pkg);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 11, __pyx_n_u_ensure_pkg)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_flatten_data_if);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_flatten_data_if);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 12, __pyx_n_u_flatten_data_if)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_flatten_list);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_flatten_list);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 13, __pyx_n_u_flatten_list)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_install_package);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_install_package);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 14, __pyx_n_u_install_package)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_is_valid_if);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_is_valid_if);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 15, __pyx_n_u_is_valid_if)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_make_data_dynamic);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_make_data_dynamic);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 16, __pyx_n_u_make_data_dynamic)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_memoize);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_memoize);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 17, __pyx_n_u_memoize)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_merge_dicts);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_merge_dicts);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 18, __pyx_n_u_merge_dicts)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_preserve_input_type);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_preserve_input_type);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 19, __pyx_n_u_preserve_input_type)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_retry_operation);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_retry_operation);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 20, __pyx_n_u_retry_operation)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_series_naming);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_series_naming);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 21, __pyx_n_u_series_naming)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_to_pandas);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_to_pandas);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 22, __pyx_n_u_to_pandas)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_update_dataframe_index);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_update_dataframe_index);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 23, __pyx_n_u_update_dataframe_index)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_update_index);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_update_index);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 24, __pyx_n_u_update_index)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_update_series_index);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_update_series_index);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 25, __pyx_n_u_update_series_index)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_validate_years);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_validate_years);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 26, __pyx_n_u_validate_years)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_all, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0031</span>:     'apply_transform',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0032</span>:     'batch_processor',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0033</span>:     'cast_numeric',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0034</span>:     'compose',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0035</span>:     'conditional_apply',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0036</span>:     'conditional_decorator',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0037</span>:     'context_checker',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0038</span>:     'convert_and_format_data',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0039</span>:     'convert_to_pandas',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0040</span>:     'curry',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0041</span>:     'drop_nan_if',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0042</span>:     'ensure_pkg',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0043</span>:     'flatten_data_if',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0044</span>:     'flatten_list',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0045</span>:     'install_package',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0046</span>:     'is_valid_if',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0047</span>:     'make_data_dynamic',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0048</span>:     'memoize',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0049</span>:     'merge_dicts',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0050</span>:     'preserve_input_type',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0051</span>:     'retry_operation',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0052</span>:     'series_naming',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0053</span>:     'to_pandas',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0054</span>:     'update_dataframe_index',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0055</span>:     'update_index',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0056</span>:     'update_series_index',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0057</span>:     'validate_years'</pre>
<pre class="cython line score-0">&#xA0;<span class="">0058</span>:     ]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0059</span>: </pre>
<pre class="cython line score-97" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0060</span>: def curry(check_types=False, strict=False, allow_extra_args=False):</pre>
<pre class='cython code score-97 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_1curry(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_curry, "\n    Decorator for currying a function, with options for type checking, \n    strict argument completion, and allowing extra arguments.\n\n    Parameters\n    ----------\n    check_types : bool, optional\n        If True, enables type checking against the annotated types of the \n        curried function's arguments. Defaults to False.\n    strict : bool, optional\n        If True, requires all arguments to be provided for the curried \n        function to execute. Defaults to False.\n    allow_extra_args : bool, optional\n        If True, the curried function accepts extra arguments beyond its \n        defined parameters. Defaults to False.\n\n    Returns\n    -------\n    callable\n        A curried version of the original function.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import curry\n\n    &gt;&gt;&gt; @curry(check_types=True)\n    &gt;&gt;&gt; def add(x: int, y: int) -&gt; int:\n    ...     return x + y\n\n    &gt;&gt;&gt; add_five = add(5)\n    &gt;&gt;&gt; print(add_five(3))\n    8\n\n    &gt;&gt;&gt; @curry(strict=True)\n    &gt;&gt;&gt; def greet(greeting, name):\n    ...     return f\"{greeting}, {name}!\"\n\n    &gt;&gt;&gt; greet_hello = greet(\"Hello\")\n    &gt;&gt;&gt; print(greet_hello(\"World\"))\n    Hello, World!\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_1curry = {"curry", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_1curry, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_curry};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_1curry(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_check_types = 0;
  PyObject *__pyx_v_strict = 0;
  PyObject *__pyx_v_allow_extra_args = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("curry (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_check_types,&amp;__pyx_n_s_strict,&amp;__pyx_n_s_allow_extra_args,0};
  PyObject* values[3] = {0,0,0};
    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_check_types);
          if (value) { values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_strict);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_allow_extra_args);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "curry") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_check_types = values[0];
    __pyx_v_strict = values[1];
    __pyx_v_allow_extra_args = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("curry", 0, 0, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.curry", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_curry(__pyx_self, __pyx_v_check_types, __pyx_v_strict, __pyx_v_allow_extra_args);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_curry(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_check_types, PyObject *__pyx_v_strict, PyObject *__pyx_v_allow_extra_args) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct__curry *__pyx_cur_scope;
  PyObject *__pyx_v_decorator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__3)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct__curry *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct__curry(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct__curry, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct__curry *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("curry", __pyx_f[0], 60, 0, <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_check_types = __pyx_v_check_types;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_check_types);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_check_types);
  __pyx_cur_scope-&gt;__pyx_v_strict = __pyx_v_strict;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_strict);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_strict);
  __pyx_cur_scope-&gt;__pyx_v_allow_extra_args = __pyx_v_allow_extra_args;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_allow_extra_args);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_allow_extra_args);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.curry", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_decorator);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__148 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_check_types, __pyx_n_s_strict, __pyx_n_s_allow_extra_args, __pyx_n_s_decorator, __pyx_n_s_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__148)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__148);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__148);
  __pyx_codeobj__3 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__148, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_curry, 60, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__3)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(60,0,<span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_1curry, 0, __pyx_n_s_curry, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__3));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_tuple__149);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_curry, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__149 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject *)Py_False), ((PyObject *)Py_False), ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__149)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__149);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__149);
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct__curry {
  PyObject_HEAD
  PyObject *__pyx_v_allow_extra_args;
  PyObject *__pyx_v_check_types;
  PyObject *__pyx_v_strict;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0061</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0062</span>:     Decorator for currying a function, with options for type checking,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0063</span>:     strict argument completion, and allowing extra arguments.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0064</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0065</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0066</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>:     check_types : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0068</span>:         If True, enables type checking against the annotated types of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0069</span>:         curried function's arguments. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0070</span>:     strict : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>:         If True, requires all arguments to be provided for the curried</pre>
<pre class="cython line score-0">&#xA0;<span class="">0072</span>:         function to execute. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0073</span>:     allow_extra_args : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0074</span>:         If True, the curried function accepts extra arguments beyond its</pre>
<pre class="cython line score-0">&#xA0;<span class="">0075</span>:         defined parameters. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0076</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0077</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0078</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0079</span>:     callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0080</span>:         A curried version of the original function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0081</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0082</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0083</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0084</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import curry</pre>
<pre class="cython line score-0">&#xA0;<span class="">0085</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0086</span>:     &gt;&gt;&gt; @curry(check_types=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0087</span>:     &gt;&gt;&gt; def add(x: int, y: int) -&gt; int:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0088</span>:     ...     return x + y</pre>
<pre class="cython line score-0">&#xA0;<span class="">0089</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0090</span>:     &gt;&gt;&gt; add_five = add(5)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0091</span>:     &gt;&gt;&gt; print(add_five(3))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0092</span>:     8</pre>
<pre class="cython line score-0">&#xA0;<span class="">0093</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0094</span>:     &gt;&gt;&gt; @curry(strict=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0095</span>:     &gt;&gt;&gt; def greet(greeting, name):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0096</span>:     ...     return f"{greeting}, {name}!"</pre>
<pre class="cython line score-0">&#xA0;<span class="">0097</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0098</span>:     &gt;&gt;&gt; greet_hello = greet("Hello")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0099</span>:     &gt;&gt;&gt; print(greet_hello("World"))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0100</span>:     Hello, World!</pre>
<pre class="cython line score-0">&#xA0;<span class="">0101</span>:     """</pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0102</span>:     def decorator(func):</pre>
<pre class='cython code score-54 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_5curry_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_5curry_1decorator = {"decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_5curry_1decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_5curry_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decorator", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.curry.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_5curry_decorator(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_5curry_decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_1_decorator *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_1_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_1_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_1_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_1_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct__curry *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("decorator", __pyx_f[0], 102, 0, <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.curry.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_func, __pyx_n_s_curried, __pyx_n_s_curried);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(102,0,<span class='error_goto'>__PYX_ERR(0, 102, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_5curry_1decorator, 0, __pyx_n_s_curry_locals_decorator, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__5));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_decorator = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__5 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__4, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_decorator, 102, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__5)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_1_decorator {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct__curry *__pyx_outer_scope;
  PyObject *__pyx_v_curried;
  PyObject *__pyx_v_func;
};

</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0103</span>:         @functools.wraps(func)</pre>
<pre class='cython code score-71 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_5curry_9decorator_1curried(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_5curry_9decorator_1curried = {"curried", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_5curry_9decorator_1curried, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_5curry_9decorator_1curried(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("curried (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "curried", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_5curry_9decorator_curried(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_5curry_9decorator_curried(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_1_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_1_decorator *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_1_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("curried", __pyx_f[0], 103, 0, <span class='error_goto'>__PYX_ERR(0, 103, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.curry.decorator.curried", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(103,0,<span class='error_goto'>__PYX_ERR(0, 103, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 103, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
/*  */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_args, __pyx_n_s_kwargs);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_5curry_9decorator_1curried, 0, __pyx_n_s_curry_locals_decorator_locals_cu, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__2));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 103, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_curried = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__2 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple_, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_curried, 103, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__2)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0104</span>:         def curried(*args, **kwargs):</pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0105</span>:             if _should_check_types(check_types):</pre>
<pre class='cython code score-21 '>  <span class='trace'>__Pyx_TraceLine</span>(105,0,<span class='error_goto'>__PYX_ERR(0, 105, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_should_check_types);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_check_types)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("check_types"); <span class='error_goto'>__PYX_ERR(0, 105, __pyx_L1_error)</span> }
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_check_types};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 105, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 105, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/*  */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0106</span>:                 _check_arg_types(func, args)</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(106,0,<span class='error_goto'>__PYX_ERR(0, 106, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_check_arg_types);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 106, __pyx_L1_error)</span> }
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 106, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0107</span>:             if _is_complete(func, args, kwargs, strict, allow_extra_args):</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(107,0,<span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_is_complete);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_strict)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("strict"); <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_allow_extra_args)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("allow_extra_args"); <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span> }
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[6] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_v_kwargs, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_strict, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_allow_extra_args};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 5+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/*  */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0108</span>:                 return func(*args, **kwargs)</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(108,0,<span class='error_goto'>__PYX_ERR(0, 108, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 108, __pyx_L1_error)</span> }
    __pyx_t_1 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0109</span>:             else:</pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0110</span>:                 return functools.partial(curried, *args, **kwargs)</pre>
<pre class='cython code score-32 '>  <span class='trace'>__Pyx_TraceLine</span>(110,0,<span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_partial);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_curried)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("curried"); <span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span> }
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_curried);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_curried);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_cur_scope-&gt;__pyx_v_curried)) <span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_v_args);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_6;
    __pyx_t_6 = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0111</span>:         return curried</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(111,0,<span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_curried);
  __pyx_r = __pyx_cur_scope-&gt;__pyx_v_curried;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0112</span>:     return decorator</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(112,0,<span class='error_goto'>__PYX_ERR(0, 112, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorator);
  __pyx_r = __pyx_v_decorator;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0113</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0114</span>: def _should_check_types(check_types):</pre>
<pre class='cython code score-51 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_3_should_check_types(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_2_should_check_types, "Determine if type checking is enabled.");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_3_should_check_types = {"_should_check_types", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_3_should_check_types, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_2_should_check_types};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_3_should_check_types(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_check_types = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_should_check_types (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_check_types,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_check_types)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_should_check_types") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_check_types = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_should_check_types", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._should_check_types", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_2_should_check_types(__pyx_self, __pyx_v_check_types);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_2_should_check_types(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_check_types) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__6)
  <span class='trace'>__Pyx_TraceCall</span>("_should_check_types", __pyx_f[0], 114, 0, <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._should_check_types", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__150 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_check_types);<span class='error_goto'> if (unlikely(!__pyx_tuple__150)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__150);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__150);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(114,0,<span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_3_should_check_types, 0, __pyx_n_s_should_check_types, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__6));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_should_check_types, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__6 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__150, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_should_check_types, 114, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__6)) __PYX_ERR(0, 114, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0115</span>:     """Determine if type checking is enabled."""</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0116</span>:     return check_types</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(116,0,<span class='error_goto'>__PYX_ERR(0, 116, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_check_types);
  __pyx_r = __pyx_v_check_types;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0117</span>: </pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0118</span>: def _check_arg_types(func, args):</pre>
<pre class='cython code score-74 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_5_check_arg_types(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_4_check_arg_types, "Check argument types against function annotations.");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_5_check_arg_types = {"_check_arg_types", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_5_check_arg_types, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_4_check_arg_types};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_5_check_arg_types(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_check_arg_types (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,&amp;__pyx_n_s_args,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_args)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_check_arg_types", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_check_arg_types") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_func = values[0];
    __pyx_v_args = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_check_arg_types", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_arg_types", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_4_check_arg_types(__pyx_self, __pyx_v_func, __pyx_v_args);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_4_check_arg_types(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args) {
  PyObject *__pyx_v_a = NULL;
  PyObject *__pyx_v_v = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__7)
  <span class='trace'>__Pyx_TraceCall</span>("_check_arg_types", __pyx_f[0], 118, 0, <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_arg_types", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_a);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__151 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_func, __pyx_n_s_args, __pyx_n_s_a, __pyx_n_s_v);<span class='error_goto'> if (unlikely(!__pyx_tuple__151)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__151);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__151);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(118,0,<span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_5_check_arg_types, 0, __pyx_n_s_check_arg_types, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__7));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_arg_types, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__7 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__151, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_check_arg_types, 118, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__7)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0119</span>:     """Check argument types against function annotations."""</pre>
<pre class="cython line score-149" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0120</span>:     for a, v in zip(inspect.signature(func).parameters.values(), args):</pre>
<pre class='cython code score-149 '>  <span class='trace'>__Pyx_TraceLine</span>(120,0,<span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_inspect);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_signature);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_parameters);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_values);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_args);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_args);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_args)) <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_6 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_6 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_7(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 120, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_8);
      index = 0; __pyx_t_4 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_4)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      index = 1; __pyx_t_3 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_8), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_a, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v, __pyx_t_3);
    __pyx_t_3 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(120,0,<span class='error_goto'>__PYX_ERR(0, 120, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0121</span>:         if a.annotation is not inspect.Parameter.empty and not isinstance(v, a.annotation):</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(121,0,<span class='error_goto'>__PYX_ERR(0, 121, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_a, __pyx_n_s_annotation);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_inspect);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_Parameter);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_11 = (__pyx_t_1 != __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_11) {
    } else {
      __pyx_t_10 = __pyx_t_11;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_a, __pyx_n_s_annotation);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_11 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_v, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_12 = (!__pyx_t_11);
    __pyx_t_10 = __pyx_t_12;
    __pyx_L8_bool_binop_done:;
    if (unlikely(__pyx_t_10)) {
/*  */
    }
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0122</span>:             raise TypeError(f"Argument {a.name} must be of type {a.annotation.__name__}")</pre>
<pre class='cython code score-45 '>      <span class='trace'>__Pyx_TraceLine</span>(122,0,<span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_13 = 0;
      __pyx_t_14 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Argument);
      __pyx_t_13 += 9;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Argument);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_kp_u_Argument);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_a, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_14 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_14) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_14;
      __pyx_t_13 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
      __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_must_be_of_type);
      __pyx_t_13 += 17;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_must_be_of_type);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_kp_u_must_be_of_type);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_a, __pyx_n_s_annotation);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_14 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_14) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_14;
      __pyx_t_13 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_t_4);
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 4, __pyx_t_13, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0123</span>: </pre>
<pre class="cython line score-115" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0124</span>: def _is_complete(func, args, kwargs, strict, allow_extra_args):</pre>
<pre class='cython code score-115 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7_is_complete(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_6_is_complete, "Check if the argument list completes the function signature.");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_7_is_complete = {"_is_complete", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_7_is_complete, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_6_is_complete};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7_is_complete(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_v_strict = 0;
  PyObject *__pyx_v_allow_extra_args = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_is_complete (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_strict,&amp;__pyx_n_s_allow_extra_args,0};
  PyObject* values[5] = {0,0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_args)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_is_complete", 1, 5, 5, 1); <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_kwargs)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_is_complete", 1, 5, 5, 2); <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_strict)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_is_complete", 1, 5, 5, 3); <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_allow_extra_args)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_is_complete", 1, 5, 5, 4); <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_is_complete") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 5)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
      values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
      values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
    }
    __pyx_v_func = values[0];
    __pyx_v_args = values[1];
    __pyx_v_kwargs = values[2];
    __pyx_v_strict = values[3];
    __pyx_v_allow_extra_args = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_is_complete", 1, 5, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._is_complete", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_6_is_complete(__pyx_self, __pyx_v_func, __pyx_v_args, __pyx_v_kwargs, __pyx_v_strict, __pyx_v_allow_extra_args);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_6_is_complete(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, PyObject *__pyx_v_strict, PyObject *__pyx_v_allow_extra_args) {
  Py_ssize_t __pyx_v_arg_count;
  PyObject *__pyx_v_required_arg_count = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__8)
  <span class='trace'>__Pyx_TraceCall</span>("_is_complete", __pyx_f[0], 124, 0, <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._is_complete", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_required_arg_count);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__152 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_func, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_strict, __pyx_n_s_allow_extra_args, __pyx_n_s_arg_count, __pyx_n_s_required_arg_count);<span class='error_goto'> if (unlikely(!__pyx_tuple__152)) __PYX_ERR(0, 124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__152);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__152);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(124,0,<span class='error_goto'>__PYX_ERR(0, 124, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_7_is_complete, 0, __pyx_n_s_is_complete, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__8));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_is_complete, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 124, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__8 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__152, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_is_complete, 124, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__8)) __PYX_ERR(0, 124, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0125</span>:     """Check if the argument list completes the function signature."""</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0126</span>:     arg_count = len(args) + len(kwargs)</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(126,0,<span class='error_goto'>__PYX_ERR(0, 126, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_args);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  __pyx_v_arg_count = (__pyx_t_1 + __pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0127</span>:     required_arg_count = func.__code__.co_argcount</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(127,0,<span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_func, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_co_argcount);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_required_arg_count = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0128</span>:     if allow_extra_args:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(128,0,<span class='error_goto'>__PYX_ERR(0, 128, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_allow_extra_args); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/*  */
  }
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0129</span>:         return arg_count &gt;= required_arg_count</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(129,0,<span class='error_goto'>__PYX_ERR(0, 129, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_arg_count);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_v_required_arg_count, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0130</span>:     if strict:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(130,0,<span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_strict); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/*  */
  }
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0131</span>:         return arg_count == required_arg_count</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(131,0,<span class='error_goto'>__PYX_ERR(0, 131, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_arg_count);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_v_required_arg_count, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 131, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0132</span>:     return arg_count &gt;= required_arg_count and not strict</pre>
<pre class='cython code score-21 '>  <span class='trace'>__Pyx_TraceLine</span>(132,0,<span class='error_goto'>__PYX_ERR(0, 132, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_arg_count);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_v_required_arg_count, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 132, __pyx_L1_error)</span>
  if (__pyx_t_5) {
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    __pyx_t_4 = __pyx_t_6;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_strict); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 132, __pyx_L1_error)</span>
  __pyx_t_7 = (!__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = __pyx_t_6;
  __pyx_t_6 = 0;
  __pyx_L5_bool_binop_done:;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0133</span>: </pre>
<pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0134</span>: def compose(*functions, reverse_order=True, type_check=False):</pre>
<pre class='cython code score-78 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_9compose(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_8compose, "\n    A hybrid function that can be used to compose multiple functions together or \n    as a decorator to enhance a single function. \n    \n    When used to compose multiple functions, it returns a new function that is\n    the composition of those functions. When used as a decorator, it enhances \n    the decorated function based on the provided parameters.\n\n    Parameters\n    ----------\n    *functions : callable\n        The functions to be composed. When used as a decorator, this contains \n        only the decorated function.\n    reverse_order : bool, optional\n        Controls the order of function application when composing multiple\n        functions. \n        Ignored when used as a decorator. Defaults to True.\n    type_check : bool, optional\n        Enables type checking based on annotations in the composed functions. \n        Defaults to False.\n\n    Returns\n    -------\n    callable\n        When composing functions, returns a new function representing the \n        composition.  When used as a decorator, returns the enhanced decorated\n        function.\n\n    Examples\n    --------\n    \n    # Used as a decorator\n    &gt;&gt;&gt; from gofast.tools.funcutils import compose \n    &gt;&gt;&gt; @compose(type_check=True)\n    ... def add_one(x: int) -&gt; int:\n    ...     return x + 1\n    &gt;&gt;&gt; print(add_one(4))\n    5\n\n    # Used to compose functions\n    &gt;&gt;&gt; def double(x):\n    ...     return x * 2\n    &gt;&gt;&gt; increment_and_double = compose(lambda x: x + 1, double)\n    &gt;&gt;&gt; print(increment_and_double(3))\n    8\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_9compose = {"compose", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_9compose, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_8compose};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_9compose(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_reverse_order = 0;
  PyObject *__pyx_v_type_check = 0;
  PyObject *__pyx_v_functions = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compose (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_functions = __pyx_args;
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_reverse_order,&amp;__pyx_n_s_type_check,0};
  PyObject* values[2] = {0,0};
    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(((PyObject *)((PyObject *)Py_True)));
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        default:
        case  0: break;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_VARARGS</span>(__pyx_kwds);
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 2)) {
        Py_ssize_t index;
        for (index = 0; index &lt; 2 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_VARARGS</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "compose") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs &lt; 0)) {
      goto __pyx_L5_argtuple_error;
    } else {
    }
    __pyx_v_reverse_order = values[0];
    __pyx_v_type_check = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compose", 0, 0, 0, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_VARARGS</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_CLEAR</span>(__pyx_v_functions);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.compose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_8compose(__pyx_self, __pyx_v_reverse_order, __pyx_v_type_check, __pyx_v_functions);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_functions);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_VARARGS</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_8compose(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_reverse_order, PyObject *__pyx_v_type_check, PyObject *__pyx_v_functions) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_2_compose *__pyx_cur_scope;
  PyObject *__pyx_v_composed_function = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__9)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_2_compose *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_2_compose(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_2_compose, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_2_compose *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("compose", __pyx_f[0], 134, 0, <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_type_check = __pyx_v_type_check;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_type_check);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_type_check);
  __pyx_cur_scope-&gt;__pyx_v_functions = __pyx_v_functions;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_functions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_functions);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.compose", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_composed_function);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__153 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_reverse_order, __pyx_n_s_type_check, __pyx_n_s_functions, __pyx_n_s_composed_function, __pyx_n_s_composed_function);<span class='error_goto'> if (unlikely(!__pyx_tuple__153)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__153);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__153);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(134,0,<span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_reverse_order, ((PyObject *)Py_True)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_type_check, ((PyObject *)Py_False)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_9compose, 0, __pyx_n_s_compose, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__9));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compose, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__9 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 2, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__153, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_compose, 134, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_2_compose {
  PyObject_HEAD
  PyObject *__pyx_v_functions;
  PyObject *__pyx_v_type_check;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0135</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0136</span>:     A hybrid function that can be used to compose multiple functions together or</pre>
<pre class="cython line score-0">&#xA0;<span class="">0137</span>:     as a decorator to enhance a single function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0138</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0139</span>:     When used to compose multiple functions, it returns a new function that is</pre>
<pre class="cython line score-0">&#xA0;<span class="">0140</span>:     the composition of those functions. When used as a decorator, it enhances</pre>
<pre class="cython line score-0">&#xA0;<span class="">0141</span>:     the decorated function based on the provided parameters.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0142</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0143</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0144</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0145</span>:     *functions : callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0146</span>:         The functions to be composed. When used as a decorator, this contains</pre>
<pre class="cython line score-0">&#xA0;<span class="">0147</span>:         only the decorated function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0148</span>:     reverse_order : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0149</span>:         Controls the order of function application when composing multiple</pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>:         functions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0151</span>:         Ignored when used as a decorator. Defaults to True.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0152</span>:     type_check : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>:         Enables type checking based on annotations in the composed functions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0154</span>:         Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0155</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0156</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0157</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0158</span>:     callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0159</span>:         When composing functions, returns a new function representing the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0160</span>:         composition.  When used as a decorator, returns the enhanced decorated</pre>
<pre class="cython line score-0">&#xA0;<span class="">0161</span>:         function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0162</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0163</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0164</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0165</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0166</span>:     # Used as a decorator</pre>
<pre class="cython line score-0">&#xA0;<span class="">0167</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import compose</pre>
<pre class="cython line score-0">&#xA0;<span class="">0168</span>:     &gt;&gt;&gt; @compose(type_check=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0169</span>:     ... def add_one(x: int) -&gt; int:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0170</span>:     ...     return x + 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0171</span>:     &gt;&gt;&gt; print(add_one(4))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0172</span>:     5</pre>
<pre class="cython line score-0">&#xA0;<span class="">0173</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0174</span>:     # Used to compose functions</pre>
<pre class="cython line score-0">&#xA0;<span class="">0175</span>:     &gt;&gt;&gt; def double(x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0176</span>:     ...     return x * 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">0177</span>:     &gt;&gt;&gt; increment_and_double = compose(lambda x: x + 1, double)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0178</span>:     &gt;&gt;&gt; print(increment_and_double(3))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0179</span>:     8</pre>
<pre class="cython line score-0">&#xA0;<span class="">0180</span>:     """</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0181</span>:     if len(functions) == 1 and callable(functions[0]):</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(181,0,<span class='error_goto'>__PYX_ERR(0, 181, __pyx_L1_error)</span>)
  __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_v_functions;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 181, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = (__pyx_t_3 == 1);
  if (__pyx_t_4) {
  } else {
    __pyx_t_1 = __pyx_t_4;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope-&gt;__pyx_v_functions, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 181, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_1 = __pyx_t_4;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0182</span>:         return _enhance_function(functions[0], type_check=type_check)</pre>
<pre class='cython code score-24 '>    <span class='trace'>__Pyx_TraceLine</span>(182,0,<span class='error_goto'>__PYX_ERR(0, 182, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_enhance_function);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_cur_scope-&gt;__pyx_v_functions, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 182, __pyx_L1_error)</span>;
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_type_check, __pyx_cur_scope-&gt;__pyx_v_type_check) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 182, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0183</span>:     else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0184</span>:         if reverse_order:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(184,0,<span class='error_goto'>__PYX_ERR(0, 184, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_reverse_order); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 184, __pyx_L1_error)</span>
    if (__pyx_t_1) {
/*  */
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0185</span>:             functions = reversed(functions)</pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(185,0,<span class='error_goto'>__PYX_ERR(0, 185, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_reversed, __pyx_cur_scope-&gt;__pyx_v_functions);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_functions);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_functions, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      __pyx_t_7 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0186</span>:         def composed_function(*args, **kwargs):</pre>
<pre class='cython code score-33 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7compose_1composed_function(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_7compose_1composed_function = {"composed_function", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_7compose_1composed_function, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7compose_1composed_function(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  CYTHON_UNUSED PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("composed_function (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "composed_function", 1))) return NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_7compose_composed_function(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_7compose_composed_function(PyObject *__pyx_self, PyObject *__pyx_v_args, CYTHON_UNUSED PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_2_compose *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_2_compose *__pyx_outer_scope;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_func = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_2_compose *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("composed_function", __pyx_f[0], 186, 0, <span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.compose.composed_function", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_func);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_result, __pyx_n_s_func);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(186,0,<span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_7compose_1composed_function, 0, __pyx_n_s_compose_locals_composed_function, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__11));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_v_composed_function = __pyx_t_7;
    __pyx_t_7 = 0;
  __pyx_codeobj__11 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__10, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_composed_function, 186, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0187</span>:             # Start with the initial argument</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0188</span>:             result = args</pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(188,0,<span class='error_goto'>__PYX_ERR(0, 188, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_args);
  __pyx_v_result = __pyx_v_args;
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0189</span>:             for func in functions:</pre>
<pre class='cython code score-51 '>  <span class='trace'>__Pyx_TraceLine</span>(189,0,<span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_functions)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("functions"); <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span> }
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_v_functions)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_v_functions)) {
    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_v_functions; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope-&gt;__pyx_v_functions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_func, __pyx_t_4);
    __pyx_t_4 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(189,0,<span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0190</span>:                 if type_check:</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(190,0,<span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span>)
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_type_check)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("type_check"); <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span> }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_type_check); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span>
    if (__pyx_t_5) {
/*  */
    }
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0191</span>:                     _check_comp_arg_types(func, *result)</pre>
<pre class='cython code score-24 '>      <span class='trace'>__Pyx_TraceLine</span>(191,0,<span class='error_goto'>__PYX_ERR(0, 191, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_check_comp_arg_types);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 191, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 191, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_func);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_func);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_func)) <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L1_error)</span>;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 191, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 191, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 191, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0192</span>:                 # Pass the result of the last function as the argument to the next</pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0193</span>:                 result = (func(*result),) if isinstance(result, tuple) else func(result)</pre>
<pre class='cython code score-33 '>    <span class='trace'>__Pyx_TraceLine</span>(193,0,<span class='error_goto'>__PYX_ERR(0, 193, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='py_c_api'>PyTuple_Check</span>(__pyx_v_result); 
    if (__pyx_t_5) {
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 193, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_func, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 193, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 193, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 193, __pyx_L1_error)</span>;
      __pyx_t_4 = 0;
      __pyx_t_7 = __pyx_t_8;
      __pyx_t_8 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_func);
      __pyx_t_4 = __pyx_v_func; __pyx_t_6 = NULL;
      __pyx_t_9 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_9 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_v_result};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 193, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      __pyx_t_7 = __pyx_t_8;
      __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_result, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0194</span>:             # Return the final result after all functions have been applied</pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0195</span>:             return result[0] if isinstance(result, tuple) else result</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(195,0,<span class='error_goto'>__PYX_ERR(0, 195, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_Check</span>(__pyx_v_result); 
  if (__pyx_t_5) {
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_result, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_1 = __pyx_t_7;
    __pyx_t_7 = 0;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
    __pyx_t_1 = __pyx_v_result;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0196</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0197</span>:         return composed_function</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(197,0,<span class='error_goto'>__PYX_ERR(0, 197, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_composed_function);
    __pyx_r = __pyx_v_composed_function;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0198</span>: </pre>
<pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0199</span>: def _enhance_function(func, type_check=False):</pre>
<pre class='cython code score-77 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11_enhance_function(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_10_enhance_function, "Enhances a single function with optional type checking.");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_11_enhance_function = {"_enhance_function", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_11_enhance_function, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_10_enhance_function};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11_enhance_function(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_type_check = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_enhance_function (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,&amp;__pyx_n_s_type_check,0};
  PyObject* values[2] = {0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_type_check);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_enhance_function") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_func = values[0];
    __pyx_v_type_check = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_enhance_function", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._enhance_function", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_10_enhance_function(__pyx_self, __pyx_v_func, __pyx_v_type_check);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_10_enhance_function(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_func, PyObject *__pyx_v_type_check) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_3__enhance_function *__pyx_cur_scope;
  PyObject *__pyx_v_wrapper = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__12)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_3__enhance_function *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_3__enhance_function(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_3__enhance_function, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_3__enhance_function *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("_enhance_function", __pyx_f[0], 199, 0, <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  __pyx_cur_scope-&gt;__pyx_v_type_check = __pyx_v_type_check;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_type_check);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_type_check);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._enhance_function", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_wrapper);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__154 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_func, __pyx_n_s_type_check, __pyx_n_s_wrapper, __pyx_n_s_wrapper);<span class='error_goto'> if (unlikely(!__pyx_tuple__154)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__154);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__154);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(199,0,<span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_11_enhance_function, 0, __pyx_n_s_enhance_function, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__12));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__62);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_enhance_function, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__12 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__154, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_enhance_function, 199, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_3__enhance_function {
  PyObject_HEAD
  PyObject *__pyx_v_func;
  PyObject *__pyx_v_type_check;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0200</span>:     """Enhances a single function with optional type checking."""</pre>
<pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0201</span>:     @functools.wraps(func)</pre>
<pre class='cython code score-66 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17_enhance_function_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_17_enhance_function_1wrapper = {"wrapper", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_17_enhance_function_1wrapper, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17_enhance_function_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("wrapper (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "wrapper", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_17_enhance_function_wrapper(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_17_enhance_function_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_3__enhance_function *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_3__enhance_function *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_3__enhance_function *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("wrapper", __pyx_f[0], 201, 0, <span class='error_goto'>__PYX_ERR(0, 201, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._enhance_function.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(201,0,<span class='error_goto'>__PYX_ERR(0, 201, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 201, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_17_enhance_function_1wrapper, 0, __pyx_n_s_enhance_function_locals_wrapper, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__13));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 201, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_wrapper = __pyx_t_1;
  __pyx_t_1 = 0;
/*  */
  __pyx_codeobj__13 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple_, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_wrapper, 201, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__13)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0202</span>:     def wrapper(*args, **kwargs):</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0203</span>:         if type_check:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(203,0,<span class='error_goto'>__PYX_ERR(0, 203, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_type_check)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("type_check"); <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_type_check); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0204</span>:             _check_comp_arg_types(func, *args, **kwargs)</pre>
<pre class='cython code score-29 '>    <span class='trace'>__Pyx_TraceLine</span>(204,0,<span class='error_goto'>__PYX_ERR(0, 204, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_check_comp_arg_types);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 204, __pyx_L1_error)</span> }
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_cur_scope-&gt;__pyx_v_func)) <span class='error_goto'>__PYX_ERR(0, 204, __pyx_L1_error)</span>;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_args);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0205</span>:         return func(*args, **kwargs)</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(205,0,<span class='error_goto'>__PYX_ERR(0, 205, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L1_error)</span> }
  __pyx_t_5 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 205, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 205, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0206</span>:     return wrapper</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(206,0,<span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wrapper);
  __pyx_r = __pyx_v_wrapper;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0207</span>: </pre>
<pre class="cython line score-72" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0208</span>: def _compose_functions(*functions, reverse_order, type_check):</pre>
<pre class='cython code score-72 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_13_compose_functions(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_12_compose_functions, "Composes multiple functions with optional type checking and error handling.");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_13_compose_functions = {"_compose_functions", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_13_compose_functions, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_12_compose_functions};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_13_compose_functions(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_reverse_order = 0;
  PyObject *__pyx_v_type_check = 0;
  PyObject *__pyx_v_functions = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_compose_functions (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_functions = __pyx_args;
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_reverse_order,&amp;__pyx_n_s_type_check,0};
  PyObject* values[2] = {0,0};
    if (likely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        default:
        case  0: break;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_VARARGS</span>(__pyx_kwds);
      if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_VARARGS</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_reverse_order)) != 0)) {
        (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(values[0]);
        kw_args--;
      }
      else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
      else {
        <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("_compose_functions", __pyx_n_s_reverse_order); <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
      }
      if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_VARARGS</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_type_check)) != 0)) {
        (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(values[1]);
        kw_args--;
      }
      else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
      else {
        <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("_compose_functions", __pyx_n_s_type_check); <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "_compose_functions") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs &lt; 0)) {
      goto __pyx_L5_argtuple_error;
    } else {
      <span class='pyx_c_api'>__Pyx_RaiseKeywordRequired</span>("_compose_functions", __pyx_n_s_reverse_order); <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
    }
    __pyx_v_reverse_order = values[0];
    __pyx_v_type_check = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compose_functions", 0, 0, 0, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_VARARGS</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_CLEAR</span>(__pyx_v_functions);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._compose_functions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_12_compose_functions(__pyx_self, __pyx_v_reverse_order, __pyx_v_type_check, __pyx_v_functions);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_functions);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_VARARGS</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_12_compose_functions(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_reverse_order, PyObject *__pyx_v_type_check, PyObject *__pyx_v_functions) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_4__compose_functions *__pyx_cur_scope;
  PyObject *__pyx_v_composed = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__14)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_4__compose_functions *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_4__compose_functions(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_4__compose_functions, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_4__compose_functions *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("_compose_functions", __pyx_f[0], 208, 0, <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_reverse_order = __pyx_v_reverse_order;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_reverse_order);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_reverse_order);
  __pyx_cur_scope-&gt;__pyx_v_type_check = __pyx_v_type_check;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_type_check);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_type_check);
  __pyx_cur_scope-&gt;__pyx_v_functions = __pyx_v_functions;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_functions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_functions);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._compose_functions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_composed);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__155 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_reverse_order, __pyx_n_s_type_check, __pyx_n_s_functions, __pyx_n_s_composed, __pyx_n_s_composed);<span class='error_goto'> if (unlikely(!__pyx_tuple__155)) __PYX_ERR(0, 208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__155);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__155);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(208,0,<span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_13_compose_functions, 0, __pyx_n_s_compose_functions, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__14));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compose_functions, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__14 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 2, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__155, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_compose_functions, 208, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 208, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_4__compose_functions {
  PyObject_HEAD
  PyObject *__pyx_v_functions;
  PyObject *__pyx_v_reverse_order;
  PyObject *__pyx_v_type_check;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0209</span>:     """Composes multiple functions with optional type checking and error handling."""</pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0210</span>:     def composed(*args, **kwargs):</pre>
<pre class='cython code score-40 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_18_compose_functions_1composed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_18_compose_functions_1composed = {"composed", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_18_compose_functions_1composed, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_18_compose_functions_1composed(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("composed (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "composed", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_18_compose_functions_composed(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_18_compose_functions_composed(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_4__compose_functions *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_4__compose_functions *__pyx_outer_scope;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_funcs = NULL;
  PyObject *__pyx_v_func = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_4__compose_functions *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("composed", __pyx_f[0], 210, 0, <span class='error_goto'>__PYX_ERR(0, 210, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._compose_functions.composed", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_funcs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_func);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_result, __pyx_n_s_funcs, __pyx_n_s_func);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 210, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(210,0,<span class='error_goto'>__PYX_ERR(0, 210, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_18_compose_functions_1composed, 0, __pyx_n_s_compose_functions_locals_compos, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__16));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 210, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_composed = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__16 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__15, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_composed, 210, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 210, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0211</span>:         result = args[0] if args else kwargs.get('result', None)</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(211,0,<span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>)
  __pyx_t_2 = (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_args) != 0);
  if (__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(__pyx_v_args, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = __pyx_t_3;
    __pyx_t_3 = 0;
  } else {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_GetItemDefault</span>(__pyx_v_kwargs, __pyx_n_u_result, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = __pyx_t_3;
    __pyx_t_3 = 0;
  }
  __pyx_v_result = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0212</span>:         funcs = functions if reverse_order else reversed(functions)</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(212,0,<span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_reverse_order)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("reverse_order"); <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_reverse_order); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>
  if (__pyx_t_2) {
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_functions)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("functions"); <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span> }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_functions);
    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_v_functions;
  } else {
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_functions)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("functions"); <span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span> }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_reversed, __pyx_cur_scope-&gt;__pyx_v_functions);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 212, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = __pyx_t_3;
    __pyx_t_3 = 0;
  }
  __pyx_v_funcs = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0213</span>:         for func in funcs:</pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(213,0,<span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>)
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_funcs)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_funcs)) {
    __pyx_t_1 = __pyx_v_funcs; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_funcs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 213, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_4 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 213, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_4 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 213, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_func, __pyx_t_3);
    __pyx_t_3 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(213,0,<span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0214</span>:             if type_check:</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(214,0,<span class='error_goto'>__PYX_ERR(0, 214, __pyx_L1_error)</span>)
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_type_check)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("type_check"); <span class='error_goto'>__PYX_ERR(0, 214, __pyx_L1_error)</span> }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_type_check); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 214, __pyx_L1_error)</span>
    if (__pyx_t_2) {
/*  */
    }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0215</span>:                 _check_comp_arg_types(func, result)</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(215,0,<span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_check_comp_arg_types);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 215, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = NULL;
      __pyx_t_8 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_8 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_7, __pyx_v_func, __pyx_v_result};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 215, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0216</span>:             result = func(result)</pre>
<pre class='cython code score-16 '>    <span class='trace'>__Pyx_TraceLine</span>(216,0,<span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_func);
    __pyx_t_6 = __pyx_v_func; __pyx_t_7 = NULL;
    __pyx_t_8 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_8 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_result};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 216, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_result, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0217</span>:         return result</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(217,0,<span class='error_goto'>__PYX_ERR(0, 217, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0218</span>:     return composed</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(218,0,<span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_composed);
  __pyx_r = __pyx_v_composed;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0219</span>: </pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0220</span>: def _check_comp_arg_types(func, *args, **kwargs):</pre>
<pre class='cython code score-73 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15_check_comp_arg_types(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_14_check_comp_arg_types, "Check argument types against function annotations.");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_15_check_comp_arg_types = {"_check_comp_arg_types", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_15_check_comp_arg_types, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_14_check_comp_arg_types};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15_check_comp_arg_types(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_check_comp_arg_types (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  __pyx_v_args = <span class='pyx_c_api'>__Pyx_ArgsSlice_FASTCALL</span>(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return NULL;
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_args);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        default:
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        const Py_ssize_t used_pos_args = (kwd_pos_args &lt; 1) ? kwd_pos_args : 1;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, used_pos_args, "_check_comp_arg_types") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs &lt; 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_check_comp_arg_types", 0, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args); __pyx_v_args = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_comp_arg_types", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_14_check_comp_arg_types(__pyx_self, __pyx_v_func, __pyx_v_args, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_14_check_comp_arg_types(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_func, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_sig = NULL;
  PyObject *__pyx_v_bound_values = NULL;
  PyObject *__pyx_v_name = NULL;
  PyObject *__pyx_v_value = NULL;
  PyObject *__pyx_v_expected_type = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__17)
  <span class='trace'>__Pyx_TraceCall</span>("_check_comp_arg_types", __pyx_f[0], 220, 0, <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_comp_arg_types", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bound_values);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_expected_type);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__156 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_func, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_sig, __pyx_n_s_bound_values, __pyx_n_s_name, __pyx_n_s_value, __pyx_n_s_expected_type);<span class='error_goto'> if (unlikely(!__pyx_tuple__156)) __PYX_ERR(0, 220, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__156);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__156);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(220,0,<span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_15_check_comp_arg_types, 0, __pyx_n_s_check_comp_arg_types, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__17));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 220, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_comp_arg_types, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 220, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__17 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__156, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_check_comp_arg_types, 220, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__17)) __PYX_ERR(0, 220, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0221</span>:     """Check argument types against function annotations."""</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0222</span>:     sig = inspect.signature(func)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(222,0,<span class='error_goto'>__PYX_ERR(0, 222, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_inspect);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 222, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_signature);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 222, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_func};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 222, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_sig = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0223</span>:     bound_values = sig.bind(*args, **kwargs).arguments</pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(223,0,<span class='error_goto'>__PYX_ERR(0, 223, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sig, __pyx_n_s_bind);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_v_args, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_arguments);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_bound_values = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0224</span>:     for name, value in bound_values.items():</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(224,0,<span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>)
  __pyx_t_5 = 0;
  if (unlikely(__pyx_v_bound_values == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "items");
    <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>
  }
  __pyx_t_2 = __Pyx_dict_iterator(__pyx_v_bound_values, 0, __pyx_n_s_items, (&amp;__pyx_t_6), (&amp;__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  __pyx_t_3 = __pyx_t_2;
  __pyx_t_2 = 0;
  while (1) {
    __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_3, __pyx_t_6, &amp;__pyx_t_5, &amp;__pyx_t_2, &amp;__pyx_t_1, NULL, __pyx_t_4);
    if (unlikely(__pyx_t_7 == 0)) break;
    if (unlikely(__pyx_t_7 == -1)) <span class='error_goto'>__PYX_ERR(0, 224, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_name, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_value, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0225</span>:         expected_type = sig.parameters[name].annotation</pre>
<pre class='cython code score-9 '>    <span class='trace'>__Pyx_TraceLine</span>(225,0,<span class='error_goto'>__PYX_ERR(0, 225, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_sig, __pyx_n_s_parameters);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_annotation);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_expected_type, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0226</span>:         if expected_type is not inspect.Parameter.empty and not isinstance(</pre>
<pre class='cython code score-15 '>    <span class='trace'>__Pyx_TraceLine</span>(226,0,<span class='error_goto'>__PYX_ERR(0, 226, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_inspect);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_Parameter);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_9 = (__pyx_v_expected_type != __pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_9) {
    } else {
      __pyx_t_8 = __pyx_t_9;
      goto __pyx_L6_bool_binop_done;
    }
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(227,0,<span class='error_goto'>__PYX_ERR(0, 227, __pyx_L1_error)</span>)
    __pyx_t_9 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_value, __pyx_v_expected_type);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 226, __pyx_L1_error)</span>
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(226,0,<span class='error_goto'>__PYX_ERR(0, 226, __pyx_L1_error)</span>)
    __pyx_t_10 = (!__pyx_t_9);
    __pyx_t_8 = __pyx_t_10;
    __pyx_L6_bool_binop_done:;
    if (unlikely(__pyx_t_8)) {
/*  */
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0227</span>:                 value, expected_type):</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0228</span>:             raise TypeError(</pre>
<pre class='cython code score-6 '>      <span class='trace'>__Pyx_TraceLine</span>(228,0,<span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0229</span>:                 f"Argument {name} must be of type {expected_type.__name__},"</pre>
<pre class='cython code score-35 '>      <span class='trace'>__Pyx_TraceLine</span>(229,0,<span class='error_goto'>__PYX_ERR(0, 229, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_11 = 0;
      __pyx_t_12 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Argument);
      __pyx_t_11 += 9;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Argument);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_Argument);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_name, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) : __pyx_t_12;
      __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_must_be_of_type);
      __pyx_t_11 += 17;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_must_be_of_type);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_must_be_of_type);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_expected_type, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_2, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_13) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_13) : __pyx_t_12;
      __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_13);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_13);
      __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_got);
      __pyx_t_11 += 6;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_got);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_kp_u_got);
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(229,0,<span class='error_goto'>__PYX_ERR(0, 229, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 6, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0230</span>:                 f" got {type(value).__name__}")</pre>
<pre class='cython code score-12 '>      <span class='trace'>__Pyx_TraceLine</span>(230,0,<span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>)
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)Py_TYPE(__pyx_v_value)), __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 230, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_13, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 230, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) : __pyx_t_12;
      __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 5, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0231</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0232</span>: def memoize(</pre>
<pre class='cython code score-42 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17memoize(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_16memoize, "\n    A hybrid decorator for memoizing a function with options for cache size limit, \n    eviction policy, and thread safety.\n    \n    Functions caches results of function calls, optimizing performance for \n    expensive operations when called with repeated arguments.\n\n    Parameters\n    ----------\n    func : callable, optional\n        The function to be memoized. If not provided, returns a decorator that \n        takes a function and memoizes it.\n    cache_limit : int, optional\n        The maximum number of results to cache. If None (default), caches all results.\n    eviction_policy : str, optional\n        The cache eviction policy to use when the cache is full. Supported policies \n        are 'LRU' (Least Recently Used, default) and 'FIFO' (First In, First Out).\n    thread_safe : bool, optional\n        If True, makes the memoization thread-safe using a lock. Defaults to False.\n\n    Returns\n    -------\n    callable\n        The memoized function.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import memoize\n\n    &gt;&gt;&gt; @memoize(cache_limit=100, eviction_policy='LRU', thread_safe=True)\n    &gt;&gt;&gt; def fibonacci(n):\n    ...      if n &lt; 2:\n    ...          return n\n    ...   return fibonacci(n - 1) + fibonacci(n - 2)\n\n    &gt;&gt;&gt; print(fibonacci(10))\n    55\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_17memoize = {"memoize", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_17memoize, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_16memoize};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17memoize(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_cache_limit = 0;
  PyObject *__pyx_v_eviction_policy = 0;
  PyObject *__pyx_v_thread_safe = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("memoize (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,&amp;__pyx_n_s_cache_limit,&amp;__pyx_n_s_eviction_policy,&amp;__pyx_n_s_thread_safe,0};
  PyObject* values[4] = {0,0,0,0};
/*  */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_16memoize(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_func, PyObject *__pyx_v_cache_limit, PyObject *__pyx_v_eviction_policy, PyObject *__pyx_v_thread_safe) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_5_memoize *__pyx_cur_scope;
  PyObject *__pyx_v_decorator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__25)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_5_memoize *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_5_memoize(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_5_memoize, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_5_memoize *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("memoize", __pyx_f[0], 232, 0, <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_cache_limit = __pyx_v_cache_limit;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_cache_limit);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_cache_limit);
  __pyx_cur_scope-&gt;__pyx_v_eviction_policy = __pyx_v_eviction_policy;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_eviction_policy);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_eviction_policy);
  __pyx_cur_scope-&gt;__pyx_v_thread_safe = __pyx_v_thread_safe;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_thread_safe);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_thread_safe);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.memoize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_decorator);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__157 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_func, __pyx_n_s_cache_limit, __pyx_n_s_eviction_policy, __pyx_n_s_thread_safe, __pyx_n_s_decorator, __pyx_n_s_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__157)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__157);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__157);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(232,0,<span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(232,0,<span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_17memoize, 0, __pyx_n_s_memoize, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__25));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_tuple__139);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_memoize, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__25 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 3, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__157, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_memoize, 232, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 232, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_5_memoize {
  PyObject_HEAD
  PyObject *__pyx_v_cache_limit;
  PyObject *__pyx_v_eviction_policy;
  PyObject *__pyx_v_thread_safe;
};

</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0233</span>:     func=None, *,</pre>
<pre class='cython code score-2 '>    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0234</span>:     cache_limit=None,</pre>
<pre class='cython code score-19 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_LRU)));
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(234,0,<span class='error_goto'>__PYX_ERR(0, 234, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_cache_limit, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_eviction_policy, ((PyObject*)__pyx_n_u_LRU)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_thread_safe, ((PyObject *)Py_False)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0235</span>:     eviction_policy='LRU',</pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0236</span>:     thread_safe=False</pre>
<pre class='cython code score-34 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func);
          if (value) { values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 3)) {
        Py_ssize_t index;
        for (index = 1; index &lt; 4 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "memoize") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_func = values[0];
    __pyx_v_cache_limit = values[1];
    __pyx_v_eviction_policy = values[2];
    __pyx_v_thread_safe = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("memoize", 0, 0, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.memoize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_16memoize(__pyx_self, __pyx_v_func, __pyx_v_cache_limit, __pyx_v_eviction_policy, __pyx_v_thread_safe);
</pre><pre class="cython line score-0">&#xA0;<span class="">0237</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0238</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0239</span>:     A hybrid decorator for memoizing a function with options for cache size limit,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0240</span>:     eviction policy, and thread safety.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0241</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0242</span>:     Functions caches results of function calls, optimizing performance for</pre>
<pre class="cython line score-0">&#xA0;<span class="">0243</span>:     expensive operations when called with repeated arguments.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0244</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0245</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0246</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0247</span>:     func : callable, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0248</span>:         The function to be memoized. If not provided, returns a decorator that</pre>
<pre class="cython line score-0">&#xA0;<span class="">0249</span>:         takes a function and memoizes it.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0250</span>:     cache_limit : int, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0251</span>:         The maximum number of results to cache. If None (default), caches all results.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0252</span>:     eviction_policy : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0253</span>:         The cache eviction policy to use when the cache is full. Supported policies</pre>
<pre class="cython line score-0">&#xA0;<span class="">0254</span>:         are 'LRU' (Least Recently Used, default) and 'FIFO' (First In, First Out).</pre>
<pre class="cython line score-0">&#xA0;<span class="">0255</span>:     thread_safe : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0256</span>:         If True, makes the memoization thread-safe using a lock. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0257</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0258</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0259</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0260</span>:     callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0261</span>:         The memoized function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0262</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0263</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0264</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0265</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import memoize</pre>
<pre class="cython line score-0">&#xA0;<span class="">0266</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0267</span>:     &gt;&gt;&gt; @memoize(cache_limit=100, eviction_policy='LRU', thread_safe=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0268</span>:     &gt;&gt;&gt; def fibonacci(n):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0269</span>:     ...      if n &lt; 2:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0270</span>:     ...          return n</pre>
<pre class="cython line score-0">&#xA0;<span class="">0271</span>:     ...   return fibonacci(n - 1) + fibonacci(n - 2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0272</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0273</span>:     &gt;&gt;&gt; print(fibonacci(10))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0274</span>:     55</pre>
<pre class="cython line score-0">&#xA0;<span class="">0275</span>:     """</pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0276</span>:     def decorator(func):</pre>
<pre class='cython code score-55 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7memoize_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_7memoize_1decorator = {"decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_7memoize_1decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7memoize_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decorator", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.memoize.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_7memoize_decorator(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_7memoize_decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *__pyx_cur_scope;
  PyObject *__pyx_v_memoized = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_5_memoize *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("decorator", __pyx_f[0], 276, 0, <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.memoize.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_memoized);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_func, __pyx_n_s_memo, __pyx_n_s_cache_keys, __pyx_n_s_lock, __pyx_n_s_memoized, __pyx_n_s_memoized, __pyx_n_s_check_cache, __pyx_n_s_check_cache, __pyx_n_s_handle_eviction, __pyx_n_s_handle_eviction);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 276, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(276,0,<span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_7memoize_1decorator, 0, __pyx_n_s_memoize_locals_decorator, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__27));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_decorator = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__27 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_decorator, 276, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 276, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_5_memoize *__pyx_outer_scope;
  PyObject *__pyx_v_cache_keys;
  PyObject *__pyx_v_check_cache;
  PyObject *__pyx_v_func;
  PyObject *__pyx_v_handle_eviction;
  PyObject *__pyx_v_lock;
  PyObject *__pyx_v_memo;
};

</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0277</span>:         memo = {}</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(277,0,<span class='error_goto'>__PYX_ERR(0, 277, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_memo = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0278</span>:         cache_keys = []</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(278,0,<span class='error_goto'>__PYX_ERR(0, 278, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_cache_keys = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0279</span>:         lock = threading.Lock() if thread_safe else None</pre>
<pre class='cython code score-24 '>  <span class='trace'>__Pyx_TraceLine</span>(279,0,<span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_thread_safe)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("thread_safe"); <span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_thread_safe); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>
  if (__pyx_t_2) {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_threading);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_Lock);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 279, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 279, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_t_1 = __pyx_t_3;
    __pyx_t_3 = 0;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    __pyx_t_1 = Py_None;
  }
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_lock = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0280</span>: </pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0281</span>:         @functools.wraps(func)</pre>
<pre class='cython code score-73 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7memoize_9decorator_1memoized(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_7memoize_9decorator_1memoized = {"memoized", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_7memoize_9decorator_1memoized, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7memoize_9decorator_1memoized(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("memoized (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "memoized", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_7memoize_9decorator_memoized(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_7memoize_9decorator_memoized(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *__pyx_outer_scope;
  PyObject *__pyx_v_key = NULL;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("memoized", __pyx_f[0], 281, 0, <span class='error_goto'>__PYX_ERR(0, 281, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.memoize.decorator.memoized", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(281,0,<span class='error_goto'>__PYX_ERR(0, 281, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 281, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
/*  */
  __pyx_tuple__19 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_key, __pyx_n_s_result);<span class='error_goto'> if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__19);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_7memoize_9decorator_1memoized, 0, __pyx_n_s_memoize_locals_decorator_locals, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__20));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 281, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 281, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_memoized = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__20 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__19, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_memoized, 281, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__20)) __PYX_ERR(0, 281, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0282</span>:         def memoized(*args, **kwargs):</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0283</span>:             key = args + tuple(kwargs.items())</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(283,0,<span class='error_goto'>__PYX_ERR(0, 283, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_Items</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 283, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 283, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_args, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 283, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_key = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0284</span>:             if lock:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(284,0,<span class='error_goto'>__PYX_ERR(0, 284, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_lock)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("lock"); <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L1_error)</span> }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_lock); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L1_error)</span>
  if (__pyx_t_3) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0285</span>:                 with lock:</pre>
<pre class='cython code score-62 '>    <span class='trace'>__Pyx_TraceLine</span>(285,0,<span class='error_goto'>__PYX_ERR(0, 285, __pyx_L1_error)</span>)
    /*with:*/ {
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_lock)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("lock"); <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L1_error)</span> }
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_cur_scope-&gt;__pyx_v_lock, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_cur_scope-&gt;__pyx_v_lock, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 285, __pyx_L4_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L4_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      /*try:*/ {
        {
          /*try:*/ {
/*  */
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          goto __pyx_L13_try_end;
          __pyx_L8_error:;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          /*except:*/ {
            <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.memoize.decorator.memoized", __pyx_clineno, __pyx_lineno, __pyx_filename);
            if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_5, &amp;__pyx_t_1, &amp;__pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L10_except_error)</span>
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);
            __pyx_t_10 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_5, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 285, __pyx_L10_except_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
            __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_10, NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
            if (unlikely(!__pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L10_except_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
            if (__pyx_t_3 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L10_except_error)</span>
            __pyx_t_12 = (!__pyx_t_3);
            if (unlikely(__pyx_t_12)) {
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
              <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_5, __pyx_t_1, __pyx_t_2);
              __pyx_t_5 = 0; __pyx_t_1 = 0; __pyx_t_2 = 0; 
              <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L10_except_error)</span>
            }
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            goto __pyx_L9_exception_handled;
          }
          __pyx_L10_except_error:;
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
          goto __pyx_L1_error;
          __pyx_L9_exception_handled:;
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
          __pyx_L13_try_end:;
        }
      }
      /*finally:*/ {
        /*normal exit:*/{
          if (__pyx_t_4) {
            __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__18, NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          }
          goto __pyx_L7;
        }
        __pyx_L7:;
      }
      goto __pyx_L17;
      __pyx_L4_error:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L1_error;
      __pyx_L17:;
    }
/*  */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0286</span>:                     result = check_cache(key,  *args, **kwargs)</pre>
<pre class='cython code score-25 '>            <span class='trace'>__Pyx_TraceLine</span>(286,0,<span class='error_goto'>__PYX_ERR(0, 286, __pyx_L8_error)</span>)
            if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_check_cache)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("check_cache"); <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L8_error)</span> }
            __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L8_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_key);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_key);
            if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_key)) <span class='error_goto'>__PYX_ERR(0, 286, __pyx_L8_error)</span>;
            __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_args);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 286, __pyx_L8_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L8_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_check_cache, __pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L8_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_v_result = __pyx_t_5;
            __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0287</span>:             else:</pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0288</span>:                 result = check_cache(key, *args, **kwargs)</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(288,0,<span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>)
  /*else*/ {
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_check_cache)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("check_cache"); <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span> }
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_key);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_key);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_key)) <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_v_args);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_check_cache, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_result = __pyx_t_5;
    __pyx_t_5 = 0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0289</span>:             return result</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(289,0,<span class='error_goto'>__PYX_ERR(0, 289, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_result)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("result"); <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0290</span>: </pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0291</span>:         def check_cache(key, *args, **kwargs):</pre>
<pre class='cython code score-61 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7memoize_9decorator_3check_cache(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_7memoize_9decorator_3check_cache = {"check_cache", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_7memoize_9decorator_3check_cache, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7memoize_9decorator_3check_cache(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_key = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("check_cache (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  __pyx_v_args = <span class='pyx_c_api'>__Pyx_ArgsSlice_FASTCALL</span>(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return NULL;
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_args);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_key,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        default:
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_key)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 291, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        const Py_ssize_t used_pos_args = (kwd_pos_args &lt; 1) ? kwd_pos_args : 1;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, used_pos_args, "check_cache") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 291, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs &lt; 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_key = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("check_cache", 0, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 291, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args); __pyx_v_args = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.memoize.decorator.check_cache", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_7memoize_9decorator_2check_cache(__pyx_self, __pyx_v_key, __pyx_v_args, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_7memoize_9decorator_2check_cache(PyObject *__pyx_self, PyObject *__pyx_v_key, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *__pyx_outer_scope;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("check_cache", __pyx_f[0], 291, 0, <span class='error_goto'>__PYX_ERR(0, 291, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.memoize.decorator.check_cache", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_key, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_result);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 291, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(291,0,<span class='error_goto'>__PYX_ERR(0, 291, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_7memoize_9decorator_3check_cache, 0, __pyx_n_s_memoize_locals_decorator_locals_2, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__22));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_check_cache = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__22 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_check_cache, 291, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(0, 291, __pyx_L1_error)</span>
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0292</span>:             if key in memo:</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(292,0,<span class='error_goto'>__PYX_ERR(0, 292, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_memo)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("memo"); <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L1_error)</span> }
  if (unlikely(__pyx_cur_scope-&gt;__pyx_v_memo == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L1_error)</span>
  }
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_v_key, __pyx_cur_scope-&gt;__pyx_v_memo, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0293</span>:                 if eviction_policy == 'LRU':</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(293,0,<span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span>)
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_eviction_policy)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("eviction_policy"); <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span> }
    __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_eviction_policy, __pyx_n_u_LRU, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span>
    if (__pyx_t_1) {
/*  */
    }
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0294</span>:                     cache_keys.append(cache_keys.pop(cache_keys.index(key)))</pre>
<pre class='cython code score-29 '>      <span class='trace'>__Pyx_TraceLine</span>(294,0,<span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span>)
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_cache_keys)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cache_keys"); <span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span> }
      if (unlikely(__pyx_cur_scope-&gt;__pyx_v_cache_keys == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
        <span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_cache_keys)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cache_keys"); <span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span> }
      if (unlikely(__pyx_cur_scope-&gt;__pyx_v_cache_keys == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "pop");
        <span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span>
      }
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_cache_keys)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cache_keys"); <span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span> }
      __pyx_t_2 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PyList_Type_index, __pyx_cur_scope-&gt;__pyx_v_cache_keys, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span>
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyList_PopIndex</span>(__pyx_cur_scope-&gt;__pyx_v_cache_keys, __pyx_t_2, __pyx_t_3, 1, Py_ssize_t, PyInt_FromSsize_t);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_cur_scope-&gt;__pyx_v_cache_keys, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 294, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0295</span>:                 return memo[key]</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(295,0,<span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_memo)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("memo"); <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span> }
    if (unlikely(__pyx_cur_scope-&gt;__pyx_v_memo == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_memo, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0296</span>:             result = func(*args, **kwargs)</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(296,0,<span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span> }
  __pyx_t_4 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_result = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0297</span>:             handle_eviction(key, result)</pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(297,0,<span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_handle_eviction)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("handle_eviction"); <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span> }
  __pyx_t_2 = __pyx_pf_6gofast_5tools_9funcutils_7memoize_9decorator_4handle_eviction(__pyx_cur_scope-&gt;__pyx_v_handle_eviction, __pyx_v_key, __pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0298</span>:             return result</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(298,0,<span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0299</span>: </pre>
<pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0300</span>:         def handle_eviction(key, result):</pre>
<pre class='cython code score-66 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7memoize_9decorator_5handle_eviction(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_7memoize_9decorator_5handle_eviction = {"handle_eviction", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_7memoize_9decorator_5handle_eviction, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_7memoize_9decorator_5handle_eviction(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_key = 0;
  PyObject *__pyx_v_result = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("handle_eviction (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_key,&amp;__pyx_n_s_result,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_key)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_result)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("handle_eviction", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "handle_eviction") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_key = values[0];
    __pyx_v_result = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("handle_eviction", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.memoize.decorator.handle_eviction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_7memoize_9decorator_4handle_eviction(__pyx_self, __pyx_v_key, __pyx_v_result);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_7memoize_9decorator_4handle_eviction(PyObject *__pyx_self, PyObject *__pyx_v_key, PyObject *__pyx_v_result) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *__pyx_outer_scope;
  PyObject *__pyx_v_oldest_key = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_6_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("handle_eviction", __pyx_f[0], 300, 0, <span class='error_goto'>__PYX_ERR(0, 300, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.memoize.decorator.handle_eviction", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_oldest_key);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_key, __pyx_n_s_result, __pyx_n_s_oldest_key);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(300,0,<span class='error_goto'>__PYX_ERR(0, 300, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_7memoize_9decorator_5handle_eviction, 0, __pyx_n_s_memoize_locals_decorator_locals_3, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__24));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_handle_eviction = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__24 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_handle_eviction, 300, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 300, __pyx_L1_error)</span>
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0301</span>:             if cache_limit is not None and len(cache_keys) &gt;= cache_limit:</pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(301,0,<span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_cache_limit)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cache_limit"); <span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span> }
  __pyx_t_2 = (__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_cache_limit != Py_None);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_cache_keys)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cache_keys"); <span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span> }
  __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_cache_keys;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  if (unlikely(__pyx_t_3 == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
    <span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span>
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 301, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 301, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_cache_limit)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cache_limit"); <span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span> }
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_cache_limit, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 301, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 301, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0302</span>:                 oldest_key = _apply_eviction_policy(eviction_policy, cache_keys)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(302,0,<span class='error_goto'>__PYX_ERR(0, 302, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_apply_eviction_policy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 302, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_eviction_policy)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("eviction_policy"); <span class='error_goto'>__PYX_ERR(0, 302, __pyx_L1_error)</span> }
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_cache_keys)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cache_keys"); <span class='error_goto'>__PYX_ERR(0, 302, __pyx_L1_error)</span> }
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_6, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_eviction_policy, __pyx_cur_scope-&gt;__pyx_v_cache_keys};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 302, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_v_oldest_key = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0303</span>:                 memo.pop(oldest_key, None)</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(303,0,<span class='error_goto'>__PYX_ERR(0, 303, __pyx_L1_error)</span>)
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_memo)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("memo"); <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L1_error)</span> }
    if (unlikely(__pyx_cur_scope-&gt;__pyx_v_memo == Py_None)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "pop");
      <span class='error_goto'>__PYX_ERR(0, 303, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_Pop</span>(__pyx_cur_scope-&gt;__pyx_v_memo, __pyx_v_oldest_key, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 303, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0304</span>:             memo[key] = result</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(304,0,<span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_memo)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("memo"); <span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span> }
  if (unlikely(__pyx_cur_scope-&gt;__pyx_v_memo == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span>
  }
  if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_cur_scope-&gt;__pyx_v_memo, __pyx_v_key, __pyx_v_result) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 304, __pyx_L1_error)</span>
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0305</span>:             cache_keys.append(key)</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(305,0,<span class='error_goto'>__PYX_ERR(0, 305, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_cache_keys)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("cache_keys"); <span class='error_goto'>__PYX_ERR(0, 305, __pyx_L1_error)</span> }
  if (unlikely(__pyx_cur_scope-&gt;__pyx_v_cache_keys == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
    <span class='error_goto'>__PYX_ERR(0, 305, __pyx_L1_error)</span>
  }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_cur_scope-&gt;__pyx_v_cache_keys, __pyx_v_key);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 305, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0306</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0307</span>:         return memoized</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(307,0,<span class='error_goto'>__PYX_ERR(0, 307, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_memoized);
  __pyx_r = __pyx_v_memoized;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0308</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0309</span>:     if func:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(309,0,<span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_func); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>
  if (__pyx_t_2) {
/*  */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0310</span>:         return decorator(func)</pre>
<pre class='cython code score-1 '>    <span class='trace'>__Pyx_TraceLine</span>(310,0,<span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = __pyx_pf_6gofast_5tools_9funcutils_7memoize_decorator(__pyx_v_decorator, __pyx_v_func);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0311</span>:     return decorator</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(311,0,<span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorator);
  __pyx_r = __pyx_v_decorator;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0312</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0313</span>: </pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0314</span>: def _apply_eviction_policy(eviction_policy, cache_keys):</pre>
<pre class='cython code score-67 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_19_apply_eviction_policy(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_18_apply_eviction_policy, " Added support for customizable eviction policies (LRU and FIFO). \n    The helper function  manages which cache entry to evict based on the\n    selected policy.");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_19_apply_eviction_policy = {"_apply_eviction_policy", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_19_apply_eviction_policy, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_18_apply_eviction_policy};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_19_apply_eviction_policy(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_eviction_policy = 0;
  PyObject *__pyx_v_cache_keys = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_apply_eviction_policy (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_eviction_policy,&amp;__pyx_n_s_cache_keys,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_eviction_policy)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_cache_keys)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_apply_eviction_policy", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_apply_eviction_policy") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_eviction_policy = values[0];
    __pyx_v_cache_keys = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_apply_eviction_policy", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._apply_eviction_policy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_18_apply_eviction_policy(__pyx_self, __pyx_v_eviction_policy, __pyx_v_cache_keys);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_18_apply_eviction_policy(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_eviction_policy, PyObject *__pyx_v_cache_keys) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__28)
  <span class='trace'>__Pyx_TraceCall</span>("_apply_eviction_policy", __pyx_f[0], 314, 0, <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._apply_eviction_policy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__158 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_eviction_policy, __pyx_n_s_cache_keys);<span class='error_goto'> if (unlikely(!__pyx_tuple__158)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__158);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__158);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(314,0,<span class='error_goto'>__PYX_ERR(0, 314, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_19_apply_eviction_policy, 0, __pyx_n_s_apply_eviction_policy, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__28));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_apply_eviction_policy, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__28 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__158, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_apply_eviction_policy, 314, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0315</span>:     """ Added support for customizable eviction policies (LRU and FIFO).</pre>
<pre class="cython line score-0">&#xA0;<span class="">0316</span>:     The helper function  manages which cache entry to evict based on the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0317</span>:     selected policy."""</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0318</span>:     if eviction_policy == 'LRU':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(318,0,<span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>)
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_eviction_policy, __pyx_n_u_LRU, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0319</span>:         return cache_keys.pop(0)  # Remove the least recently used item</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(319,0,<span class='error_goto'>__PYX_ERR(0, 319, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_PopIndex</span>(__pyx_v_cache_keys, __pyx_int_0, 0, 1, Py_ssize_t, PyInt_FromSsize_t);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0320</span>:     elif eviction_policy == 'FIFO':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(320,0,<span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>)
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_eviction_policy, __pyx_n_u_FIFO, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 320, __pyx_L1_error)</span>
  if (likely(__pyx_t_1)) {
/*  */
  }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0321</span>:         return cache_keys.pop(0)  # Remove the first inserted item</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(321,0,<span class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_PopIndex</span>(__pyx_v_cache_keys, __pyx_int_0, 0, 1, Py_ssize_t, PyInt_FromSsize_t);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0322</span>:     else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0323</span>:         raise ValueError(</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(323,0,<span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__29, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span>
  }
/*  */
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Unsupported_eviction_policy_Expe);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
</pre><pre class="cython line score-0">&#xA0;<span class="">0324</span>:             "Unsupported eviction policy. Expected 'LRU' or 'FIFO'.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0325</span>: </pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0326</span>: def merge_dicts(</pre>
<pre class='cython code score-84 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_21merge_dicts(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_20merge_dicts, "\n    Merges multiple dictionaries into a single dictionary. Allows for deep\n    merging and custom handling of list concatenation.\n\n    Parameters\n    ----------\n    *dicts : Dict[Any, Any]\n        Variable number of dictionary objects to be merged.\n    deep_merge : bool, optional\n        Enables deep merging of nested dictionaries. Defaults to False.\n    list_merge : bool or Callable, optional\n        Determines how list values are handled during merge. If True, lists\n        are concatenated. If a Callable is provided, it is used to merge lists.\n        Defaults to False, which replaces lists from earlier dicts with those\n        from later dicts.\n\n    Returns\n    -------\n    Dict[Any, Any]\n        The resulting dictionary from merging all input dictionaries.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import merge_dicts\n    &gt;&gt;&gt; dict_a = {'a': 1, 'b': [2], 'c': {'d': 4}}\n    &gt;&gt;&gt; dict_b = {'b': [3], 'c': {'e': 5}}\n    &gt;&gt;&gt; print(merge_dicts(dict_a, dict_b))\n    {'a': 1, 'b': [3], 'c': {'e': 5}}\n\n    Deep merge with list concatenation:\n\n    &gt;&gt;&gt; print(merge_dicts(dict_a, dict_b, deep_merge=True, list_merge=True))\n    {'a': 1, 'b': [2, 3], 'c': {'d': 4, 'e': 5}}\n\n    Deep merge with custom list merge function (taking the max of each list):\n\n    &gt;&gt;&gt; print(merge_dicts(dict_a, dict_b, deep_merge=True,\n    ... list_merge=lambda x, y: [max(x + y)]))\n    {'a': 1, 'b': [3], 'c': {'d': 4, 'e': 5}}\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_21merge_dicts = {"merge_dicts", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_21merge_dicts, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_20merge_dicts};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_21merge_dicts(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_deep_merge = 0;
  PyObject *__pyx_v_list_merge = 0;
  PyObject *__pyx_v_dicts = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("merge_dicts (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_dicts = __pyx_args;
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_deep_merge,&amp;__pyx_n_s_list_merge,0};
  PyObject* values[2] = {0,0};
/*  */
  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dicts);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_VARARGS</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_20merge_dicts(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_deep_merge, PyObject *__pyx_v_list_merge, PyObject *__pyx_v_dicts) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_7_merge_dicts *__pyx_cur_scope;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_dictionary = NULL;
  PyObject *__pyx_v_key = NULL;
  PyObject *__pyx_v_value = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__30)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_7_merge_dicts *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_7_merge_dicts(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_7_merge_dicts, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_7_merge_dicts *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("merge_dicts", __pyx_f[0], 326, 0, <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_deep_merge = __pyx_v_deep_merge;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_deep_merge);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_deep_merge);
  __pyx_cur_scope-&gt;__pyx_v_list_merge = __pyx_v_list_merge;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_list_merge);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_list_merge);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.merge_dicts", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dictionary);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__159 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_deep_merge, __pyx_n_s_list_merge, __pyx_n_s_dicts, __pyx_n_s_deep_merge_dicts, __pyx_n_s_deep_merge_dicts, __pyx_n_s_result, __pyx_n_s_dictionary, __pyx_n_s_key, __pyx_n_s_value);<span class='error_goto'> if (unlikely(!__pyx_tuple__159)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__159);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__159);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(326,0,<span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_deep_merge, ((PyObject *)Py_False)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_list_merge, ((PyObject *)Py_False)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_deep_merge, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_list_merge, __pyx_kp_s_Union_bool_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dicts, __pyx_kp_s_Dict_Any_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_kp_s_Dict_Any_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_21merge_dicts, 0, __pyx_n_s_merge_dicts, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__30));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_merge_dicts, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__30 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 2, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__159, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_merge_dicts, 326, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_7_merge_dicts {
  PyObject_HEAD
  PyObject *__pyx_v_deep_merge;
  PyObject *__pyx_v_deep_merge_dicts;
  PyObject *__pyx_v_list_merge;
};

</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0327</span>:     *dicts: Dict[Any, Any], deep_merge: bool = False,</pre>
<pre class='cython code score-2 '>    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0328</span>:      list_merge: Union[bool, Callable] = False) -&gt; Dict[Any, Any]:</pre>
<pre class='cython code score-22 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        default:
        case  0: break;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_VARARGS</span>(__pyx_kwds);
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 2)) {
        Py_ssize_t index;
        for (index = 0; index &lt; 2 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_VARARGS</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "merge_dicts") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs &lt; 0)) {
      goto __pyx_L5_argtuple_error;
    } else {
    }
    __pyx_v_deep_merge = values[0];
    __pyx_v_list_merge = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("merge_dicts", 0, 0, 0, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_VARARGS</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_dicts); __pyx_v_dicts = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.merge_dicts", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_20merge_dicts(__pyx_self, __pyx_v_deep_merge, __pyx_v_list_merge, __pyx_v_dicts);
</pre><pre class="cython line score-0">&#xA0;<span class="">0329</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0330</span>:     Merges multiple dictionaries into a single dictionary. Allows for deep</pre>
<pre class="cython line score-0">&#xA0;<span class="">0331</span>:     merging and custom handling of list concatenation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0332</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0333</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0334</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0335</span>:     *dicts : Dict[Any, Any]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0336</span>:         Variable number of dictionary objects to be merged.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0337</span>:     deep_merge : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0338</span>:         Enables deep merging of nested dictionaries. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0339</span>:     list_merge : bool or Callable, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0340</span>:         Determines how list values are handled during merge. If True, lists</pre>
<pre class="cython line score-0">&#xA0;<span class="">0341</span>:         are concatenated. If a Callable is provided, it is used to merge lists.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0342</span>:         Defaults to False, which replaces lists from earlier dicts with those</pre>
<pre class="cython line score-0">&#xA0;<span class="">0343</span>:         from later dicts.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0344</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0345</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0346</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0347</span>:     Dict[Any, Any]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0348</span>:         The resulting dictionary from merging all input dictionaries.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0349</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0350</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0351</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0352</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import merge_dicts</pre>
<pre class="cython line score-0">&#xA0;<span class="">0353</span>:     &gt;&gt;&gt; dict_a = {'a': 1, 'b': [2], 'c': {'d': 4}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0354</span>:     &gt;&gt;&gt; dict_b = {'b': [3], 'c': {'e': 5}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0355</span>:     &gt;&gt;&gt; print(merge_dicts(dict_a, dict_b))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0356</span>:     {'a': 1, 'b': [3], 'c': {'e': 5}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0357</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0358</span>:     Deep merge with list concatenation:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0359</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0360</span>:     &gt;&gt;&gt; print(merge_dicts(dict_a, dict_b, deep_merge=True, list_merge=True))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0361</span>:     {'a': 1, 'b': [2, 3], 'c': {'d': 4, 'e': 5}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0362</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0363</span>:     Deep merge with custom list merge function (taking the max of each list):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0364</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0365</span>:     &gt;&gt;&gt; print(merge_dicts(dict_a, dict_b, deep_merge=True,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0366</span>:     ... list_merge=lambda x, y: [max(x + y)]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0367</span>:     {'a': 1, 'b': [3], 'c': {'d': 4, 'e': 5}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0368</span>:     """</pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0369</span>:     def deep_merge_dicts(target, source):</pre>
<pre class='cython code score-69 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11merge_dicts_1deep_merge_dicts(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_11merge_dicts_1deep_merge_dicts = {"deep_merge_dicts", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_11merge_dicts_1deep_merge_dicts, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11merge_dicts_1deep_merge_dicts(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_target = 0;
  PyObject *__pyx_v_source = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("deep_merge_dicts (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_target,&amp;__pyx_n_s_source,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_target)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_source)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("deep_merge_dicts", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "deep_merge_dicts") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_target = values[0];
    __pyx_v_source = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("deep_merge_dicts", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.merge_dicts.deep_merge_dicts", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_11merge_dicts_deep_merge_dicts(__pyx_self, __pyx_v_target, __pyx_v_source);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_11merge_dicts_deep_merge_dicts(PyObject *__pyx_self, PyObject *__pyx_v_target, PyObject *__pyx_v_source) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_7_merge_dicts *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_7_merge_dicts *__pyx_outer_scope;
  PyObject *__pyx_v_key = NULL;
  PyObject *__pyx_v_value = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_7_merge_dicts *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("deep_merge_dicts", __pyx_f[0], 369, 0, <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.merge_dicts.deep_merge_dicts", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_key);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__31 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_target, __pyx_n_s_source, __pyx_n_s_key, __pyx_n_s_value);<span class='error_goto'> if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__31);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(369,0,<span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_11merge_dicts_1deep_merge_dicts, 0, __pyx_n_s_merge_dicts_locals_deep_merge_di, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__32));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_deep_merge_dicts = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__32 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_deep_merge_dicts, 369, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0370</span>:         for key, value in source.items():</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(370,0,<span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>)
  __pyx_t_2 = 0;
  if (unlikely(__pyx_v_source == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "items");
    <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
  }
  __pyx_t_5 = __Pyx_dict_iterator(__pyx_v_source, 0, __pyx_n_s_items, (&amp;__pyx_t_3), (&amp;__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __pyx_t_1 = __pyx_t_5;
  __pyx_t_5 = 0;
  while (1) {
    __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_3, &amp;__pyx_t_2, &amp;__pyx_t_5, &amp;__pyx_t_6, NULL, __pyx_t_4);
    if (unlikely(__pyx_t_7 == 0)) break;
    if (unlikely(__pyx_t_7 == -1)) <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_key, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_value, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0371</span>:             if deep_merge and isinstance(value, dict) and key in target and isinstance(</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(371,0,<span class='error_goto'>__PYX_ERR(0, 371, __pyx_L1_error)</span>)
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_deep_merge)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("deep_merge"); <span class='error_goto'>__PYX_ERR(0, 371, __pyx_L1_error)</span> }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_deep_merge); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 371, __pyx_L1_error)</span>
    if (__pyx_t_9) {
    } else {
      __pyx_t_8 = __pyx_t_9;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_9 = <span class='py_c_api'>PyDict_Check</span>(__pyx_v_value); 
    if (__pyx_t_9) {
    } else {
      __pyx_t_8 = __pyx_t_9;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_key, __pyx_v_target, Py_EQ)); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 371, __pyx_L1_error)</span>
    if (__pyx_t_9) {
    } else {
      __pyx_t_8 = __pyx_t_9;
      goto __pyx_L6_bool_binop_done;
    }
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(371,0,<span class='error_goto'>__PYX_ERR(0, 371, __pyx_L1_error)</span>)
    if (__pyx_t_8) {
/*  */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0372</span>:                     target[key], dict):</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(372,0,<span class='error_goto'>__PYX_ERR(0, 372, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_target, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 372, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_9 = <span class='py_c_api'>PyDict_Check</span>(__pyx_t_6); 
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_8 = __pyx_t_9;
    __pyx_L6_bool_binop_done:;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0373</span>:                 deep_merge_dicts(target[key], value)</pre>
<pre class='cython code score-6 '>      <span class='trace'>__Pyx_TraceLine</span>(373,0,<span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>)
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_target, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 373, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_deep_merge_dicts)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("deep_merge_dicts"); <span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span> }
      __pyx_t_5 = __pyx_pf_6gofast_5tools_9funcutils_11merge_dicts_deep_merge_dicts(__pyx_cur_scope-&gt;__pyx_v_deep_merge_dicts, __pyx_t_6, __pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 373, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0374</span>:             elif isinstance(value, list) and key in target and isinstance(</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(374,0,<span class='error_goto'>__PYX_ERR(0, 374, __pyx_L1_error)</span>)
    __pyx_t_9 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_value); 
    if (__pyx_t_9) {
    } else {
      __pyx_t_8 = __pyx_t_9;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_key, __pyx_v_target, Py_EQ)); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 374, __pyx_L1_error)</span>
    if (__pyx_t_9) {
    } else {
      __pyx_t_8 = __pyx_t_9;
      goto __pyx_L10_bool_binop_done;
    }
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(374,0,<span class='error_goto'>__PYX_ERR(0, 374, __pyx_L1_error)</span>)
    if (__pyx_t_8) {
/*  */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0375</span>:                     target[key], list):</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(375,0,<span class='error_goto'>__PYX_ERR(0, 375, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_target, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = <span class='py_c_api'>PyList_Check</span>(__pyx_t_5); 
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_8 = __pyx_t_9;
    __pyx_L10_bool_binop_done:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0376</span>:                 if list_merge is True:</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(376,0,<span class='error_goto'>__PYX_ERR(0, 376, __pyx_L1_error)</span>)
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_list_merge)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("list_merge"); <span class='error_goto'>__PYX_ERR(0, 376, __pyx_L1_error)</span> }
      __pyx_t_8 = (__pyx_cur_scope-&gt;__pyx_v_list_merge == Py_True);
      if (__pyx_t_8) {
/*  */
        goto __pyx_L13;
      }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0377</span>:                     target[key].extend(value)  # Changed from += to extend for clarity</pre>
<pre class='cython code score-20 '>        <span class='trace'>__Pyx_TraceLine</span>(377,0,<span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>)
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_target, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_extend);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = NULL;
        __pyx_t_7 = 0;
        #if CYTHON_UNPACK_METHODS
        if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
          __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
          if (likely(__pyx_t_6)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
            __pyx_t_7 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_v_value};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0378</span>:                 elif callable(list_merge):</pre>
<pre class='cython code score-6 '>      <span class='trace'>__Pyx_TraceLine</span>(378,0,<span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span>)
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_list_merge)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("list_merge"); <span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span> }
      __pyx_t_5 = __pyx_cur_scope-&gt;__pyx_v_list_merge;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 378, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_8) {
/*  */
        goto __pyx_L13;
      }
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0379</span>:                     target[key] = list_merge(target[key], value)</pre>
<pre class='cython code score-26 '>        <span class='trace'>__Pyx_TraceLine</span>(379,0,<span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>)
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_list_merge)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("list_merge"); <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span> }
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_target, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 379, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_list_merge);
        __pyx_t_6 = __pyx_cur_scope-&gt;__pyx_v_list_merge; __pyx_t_11 = NULL;
        __pyx_t_7 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
          __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
          if (likely(__pyx_t_11)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
            __pyx_t_7 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[3] = {__pyx_t_11, __pyx_t_10, __pyx_v_value};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        }
        if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_target, __pyx_v_key, __pyx_t_5) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0380</span>:                 else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0381</span>:                     target[key] = value</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(381,0,<span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>)
      /*else*/ {
        if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_target, __pyx_v_key, __pyx_v_value) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>
      }
      __pyx_L13:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0382</span>:             else:</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0383</span>:                 target[key] = value</pre>
<pre class='cython code score-6 '>    <span class='trace'>__Pyx_TraceLine</span>(383,0,<span class='error_goto'>__PYX_ERR(0, 383, __pyx_L1_error)</span>)
    /*else*/ {
      if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_target, __pyx_v_key, __pyx_v_value) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 383, __pyx_L1_error)</span>
    }
    __pyx_L5:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0384</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0385</span>:     result = {}</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(385,0,<span class='error_goto'>__PYX_ERR(0, 385, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 385, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_result = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0386</span>:     for dictionary in dicts:</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(386,0,<span class='error_goto'>__PYX_ERR(0, 386, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_v_dicts; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = 0;
  for (;;) {
    {
      Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
      #if !CYTHON_ASSUME_SAFE_MACROS
      if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 386, __pyx_L1_error)</span>
      #endif
      if (__pyx_t_2 &gt;= __pyx_temp) break;
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 386, __pyx_L1_error)</span>
    #else
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 386, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dictionary, __pyx_t_3);
    __pyx_t_3 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(386,0,<span class='error_goto'>__PYX_ERR(0, 386, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0387</span>:         if deep_merge:</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(387,0,<span class='error_goto'>__PYX_ERR(0, 387, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_deep_merge); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 387, __pyx_L1_error)</span>
    if (__pyx_t_4) {
/*  */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0388</span>:             deep_merge_dicts(result, dictionary)</pre>
<pre class='cython code score-1 '>      <span class='trace'>__Pyx_TraceLine</span>(388,0,<span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>)
      __pyx_t_3 = __pyx_pf_6gofast_5tools_9funcutils_11merge_dicts_deep_merge_dicts(__pyx_cur_scope-&gt;__pyx_v_deep_merge_dicts, __pyx_v_result, __pyx_v_dictionary);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 388, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0389</span>:         else:</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0390</span>:             for key, value in dictionary.items():</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(390,0,<span class='error_goto'>__PYX_ERR(0, 390, __pyx_L1_error)</span>)
    /*else*/ {
      __pyx_t_5 = 0;
      if (unlikely(__pyx_v_dictionary == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "items");
        <span class='error_goto'>__PYX_ERR(0, 390, __pyx_L1_error)</span>
      }
      __pyx_t_8 = __Pyx_dict_iterator(__pyx_v_dictionary, 0, __pyx_n_s_items, (&amp;__pyx_t_6), (&amp;__pyx_t_7));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 390, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
      __pyx_t_3 = __pyx_t_8;
      __pyx_t_8 = 0;
      while (1) {
        __pyx_t_10 = __Pyx_dict_iter_next(__pyx_t_3, __pyx_t_6, &amp;__pyx_t_5, &amp;__pyx_t_8, &amp;__pyx_t_9, NULL, __pyx_t_7);
        if (unlikely(__pyx_t_10 == 0)) break;
        if (unlikely(__pyx_t_10 == -1)) <span class='error_goto'>__PYX_ERR(0, 390, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_key, __pyx_t_8);
        __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_value, __pyx_t_9);
        __pyx_t_9 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0391</span>:                 if key in result and isinstance(result[key], list) and isinstance(</pre>
<pre class='cython code score-10 '>        <span class='trace'>__Pyx_TraceLine</span>(391,0,<span class='error_goto'>__PYX_ERR(0, 391, __pyx_L1_error)</span>)
        __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_v_key, __pyx_v_result, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 391, __pyx_L1_error)</span>
        if (__pyx_t_11) {
        } else {
          __pyx_t_4 = __pyx_t_11;
          goto __pyx_L9_bool_binop_done;
        }
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_result, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 391, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_11 = <span class='py_c_api'>PyList_Check</span>(__pyx_t_9); 
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (__pyx_t_11) {
        } else {
          __pyx_t_4 = __pyx_t_11;
          goto __pyx_L9_bool_binop_done;
        }
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(391,0,<span class='error_goto'>__PYX_ERR(0, 391, __pyx_L1_error)</span>)
        if (__pyx_t_4) {
/*  */
          goto __pyx_L8;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0392</span>:                         value, list):</pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(392,0,<span class='error_goto'>__PYX_ERR(0, 392, __pyx_L1_error)</span>)
        __pyx_t_11 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_value); 
        __pyx_t_4 = __pyx_t_11;
        __pyx_L9_bool_binop_done:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0393</span>:                     if list_merge is True:</pre>
<pre class='cython code score-0 '>          <span class='trace'>__Pyx_TraceLine</span>(393,0,<span class='error_goto'>__PYX_ERR(0, 393, __pyx_L1_error)</span>)
          __pyx_t_4 = (__pyx_cur_scope-&gt;__pyx_v_list_merge == Py_True);
          if (__pyx_t_4) {
/*  */
            goto __pyx_L12;
          }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0394</span>:                         result[key].extend(value)</pre>
<pre class='cython code score-20 '>            <span class='trace'>__Pyx_TraceLine</span>(394,0,<span class='error_goto'>__PYX_ERR(0, 394, __pyx_L1_error)</span>)
            __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_result, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_extend);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            __pyx_t_8 = NULL;
            __pyx_t_10 = 0;
            #if CYTHON_UNPACK_METHODS
            if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
              __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
              if (likely(__pyx_t_8)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
                __pyx_t_10 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_value};
              __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_12, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
              if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 394, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0395</span>:                     elif callable(list_merge):</pre>
<pre class='cython code score-4 '>          <span class='trace'>__Pyx_TraceLine</span>(395,0,<span class='error_goto'>__PYX_ERR(0, 395, __pyx_L1_error)</span>)
          __pyx_t_9 = __pyx_cur_scope-&gt;__pyx_v_list_merge;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 395, __pyx_L1_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          if (__pyx_t_4) {
/*  */
            goto __pyx_L12;
          }
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0396</span>:                         result[key] = list_merge(result[key], value)</pre>
<pre class='cython code score-24 '>            <span class='trace'>__Pyx_TraceLine</span>(396,0,<span class='error_goto'>__PYX_ERR(0, 396, __pyx_L1_error)</span>)
            __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_result, __pyx_v_key);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_list_merge);
            __pyx_t_8 = __pyx_cur_scope-&gt;__pyx_v_list_merge; __pyx_t_13 = NULL;
            __pyx_t_10 = 0;
            #if CYTHON_UNPACK_METHODS
            if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
              __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
              if (likely(__pyx_t_13)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
                __pyx_t_10 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[3] = {__pyx_t_13, __pyx_t_12, __pyx_v_value};
              __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_10, 2+__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
              if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 396, __pyx_L1_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            }
            if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_result, __pyx_v_key, __pyx_t_9) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 396, __pyx_L1_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0397</span>:                     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0398</span>:                         result[key] = value</pre>
<pre class='cython code score-5 '>          <span class='trace'>__Pyx_TraceLine</span>(398,0,<span class='error_goto'>__PYX_ERR(0, 398, __pyx_L1_error)</span>)
          /*else*/ {
            if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_result, __pyx_v_key, __pyx_v_value) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 398, __pyx_L1_error)</span>
          }
          __pyx_L12:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0399</span>:                 else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0400</span>:                     result.update({key: value})</pre>
<pre class='cython code score-10 '>        <span class='trace'>__Pyx_TraceLine</span>(400,0,<span class='error_goto'>__PYX_ERR(0, 400, __pyx_L1_error)</span>)
        /*else*/ {
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 400, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_v_key, __pyx_v_value) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 400, __pyx_L1_error)</span>
          __pyx_t_8 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PyDict_Type_update, __pyx_v_result, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 400, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        __pyx_L8:;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_L5:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0401</span>:     return result</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(401,0,<span class='error_goto'>__PYX_ERR(0, 401, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0402</span>: </pre>
<pre class="cython line score-129" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0403</span>: def retry_operation(</pre>
<pre class='cython code score-129 '>static PyObject *__pyx_pf_6gofast_5tools_9funcutils_104__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("__defaults__", __pyx_f[0], 403, 0, <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(403,0,<span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_retries);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_retries);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_retries)) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_catch_exceptions);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_catch_exceptions);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_catch_exceptions)) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 4, Py_None)) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_23retry_operation(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_22retry_operation, "\n    Retries a specified function upon failure, for a defined number of retries\n    and with a delay between attempts. Enhancements include the ability to \n    pre-process function arguments before each retry attempt.\n\n    Parameters\n    ----------\n    func : Callable\n        The function to be executed and possibly retried upon failure.\n    retries : int, optional\n        The number of retries to attempt upon failure. Default is 3.\n    delay : float, optional\n        The initial delay between retries in seconds. Default is 1.0.\n    catch_exceptions : tuple, optional\n        A tuple of exception classes to catch and retry. Default is (Exception,).\n    backoff_factor : float, optional\n        The factor by which the delay increases after each retry. Default is 1.0.\n    on_retry : Optional[Callable[[int, Exception], None]], optional\n        A callback function that is called after a failed attempt.\n    pre_process_args : Optional[Callable[\n        [int, Tuple[Any, ...], dict], Tuple[Tuple[Any, ...], dict]]], optional\n        A function to pre-process the arguments to `func` before each retry.\n        It receives the current attempt number, the arguments, and keyword\n        arguments to `func` and returns a tuple of processed arguments and\n        keyword arguments.\n\n    Returns\n    -------\n    Any\n        The return value of the function if successful.\n\n    Raises\n    ------\n    Exception\n        The exception from the last attempt if all retries fail.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import retry_operation\n    &gt;&gt;&gt; def test_func(x):\n    ...     print(f\"Trying with x={x}...\")\n    ...     raise ValueError(\"Fail\")\n    &gt;&gt;&gt; def pre_process(attempt, args, kwargs):\n    ...     # Increase argument x by 1 on each retry\n    ...     return ((args[0] + 1,), kwargs)\n    &gt;&gt;&gt; try:\n    ...     retry_operation(test_func, retries=2, delay=0.5,\n    ...                        pre_process_args=pre_process,ar""gs=(1,))\n    ... except ValueError as e:\n    ...     print(e)\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_23retry_operation = {"retry_operation", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_23retry_operation, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_22retry_operation};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_23retry_operation(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_retries = 0;
  double __pyx_v_delay;
  PyObject *__pyx_v_catch_exceptions = 0;
  double __pyx_v_backoff_factor;
  PyObject *__pyx_v_on_retry = 0;
  PyObject *__pyx_v_pre_process_args = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("retry_operation (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,&amp;__pyx_n_s_retries,&amp;__pyx_n_s_delay,&amp;__pyx_n_s_catch_exceptions,&amp;__pyx_n_s_backoff_factor,&amp;__pyx_n_s_on_retry,&amp;__pyx_n_s_pre_process_args,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
    __pyx_defaults *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self);
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_retries);
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_catch_exceptions);
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_22retry_operation(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_func, PyObject *__pyx_v_retries, double __pyx_v_delay, PyObject *__pyx_v_catch_exceptions, double __pyx_v_backoff_factor, PyObject *__pyx_v_on_retry, PyObject *__pyx_v_pre_process_args) {
  PyObject *__pyx_v_args = NULL;
  PyObject *__pyx_v_kwargs = NULL;
  PyObject *__pyx_v_attempt = NULL;
  PyObject *__pyx_v_e = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__33)
  <span class='trace'>__Pyx_TraceCall</span>("retry_operation", __pyx_f[0], 403, 0, <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.retry_operation", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwargs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_attempt);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_e);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__160 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_func, __pyx_n_s_retries, __pyx_n_s_delay, __pyx_n_s_catch_exceptions, __pyx_n_s_backoff_factor, __pyx_n_s_on_retry, __pyx_n_s_pre_process_args, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_attempt, __pyx_n_s_e);<span class='error_goto'> if (unlikely(!__pyx_tuple__160)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__160);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__160);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(403,0,<span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_retries, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_delay, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_catch_exceptions, __pyx_n_s_tuple) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_backoff_factor, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_on_retry, __pyx_kp_s_Optional_Callable_int_Exception) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_pre_process_args, __pyx_kp_s_Optional_Callable_int_Tuple_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_23retry_operation, 0, __pyx_n_s_retry_operation, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__33));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_2, sizeof(__pyx_defaults), 2)) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
  __pyx_codeobj__33 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__160, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_retry_operation, 403, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__33)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0404</span>:     func: Callable,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0405</span>:     retries: int = 3,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(405,0,<span class='error_goto'>__PYX_ERR(0, 405, __pyx_L1_error)</span>)
  if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_3)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_3))) <span class='error_goto'>__PYX_ERR(0, 405, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_t_2)-&gt;__pyx_arg_retries = ((PyObject*)__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0406</span>:     delay: float = 1.0,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(406,0,<span class='error_goto'>__PYX_ERR(0, 406, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0407</span>:     catch_exceptions: tuple = (Exception,),</pre>
<pre class='cython code score-21 '>  <span class='trace'>__Pyx_TraceLine</span>(407,0,<span class='error_goto'>__PYX_ERR(0, 407, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 407, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0]));
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0]));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])))) <span class='error_goto'>__PYX_ERR(0, 407, __pyx_L1_error)</span>;
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_t_2)-&gt;__pyx_arg_catch_exceptions = ((PyObject*)__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_2, __pyx_pf_6gofast_5tools_9funcutils_104__defaults__);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_retry_operation, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0408</span>:     backoff_factor: float = 1.0,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(408,0,<span class='error_goto'>__PYX_ERR(0, 408, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 408, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0409</span>:     on_retry: Optional[Callable[[int, Exception], None]] = None,</pre>
<pre class='cython code score-2 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0410</span>:     pre_process_args: Optional[Callable[[int, Tuple[Any, ...], dict],</pre>
<pre class='cython code score-127 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_retries);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delay);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_catch_exceptions);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_backoff_factor);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_retry);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_pre_process_args);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "retry_operation") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_func = values[0];
    __pyx_v_retries = ((PyObject*)values[1]);
    if (values[2]) {
      __pyx_v_delay = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_delay == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 406, __pyx_L3_error)</span>
    } else {
      __pyx_v_delay = ((double)((double)1.0));
    }
    __pyx_v_catch_exceptions = ((PyObject*)values[3]);
    if (values[4]) {
      __pyx_v_backoff_factor = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[4]); if (unlikely((__pyx_v_backoff_factor == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 408, __pyx_L3_error)</span>
    } else {
      __pyx_v_backoff_factor = ((double)((double)1.0));
    }
    __pyx_v_on_retry = values[5];
    __pyx_v_pre_process_args = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("retry_operation", 0, 1, 7, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 403, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.retry_operation", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_retries), (&amp;PyInt_Type), 0, "retries", 1))) <span class='error_goto'>__PYX_ERR(0, 405, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_catch_exceptions), (&amp;PyTuple_Type), 0, "catch_exceptions", 1))) <span class='error_goto'>__PYX_ERR(0, 407, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_22retry_operation(__pyx_self, __pyx_v_func, __pyx_v_retries, __pyx_v_delay, __pyx_v_catch_exceptions, __pyx_v_backoff_factor, __pyx_v_on_retry, __pyx_v_pre_process_args);
</pre><pre class="cython line score-0">&#xA0;<span class="">0411</span>:                                         Tuple[Tuple[Any, ...], dict]]] = None</pre>
<pre class="cython line score-0">&#xA0;<span class="">0412</span>: ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0413</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0414</span>:     Retries a specified function upon failure, for a defined number of retries</pre>
<pre class="cython line score-0">&#xA0;<span class="">0415</span>:     and with a delay between attempts. Enhancements include the ability to</pre>
<pre class="cython line score-0">&#xA0;<span class="">0416</span>:     pre-process function arguments before each retry attempt.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0417</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0418</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0420</span>:     func : Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0421</span>:         The function to be executed and possibly retried upon failure.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0422</span>:     retries : int, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0423</span>:         The number of retries to attempt upon failure. Default is 3.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0424</span>:     delay : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0425</span>:         The initial delay between retries in seconds. Default is 1.0.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>:     catch_exceptions : tuple, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>:         A tuple of exception classes to catch and retry. Default is (Exception,).</pre>
<pre class="cython line score-0">&#xA0;<span class="">0428</span>:     backoff_factor : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0429</span>:         The factor by which the delay increases after each retry. Default is 1.0.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0430</span>:     on_retry : Optional[Callable[[int, Exception], None]], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0431</span>:         A callback function that is called after a failed attempt.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0432</span>:     pre_process_args : Optional[Callable[</pre>
<pre class="cython line score-0">&#xA0;<span class="">0433</span>:         [int, Tuple[Any, ...], dict], Tuple[Tuple[Any, ...], dict]]], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0434</span>:         A function to pre-process the arguments to `func` before each retry.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0435</span>:         It receives the current attempt number, the arguments, and keyword</pre>
<pre class="cython line score-0">&#xA0;<span class="">0436</span>:         arguments to `func` and returns a tuple of processed arguments and</pre>
<pre class="cython line score-0">&#xA0;<span class="">0437</span>:         keyword arguments.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0438</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0439</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0440</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0441</span>:     Any</pre>
<pre class="cython line score-0">&#xA0;<span class="">0442</span>:         The return value of the function if successful.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0443</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0444</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">0445</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0446</span>:     Exception</pre>
<pre class="cython line score-0">&#xA0;<span class="">0447</span>:         The exception from the last attempt if all retries fail.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0448</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0449</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0450</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0451</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import retry_operation</pre>
<pre class="cython line score-0">&#xA0;<span class="">0452</span>:     &gt;&gt;&gt; def test_func(x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0453</span>:     ...     print(f"Trying with x={x}...")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0454</span>:     ...     raise ValueError("Fail")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0455</span>:     &gt;&gt;&gt; def pre_process(attempt, args, kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0456</span>:     ...     # Increase argument x by 1 on each retry</pre>
<pre class="cython line score-0">&#xA0;<span class="">0457</span>:     ...     return ((args[0] + 1,), kwargs)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>:     &gt;&gt;&gt; try:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0459</span>:     ...     retry_operation(test_func, retries=2, delay=0.5,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0460</span>:     ...                        pre_process_args=pre_process,args=(1,))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0461</span>:     ... except ValueError as e:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0462</span>:     ...     print(e)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0463</span>:     """</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0464</span>:     args, kwargs = (), {}</pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(464,0,<span class='error_goto'>__PYX_ERR(0, 464, __pyx_L1_error)</span>)
  __pyx_t_1 = __pyx_empty_tuple;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_v_args = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_kwargs = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0465</span>:     for attempt in range(1, retries + 1):</pre>
<pre class='cython code score-68 '>  <span class='trace'>__Pyx_TraceLine</span>(465,0,<span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_retries, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_3 = 0;
    __pyx_t_4 = NULL;
  } else {
    __pyx_t_3 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_4)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_3 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_3 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_3); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_3++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_3); __pyx_t_3++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_4(__pyx_t_1);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_attempt, __pyx_t_2);
    __pyx_t_2 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(465,0,<span class='error_goto'>__PYX_ERR(0, 465, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0466</span>:         try:</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(466,0,<span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>)
    {
      /*try:*/ {
/*  */
      }
      __pyx_L5_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/*  */
      __pyx_L7_except_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_6, __pyx_t_7);
      goto __pyx_L1_error;
      __pyx_L9_try_return:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_6, __pyx_t_7);
      goto __pyx_L0;
      __pyx_L6_exception_handled:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_6, __pyx_t_7);
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0467</span>:             if pre_process_args:</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(467,0,<span class='error_goto'>__PYX_ERR(0, 467, __pyx_L5_error)</span>)
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_pre_process_args); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 467, __pyx_L5_error)</span>
        if (__pyx_t_8) {
/*  */
        }
</pre><pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0468</span>:                 args, kwargs = pre_process_args(attempt, args, kwargs)</pre>
<pre class='cython code score-63 '>          <span class='trace'>__Pyx_TraceLine</span>(468,0,<span class='error_goto'>__PYX_ERR(0, 468, __pyx_L5_error)</span>)
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pre_process_args);
          __pyx_t_9 = __pyx_v_pre_process_args; __pyx_t_10 = NULL;
          __pyx_t_11 = 0;
          #if CYTHON_UNPACK_METHODS
          if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
            __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
            if (likely(__pyx_t_10)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
              __pyx_t_11 = 1;
            }
          }
          #endif
          {
            PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_v_attempt, __pyx_v_args, __pyx_v_kwargs};
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_11, 3+__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
            if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 468, __pyx_L5_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          }
          if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
            PyObject* sequence = __pyx_t_2;
            Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
            if (unlikely(size != 2)) {
              if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
              else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
              <span class='error_goto'>__PYX_ERR(0, 468, __pyx_L5_error)</span>
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
              __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
              __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
            } else {
              __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
              __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
            }
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
            #else
            __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 468, __pyx_L5_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
            __pyx_t_10 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 468, __pyx_L5_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
            #endif
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          } else {
            Py_ssize_t index = -1;
            __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 468, __pyx_L5_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_12);
            index = 0; __pyx_t_9 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_9)) goto __pyx_L14_unpacking_failed;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
            index = 1; __pyx_t_10 = __pyx_t_13(__pyx_t_12); if (unlikely(!__pyx_t_10)) goto __pyx_L14_unpacking_failed;
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
            if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_13(__pyx_t_12), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 468, __pyx_L5_error)</span>
            __pyx_t_13 = NULL;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
            goto __pyx_L15_unpacking_done;
            __pyx_L14_unpacking_failed:;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
            __pyx_t_13 = NULL;
            if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
            <span class='error_goto'>__PYX_ERR(0, 468, __pyx_L5_error)</span>
            __pyx_L15_unpacking_done:;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_args, __pyx_t_9);
          __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kwargs, __pyx_t_10);
          __pyx_t_10 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0469</span>:             return func(*args, **kwargs)</pre>
<pre class='cython code score-25 '>        <span class='trace'>__Pyx_TraceLine</span>(469,0,<span class='error_goto'>__PYX_ERR(0, 469, __pyx_L5_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_args);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 469, __pyx_L5_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        if (unlikely(__pyx_v_kwargs == Py_None)) {
          <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
          <span class='error_goto'>__PYX_ERR(0, 469, __pyx_L5_error)</span>
        }
        if (likely(<span class='py_c_api'>PyDict_CheckExact</span>(__pyx_v_kwargs))) {
          __pyx_t_10 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 469, __pyx_L5_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        } else {
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>((PyObject*)&amp;PyDict_Type, __pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 469, __pyx_L5_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        }
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_func, __pyx_t_2, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 469, __pyx_L5_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_r = __pyx_t_9;
        __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L9_try_return;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0470</span>:         except catch_exceptions as e:</pre>
<pre class='cython code score-26 '>      <span class='trace'>__Pyx_TraceLine</span>(470,0,<span class='error_goto'>__PYX_ERR(0, 470, __pyx_L7_except_error)</span>)
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(__pyx_v_catch_exceptions);
      if (__pyx_t_11) {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.retry_operation", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_9, &amp;__pyx_t_10, &amp;__pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L7_except_error)</span>
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        __pyx_v_e = __pyx_t_10;
        /*try:*/ {
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(470,0,<span class='error_goto'>__PYX_ERR(0, 470, __pyx_L21_error)</span>)
        /*finally:*/ {
          /*normal exit:*/{
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
            goto __pyx_L22;
          }
          __pyx_L21_error:;
          /*exception exit:*/{
            __Pyx_PyThreadState_declare
            __Pyx_PyThreadState_assign
            __pyx_t_19 = 0; __pyx_t_20 = 0; __pyx_t_21 = 0; __pyx_t_22 = 0; __pyx_t_23 = 0; __pyx_t_24 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
            if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_22, &amp;__pyx_t_23, &amp;__pyx_t_24);
            if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_19, &amp;__pyx_t_20, &amp;__pyx_t_21) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_19, &amp;__pyx_t_20, &amp;__pyx_t_21);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_19);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_20);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_21);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_22);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_23);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_24);
            __pyx_t_11 = __pyx_lineno; __pyx_t_17 = __pyx_clineno; __pyx_t_18 = __pyx_filename;
            {
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
            }
            if (PY_MAJOR_VERSION &gt;= 3) {
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_22);
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_23);
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_24);
              <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_22, __pyx_t_23, __pyx_t_24);
            }
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_19);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_20);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_21);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_19, __pyx_t_20, __pyx_t_21);
            __pyx_t_19 = 0; __pyx_t_20 = 0; __pyx_t_21 = 0; __pyx_t_22 = 0; __pyx_t_23 = 0; __pyx_t_24 = 0;
            __pyx_lineno = __pyx_t_11; __pyx_clineno = __pyx_t_17; __pyx_filename = __pyx_t_18;
            goto __pyx_L7_except_error;
          }
          __pyx_L22:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        goto __pyx_L6_exception_handled;
      }
      goto __pyx_L7_except_error;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0471</span>:             if attempt &lt; retries:</pre>
<pre class='cython code score-8 '>          <span class='trace'>__Pyx_TraceLine</span>(471,0,<span class='error_goto'>__PYX_ERR(0, 471, __pyx_L21_error)</span>)
          __pyx_t_12 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_attempt, __pyx_v_retries, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 471, __pyx_L21_error)</span>
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_12); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 471, __pyx_L21_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          if (likely(__pyx_t_8)) {
/*  */
            goto __pyx_L23;
          }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0472</span>:                 if on_retry:</pre>
<pre class='cython code score-2 '>            <span class='trace'>__Pyx_TraceLine</span>(472,0,<span class='error_goto'>__PYX_ERR(0, 472, __pyx_L21_error)</span>)
            __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_on_retry); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 472, __pyx_L21_error)</span>
            if (__pyx_t_8) {
/*  */
            }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0473</span>:                     on_retry(attempt, e)</pre>
<pre class='cython code score-16 '>              <span class='trace'>__Pyx_TraceLine</span>(473,0,<span class='error_goto'>__PYX_ERR(0, 473, __pyx_L21_error)</span>)
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_on_retry);
              __pyx_t_14 = __pyx_v_on_retry; __pyx_t_15 = NULL;
              __pyx_t_11 = 0;
              #if CYTHON_UNPACK_METHODS
              if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
                __pyx_t_15 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
                if (likely(__pyx_t_15)) {
                  PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
                  <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
                  __pyx_t_11 = 1;
                }
              }
              #endif
              {
                PyObject *__pyx_callargs[3] = {__pyx_t_15, __pyx_v_attempt, __pyx_v_e};
                __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_14, __pyx_callargs+1-__pyx_t_11, 2+__pyx_t_11);
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 473, __pyx_L21_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
              }
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0474</span>:                 time.sleep(delay)</pre>
<pre class='cython code score-26 '>            <span class='trace'>__Pyx_TraceLine</span>(474,0,<span class='error_goto'>__PYX_ERR(0, 474, __pyx_L21_error)</span>)
            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 474, __pyx_L21_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
            __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_sleep);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 474, __pyx_L21_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
            __pyx_t_14 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_delay);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 474, __pyx_L21_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
            __pyx_t_16 = NULL;
            __pyx_t_11 = 0;
            #if CYTHON_UNPACK_METHODS
            if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
              __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
              if (likely(__pyx_t_16)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, function);
                __pyx_t_11 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_16, __pyx_t_14};
              __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_15, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
              if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 474, __pyx_L21_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0475</span>:                 delay *= backoff_factor</pre>
<pre class='cython code score-0 '>            <span class='trace'>__Pyx_TraceLine</span>(475,0,<span class='error_goto'>__PYX_ERR(0, 475, __pyx_L21_error)</span>)
            __pyx_v_delay = (__pyx_v_delay * __pyx_v_backoff_factor);
</pre><pre class="cython line score-0">&#xA0;<span class="">0476</span>:             else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0477</span>:                 raise e</pre>
<pre class='cython code score-2 '>          <span class='trace'>__Pyx_TraceLine</span>(477,0,<span class='error_goto'>__PYX_ERR(0, 477, __pyx_L21_error)</span>)
          /*else*/ {
            <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_v_e, 0, 0, 0);
            <span class='error_goto'>__PYX_ERR(0, 477, __pyx_L21_error)</span>
          }
          __pyx_L23:;
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0478</span>: </pre>
<pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0479</span>: def flatten_list(</pre>
<pre class='cython code score-87 '>static PyObject *__pyx_pf_6gofast_5tools_9funcutils_106__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("__defaults__", __pyx_f[0], 479, 0, <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(482,0,<span class='error_goto'>__PYX_ERR(0, 482, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self)-&gt;__pyx_arg_depth);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self)-&gt;__pyx_arg_depth);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self)-&gt;__pyx_arg_depth)) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>;
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(479,0,<span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_25flatten_list(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_24flatten_list, "\n    Flattens a nested list into a single list of values, with optional depth \n    and item processing parameters.\n\n    Parameters\n    ----------\n    nested_list : List[Any]\n        The list to flatten, which may contain nested lists of any depth.\n    depth : int, optional\n        The maximum depth of list nesting to flatten. A depth of -1 (default)\n        means fully flatten, a depth of 0 means no flattening, a depth of 1\n        means flatten one level of nesting, and so on.\n    process_item : Optional[Callable[[Any], Any]], optional\n        A callable that processes each item during flattening. It takes a single\n        item and returns the processed item. Default is None, which means no processing.\n\n    Returns\n    -------\n    List[Any]\n        A single, flat list containing all values from the nested list to the\n        specified depth, with each item processed if a callable is provided.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import flatten_list\n    &gt;&gt;&gt; nested = [1, [2, 3], [4, [5, 6]], 7]\n    &gt;&gt;&gt; flat = flatten_list(nested, depth=1)\n    &gt;&gt;&gt; print(flat)\n    [1, 2, 3, 4, [5, 6], 7]\n\n    With item processing to square numbers:\n    &gt;&gt;&gt; flat_processed = flatten_list(nested, process_item=(lambda x: x**2 if\n    ...                                  isinstance(x, int) else x))\n    &gt;&gt;&gt; print(flat_processed)\n    [1, 4, 9, 16, [25, 36], 49]\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_25flatten_list = {"flatten_list", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_25flatten_list, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_24flatten_list};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_25flatten_list(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_nested_list = 0;
  PyObject *__pyx_v_depth = 0;
  PyObject *__pyx_v_process_item = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("flatten_list (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_nested_list,&amp;__pyx_n_s_depth,&amp;__pyx_n_s_process_item,0};
  PyObject* values[3] = {0,0,0};
    __pyx_defaults1 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self);
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_depth);
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_24flatten_list(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_nested_list, PyObject *__pyx_v_depth, PyObject *__pyx_v_process_item) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_8_flatten_list *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__34)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_8_flatten_list *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_8_flatten_list(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_8_flatten_list, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_8_flatten_list *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("flatten_list", __pyx_f[0], 479, 0, <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_process_item = __pyx_v_process_item;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_process_item);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_process_item);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.flatten_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__161 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_nested_list, __pyx_n_s_depth, __pyx_n_s_process_item, __pyx_n_s_flatten, __pyx_n_s_flatten);<span class='error_goto'> if (unlikely(!__pyx_tuple__161)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__161);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__161);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(479,0,<span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_nested_list, __pyx_kp_s_List_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_depth, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_process_item, __pyx_kp_s_Optional_Callable_Any_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_kp_s_List_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_25flatten_list, 0, __pyx_n_s_flatten_list, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__34));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_3, sizeof(__pyx_defaults1), 1)) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>
  __pyx_codeobj__34 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__161, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_flatten_list, 479, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 479, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_8_flatten_list {
  PyObject_HEAD
  PyObject *__pyx_v_flatten;
  PyObject *__pyx_v_process_item;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0480</span>:     nested_list: List[Any],</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0481</span>:     depth: int = -1,</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(481,0,<span class='error_goto'>__PYX_ERR(0, 481, __pyx_L1_error)</span>)
  if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_neg_1)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_neg_1))) <span class='error_goto'>__PYX_ERR(0, 481, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_t_3)-&gt;__pyx_arg_depth = ((PyObject*)__pyx_int_neg_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_neg_1);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_3, __pyx_pf_6gofast_5tools_9funcutils_106__defaults__);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_flatten_list, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0482</span>:     process_item: Optional[Callable[[Any], Any]] = None</pre>
<pre class='cython code score-53 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_nested_list)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_depth);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_process_item);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "flatten_list") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_nested_list = values[0];
    __pyx_v_depth = ((PyObject*)values[1]);
    __pyx_v_process_item = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flatten_list", 0, 1, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 479, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.flatten_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_depth), (&amp;PyInt_Type), 0, "depth", 1))) <span class='error_goto'>__PYX_ERR(0, 481, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_24flatten_list(__pyx_self, __pyx_v_nested_list, __pyx_v_depth, __pyx_v_process_item);
</pre><pre class="cython line score-0">&#xA0;<span class="">0483</span>:     ) -&gt; List[Any]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0484</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0485</span>:     Flattens a nested list into a single list of values, with optional depth</pre>
<pre class="cython line score-0">&#xA0;<span class="">0486</span>:     and item processing parameters.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0487</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>:     nested_list : List[Any]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0491</span>:         The list to flatten, which may contain nested lists of any depth.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0492</span>:     depth : int, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0493</span>:         The maximum depth of list nesting to flatten. A depth of -1 (default)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0494</span>:         means fully flatten, a depth of 0 means no flattening, a depth of 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0495</span>:         means flatten one level of nesting, and so on.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>:     process_item : Optional[Callable[[Any], Any]], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0497</span>:         A callable that processes each item during flattening. It takes a single</pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>:         item and returns the processed item. Default is None, which means no processing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0500</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0501</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0502</span>:     List[Any]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0503</span>:         A single, flat list containing all values from the nested list to the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0504</span>:         specified depth, with each item processed if a callable is provided.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0505</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0506</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0507</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0508</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import flatten_list</pre>
<pre class="cython line score-0">&#xA0;<span class="">0509</span>:     &gt;&gt;&gt; nested = [1, [2, 3], [4, [5, 6]], 7]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0510</span>:     &gt;&gt;&gt; flat = flatten_list(nested, depth=1)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0511</span>:     &gt;&gt;&gt; print(flat)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0512</span>:     [1, 2, 3, 4, [5, 6], 7]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0513</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0514</span>:     With item processing to square numbers:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0515</span>:     &gt;&gt;&gt; flat_processed = flatten_list(nested, process_item=(lambda x: x**2 if</pre>
<pre class="cython line score-0">&#xA0;<span class="">0516</span>:     ...                                  isinstance(x, int) else x))</pre>
<pre class="cython line score-0">&#xA0;<span class="">0517</span>:     &gt;&gt;&gt; print(flat_processed)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0518</span>:     [1, 4, 9, 16, [25, 36], 49]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0519</span>:     """</pre>
<pre class="cython line score-92" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0520</span>:     def flatten(current_list: List[Any], current_depth: int) -&gt; List[Any]:</pre>
<pre class='cython code score-92 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_12flatten_list_1flatten(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_12flatten_list_1flatten = {"flatten", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_12flatten_list_1flatten, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_12flatten_list_1flatten(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_current_list = 0;
  PyObject *__pyx_v_current_depth = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("flatten (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_current_list,&amp;__pyx_n_s_current_depth,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_current_list)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_current_depth)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flatten", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "flatten") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_current_list = values[0];
    __pyx_v_current_depth = ((PyObject*)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flatten", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.flatten_list.flatten", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_current_depth), (&amp;PyInt_Type), 0, "current_depth", 1))) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_12flatten_list_flatten(__pyx_self, __pyx_v_current_list, __pyx_v_current_depth);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_12flatten_list_flatten(PyObject *__pyx_self, PyObject *__pyx_v_current_list, PyObject *__pyx_v_current_depth) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_8_flatten_list *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_8_flatten_list *__pyx_outer_scope;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_item = NULL;
  PyObject *__pyx_v_new_depth = NULL;
  PyObject *__pyx_v_processed_item = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_8_flatten_list *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("flatten", __pyx_f[0], 520, 0, <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.flatten_list.flatten", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_item);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_new_depth);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_processed_item);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__35 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_current_list, __pyx_n_s_current_depth, __pyx_n_s_result, __pyx_n_s_item, __pyx_n_s_new_depth, __pyx_n_s_processed_item);<span class='error_goto'> if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__35);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(520,0,<span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_current_list, __pyx_kp_s_List_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_current_depth, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_kp_s_List_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_12flatten_list_1flatten, 0, __pyx_n_s_flatten_list_locals_flatten, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__36));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_cur_scope-&gt;__pyx_v_flatten = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_codeobj__36 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_flatten, 520, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0521</span>:         result = []</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(521,0,<span class='error_goto'>__PYX_ERR(0, 521, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_result = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0522</span>:         for item in current_list:</pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(522,0,<span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>)
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_current_list)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_current_list)) {
    __pyx_t_1 = __pyx_v_current_list; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_current_list);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_item, __pyx_t_4);
    __pyx_t_4 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(522,0,<span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0523</span>:             if isinstance(item, list) and current_depth != 0:</pre>
<pre class='cython code score-13 '>    <span class='trace'>__Pyx_TraceLine</span>(523,0,<span class='error_goto'>__PYX_ERR(0, 523, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_item); 
    if (__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_current_depth, __pyx_int_0, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 523, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = __pyx_t_6;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_5) {
/*  */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">0524</span>:                 # Decrement depth unless it's infinite (-1)</pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0525</span>:                 new_depth = current_depth - 1 if current_depth &gt; 0 else -1</pre>
<pre class='cython code score-15 '>      <span class='trace'>__Pyx_TraceLine</span>(525,0,<span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_current_depth, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 525, __pyx_L1_error)</span>
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 525, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (__pyx_t_5) {
        __pyx_t_7 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_current_depth, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 525, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_4 = __pyx_t_7;
        __pyx_t_7 = 0;
      } else {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_neg_1);
        __pyx_t_4 = __pyx_int_neg_1;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_new_depth, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0526</span>:                 result.extend(flatten(item, new_depth))</pre>
<pre class='cython code score-7 '>      <span class='trace'>__Pyx_TraceLine</span>(526,0,<span class='error_goto'>__PYX_ERR(0, 526, __pyx_L1_error)</span>)
      if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_v_new_depth))||((__pyx_v_new_depth) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_v_new_depth))) <span class='error_goto'>__PYX_ERR(0, 526, __pyx_L1_error)</span>
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_flatten)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("flatten"); <span class='error_goto'>__PYX_ERR(0, 526, __pyx_L1_error)</span> }
      __pyx_t_4 = __pyx_pf_6gofast_5tools_9funcutils_12flatten_list_flatten(__pyx_cur_scope-&gt;__pyx_v_flatten, __pyx_v_item, ((PyObject*)__pyx_v_new_depth));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 526, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Extend</span>(__pyx_v_result, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 526, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0527</span>:             else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0528</span>:                 # Apply processing if available</pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0529</span>:                 processed_item = process_item(item) if process_item else item</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(529,0,<span class='error_goto'>__PYX_ERR(0, 529, __pyx_L1_error)</span>)
    /*else*/ {
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_process_item)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("process_item"); <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L1_error)</span> }
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_process_item); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L1_error)</span>
      if (__pyx_t_5) {
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_process_item)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("process_item"); <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L1_error)</span> }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_process_item);
        __pyx_t_9 = __pyx_cur_scope-&gt;__pyx_v_process_item; __pyx_t_10 = NULL;
        __pyx_t_11 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
          __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
          if (likely(__pyx_t_10)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
            __pyx_t_11 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_v_item};
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
        __pyx_t_4 = __pyx_t_7;
        __pyx_t_7 = 0;
      } else {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_item);
        __pyx_t_4 = __pyx_v_item;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_processed_item, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0530</span>:                 result.append(processed_item)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(530,0,<span class='error_goto'>__PYX_ERR(0, 530, __pyx_L1_error)</span>)
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_result, __pyx_v_processed_item);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 530, __pyx_L1_error)</span>
    }
    __pyx_L5:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0531</span>:         return result</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(531,0,<span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0532</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0533</span>:     return flatten(nested_list, depth)</pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(533,0,<span class='error_goto'>__PYX_ERR(0, 533, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = __pyx_pf_6gofast_5tools_9funcutils_12flatten_list_flatten(__pyx_cur_scope-&gt;__pyx_v_flatten, __pyx_v_nested_list, __pyx_v_depth);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 533, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0534</span>: </pre>
<pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0535</span>: def timeit_decorator(</pre>
<pre class='cython code score-77 '>static PyObject *__pyx_pf_6gofast_5tools_9funcutils_108__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("__defaults__", __pyx_f[0], 535, 0, <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(536,0,<span class='error_goto'>__PYX_ERR(0, 536, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, Py_None)) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self)-&gt;__pyx_arg_level);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self)-&gt;__pyx_arg_level);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self)-&gt;__pyx_arg_level)) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>;
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(535,0,<span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_27timeit_decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_26timeit_decorator, "\n    A decorator that measures the execution time of a function and optionally\n    logs it.\n\n    Parameters\n    ----------\n    logger : Optional[logging.Logger], optional\n        A logger object to log the execution time message. If None (default),\n        the message is printed using the print function.\n    level : int, optional\n        The logging level at which to log the execution time message. Default\n        is logging.INFO.\n\n    Returns\n    -------\n    Callable\n        A wrapped version of the input function that, when called, logs or prints\n        the execution time.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import timeit_decorator\n    &gt;&gt;&gt; import logging\n    &gt;&gt;&gt; logger = logging.getLogger('MyLogger')\n    &gt;&gt;&gt; @timeit_decorator(logger=logger)\n    ... def example_function(delay: float):\n    ...     '''Example function that sleeps for a given delay.'''\n    ...     time.sleep(delay)\n    &gt;&gt;&gt; example_function(1)\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_27timeit_decorator = {"timeit_decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_27timeit_decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_26timeit_decorator};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_27timeit_decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_logger = 0;
  PyObject *__pyx_v_level = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("timeit_decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_logger,&amp;__pyx_n_s_level,0};
  PyObject* values[2] = {0,0};
    __pyx_defaults2 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self);
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_26timeit_decorator(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_logger, PyObject *__pyx_v_level) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_9_timeit_decorator *__pyx_cur_scope;
  PyObject *__pyx_v_decorator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__40)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_9_timeit_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_9_timeit_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_9_timeit_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_9_timeit_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("timeit_decorator", __pyx_f[0], 535, 0, <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_logger = __pyx_v_logger;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_logger);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_logger);
  __pyx_cur_scope-&gt;__pyx_v_level = __pyx_v_level;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_level);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_level);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.timeit_decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_decorator);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__162 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_logger, __pyx_n_s_level, __pyx_n_s_decorator, __pyx_n_s_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__162)) __PYX_ERR(0, 535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__162);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__162);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(535,0,<span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_logger, __pyx_kp_s_Optional_logging_Logger) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_level, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_27timeit_decorator, 0, __pyx_n_s_timeit_decorator, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__40));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 535, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_2, sizeof(__pyx_defaults2), 1)) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>
  __pyx_codeobj__40 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__162, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_timeit_decorator, 535, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 535, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_9_timeit_decorator {
  PyObject_HEAD
  PyObject *__pyx_v_level;
  PyObject *__pyx_v_logger;
};

</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0536</span>:     logger: Optional[logging.Logger] = None,</pre>
<pre class='cython code score-42 '>    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_level);
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_logger);
          if (value) { values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_level);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "timeit_decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_logger = values[0];
    __pyx_v_level = ((PyObject*)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("timeit_decorator", 0, 0, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.timeit_decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_level), (&amp;PyInt_Type), 0, "level", 1))) <span class='error_goto'>__PYX_ERR(0, 537, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_26timeit_decorator(__pyx_self, __pyx_v_logger, __pyx_v_level);
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0537</span>:     level: int = logging.INFO</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(537,0,<span class='error_goto'>__PYX_ERR(0, 537, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_logging);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 537, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_INFO);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 537, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_t_5))||((__pyx_t_5) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_t_5))) <span class='error_goto'>__PYX_ERR(0, 537, __pyx_L1_error)</span>
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_t_2)-&gt;__pyx_arg_level = ((PyObject*)__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_2, __pyx_pf_6gofast_5tools_9funcutils_108__defaults__);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_timeit_decorator, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0538</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0539</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>:     A decorator that measures the execution time of a function and optionally</pre>
<pre class="cython line score-0">&#xA0;<span class="">0541</span>:     logs it.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0542</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0543</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0544</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0545</span>:     logger : Optional[logging.Logger], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0546</span>:         A logger object to log the execution time message. If None (default),</pre>
<pre class="cython line score-0">&#xA0;<span class="">0547</span>:         the message is printed using the print function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0548</span>:     level : int, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>:         The logging level at which to log the execution time message. Default</pre>
<pre class="cython line score-0">&#xA0;<span class="">0550</span>:         is logging.INFO.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0551</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0552</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0553</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0554</span>:     Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0555</span>:         A wrapped version of the input function that, when called, logs or prints</pre>
<pre class="cython line score-0">&#xA0;<span class="">0556</span>:         the execution time.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0557</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0558</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0559</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0560</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import timeit_decorator</pre>
<pre class="cython line score-0">&#xA0;<span class="">0561</span>:     &gt;&gt;&gt; import logging</pre>
<pre class="cython line score-0">&#xA0;<span class="">0562</span>:     &gt;&gt;&gt; logger = logging.getLogger('MyLogger')</pre>
<pre class="cython line score-0">&#xA0;<span class="">0563</span>:     &gt;&gt;&gt; @timeit_decorator(logger=logger)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0564</span>:     ... def example_function(delay: float):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0565</span>:     ...     '''Example function that sleeps for a given delay.'''</pre>
<pre class="cython line score-0">&#xA0;<span class="">0566</span>:     ...     time.sleep(delay)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0567</span>:     &gt;&gt;&gt; example_function(1)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0568</span>:     """</pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0569</span>:     def decorator(func: Callable) -&gt; Callable:</pre>
<pre class='cython code score-70 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_16timeit_decorator_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_16timeit_decorator_1decorator = {"decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_16timeit_decorator_1decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_16timeit_decorator_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decorator", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.timeit_decorator.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_16timeit_decorator_decorator(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_16timeit_decorator_decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_10_decorator *__pyx_cur_scope;
  PyObject *__pyx_v_wrapper = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_10_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_10_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_10_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_10_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_9_timeit_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("decorator", __pyx_f[0], 569, 0, <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.timeit_decorator.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_wrapper);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__41 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_func, __pyx_n_s_wrapper, __pyx_n_s_wrapper);<span class='error_goto'> if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__41);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__41);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(569,0,<span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_16timeit_decorator_1decorator, 0, __pyx_n_s_timeit_decorator_locals_decorato_2, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__42));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_decorator = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_codeobj__42 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_decorator, 569, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_10_decorator {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_9_timeit_decorator *__pyx_outer_scope;
  PyObject *__pyx_v_func;
};

</pre><pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0570</span>:         @functools.wraps(func)</pre>
<pre class='cython code score-74 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_16timeit_decorator_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_16timeit_decorator_9decorator_1wrapper = {"wrapper", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_16timeit_decorator_9decorator_1wrapper, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_16timeit_decorator_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("wrapper (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "wrapper", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_16timeit_decorator_9decorator_wrapper(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_16timeit_decorator_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_10_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_10_decorator *__pyx_outer_scope;
  PyObject *__pyx_v_start_time = NULL;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_end_time = NULL;
  PyObject *__pyx_v_message = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_10_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("wrapper", __pyx_f[0], 570, 0, <span class='error_goto'>__PYX_ERR(0, 570, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.timeit_decorator.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start_time);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end_time);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_message);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(570,0,<span class='error_goto'>__PYX_ERR(0, 570, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 570, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
/*  */
  __pyx_tuple__38 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_start_time, __pyx_n_s_result, __pyx_n_s_end_time, __pyx_n_s_message);<span class='error_goto'> if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__38);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__38);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_16timeit_decorator_9decorator_1wrapper, 0, __pyx_n_s_timeit_decorator_locals_decorato, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__39));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 570, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_wrapper = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__39 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__38, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_wrapper, 570, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 570, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0571</span>:         def wrapper(*args, **kwargs):</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0572</span>:             start_time = time.time()</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(572,0,<span class='error_goto'>__PYX_ERR(0, 572, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 572, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 572, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_start_time = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0573</span>:             result = func(*args, **kwargs)</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(573,0,<span class='error_goto'>__PYX_ERR(0, 573, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 573, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 573, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_result = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0574</span>:             end_time = time.time()</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(574,0,<span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 574, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_end_time = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0575</span>:             message = f"'{func.__name__}' executed in {end_time - start_time:.2f}s"</pre>
<pre class='cython code score-43 '>  <span class='trace'>__Pyx_TraceLine</span>(575,0,<span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = 0;
  __pyx_t_6 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__37);
  __pyx_t_5 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__37);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_kp_u__37);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 575, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_2, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_6;
  __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_executed_in);
  __pyx_t_5 += 14;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_executed_in);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_kp_u_executed_in);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_end_time, __pyx_v_start_time);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Format</span>(__pyx_t_1, __pyx_kp_u_2f);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) : __pyx_t_6;
  __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_s);
  __pyx_t_5 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_s);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 4, __pyx_n_u_s);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 5, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 575, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_message = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0576</span>:             if logger:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(576,0,<span class='error_goto'>__PYX_ERR(0, 576, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_logger)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("logger"); <span class='error_goto'>__PYX_ERR(0, 576, __pyx_L1_error)</span> }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_logger); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 576, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0577</span>:                 logger.log(level, message)</pre>
<pre class='cython code score-21 '>    <span class='trace'>__Pyx_TraceLine</span>(577,0,<span class='error_goto'>__PYX_ERR(0, 577, __pyx_L1_error)</span>)
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_logger)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("logger"); <span class='error_goto'>__PYX_ERR(0, 577, __pyx_L1_error)</span> }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_logger, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 577, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_level)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("level"); <span class='error_goto'>__PYX_ERR(0, 577, __pyx_L1_error)</span> }
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_level, __pyx_v_message};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 577, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0578</span>:             else:</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0579</span>:                 print(message)</pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(579,0,<span class='error_goto'>__PYX_ERR(0, 579, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_v_message);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 579, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0580</span>:             return result</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(580,0,<span class='error_goto'>__PYX_ERR(0, 580, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0581</span>:         return wrapper</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(581,0,<span class='error_goto'>__PYX_ERR(0, 581, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wrapper);
  __pyx_r = __pyx_v_wrapper;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0582</span>:     return decorator</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(582,0,<span class='error_goto'>__PYX_ERR(0, 582, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorator);
  __pyx_r = __pyx_v_decorator;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0583</span>: </pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0584</span>: def conditional_decorator(</pre>
<pre class='cython code score-63 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_29conditional_decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_28conditional_decorator, "\n    Applies a decorator to a function conditionally based on a predicate. \n    \n    Optionally, applies an alternative decorator if the condition is not met.\n\n    Parameters\n    ----------\n    predicate : Callable[[Callable], bool]\n        A function that takes a function as input and returns True if the primary\n        decorator should be applied, False otherwise.\n    decorator : Callable[[Callable], Callable]\n        The primary decorator to apply if the predicate returns True.\n    else_decorator : Optional[Callable[[Callable], Callable]], optional\n        An alternative decorator to apply if the predicate returns False. If None,\n        the function is returned unchanged in case of False. Default is None.\n\n    Returns\n    -------\n    Callable\n        A new decorator that conditionally applies the given decorators based on\n        the predicate.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import conditional_decorator\n    &gt;&gt;&gt; def my_decorator(func):\n    ...     def wrapper(*args, **kwargs):\n    ...         print(\"Decorated\")\n    ...         return func(*args, **kwargs)\n    ...     return wrapper\n    &gt;&gt;&gt; def is_even(func):\n    ...     return func(2) % 2 == 0\n    &gt;&gt;&gt; @conditional_decorator(predicate=is_even, decorator=my_decorator)\n    ... def add_one(x):\n    ...     return x + 1\n    &gt;&gt;&gt; add_one(2)\n    'Decorated'\n    3\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_29conditional_decorator = {"conditional_decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_29conditional_decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_28conditional_decorator};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_29conditional_decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_predicate = 0;
  PyObject *__pyx_v_decorator = 0;
  PyObject *__pyx_v_else_decorator = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("conditional_decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_predicate,&amp;__pyx_n_s_decorator,&amp;__pyx_n_s_else_decorator,0};
  PyObject* values[3] = {0,0,0};
/*  */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_28conditional_decorator(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_predicate, PyObject *__pyx_v_decorator, PyObject *__pyx_v_else_decorator) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_11_conditional_decorator *__pyx_cur_scope;
  PyObject *__pyx_v_new_decorator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__43)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_11_conditional_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_11_conditional_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_11_conditional_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_11_conditional_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("conditional_decorator", __pyx_f[0], 584, 0, <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_predicate = __pyx_v_predicate;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_predicate);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_predicate);
  __pyx_cur_scope-&gt;__pyx_v_decorator = __pyx_v_decorator;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_decorator);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_decorator);
  __pyx_cur_scope-&gt;__pyx_v_else_decorator = __pyx_v_else_decorator;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_else_decorator);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_else_decorator);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.conditional_decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_new_decorator);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__163 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_predicate, __pyx_n_s_decorator, __pyx_n_s_else_decorator, __pyx_n_s_new_decorator, __pyx_n_s_new_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__163)) __PYX_ERR(0, 584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__163);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__163);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(584,0,<span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_predicate, __pyx_kp_s_Callable_Callable_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_decorator, __pyx_kp_s_Callable_Callable_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_else_decorator, __pyx_kp_s_Optional_Callable_Callable_Calla) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_29conditional_decorator, 0, __pyx_n_s_conditional_decorator, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__43));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 584, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__139);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_conditional_decorator, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__43 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__163, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_conditional_decorator, 584, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__43)) __PYX_ERR(0, 584, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_11_conditional_decorator {
  PyObject_HEAD
  PyObject *__pyx_v_decorator;
  PyObject *__pyx_v_else_decorator;
  PyObject *__pyx_v_predicate;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0585</span>:     predicate: Callable[[Callable], bool],</pre>
<pre class="cython line score-0">&#xA0;<span class="">0586</span>:     decorator: Callable[[Callable], Callable],</pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0587</span>:     else_decorator: Optional[Callable[[Callable], Callable]] = None</pre>
<pre class='cython code score-53 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_predicate)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_decorator)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conditional_decorator", 0, 2, 3, 1); <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_else_decorator);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "conditional_decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_predicate = values[0];
    __pyx_v_decorator = values[1];
    __pyx_v_else_decorator = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conditional_decorator", 0, 2, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 584, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.conditional_decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_28conditional_decorator(__pyx_self, __pyx_v_predicate, __pyx_v_decorator, __pyx_v_else_decorator);
</pre><pre class="cython line score-0">&#xA0;<span class="">0588</span>:     ) -&gt; Callable:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>:     Applies a decorator to a function conditionally based on a predicate.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0591</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0592</span>:     Optionally, applies an alternative decorator if the condition is not met.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0593</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0594</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0595</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0596</span>:     predicate : Callable[[Callable], bool]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0597</span>:         A function that takes a function as input and returns True if the primary</pre>
<pre class="cython line score-0">&#xA0;<span class="">0598</span>:         decorator should be applied, False otherwise.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0599</span>:     decorator : Callable[[Callable], Callable]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0600</span>:         The primary decorator to apply if the predicate returns True.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0601</span>:     else_decorator : Optional[Callable[[Callable], Callable]], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0602</span>:         An alternative decorator to apply if the predicate returns False. If None,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0603</span>:         the function is returned unchanged in case of False. Default is None.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0604</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0605</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0606</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0607</span>:     Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0608</span>:         A new decorator that conditionally applies the given decorators based on</pre>
<pre class="cython line score-0">&#xA0;<span class="">0609</span>:         the predicate.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0610</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0611</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0612</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0613</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import conditional_decorator</pre>
<pre class="cython line score-0">&#xA0;<span class="">0614</span>:     &gt;&gt;&gt; def my_decorator(func):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0615</span>:     ...     def wrapper(*args, **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0616</span>:     ...         print("Decorated")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0617</span>:     ...         return func(*args, **kwargs)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0618</span>:     ...     return wrapper</pre>
<pre class="cython line score-0">&#xA0;<span class="">0619</span>:     &gt;&gt;&gt; def is_even(func):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0620</span>:     ...     return func(2) % 2 == 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">0621</span>:     &gt;&gt;&gt; @conditional_decorator(predicate=is_even, decorator=my_decorator)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0622</span>:     ... def add_one(x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0623</span>:     ...     return x + 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0624</span>:     &gt;&gt;&gt; add_one(2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0625</span>:     'Decorated'</pre>
<pre class="cython line score-0">&#xA0;<span class="">0626</span>:     3</pre>
<pre class="cython line score-0">&#xA0;<span class="">0627</span>:     """</pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0628</span>:     def new_decorator(func: Callable) -&gt; Callable:</pre>
<pre class='cython code score-64 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_21conditional_decorator_1new_decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_21conditional_decorator_1new_decorator = {"new_decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_21conditional_decorator_1new_decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_21conditional_decorator_1new_decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("new_decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "new_decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("new_decorator", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.conditional_decorator.new_decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_21conditional_decorator_new_decorator(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_21conditional_decorator_new_decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_11_conditional_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_11_conditional_decorator *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_11_conditional_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("new_decorator", __pyx_f[0], 628, 0, <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.conditional_decorator.new_decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__44 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_func);<span class='error_goto'> if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__44);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__44);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(628,0,<span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_21conditional_decorator_1new_decorator, 0, __pyx_n_s_conditional_decorator_locals_new, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__45));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_new_decorator = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_codeobj__45 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_new_decorator, 628, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__45)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0629</span>:         if predicate(func):</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(629,0,<span class='error_goto'>__PYX_ERR(0, 629, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_predicate)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("predicate"); <span class='error_goto'>__PYX_ERR(0, 629, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_predicate);
  __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_v_predicate; __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_func};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 629, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/*  */
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0630</span>:             return decorator(func)</pre>
<pre class='cython code score-18 '>    <span class='trace'>__Pyx_TraceLine</span>(630,0,<span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_decorator)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("decorator"); <span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span> }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_decorator);
    __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_v_decorator; __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_func};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0631</span>:         elif else_decorator:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(631,0,<span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_else_decorator)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("else_decorator"); <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span> }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_else_decorator); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/*  */
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0632</span>:             return else_decorator(func)</pre>
<pre class='cython code score-18 '>    <span class='trace'>__Pyx_TraceLine</span>(632,0,<span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_else_decorator)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("else_decorator"); <span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span> }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_else_decorator);
    __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_v_else_decorator; __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_func};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0633</span>:         return func</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(633,0,<span class='error_goto'>__PYX_ERR(0, 633, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_func);
  __pyx_r = __pyx_v_func;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0634</span>:     return new_decorator</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(634,0,<span class='error_goto'>__PYX_ERR(0, 634, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_decorator);
  __pyx_r = __pyx_v_new_decorator;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0635</span>: </pre>
<pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0636</span>: def batch_processor(</pre>
<pre class='cython code score-68 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_31batch_processor(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_30batch_processor, "\n    Process a batch of inputs, with optional error handling and success \n    callbacks.\n\n    Parameters\n    ----------\n    func : Callable\n        The original function to be applied to each element of the input batch.\n    on_error : Optional[Callable[[Exception, Any], Any]], optional\n        A callback function to be called if an exception occurs while processing\n        an element. It should take two parameters: the exception and the input\n        that caused it, and return a value to be included in the results list.\n        If None (default), exceptions are raised immediately, stopping the batch.\n    on_success : Optional[Callable[[Any, Any], None]], optional\n        A callback function to be called after successfully processing an element.\n        It should take two parameters: the result of the function call and the\n        input that led to it. This can be used for logging or further processing.\n\n    Returns\n    -------\n    Callable\n        A function that takes a list of inputs and returns a list of results,\n        applying `func` to each input element, handling exceptions and successes\n        as specified.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import batch_processor\n    &gt;&gt;&gt; def safe_divide(x):\n    ...     return 10 / x\n    &gt;&gt;&gt; def handle_error(e, x):\n    ...     print(f\"Error {e} occurred with input {x}\")\n    ...     return None  # Default value in case of error\n    &gt;&gt;&gt; batch_divide = batch_processor(safe_divide, on_error=handle_error)\n    &gt;&gt;&gt; print(batch_divide([2, 1, 0]))  # 0 will cause a division by zero error\n    Error division by zero occurred with input 0\n    [5.0, 10.0, None]\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_31batch_processor = {"batch_processor", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_31batch_processor, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_30batch_processor};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_31batch_processor(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_on_error = 0;
  PyObject *__pyx_v_on_success = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("batch_processor (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,&amp;__pyx_n_s_on_error,&amp;__pyx_n_s_on_success,0};
  PyObject* values[3] = {0,0,0};
/*  */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_30batch_processor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_func, PyObject *__pyx_v_on_error, PyObject *__pyx_v_on_success) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_12_batch_processor *__pyx_cur_scope;
  PyObject *__pyx_v_process_batch = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__46)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_12_batch_processor *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_12_batch_processor(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_12_batch_processor, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_12_batch_processor *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("batch_processor", __pyx_f[0], 636, 0, <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  __pyx_cur_scope-&gt;__pyx_v_on_error = __pyx_v_on_error;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_on_error);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_on_error);
  __pyx_cur_scope-&gt;__pyx_v_on_success = __pyx_v_on_success;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_on_success);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_on_success);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.batch_processor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_process_batch);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__164 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_func, __pyx_n_s_on_error, __pyx_n_s_on_success, __pyx_n_s_process_batch, __pyx_n_s_process_batch);<span class='error_goto'> if (unlikely(!__pyx_tuple__164)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__164);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__164);
  __pyx_codeobj__46 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__164, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_batch_processor, 636, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(636,0,<span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_on_error, __pyx_kp_s_Optional_Callable_Exception_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_on_success, __pyx_kp_s_Optional_Callable_Any_Any_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_31batch_processor, 0, __pyx_n_s_batch_processor, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__46));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__165);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_batch_processor, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__165 = <span class='py_c_api'>PyTuple_Pack</span>(2, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__165)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__165);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__165);
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_12_batch_processor {
  PyObject_HEAD
  PyObject *__pyx_v_func;
  PyObject *__pyx_v_on_error;
  PyObject *__pyx_v_on_success;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0637</span>:     func: Callable,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0638</span>:     on_error: Optional[Callable[[Exception, Any], Any]] = None,</pre>
<pre class='cython code score-2 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0639</span>:     on_success: Optional[Callable[[Any, Any], None]] = None) -&gt; Callable:</pre>
<pre class='cython code score-51 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_error);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_success);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "batch_processor") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_func = values[0];
    __pyx_v_on_error = values[1];
    __pyx_v_on_success = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("batch_processor", 0, 1, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.batch_processor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_30batch_processor(__pyx_self, __pyx_v_func, __pyx_v_on_error, __pyx_v_on_success);
</pre><pre class="cython line score-0">&#xA0;<span class="">0640</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0641</span>:     Process a batch of inputs, with optional error handling and success</pre>
<pre class="cython line score-0">&#xA0;<span class="">0642</span>:     callbacks.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0643</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0644</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0645</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0646</span>:     func : Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0647</span>:         The original function to be applied to each element of the input batch.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0648</span>:     on_error : Optional[Callable[[Exception, Any], Any]], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0649</span>:         A callback function to be called if an exception occurs while processing</pre>
<pre class="cython line score-0">&#xA0;<span class="">0650</span>:         an element. It should take two parameters: the exception and the input</pre>
<pre class="cython line score-0">&#xA0;<span class="">0651</span>:         that caused it, and return a value to be included in the results list.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0652</span>:         If None (default), exceptions are raised immediately, stopping the batch.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0653</span>:     on_success : Optional[Callable[[Any, Any], None]], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0654</span>:         A callback function to be called after successfully processing an element.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0655</span>:         It should take two parameters: the result of the function call and the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0656</span>:         input that led to it. This can be used for logging or further processing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0657</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0658</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0659</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0660</span>:     Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0661</span>:         A function that takes a list of inputs and returns a list of results,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0662</span>:         applying `func` to each input element, handling exceptions and successes</pre>
<pre class="cython line score-0">&#xA0;<span class="">0663</span>:         as specified.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0664</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0665</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0666</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0667</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import batch_processor</pre>
<pre class="cython line score-0">&#xA0;<span class="">0668</span>:     &gt;&gt;&gt; def safe_divide(x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0669</span>:     ...     return 10 / x</pre>
<pre class="cython line score-0">&#xA0;<span class="">0670</span>:     &gt;&gt;&gt; def handle_error(e, x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0671</span>:     ...     print(f"Error {e} occurred with input {x}")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0672</span>:     ...     return None  # Default value in case of error</pre>
<pre class="cython line score-0">&#xA0;<span class="">0673</span>:     &gt;&gt;&gt; batch_divide = batch_processor(safe_divide, on_error=handle_error)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0674</span>:     &gt;&gt;&gt; print(batch_divide([2, 1, 0]))  # 0 will cause a division by zero error</pre>
<pre class="cython line score-0">&#xA0;<span class="">0675</span>:     Error division by zero occurred with input 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">0676</span>:     [5.0, 10.0, None]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0677</span>:     """</pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0678</span>:     def process_batch(inputs: List[Any]) -&gt; List[Any]:</pre>
<pre class='cython code score-73 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15batch_processor_1process_batch(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_15batch_processor_1process_batch = {"process_batch", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_15batch_processor_1process_batch, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15batch_processor_1process_batch(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_inputs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("process_batch (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_inputs,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_inputs)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 678, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "process_batch") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 678, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_inputs = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("process_batch", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 678, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.batch_processor.process_batch", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_15batch_processor_process_batch(__pyx_self, __pyx_v_inputs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_15batch_processor_process_batch(PyObject *__pyx_self, PyObject *__pyx_v_inputs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_12_batch_processor *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_12_batch_processor *__pyx_outer_scope;
  PyObject *__pyx_v_results = NULL;
  PyObject *__pyx_v_input = NULL;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_e = NULL;
  PyObject *__pyx_v_error_result = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_12_batch_processor *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("process_batch", __pyx_f[0], 678, 0, <span class='error_goto'>__PYX_ERR(0, 678, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.batch_processor.process_batch", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_results);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_input);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_e);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_error_result);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__47 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_inputs, __pyx_n_s_results, __pyx_n_s_input, __pyx_n_s_result, __pyx_n_s_e, __pyx_n_s_error_result);<span class='error_goto'> if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__47);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__47);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(678,0,<span class='error_goto'>__PYX_ERR(0, 678, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_inputs, __pyx_kp_s_List_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 678, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_kp_s_List_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 678, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_15batch_processor_1process_batch, 0, __pyx_n_s_batch_processor_locals_process_b, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__48));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_process_batch = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_codeobj__48 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__47, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_process_batch, 678, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__48)) __PYX_ERR(0, 678, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0679</span>:         results = []</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(679,0,<span class='error_goto'>__PYX_ERR(0, 679, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 679, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_results = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0680</span>:         for input in inputs:</pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(680,0,<span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>)
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_inputs)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_inputs)) {
    __pyx_t_1 = __pyx_v_inputs; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_inputs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 680, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_input, __pyx_t_4);
    __pyx_t_4 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(680,0,<span class='error_goto'>__PYX_ERR(0, 680, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0681</span>:             try:</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(681,0,<span class='error_goto'>__PYX_ERR(0, 681, __pyx_L1_error)</span>)
    {
      /*try:*/ {
/*  */
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L12_try_end;
      __pyx_L5_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/*  */
      __pyx_L7_except_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_6, __pyx_t_7);
      goto __pyx_L1_error;
      __pyx_L6_exception_handled:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_6, __pyx_t_7);
      __pyx_L12_try_end:;
    }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0682</span>:                 result = func(input)</pre>
<pre class='cython code score-18 '>        <span class='trace'>__Pyx_TraceLine</span>(682,0,<span class='error_goto'>__PYX_ERR(0, 682, __pyx_L5_error)</span>)
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L5_error)</span> }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
        __pyx_t_8 = __pyx_cur_scope-&gt;__pyx_v_func; __pyx_t_9 = NULL;
        __pyx_t_10 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
          __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
          if (likely(__pyx_t_9)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
            __pyx_t_10 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_v_input};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 682, __pyx_L5_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_result, __pyx_t_4);
        __pyx_t_4 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0683</span>:                 if on_success:</pre>
<pre class='cython code score-4 '>        <span class='trace'>__Pyx_TraceLine</span>(683,0,<span class='error_goto'>__PYX_ERR(0, 683, __pyx_L5_error)</span>)
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_on_success)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("on_success"); <span class='error_goto'>__PYX_ERR(0, 683, __pyx_L5_error)</span> }
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_on_success); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 683, __pyx_L5_error)</span>
        if (__pyx_t_11) {
/*  */
        }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0684</span>:                     on_success(result, input)</pre>
<pre class='cython code score-18 '>          <span class='trace'>__Pyx_TraceLine</span>(684,0,<span class='error_goto'>__PYX_ERR(0, 684, __pyx_L5_error)</span>)
          if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_on_success)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("on_success"); <span class='error_goto'>__PYX_ERR(0, 684, __pyx_L5_error)</span> }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_on_success);
          __pyx_t_8 = __pyx_cur_scope-&gt;__pyx_v_on_success; __pyx_t_9 = NULL;
          __pyx_t_10 = 0;
          #if CYTHON_UNPACK_METHODS
          if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
            __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
            if (likely(__pyx_t_9)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
              __pyx_t_10 = 1;
            }
          }
          #endif
          {
            PyObject *__pyx_callargs[3] = {__pyx_t_9, __pyx_v_result, __pyx_v_input};
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_10, 2+__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
            if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 684, __pyx_L5_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0685</span>:                 results.append(result)</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(685,0,<span class='error_goto'>__PYX_ERR(0, 685, __pyx_L5_error)</span>)
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_results, __pyx_v_result);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 685, __pyx_L5_error)</span>
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0686</span>:             except Exception as e:</pre>
<pre class='cython code score-25 '>      <span class='trace'>__Pyx_TraceLine</span>(686,0,<span class='error_goto'>__PYX_ERR(0, 686, __pyx_L7_except_error)</span>)
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])));
      if (__pyx_t_10) {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.batch_processor.process_batch", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_4, &amp;__pyx_t_8, &amp;__pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 686, __pyx_L7_except_error)</span>
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        __pyx_v_e = __pyx_t_8;
        /*try:*/ {
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(686,0,<span class='error_goto'>__PYX_ERR(0, 686, __pyx_L19_error)</span>)
        /*finally:*/ {
          /*normal exit:*/{
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
            goto __pyx_L20;
          }
          __pyx_L19_error:;
          /*exception exit:*/{
            __Pyx_PyThreadState_declare
            __Pyx_PyThreadState_assign
            __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0; __pyx_t_21 = 0; __pyx_t_22 = 0; __pyx_t_23 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
            if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_21, &amp;__pyx_t_22, &amp;__pyx_t_23);
            if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_18, &amp;__pyx_t_19, &amp;__pyx_t_20) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_18, &amp;__pyx_t_19, &amp;__pyx_t_20);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_18);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_19);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_20);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_21);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_22);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_23);
            __pyx_t_10 = __pyx_lineno; __pyx_t_16 = __pyx_clineno; __pyx_t_17 = __pyx_filename;
            {
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
            }
            if (PY_MAJOR_VERSION &gt;= 3) {
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_21);
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_22);
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_23);
              <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_21, __pyx_t_22, __pyx_t_23);
            }
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_18);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_19);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_20);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_18, __pyx_t_19, __pyx_t_20);
            __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0; __pyx_t_21 = 0; __pyx_t_22 = 0; __pyx_t_23 = 0;
            __pyx_lineno = __pyx_t_10; __pyx_clineno = __pyx_t_16; __pyx_filename = __pyx_t_17;
            goto __pyx_L7_except_error;
          }
          __pyx_L20:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        goto __pyx_L6_exception_handled;
      }
      goto __pyx_L7_except_error;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0687</span>:                 if on_error:</pre>
<pre class='cython code score-4 '>          <span class='trace'>__Pyx_TraceLine</span>(687,0,<span class='error_goto'>__PYX_ERR(0, 687, __pyx_L19_error)</span>)
          if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_on_error)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("on_error"); <span class='error_goto'>__PYX_ERR(0, 687, __pyx_L19_error)</span> }
          __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_on_error); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 687, __pyx_L19_error)</span>
          if (likely(__pyx_t_11)) {
/*  */
            goto __pyx_L21;
          }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0688</span>:                     error_result = on_error(e, input)</pre>
<pre class='cython code score-18 '>            <span class='trace'>__Pyx_TraceLine</span>(688,0,<span class='error_goto'>__PYX_ERR(0, 688, __pyx_L19_error)</span>)
            if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_on_error)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("on_error"); <span class='error_goto'>__PYX_ERR(0, 688, __pyx_L19_error)</span> }
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_on_error);
            __pyx_t_14 = __pyx_cur_scope-&gt;__pyx_v_on_error; __pyx_t_15 = NULL;
            __pyx_t_10 = 0;
            #if CYTHON_UNPACK_METHODS
            if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
              __pyx_t_15 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
              if (likely(__pyx_t_15)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
                __pyx_t_10 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[3] = {__pyx_t_15, __pyx_v_e, __pyx_v_input};
              __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_14, __pyx_callargs+1-__pyx_t_10, 2+__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
              if (unlikely(!__pyx_t_13)) <span class='error_goto'>__PYX_ERR(0, 688, __pyx_L19_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_error_result, __pyx_t_13);
            __pyx_t_13 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0689</span>:                     results.append(error_result)</pre>
<pre class='cython code score-2 '>            <span class='trace'>__Pyx_TraceLine</span>(689,0,<span class='error_goto'>__PYX_ERR(0, 689, __pyx_L19_error)</span>)
            __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_results, __pyx_v_error_result);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 689, __pyx_L19_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0690</span>:                 else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0691</span>:                     raise e</pre>
<pre class='cython code score-2 '>          <span class='trace'>__Pyx_TraceLine</span>(691,0,<span class='error_goto'>__PYX_ERR(0, 691, __pyx_L19_error)</span>)
          /*else*/ {
            <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_v_e, 0, 0, 0);
            <span class='error_goto'>__PYX_ERR(0, 691, __pyx_L19_error)</span>
          }
          __pyx_L21:;
        }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0692</span>:         return results</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(692,0,<span class='error_goto'>__PYX_ERR(0, 692, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_results);
  __pyx_r = __pyx_v_results;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0693</span>:     return process_batch</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(693,0,<span class='error_goto'>__PYX_ERR(0, 693, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_process_batch);
  __pyx_r = __pyx_v_process_batch;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0694</span>: </pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0695</span>: def is_valid_if(</pre>
<pre class='cython code score-69 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_33is_valid_if(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_32is_valid_if, "\n    A decorator to verify the datatype of positional and keyword parameters \n    of a function.\n    \n    Allows specifying expected types for both positional and keyword arguments.\n    A custom error message and a condition to skip checks can also be provided.\n\n    Parameters\n    ----------\n    *expected_types : Tuple[type]\n        The expected types of the positional parameters.\n    kwarg_types : Optional[Dict[str, type]], optional\n        A dictionary mapping keyword argument names to their expected types.\n    custom_error : Optional[str], optional\n        A custom error message to raise in case of a type mismatch. Should\n        contain placeholders for positional formatting: {arg_index}, {func_name},\n        {expected_type}, and {got_type}.\n    skip_check : Optional[Callable[[Any, Any], bool]], optional\n        A function that takes the argument list and keyword argument dictionary,\n        and returns True if type checks should be skipped.\n\n    Returns\n    -------\n    Callable\n        The decorated function with type verification.\n\n    Raises\n    ------\n    TypeError\n        If the types of the actual parameters do not match the expected types\n        and skip_check is False or not provided.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import is_valid_if\n    &gt;&gt;&gt; @is_valid_if(int, float, kwarg_types={'c': str})\n    ... def add(a, b, c=\"default\"):\n    ...     return a + b\n    &gt;&gt;&gt; add(1, 2.5, c=\"text\")\n    3.5\n    &gt;&gt;&gt; add(1, \"2.5\", c=100)  # This will raise a TypeError\n    TypeError: Argument 2 of 'add' requires &lt;class 'float'&gt; but got &lt;class 'str'&gt;.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_33is_valid_if = {"is_valid_if", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_33is_valid_if, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_32is_valid_if};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_33is_valid_if(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_kwarg_types = 0;
  PyObject *__pyx_v_custom_error = 0;
  PyObject *__pyx_v_skip_check = 0;
  PyObject *__pyx_v_expected_types = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_valid_if (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_expected_types = __pyx_args;
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_kwarg_types,&amp;__pyx_n_s_custom_error,&amp;__pyx_n_s_skip_check,0};
  PyObject* values[3] = {0,0,0};
/*  */
  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_expected_types);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_VARARGS</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_32is_valid_if(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_kwarg_types, PyObject *__pyx_v_custom_error, PyObject *__pyx_v_skip_check, PyObject *__pyx_v_expected_types) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if *__pyx_cur_scope;
  PyObject *__pyx_v_decorator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__51)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("is_valid_if", __pyx_f[0], 695, 0, <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_kwarg_types = __pyx_v_kwarg_types;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_kwarg_types);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_kwarg_types);
  __pyx_cur_scope-&gt;__pyx_v_custom_error = __pyx_v_custom_error;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_custom_error);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_custom_error);
  __pyx_cur_scope-&gt;__pyx_v_skip_check = __pyx_v_skip_check;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_skip_check);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_skip_check);
  __pyx_cur_scope-&gt;__pyx_v_expected_types = __pyx_v_expected_types;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_expected_types);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_expected_types);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.is_valid_if", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_decorator);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__166 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_kwarg_types, __pyx_n_s_custom_error, __pyx_n_s_skip_check, __pyx_n_s_expected_types, __pyx_n_s_construct_error_msg, __pyx_n_s_construct_error_msg, __pyx_n_s_check_arg_types, __pyx_n_s_check_arg_types, __pyx_n_s_decorator, __pyx_n_s_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__166)) __PYX_ERR(0, 695, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__166);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__166);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(695,0,<span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 695, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(695,0,<span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 695, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_kwarg_types, __pyx_kp_s_Optional_Dict_str_type) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_custom_error, __pyx_kp_s_Optional_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_skip_check, __pyx_kp_s_Optional_Callable_Any_Any_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_expected_types, __pyx_kp_s_Tuple_type) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_33is_valid_if, 0, __pyx_n_s_is_valid_if, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__51));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 695, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_5, __pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_is_valid_if, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__51 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 3, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__166, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_is_valid_if, 695, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__51)) __PYX_ERR(0, 695, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if {
  PyObject_HEAD
  PyObject *__pyx_v__check_arg_types;
  PyObject *__pyx_v__construct_error_msg;
  PyObject *__pyx_v_custom_error;
  PyObject *__pyx_v_expected_types;
  PyObject *__pyx_v_kwarg_types;
  PyObject *__pyx_v_skip_check;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0696</span>:     *expected_types: Tuple[type],</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0697</span>:     kwarg_types: Optional[Dict[str, type]] = None,</pre>
<pre class='cython code score-7 '>    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(((PyObject *)Py_None));
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(697,0,<span class='error_goto'>__PYX_ERR(0, 697, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_kwarg_types, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0698</span>:     custom_error: Optional[str] = None,</pre>
<pre class='cython code score-7 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(((PyObject *)Py_None));
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(698,0,<span class='error_goto'>__PYX_ERR(0, 698, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_custom_error, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0699</span>:     skip_check: Optional[Callable[[Any, Any], bool]] = None</pre>
<pre class='cython code score-27 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        default:
        case  0: break;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_VARARGS</span>(__pyx_kwds);
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 3)) {
        Py_ssize_t index;
        for (index = 0; index &lt; 3 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_VARARGS</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_VARARGS</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, 0, "is_valid_if") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs &lt; 0)) {
      goto __pyx_L5_argtuple_error;
    } else {
    }
    __pyx_v_kwarg_types = values[0];
    __pyx_v_custom_error = values[1];
    __pyx_v_skip_check = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("is_valid_if", 0, 0, 0, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_VARARGS</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_CLEAR</span>(__pyx_v_expected_types);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.is_valid_if", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_32is_valid_if(__pyx_self, __pyx_v_kwarg_types, __pyx_v_custom_error, __pyx_v_skip_check, __pyx_v_expected_types);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(699,0,<span class='error_goto'>__PYX_ERR(0, 699, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_skip_check, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 695, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0700</span>: ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0701</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0702</span>:     A decorator to verify the datatype of positional and keyword parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0703</span>:     of a function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0704</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0705</span>:     Allows specifying expected types for both positional and keyword arguments.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0706</span>:     A custom error message and a condition to skip checks can also be provided.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0707</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0708</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0709</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0710</span>:     *expected_types : Tuple[type]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0711</span>:         The expected types of the positional parameters.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0712</span>:     kwarg_types : Optional[Dict[str, type]], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0713</span>:         A dictionary mapping keyword argument names to their expected types.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0714</span>:     custom_error : Optional[str], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0715</span>:         A custom error message to raise in case of a type mismatch. Should</pre>
<pre class="cython line score-0">&#xA0;<span class="">0716</span>:         contain placeholders for positional formatting: {arg_index}, {func_name},</pre>
<pre class="cython line score-0">&#xA0;<span class="">0717</span>:         {expected_type}, and {got_type}.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0718</span>:     skip_check : Optional[Callable[[Any, Any], bool]], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0719</span>:         A function that takes the argument list and keyword argument dictionary,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0720</span>:         and returns True if type checks should be skipped.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0721</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0722</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>:     Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0725</span>:         The decorated function with type verification.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">0728</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0729</span>:     TypeError</pre>
<pre class="cython line score-0">&#xA0;<span class="">0730</span>:         If the types of the actual parameters do not match the expected types</pre>
<pre class="cython line score-0">&#xA0;<span class="">0731</span>:         and skip_check is False or not provided.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0732</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0733</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0734</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0735</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import is_valid_if</pre>
<pre class="cython line score-0">&#xA0;<span class="">0736</span>:     &gt;&gt;&gt; @is_valid_if(int, float, kwarg_types={'c': str})</pre>
<pre class="cython line score-0">&#xA0;<span class="">0737</span>:     ... def add(a, b, c="default"):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0738</span>:     ...     return a + b</pre>
<pre class="cython line score-0">&#xA0;<span class="">0739</span>:     &gt;&gt;&gt; add(1, 2.5, c="text")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0740</span>:     3.5</pre>
<pre class="cython line score-0">&#xA0;<span class="">0741</span>:     &gt;&gt;&gt; add(1, "2.5", c=100)  # This will raise a TypeError</pre>
<pre class="cython line score-0">&#xA0;<span class="">0742</span>:     TypeError: Argument 2 of 'add' requires &lt;class 'float'&gt; but got &lt;class 'str'&gt;.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0743</span>:     """</pre>
<pre class="cython line score-95" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0744</span>:     def _construct_error_msg(arg_name, func_name, expected_type, got_type):</pre>
<pre class='cython code score-95 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_1_construct_error_msg(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_11is_valid_if__construct_error_msg, "Constructs a custom or default error message based on provided parameters.");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_11is_valid_if_1_construct_error_msg = {"_construct_error_msg", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_1_construct_error_msg, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_11is_valid_if__construct_error_msg};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_1_construct_error_msg(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_arg_name = 0;
  PyObject *__pyx_v_func_name = 0;
  PyObject *__pyx_v_expected_type = 0;
  PyObject *__pyx_v_got_type = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_construct_error_msg (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_arg_name,&amp;__pyx_n_s_func_name,&amp;__pyx_n_s_expected_type,&amp;__pyx_n_s_got_type,0};
  PyObject* values[4] = {0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_arg_name)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func_name)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_construct_error_msg", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_expected_type)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_construct_error_msg", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_got_type)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_construct_error_msg", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_construct_error_msg") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
      values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
    }
    __pyx_v_arg_name = values[0];
    __pyx_v_func_name = values[1];
    __pyx_v_expected_type = values[2];
    __pyx_v_got_type = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_construct_error_msg", 1, 4, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.is_valid_if._construct_error_msg", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_11is_valid_if__construct_error_msg(__pyx_self, __pyx_v_arg_name, __pyx_v_func_name, __pyx_v_expected_type, __pyx_v_got_type);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_11is_valid_if__construct_error_msg(PyObject *__pyx_self, PyObject *__pyx_v_arg_name, PyObject *__pyx_v_func_name, PyObject *__pyx_v_expected_type, PyObject *__pyx_v_got_type) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("_construct_error_msg", __pyx_f[0], 744, 0, <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.is_valid_if._construct_error_msg", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__52 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_arg_name, __pyx_n_s_func_name, __pyx_n_s_expected_type, __pyx_n_s_got_type);<span class='error_goto'> if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__52);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__52);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(744,0,<span class='error_goto'>__PYX_ERR(0, 744, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_11is_valid_if_1_construct_error_msg, 0, __pyx_n_s_is_valid_if_locals__construct_er, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__53));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v__construct_error_msg = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__53 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__52, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_construct_error_msg, 744, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__53)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0745</span>:         """Constructs a custom or default error message based on provided parameters."""</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0746</span>:         if custom_error:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(746,0,<span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_custom_error)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("custom_error"); <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_custom_error); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 746, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0747</span>:             return custom_error.format(arg_name=arg_name, func_name=func_name,</pre>
<pre class='cython code score-21 '>    <span class='trace'>__Pyx_TraceLine</span>(747,0,<span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_custom_error)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("custom_error"); <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span> }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_custom_error, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_arg_name, __pyx_v_arg_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_func_name, __pyx_v_func_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(747,0,<span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 747, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0748</span>:                                        expected_type=expected_type, got_type=got_type)</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(748,0,<span class='error_goto'>__PYX_ERR(0, 748, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_expected_type, __pyx_v_expected_type) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_got_type, __pyx_v_got_type) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 747, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0749</span>:         else:</pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0750</span>:             return (f"Argument '{arg_name}' of '{func_name}' requires {expected_type} "</pre>
<pre class='cython code score-44 '>  <span class='trace'>__Pyx_TraceLine</span>(750,0,<span class='error_goto'>__PYX_ERR(0, 750, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 0;
    __pyx_t_6 = 127;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Argument_2);
    __pyx_t_5 += 10;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Argument_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_kp_u_Argument_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_arg_name, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_6;
    __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_of);
    __pyx_t_5 += 6;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_of);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_kp_u_of);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_func_name, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_6;
    __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_requires);
    __pyx_t_5 += 11;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_requires);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 4, __pyx_kp_u_requires);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_expected_type, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_6;
    __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 5, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_but_got);
    __pyx_t_5 += 9;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_but_got);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 6, __pyx_kp_u_but_got);
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(750,0,<span class='error_goto'>__PYX_ERR(0, 750, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_4, 9, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0751</span>:                     f"but got {got_type}.")</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(751,0,<span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_got_type, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 751, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_6;
    __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 7, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__49);
    __pyx_t_5 += 1;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__49);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 8, __pyx_kp_u__49);
</pre><pre class="cython line score-0">&#xA0;<span class="">0752</span>: </pre>
<pre class="cython line score-89" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0753</span>:     def _check_arg_types(args, kwargs, func_name):</pre>
<pre class='cython code score-89 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_3_check_arg_types(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_11is_valid_if_2_check_arg_types, "Checks types of positional and keyword arguments.");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_11is_valid_if_3_check_arg_types = {"_check_arg_types", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_3_check_arg_types, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_11is_valid_if_2_check_arg_types};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_3_check_arg_types(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_v_func_name = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_check_arg_types (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_func_name,0};
  PyObject* values[3] = {0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_args)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 753, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_kwargs)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 753, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_check_arg_types", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 753, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func_name)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 753, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_check_arg_types", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 753, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_check_arg_types") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 753, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
    }
    __pyx_v_args = values[0];
    __pyx_v_kwargs = values[1];
    __pyx_v_func_name = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_check_arg_types", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 753, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.is_valid_if._check_arg_types", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_11is_valid_if_2_check_arg_types(__pyx_self, __pyx_v_args, __pyx_v_kwargs, __pyx_v_func_name);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_11is_valid_if_2_check_arg_types(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, PyObject *__pyx_v_func_name) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if *__pyx_outer_scope;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_arg = NULL;
  PyObject *__pyx_v_expected_type = NULL;
  PyObject *__pyx_v_error_msg = NULL;
  PyObject *__pyx_v_kwarg = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("_check_arg_types", __pyx_f[0], 753, 0, <span class='error_goto'>__PYX_ERR(0, 753, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.is_valid_if._check_arg_types", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_expected_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_error_msg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kwarg);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__54 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_func_name, __pyx_n_s_i, __pyx_n_s_arg, __pyx_n_s_expected_type, __pyx_n_s_error_msg, __pyx_n_s_kwarg);<span class='error_goto'> if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 753, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__54);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__54);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(753,0,<span class='error_goto'>__PYX_ERR(0, 753, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_11is_valid_if_3_check_arg_types, 0, __pyx_n_s_is_valid_if_locals__check_arg_ty, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__55));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 753, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v__check_arg_types = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__55 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__54, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_check_arg_types, 753, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__55)) __PYX_ERR(0, 753, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0754</span>:         """Checks types of positional and keyword arguments."""</pre>
<pre class="cython line score-120" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0755</span>:         for i, (arg, expected_type) in enumerate(zip(args, expected_types), 1):</pre>
<pre class='cython code score-120 '>  <span class='trace'>__Pyx_TraceLine</span>(755,0,<span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  __pyx_t_1 = __pyx_int_1;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_expected_types)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("expected_types"); <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_args);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_args);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_args)) <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_expected_types);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_expected_types);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_cur_scope-&gt;__pyx_v_expected_types)) <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_2 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_4 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_4 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_5(__pyx_t_2);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
      PyObject* sequence = __pyx_t_3;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_8);
      index = 0; __pyx_t_6 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_6)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      index = 1; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_8), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_arg, __pyx_t_6);
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_expected_type, __pyx_t_7);
    __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
    __pyx_t_1 = __pyx_t_3;
    __pyx_t_3 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(755,0,<span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0756</span>:             if not isinstance(arg, expected_type):</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(756,0,<span class='error_goto'>__PYX_ERR(0, 756, __pyx_L1_error)</span>)
    __pyx_t_10 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_arg, __pyx_v_expected_type);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 756, __pyx_L1_error)</span>
    __pyx_t_11 = (!__pyx_t_10);
    if (unlikely(__pyx_t_11)) {
/*  */
    }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0757</span>:                 error_msg = _construct_error_msg(arg_name=i, func_name=func_name,</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(757,0,<span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>)
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v__construct_error_msg)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("_construct_error_msg"); <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span> }
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_arg_name, __pyx_v_i) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_func_name, __pyx_v_func_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(757,0,<span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v__construct_error_msg, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_error_msg = __pyx_t_7;
      __pyx_t_7 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0758</span>:                                                  expected_type=expected_type,</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(758,0,<span class='error_goto'>__PYX_ERR(0, 758, __pyx_L1_error)</span>)
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_expected_type, __pyx_v_expected_type) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0759</span>:                                                  got_type=type(arg))</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(759,0,<span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>)
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_got_type, ((PyObject *)Py_TYPE(__pyx_v_arg))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0760</span>:                 raise TypeError(error_msg)</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(760,0,<span class='error_goto'>__PYX_ERR(0, 760, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_v_error_msg);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='error_goto'>__PYX_ERR(0, 760, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0761</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0762</span>:         if kwarg_types:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(762,0,<span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_kwarg_types)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("kwarg_types"); <span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span> }
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_kwarg_types); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>
  if (__pyx_t_11) {
/*  */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0763</span>:             for kwarg, expected_type in kwarg_types.items():</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(763,0,<span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>)
    __pyx_t_4 = 0;
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_kwarg_types)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("kwarg_types"); <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span> }
    if (unlikely(__pyx_cur_scope-&gt;__pyx_v_kwarg_types == Py_None)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "items");
      <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
    }
    __pyx_t_2 = __Pyx_dict_iterator(__pyx_cur_scope-&gt;__pyx_v_kwarg_types, 0, __pyx_n_s_items, (&amp;__pyx_t_12), (&amp;__pyx_t_13));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
    __pyx_t_1 = __pyx_t_2;
    __pyx_t_2 = 0;
    while (1) {
      __pyx_t_14 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_12, &amp;__pyx_t_4, &amp;__pyx_t_2, &amp;__pyx_t_7, NULL, __pyx_t_13);
      if (unlikely(__pyx_t_14 == 0)) break;
      if (unlikely(__pyx_t_14 == -1)) <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_kwarg, __pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_expected_type, __pyx_t_7);
      __pyx_t_7 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0764</span>:                 if kwarg in kwargs and not isinstance(kwargs[kwarg], expected_type):</pre>
<pre class='cython code score-11 '>      <span class='trace'>__Pyx_TraceLine</span>(764,0,<span class='error_goto'>__PYX_ERR(0, 764, __pyx_L1_error)</span>)
      __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_kwarg, __pyx_v_kwargs, Py_EQ)); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L1_error)</span>
      if (__pyx_t_10) {
      } else {
        __pyx_t_11 = __pyx_t_10;
        goto __pyx_L13_bool_binop_done;
      }
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_kwargs, __pyx_v_kwarg);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 764, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_10 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_t_7, __pyx_v_expected_type);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 764, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_15 = (!__pyx_t_10);
      __pyx_t_11 = __pyx_t_15;
      __pyx_L13_bool_binop_done:;
      if (unlikely(__pyx_t_11)) {
/*  */
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0765</span>:                     error_msg = _construct_error_msg(arg_name=kwarg, func_name=func_name,</pre>
<pre class='cython code score-17 '>        <span class='trace'>__Pyx_TraceLine</span>(765,0,<span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span>)
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_v__construct_error_msg)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("_construct_error_msg"); <span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span> }
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_arg_name, __pyx_v_kwarg) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span>
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_func_name, __pyx_v_func_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span>
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(765,0,<span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span>)
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v__construct_error_msg, __pyx_empty_tuple, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_v_error_msg = __pyx_t_2;
        __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0766</span>:                                                      expected_type=expected_type,</pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(766,0,<span class='error_goto'>__PYX_ERR(0, 766, __pyx_L1_error)</span>)
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_expected_type, __pyx_v_expected_type) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span>
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0767</span>:                                                      got_type=type(kwargs[kwarg]))</pre>
<pre class='cython code score-8 '>        <span class='trace'>__Pyx_TraceLine</span>(767,0,<span class='error_goto'>__PYX_ERR(0, 767, __pyx_L1_error)</span>)
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_kwargs, __pyx_v_kwarg);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 767, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_got_type, ((PyObject *)Py_TYPE(__pyx_t_2))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0768</span>:                     raise TypeError(error_msg)</pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(768,0,<span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>)
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_v_error_msg);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0769</span>: </pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0770</span>:     def decorator(func: Callable) -&gt; Callable:</pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_5decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_11is_valid_if_5decorator = {"decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_5decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_5decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decorator", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.is_valid_if.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_11is_valid_if_4decorator(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_11is_valid_if_4decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_14_decorator *__pyx_cur_scope;
  PyObject *__pyx_v_wrapper = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_14_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_14_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_14_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_14_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("decorator", __pyx_f[0], 770, 0, <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.is_valid_if.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_wrapper);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(770,0,<span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_11is_valid_if_5decorator, 0, __pyx_n_s_is_valid_if_locals_decorator, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__56));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_decorator = __pyx_t_2;
  __pyx_t_2 = 0;
/*  */
  __pyx_codeobj__56 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_decorator, 770, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__56)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_14_decorator {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_13_is_valid_if *__pyx_outer_scope;
  PyObject *__pyx_v_func;
};

</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0771</span>:         @functools.wraps(func)</pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_11is_valid_if_9decorator_1wrapper = {"wrapper", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_9decorator_1wrapper, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11is_valid_if_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("wrapper (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "wrapper", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_11is_valid_if_9decorator_wrapper(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_11is_valid_if_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_14_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_14_decorator *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_14_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("wrapper", __pyx_f[0], 771, 0, <span class='error_goto'>__PYX_ERR(0, 771, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.is_valid_if.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(771,0,<span class='error_goto'>__PYX_ERR(0, 771, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 771, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_11is_valid_if_9decorator_1wrapper, 0, __pyx_n_s_is_valid_if_locals_decorator_loc, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__50));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 771, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_wrapper = __pyx_t_1;
  __pyx_t_1 = 0;
/*  */
  __pyx_codeobj__50 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple_, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_wrapper, 771, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__50)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0772</span>:         def wrapper(*args, **kwargs):</pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0773</span>:             if skip_check and skip_check(args, kwargs):</pre>
<pre class='cython code score-24 '>  <span class='trace'>__Pyx_TraceLine</span>(773,0,<span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_skip_check)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("skip_check"); <span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_skip_check); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span>
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_skip_check)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("skip_check"); <span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_skip_check);
  __pyx_t_4 = __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_skip_check; __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_v_args, __pyx_v_kwargs};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0774</span>:                 return func(*args, **kwargs)</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(774,0,<span class='error_goto'>__PYX_ERR(0, 774, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 774, __pyx_L1_error)</span> }
    __pyx_t_3 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0775</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0776</span>:             _check_arg_types(args, kwargs, func.__name__)</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(776,0,<span class='error_goto'>__PYX_ERR(0, 776, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 776, __pyx_L1_error)</span> }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v__check_arg_types)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("_check_arg_types"); <span class='error_goto'>__PYX_ERR(0, 776, __pyx_L1_error)</span> }
  __pyx_t_3 = __pyx_pf_6gofast_5tools_9funcutils_11is_valid_if_2_check_arg_types(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v__check_arg_types, __pyx_v_args, __pyx_v_kwargs, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0777</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0778</span>:             return func(*args, **kwargs)</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(778,0,<span class='error_goto'>__PYX_ERR(0, 778, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 778, __pyx_L1_error)</span> }
  __pyx_t_3 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0779</span>:         return wrapper</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(779,0,<span class='error_goto'>__PYX_ERR(0, 779, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wrapper);
  __pyx_r = __pyx_v_wrapper;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0780</span>:     return decorator</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(780,0,<span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorator);
  __pyx_r = __pyx_v_decorator;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0781</span>: </pre>
<pre class="cython line score-89" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0782</span>: def install_package(</pre>
<pre class='cython code score-89 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_35install_package(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_34install_package, "\n    Install a Python package using either conda or pip, with an option to \n    display installation progress and fallback mechanism.\n\n    This function dynamically chooses between conda and pip for installing \n    Python packages, based on user preference and system configuration. It \n    supports a verbose mode for detailed operation logging and utilizes a \n    progress bar for pip installations.\n\n    Parameters\n    ----------\n    name : str\n        Name of the package to install. Version specification can be included.\n    dist_name : str, optional\n        The distribution name of the package. Useful for packages where\n        the import name differs from the distribution name.\n    infer_dist_name : bool, optional\n        If True, attempt to infer the distribution name for pip installation,\n        defaults to False.\n    extra : str, optional\n        Additional options or version specifier for the package, by default ''.\n    use_conda : bool, optional\n        Prefer conda over pip for installation, by default False.\n    verbose : bool, optional\n        Enable detailed output during the installation process, by default True.\n\n    Raises\n    ------\n    RuntimeError\n        If installation fails via both conda and pip, or if the specified installer\n        is not available.\n\n    Examples\n    --------\n    Install a package using pip without version specification:\n\n        &gt;&gt;&gt; install_package('requests', verbose=True)\n\n    Install a specific version of a package using conda:\n\n        &gt;&gt;&gt; install_package('pandas', extra='==1.2.0', use_conda=True, verbose=True)\n    \n    Notes\n    -----\n    Conda installations do not display a progress bar due to limitations in capturing\n    conda command line output. Pip installations will show a progress bar indicating\n    the number of processed output lines from the installation command.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_35install_package = {"install_package", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_35install_package, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_34install_package};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_35install_package(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_dist_name = 0;
  PyObject *__pyx_v_infer_dist_name = 0;
  PyObject *__pyx_v_extra = 0;
  PyObject *__pyx_v_use_conda = 0;
  PyObject *__pyx_v_verbose = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("install_package (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_dist_name,&amp;__pyx_n_s_infer_dist_name,&amp;__pyx_n_s_extra,&amp;__pyx_n_s_use_conda,&amp;__pyx_n_s_verbose,0};
  PyObject* values[6] = {0,0,0,0,0,0};
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_34install_package(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_name, PyObject *__pyx_v_dist_name, PyObject *__pyx_v_infer_dist_name, PyObject *__pyx_v_extra, PyObject *__pyx_v_use_conda, PyObject *__pyx_v_verbose) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_15_install_package *__pyx_cur_scope;
  PyObject *__pyx_v_execute_command = 0;
  PyObject *__pyx_v_conda_available = NULL;
  PyObject *__pyx_v_e = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__59)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_15_install_package *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_15_install_package(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_15_install_package, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_15_install_package *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("install_package", __pyx_f[0], 782, 0, <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_name = __pyx_v_name;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_name);
  __pyx_cur_scope-&gt;__pyx_v_extra = __pyx_v_extra;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
  __pyx_cur_scope-&gt;__pyx_v_verbose = __pyx_v_verbose;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_verbose);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_verbose);
/*  */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.install_package", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_execute_command);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_conda_available);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_e);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__167 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_name, __pyx_n_s_dist_name, __pyx_n_s_infer_dist_name, __pyx_n_s_extra, __pyx_n_s_use_conda, __pyx_n_s_verbose, __pyx_n_s_execute_command, __pyx_n_s_execute_command, __pyx_n_s_conda_available, __pyx_n_s_e);<span class='error_goto'> if (unlikely(!__pyx_tuple__167)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__167);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__167);
  __pyx_codeobj__59 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__167, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_install_package, 782, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__59)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(782,0,<span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_name, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dist_name, __pyx_kp_s_Optional_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_infer_dist_name, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_extra, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_use_conda, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_verbose, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_35install_package, 0, __pyx_n_s_install_package, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__59));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__168);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_install_package, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__168 = <span class='py_c_api'>PyTuple_Pack</span>(5, Py_None, ((PyObject *)Py_False), ((PyObject*)__pyx_kp_u__57), ((PyObject *)Py_False), ((PyObject *)Py_True));<span class='error_goto'> if (unlikely(!__pyx_tuple__168)) __PYX_ERR(0, 782, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__168);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__168);
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_15_install_package {
  PyObject_HEAD
  PyObject *__pyx_v_extra;
  PyObject *__pyx_v_name;
  PyObject *__pyx_v_verbose;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0783</span>:     name: str,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0784</span>:     dist_name: Optional[str]=None,</pre>
<pre class='cython code score-2 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0785</span>:     infer_dist_name: bool=False,</pre>
<pre class='cython code score-4 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_kp_u__57)));
</pre><pre class="cython line score-0">&#xA0;<span class="">0786</span>:     extra: str = '',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0787</span>:     use_conda: bool = False,</pre>
<pre class='cython code score-2 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-94" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0788</span>:     verbose: bool = True</pre>
<pre class='cython code score-94 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_name)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dist_name);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_infer_dist_name);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_extra);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_use_conda);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_verbose);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "install_package") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_dist_name = values[1];
    __pyx_v_infer_dist_name = values[2];
    __pyx_v_extra = ((PyObject*)values[3]);
    __pyx_v_use_conda = values[4];
    __pyx_v_verbose = values[5];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("install_package", 0, 1, 6, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 782, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.install_package", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyUnicode_Type), 0, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 783, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_extra), (&amp;PyUnicode_Type), 0, "extra", 1))) <span class='error_goto'>__PYX_ERR(0, 786, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_34install_package(__pyx_self, __pyx_v_name, __pyx_v_dist_name, __pyx_v_infer_dist_name, __pyx_v_extra, __pyx_v_use_conda, __pyx_v_verbose);
</pre><pre class="cython line score-0">&#xA0;<span class="">0789</span>:     ) -&gt; None:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0790</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0791</span>:     Install a Python package using either conda or pip, with an option to</pre>
<pre class="cython line score-0">&#xA0;<span class="">0792</span>:     display installation progress and fallback mechanism.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0793</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0794</span>:     This function dynamically chooses between conda and pip for installing</pre>
<pre class="cython line score-0">&#xA0;<span class="">0795</span>:     Python packages, based on user preference and system configuration. It</pre>
<pre class="cython line score-0">&#xA0;<span class="">0796</span>:     supports a verbose mode for detailed operation logging and utilizes a</pre>
<pre class="cython line score-0">&#xA0;<span class="">0797</span>:     progress bar for pip installations.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0798</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0799</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0800</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0801</span>:     name : str</pre>
<pre class="cython line score-0">&#xA0;<span class="">0802</span>:         Name of the package to install. Version specification can be included.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0803</span>:     dist_name : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0804</span>:         The distribution name of the package. Useful for packages where</pre>
<pre class="cython line score-0">&#xA0;<span class="">0805</span>:         the import name differs from the distribution name.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0806</span>:     infer_dist_name : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0807</span>:         If True, attempt to infer the distribution name for pip installation,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0808</span>:         defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0809</span>:     extra : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0810</span>:         Additional options or version specifier for the package, by default ''.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0811</span>:     use_conda : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0812</span>:         Prefer conda over pip for installation, by default False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0813</span>:     verbose : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0814</span>:         Enable detailed output during the installation process, by default True.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0815</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">0817</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0818</span>:     RuntimeError</pre>
<pre class="cython line score-0">&#xA0;<span class="">0819</span>:         If installation fails via both conda and pip, or if the specified installer</pre>
<pre class="cython line score-0">&#xA0;<span class="">0820</span>:         is not available.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0822</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0823</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0824</span>:     Install a package using pip without version specification:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0825</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0826</span>:         &gt;&gt;&gt; install_package('requests', verbose=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0827</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0828</span>:     Install a specific version of a package using conda:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0829</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0830</span>:         &gt;&gt;&gt; install_package('pandas', extra='==1.2.0', use_conda=True, verbose=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0831</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0832</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">0833</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">0834</span>:     Conda installations do not display a progress bar due to limitations in capturing</pre>
<pre class="cython line score-0">&#xA0;<span class="">0835</span>:     conda command line output. Pip installations will show a progress bar indicating</pre>
<pre class="cython line score-0">&#xA0;<span class="">0836</span>:     the number of processed output lines from the installation command.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0837</span>:     """</pre>
<pre class="cython line score-101" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0838</span>:     def execute_command(command: list, progress_bar: bool = False) -&gt; None:</pre>
<pre class='cython code score-101 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15install_package_1execute_command(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_15install_package_execute_command, "\n        Execute a system command with optional progress bar for output lines.\n\n        Parameters\n        ----------\n        command : list\n            Command and arguments to execute as a list.\n        progress_bar : bool, optional\n            Enable a progress bar that tracks the command's output lines, \n            by default False.\n        ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_15install_package_1execute_command = {"execute_command", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_15install_package_1execute_command, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_15install_package_execute_command};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15install_package_1execute_command(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_command = 0;
  PyObject *__pyx_v_progress_bar = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("execute_command (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_command,&amp;__pyx_n_s_progress_bar,0};
  PyObject* values[2] = {0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_command)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 838, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_progress_bar);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 838, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "execute_command") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 838, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_command = ((PyObject*)values[0]);
    __pyx_v_progress_bar = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("execute_command", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 838, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.install_package.execute_command", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_command), (&amp;PyList_Type), 0, "command", 1))) <span class='error_goto'>__PYX_ERR(0, 838, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_15install_package_execute_command(__pyx_self, __pyx_v_command, __pyx_v_progress_bar);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_15install_package_execute_command(PyObject *__pyx_self, PyObject *__pyx_v_command, PyObject *__pyx_v_progress_bar) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_15_install_package *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_15_install_package *__pyx_outer_scope;
  PyObject *__pyx_v_tqdm = NULL;
  PyObject *__pyx_v_process = NULL;
  PyObject *__pyx_v_pbar = NULL;
  PyObject *__pyx_v_line = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_15_install_package *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("execute_command", __pyx_f[0], 838, 0, <span class='error_goto'>__PYX_ERR(0, 838, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.install_package.execute_command", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tqdm);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_process);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pbar);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__60 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_command, __pyx_n_s_progress_bar, __pyx_n_s_tqdm, __pyx_n_s_process, __pyx_n_s_pbar, __pyx_n_s_line);<span class='error_goto'> if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 838, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__60);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__60);
  __pyx_codeobj__61 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__60, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_execute_command, 838, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__61)) __PYX_ERR(0, 838, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(838,0,<span class='error_goto'>__PYX_ERR(0, 838, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_command, __pyx_n_s_list) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 838, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_progress_bar, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 838, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_n_s_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 838, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_15install_package_1execute_command, 0, __pyx_n_s_install_package_locals_execute_c, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__61));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 838, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__62);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_execute_command = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_tuple__62 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__62)) __PYX_ERR(0, 838, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__62);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__62);
</pre><pre class="cython line score-0">&#xA0;<span class="">0839</span>:         """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0840</span>:         Execute a system command with optional progress bar for output lines.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0841</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0842</span>:         Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0843</span>:         ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0844</span>:         command : list</pre>
<pre class="cython line score-0">&#xA0;<span class="">0845</span>:             Command and arguments to execute as a list.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0846</span>:         progress_bar : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0847</span>:             Enable a progress bar that tracks the command's output lines,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0848</span>:             by default False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0849</span>:         """</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0850</span>:         from tqdm import tqdm</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(850,0,<span class='error_goto'>__PYX_ERR(0, 850, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_tqdm);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_tqdm);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_tqdm)) <span class='error_goto'>__PYX_ERR(0, 850, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_tqdm, __pyx_t_1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_tqdm);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_tqdm = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-99" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0851</span>:         with subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.STDOUT,</pre>
<pre class='cython code score-99 '>  <span class='trace'>__Pyx_TraceLine</span>(851,0,<span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>)
  /*with:*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_subprocess);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_Popen);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_command);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_command);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_command)) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_subprocess);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_PIPE);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_stdout, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_subprocess);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_STDOUT);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_stderr, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(851,0,<span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_4, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_4, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 851, __pyx_L3_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = __pyx_t_3;
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    /*try:*/ {
      {
        /*try:*/ {
          __pyx_v_process = __pyx_t_2;
          __pyx_t_2 = 0;
/*  */
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        goto __pyx_L12_try_end;
        __pyx_L7_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.install_package.execute_command", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_2, &amp;__pyx_t_1, &amp;__pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
          __pyx_t_3 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_2, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 851, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_3, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          if (__pyx_t_20 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L9_except_error)</span>
          __pyx_t_11 = (!__pyx_t_20);
          if (unlikely(__pyx_t_11)) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
            <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_2, __pyx_t_1, __pyx_t_4);
            __pyx_t_2 = 0; __pyx_t_1 = 0; __pyx_t_4 = 0; 
            <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L9_except_error)</span>
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          goto __pyx_L8_exception_handled;
        }
        __pyx_L9_except_error:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
        goto __pyx_L1_error;
        __pyx_L8_exception_handled:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
        __pyx_L12_try_end:;
      }
    }
    /*finally:*/ {
      /*normal exit:*/{
        if (__pyx_t_6) {
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__18, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        }
        goto __pyx_L6;
      }
      __pyx_L6:;
    }
    goto __pyx_L35;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L1_error;
    __pyx_L35:;
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0852</span>:                               text=True, bufsize=1) as process, \</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(852,0,<span class='error_goto'>__PYX_ERR(0, 852, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_text, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_bufsize, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 851, __pyx_L1_error)</span>
</pre><pre class="cython line score-82" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0853</span>:              tqdm(desc="Installing", unit="line", disable=not progress_bar) as pbar:</pre>
<pre class='cython code score-82 '>          <span class='trace'>__Pyx_TraceLine</span>(853,0,<span class='error_goto'>__PYX_ERR(0, 853, __pyx_L7_error)</span>)
          /*with:*/ {
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 853, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_desc, __pyx_n_u_Installing) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L7_error)</span>
            if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_unit, __pyx_n_u_line) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L7_error)</span>
            __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_progress_bar); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L7_error)</span>
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((!__pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 853, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_disable, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L7_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_tqdm, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 853, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_4, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 853, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_4, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L13_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            __pyx_t_1 = NULL;
            __pyx_t_7 = 0;
            #if CYTHON_UNPACK_METHODS
            if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
              __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
              if (likely(__pyx_t_1)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
                __pyx_t_7 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
              __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L13_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            }
            __pyx_t_3 = __pyx_t_2;
            __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            /*try:*/ {
              {
                /*try:*/ {
                  __pyx_v_pbar = __pyx_t_3;
                  __pyx_t_3 = 0;
/*  */
                }
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                goto __pyx_L22_try_end;
                __pyx_L17_error:;
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
                <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
                /*except:*/ {
                  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.install_package.execute_command", __pyx_clineno, __pyx_lineno, __pyx_filename);
                  if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_4, &amp;__pyx_t_1, &amp;__pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L19_except_error)</span>
                  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
                  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);
                  <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);
                  __pyx_t_3 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_4, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 853, __pyx_L19_except_error)</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                  __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_t_3, NULL);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  if (unlikely(!__pyx_t_19)) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L19_except_error)</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
                  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_19);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
                  if (__pyx_t_11 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L19_except_error)</span>
                  __pyx_t_20 = (!__pyx_t_11);
                  if (unlikely(__pyx_t_20)) {
                    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
                    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
                    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
                    <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_4, __pyx_t_1, __pyx_t_2);
                    __pyx_t_4 = 0; __pyx_t_1 = 0; __pyx_t_2 = 0; 
                    <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L19_except_error)</span>
                  }
                  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
                  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                  goto __pyx_L18_exception_handled;
                }
                __pyx_L19_except_error:;
                <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);
                <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);
                <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_15);
                <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_13, __pyx_t_14, __pyx_t_15);
                goto __pyx_L7_error;
                __pyx_L18_exception_handled:;
                <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);
                <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);
                <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_15);
                <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_13, __pyx_t_14, __pyx_t_15);
                __pyx_L22_try_end:;
              }
            }
            /*finally:*/ {
              /*normal exit:*/{
                if (__pyx_t_12) {
                  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_12, __pyx_tuple__18, NULL);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
                  if (unlikely(!__pyx_t_15)) <span class='error_goto'>__PYX_ERR(0, 853, __pyx_L7_error)</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
                }
                goto __pyx_L16;
              }
              __pyx_L16:;
            }
            goto __pyx_L31;
            __pyx_L13_error:;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
            goto __pyx_L7_error;
            __pyx_L31:;
          }
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0854</span>:             for line in process.stdout:</pre>
<pre class='cython code score-52 '>                  <span class='trace'>__Pyx_TraceLine</span>(854,0,<span class='error_goto'>__PYX_ERR(0, 854, __pyx_L17_error)</span>)
                  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_process, __pyx_n_s_stdout);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 854, __pyx_L17_error)</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
                    __pyx_t_4 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
                    __pyx_t_16 = 0;
                    __pyx_t_17 = NULL;
                  } else {
                    __pyx_t_16 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 854, __pyx_L17_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
                    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 854, __pyx_L17_error)</span>
                  }
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                  for (;;) {
                    if (likely(!__pyx_t_17)) {
                      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
                        {
                          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_4);
                          #if !CYTHON_ASSUME_SAFE_MACROS
                          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 854, __pyx_L17_error)</span>
                          #endif
                          if (__pyx_t_16 &gt;= __pyx_temp) break;
                        }
                        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
                        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_16++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 854, __pyx_L17_error)</span>
                        #else
                        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_4, __pyx_t_16); __pyx_t_16++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 854, __pyx_L17_error)</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        #endif
                      } else {
                        {
                          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_4);
                          #if !CYTHON_ASSUME_SAFE_MACROS
                          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 854, __pyx_L17_error)</span>
                          #endif
                          if (__pyx_t_16 &gt;= __pyx_temp) break;
                        }
                        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
                        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_16); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_16++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 854, __pyx_L17_error)</span>
                        #else
                        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_4, __pyx_t_16); __pyx_t_16++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 854, __pyx_L17_error)</span>
                        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                        #endif
                      }
                    } else {
                      __pyx_t_3 = __pyx_t_17(__pyx_t_4);
                      if (unlikely(!__pyx_t_3)) {
                        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
                        if (exc_type) {
                          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                          else <span class='error_goto'>__PYX_ERR(0, 854, __pyx_L17_error)</span>
                        }
                        break;
                      }
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                    }
                    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_line, __pyx_t_3);
                    __pyx_t_3 = 0;
/*  */
                    <span class='trace'>__Pyx_TraceLine</span>(854,0,<span class='error_goto'>__PYX_ERR(0, 854, __pyx_L17_error)</span>)
                  }
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0855</span>:                 if verbose:</pre>
<pre class='cython code score-4 '>                    <span class='trace'>__Pyx_TraceLine</span>(855,0,<span class='error_goto'>__PYX_ERR(0, 855, __pyx_L17_error)</span>)
                    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_verbose)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("verbose"); <span class='error_goto'>__PYX_ERR(0, 855, __pyx_L17_error)</span> }
                    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_verbose); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 855, __pyx_L17_error)</span>
                    if (__pyx_t_11) {
/*  */
                    }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0856</span>:                     print(line, end='')</pre>
<pre class='cython code score-20 '>                      <span class='trace'>__Pyx_TraceLine</span>(856,0,<span class='error_goto'>__PYX_ERR(0, 856, __pyx_L17_error)</span>)
                      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 856, __pyx_L17_error)</span>
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_line);
                      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_line);
                      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_line)) <span class='error_goto'>__PYX_ERR(0, 856, __pyx_L17_error)</span>;
                      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 856, __pyx_L17_error)</span>
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_end, __pyx_kp_u__57) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 856, __pyx_L17_error)</span>
                      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 856, __pyx_L17_error)</span>
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0857</span>:                 pbar.update(1)</pre>
<pre class='cython code score-17 '>                    <span class='trace'>__Pyx_TraceLine</span>(857,0,<span class='error_goto'>__PYX_ERR(0, 857, __pyx_L17_error)</span>)
                    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_pbar, __pyx_n_s_update);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 857, __pyx_L17_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
                    __pyx_t_3 = NULL;
                    __pyx_t_7 = 0;
                    #if CYTHON_UNPACK_METHODS
                    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
                      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
                      if (likely(__pyx_t_3)) {
                        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
                        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
                        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
                        __pyx_t_7 = 1;
                      }
                    }
                    #endif
                    {
                      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_int_1};
                      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
                      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 857, __pyx_L17_error)</span>
                      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                    }
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0858</span>:             if process.wait() != 0:  # Non-zero exit code indicates failure</pre>
<pre class='cython code score-19 '>                  <span class='trace'>__Pyx_TraceLine</span>(858,0,<span class='error_goto'>__PYX_ERR(0, 858, __pyx_L17_error)</span>)
                  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_process, __pyx_n_s_wait);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 858, __pyx_L17_error)</span>
                  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                  __pyx_t_2 = NULL;
                  __pyx_t_7 = 0;
                  #if CYTHON_UNPACK_METHODS
                  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
                    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
                    if (likely(__pyx_t_2)) {
                      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
                      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
                      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
                      __pyx_t_7 = 1;
                    }
                  }
                  #endif
                  {
                    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
                    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
                    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
                    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 858, __pyx_L17_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                  }
                  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolNeObjC</span>(__pyx_t_4, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 858, __pyx_L17_error)</span>
                  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
                  if (unlikely(__pyx_t_11)) {
/*  */
                  }
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0859</span>:                 raise RuntimeError(f"Installation failed for package '{name}{extra}'.")</pre>
<pre class='cython code score-40 '>                    <span class='trace'>__Pyx_TraceLine</span>(859,0,<span class='error_goto'>__PYX_ERR(0, 859, __pyx_L17_error)</span>)
                    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 859, __pyx_L17_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
                    __pyx_t_16 = 0;
                    __pyx_t_18 = 127;
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Installation_failed_for_package);
                    __pyx_t_16 += 33;
                    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Installation_failed_for_package);
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_kp_u_Installation_failed_for_package);
                    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_name)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("name"); <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L17_error)</span> }
                    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 859, __pyx_L17_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                    __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_18) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_18;
                    __pyx_t_16 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
                    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1);
                    __pyx_t_1 = 0;
                    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_extra)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("extra"); <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L17_error)</span> }
                    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_extra);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 859, __pyx_L17_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                    __pyx_t_18 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_18) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_18;
                    __pyx_t_16 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
                    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_1);
                    __pyx_t_1 = 0;
                    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__58);
                    __pyx_t_16 += 2;
                    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__58);
                    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_kp_u__58);
                    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_4, 4, __pyx_t_16, __pyx_t_18);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 859, __pyx_L17_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
                    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_RuntimeError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 859, __pyx_L17_error)</span>
                    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
                    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
                    <span class='error_goto'>__PYX_ERR(0, 859, __pyx_L17_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0860</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0861</span>:     # If the module is installed don't install again.</pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0862</span>:     if is_module_installed(name, distribution_name= dist_name ):</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(862,0,<span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_is_module_installed);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_name);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_cur_scope-&gt;__pyx_v_name)) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_distribution_name, __pyx_v_dist_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 862, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
/*  */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0863</span>:         if verbose:</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(863,0,<span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_verbose); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 863, __pyx_L1_error)</span>
    if (__pyx_t_5) {
/*  */
    }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0864</span>:            print(f"{name} is already installed.")</pre>
<pre class='cython code score-6 '>      <span class='trace'>__Pyx_TraceLine</span>(864,0,<span class='error_goto'>__PYX_ERR(0, 864, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_cur_scope-&gt;__pyx_v_name, __pyx_kp_u_is_already_installed);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 864, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 864, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0865</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0866</span>:         return True</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(866,0,<span class='error_goto'>__PYX_ERR(0, 866, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
    __pyx_r = Py_True;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0867</span>:     # If the distribution to pkg name if the pkg name</pre>
<pre class="cython line score-0">&#xA0;<span class="">0868</span>:     # is different to distribution name .</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0869</span>:     if infer_dist_name:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(869,0,<span class='error_goto'>__PYX_ERR(0, 869, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_infer_dist_name); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 869, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/*  */
  }
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0870</span>:         name = get_installation_name(name, dist_name)</pre>
<pre class='cython code score-24 '>    <span class='trace'>__Pyx_TraceLine</span>(870,0,<span class='error_goto'>__PYX_ERR(0, 870, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_get_installation_name);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 870, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_cur_scope-&gt;__pyx_v_name, __pyx_v_dist_name};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 870, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    if (!(likely(<span class='py_c_api'>PyUnicode_CheckExact</span>(__pyx_t_3))||((__pyx_t_3) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("unicode", __pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 870, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_name);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_name, ((PyObject*)__pyx_t_3));
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0871</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0872</span>:     conda_available = _check_conda_installed()</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(872,0,<span class='error_goto'>__PYX_ERR(0, 872, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_check_conda_installed);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 872, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_v_conda_available = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0873</span>:     try:</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(873,0,<span class='error_goto'>__PYX_ERR(0, 873, __pyx_L1_error)</span>)
  {
    /*try:*/ {
/*  */
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    goto __pyx_L11_try_end;
    __pyx_L6_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/*  */
    __pyx_L8_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
    goto __pyx_L1_error;
    __pyx_L11_try_end:;
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0874</span>:         if use_conda and conda_available:</pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(874,0,<span class='error_goto'>__PYX_ERR(0, 874, __pyx_L6_error)</span>)
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_use_conda); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 874, __pyx_L6_error)</span>
      if (__pyx_t_10) {
      } else {
        __pyx_t_5 = __pyx_t_10;
        goto __pyx_L13_bool_binop_done;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_conda_available); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 874, __pyx_L6_error)</span>
      __pyx_t_5 = __pyx_t_10;
      __pyx_L13_bool_binop_done:;
      if (__pyx_t_5) {
/*  */
        goto __pyx_L12;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0875</span>:             if verbose:</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(875,0,<span class='error_goto'>__PYX_ERR(0, 875, __pyx_L6_error)</span>)
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_verbose); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 875, __pyx_L6_error)</span>
        if (__pyx_t_5) {
/*  */
        }
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0876</span>:                 print(f"Attempting to install '{name}{extra}' using conda...")</pre>
<pre class='cython code score-33 '>          <span class='trace'>__Pyx_TraceLine</span>(876,0,<span class='error_goto'>__PYX_ERR(0, 876, __pyx_L6_error)</span>)
          __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_11 = 0;
          __pyx_t_12 = 127;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Attempting_to_install);
          __pyx_t_11 += 23;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Attempting_to_install);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_kp_u_Attempting_to_install);
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 876, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_12;
          __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4);
          __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
          __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_cur_scope-&gt;__pyx_v_extra) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_cur_scope-&gt;__pyx_v_extra) : __pyx_t_12;
          __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_cur_scope-&gt;__pyx_v_extra);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_using_conda);
          __pyx_t_11 += 16;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_using_conda);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_kp_u_using_conda);
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 4, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 876, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 876, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0877</span>:             execute_command(['conda', 'install', f"{name}{extra}", '-y'],</pre>
<pre class='cython code score-33 '>        <span class='trace'>__Pyx_TraceLine</span>(877,0,<span class='error_goto'>__PYX_ERR(0, 877, __pyx_L6_error)</span>)
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 877, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_extra);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 877, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 877, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_conda);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_conda);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_u_conda)) <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L6_error)</span>;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_install);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_install);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_u_install)) <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L6_error)</span>;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L6_error)</span>;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_y);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_y);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_kp_u_y)) <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L6_error)</span>;
        __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 877, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 877, __pyx_L6_error)</span>;
        __pyx_t_3 = 0;
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(877,0,<span class='error_goto'>__PYX_ERR(0, 877, __pyx_L6_error)</span>)
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_execute_command, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0878</span>:                             progress_bar=False)</pre>
<pre class='cython code score-7 '>        <span class='trace'>__Pyx_TraceLine</span>(878,0,<span class='error_goto'>__PYX_ERR(0, 878, __pyx_L6_error)</span>)
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 878, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_progress_bar, Py_False) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 878, __pyx_L6_error)</span>
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0879</span>:         elif use_conda and not conda_available:</pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(879,0,<span class='error_goto'>__PYX_ERR(0, 879, __pyx_L6_error)</span>)
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_use_conda); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 879, __pyx_L6_error)</span>
      if (__pyx_t_10) {
      } else {
        __pyx_t_5 = __pyx_t_10;
        goto __pyx_L16_bool_binop_done;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_conda_available); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 879, __pyx_L6_error)</span>
      __pyx_t_13 = (!__pyx_t_10);
      __pyx_t_5 = __pyx_t_13;
      __pyx_L16_bool_binop_done:;
      if (__pyx_t_5) {
/*  */
        goto __pyx_L12;
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0880</span>:             if verbose:</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(880,0,<span class='error_goto'>__PYX_ERR(0, 880, __pyx_L6_error)</span>)
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_verbose); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 880, __pyx_L6_error)</span>
        if (__pyx_t_5) {
/*  */
        }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0881</span>:                 print("Conda is not available. Falling back to pip...")</pre>
<pre class='cython code score-8 '>          <span class='trace'>__Pyx_TraceLine</span>(881,0,<span class='error_goto'>__PYX_ERR(0, 881, __pyx_L6_error)</span>)
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_tuple__63, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/*  */
  __pyx_tuple__63 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Conda_is_not_available_Falling_b);<span class='error_goto'> if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 881, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__63);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__63);
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0882</span>:             execute_command([sys.executable, "-m", "pip", "install", f"{name}{extra}"],</pre>
<pre class='cython code score-40 '>        <span class='trace'>__Pyx_TraceLine</span>(882,0,<span class='error_goto'>__PYX_ERR(0, 882, __pyx_L6_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_sys);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 882, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_executable);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 882, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 882, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_1, __pyx_cur_scope-&gt;__pyx_v_extra);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 882, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 882, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 882, __pyx_L6_error)</span>;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_m);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_m);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_kp_u_m)) <span class='error_goto'>__PYX_ERR(0, 882, __pyx_L6_error)</span>;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_pip);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_pip);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_u_pip)) <span class='error_goto'>__PYX_ERR(0, 882, __pyx_L6_error)</span>;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_install);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_install);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_n_u_install)) <span class='error_goto'>__PYX_ERR(0, 882, __pyx_L6_error)</span>;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 4, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 882, __pyx_L6_error)</span>;
        __pyx_t_3 = 0;
        __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 882, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 882, __pyx_L6_error)</span>;
        __pyx_t_1 = 0;
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(882,0,<span class='error_goto'>__PYX_ERR(0, 882, __pyx_L6_error)</span>)
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_execute_command, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 882, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0883</span>:                             progress_bar=True)</pre>
<pre class='cython code score-7 '>        <span class='trace'>__Pyx_TraceLine</span>(883,0,<span class='error_goto'>__PYX_ERR(0, 883, __pyx_L6_error)</span>)
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 883, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_progress_bar, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 883, __pyx_L6_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0884</span>:         else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0885</span>:             if verbose:</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(885,0,<span class='error_goto'>__PYX_ERR(0, 885, __pyx_L6_error)</span>)
      /*else*/ {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_verbose); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 885, __pyx_L6_error)</span>
        if (__pyx_t_5) {
/*  */
        }
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0886</span>:                 print(f"Attempting to install '{name}{extra}' using pip...")</pre>
<pre class='cython code score-33 '>          <span class='trace'>__Pyx_TraceLine</span>(886,0,<span class='error_goto'>__PYX_ERR(0, 886, __pyx_L6_error)</span>)
          __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 886, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_11 = 0;
          __pyx_t_12 = 127;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Attempting_to_install);
          __pyx_t_11 += 23;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Attempting_to_install);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_kp_u_Attempting_to_install);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_12;
          __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
          __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
          __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_cur_scope-&gt;__pyx_v_extra) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_cur_scope-&gt;__pyx_v_extra) : __pyx_t_12;
          __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_cur_scope-&gt;__pyx_v_extra);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_using_pip);
          __pyx_t_11 += 14;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_using_pip);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_kp_u_using_pip);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 4, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 886, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0887</span>:             execute_command([sys.executable, "-m", "pip", "install", f"{name}{extra}"],</pre>
<pre class='cython code score-40 '>        <span class='trace'>__Pyx_TraceLine</span>(887,0,<span class='error_goto'>__PYX_ERR(0, 887, __pyx_L6_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_sys);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 887, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_executable);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 887, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 887, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_extra);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 887, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 887, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 887, __pyx_L6_error)</span>;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_m);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_m);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_kp_u_m)) <span class='error_goto'>__PYX_ERR(0, 887, __pyx_L6_error)</span>;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_pip);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_pip);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_u_pip)) <span class='error_goto'>__PYX_ERR(0, 887, __pyx_L6_error)</span>;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_install);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_install);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_n_u_install)) <span class='error_goto'>__PYX_ERR(0, 887, __pyx_L6_error)</span>;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
        if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 4, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 887, __pyx_L6_error)</span>;
        __pyx_t_1 = 0;
        __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 887, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 887, __pyx_L6_error)</span>;
        __pyx_t_3 = 0;
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(887,0,<span class='error_goto'>__PYX_ERR(0, 887, __pyx_L6_error)</span>)
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_execute_command, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 887, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_L12:;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0888</span>:                             progress_bar=True)</pre>
<pre class='cython code score-7 '>        <span class='trace'>__Pyx_TraceLine</span>(888,0,<span class='error_goto'>__PYX_ERR(0, 888, __pyx_L6_error)</span>)
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 888, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_progress_bar, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 888, __pyx_L6_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0889</span>:         if verbose:</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(889,0,<span class='error_goto'>__PYX_ERR(0, 889, __pyx_L6_error)</span>)
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_verbose); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 889, __pyx_L6_error)</span>
      if (__pyx_t_5) {
/*  */
      }
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0890</span>:             print(f"Package '{name}{extra}' was successfully installed.")</pre>
<pre class='cython code score-33 '>        <span class='trace'>__Pyx_TraceLine</span>(890,0,<span class='error_goto'>__PYX_ERR(0, 890, __pyx_L6_error)</span>)
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 890, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_11 = 0;
        __pyx_t_12 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Package);
        __pyx_t_11 += 9;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Package);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_Package);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 890, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_12;
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);
        __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
        __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_cur_scope-&gt;__pyx_v_extra) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_cur_scope-&gt;__pyx_v_extra) : __pyx_t_12;
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_cur_scope-&gt;__pyx_v_extra);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_was_successfully_installed);
        __pyx_t_11 += 29;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_was_successfully_installed);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_kp_u_was_successfully_installed);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 4, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 890, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 890, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0891</span>:     except Exception as e:</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(891,0,<span class='error_goto'>__PYX_ERR(0, 891, __pyx_L8_except_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])));
    if (__pyx_t_6) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.install_package", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_3, &amp;__pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 891, __pyx_L8_except_error)</span>
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_v_e = __pyx_t_3;
      /*try:*/ {
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(891,0,<span class='error_goto'>__PYX_ERR(0, 891, __pyx_L26_error)</span>)
      /*finally:*/ {
        __pyx_L26_error:;
        /*exception exit:*/{
          __Pyx_PyThreadState_declare
          __Pyx_PyThreadState_assign
          __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0; __pyx_t_21 = 0; __pyx_t_22 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_20, &amp;__pyx_t_21, &amp;__pyx_t_22);
          if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_17, &amp;__pyx_t_18, &amp;__pyx_t_19) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_17, &amp;__pyx_t_18, &amp;__pyx_t_19);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_17);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_18);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_19);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_20);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_21);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_22);
          __pyx_t_6 = __pyx_lineno; __pyx_t_15 = __pyx_clineno; __pyx_t_16 = __pyx_filename;
          {
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
          }
          if (PY_MAJOR_VERSION &gt;= 3) {
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_20);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_21);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_22);
            <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_20, __pyx_t_21, __pyx_t_22);
          }
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_17);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_18);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_19);
          <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_17, __pyx_t_18, __pyx_t_19);
          __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0; __pyx_t_21 = 0; __pyx_t_22 = 0;
          __pyx_lineno = __pyx_t_6; __pyx_clineno = __pyx_t_15; __pyx_filename = __pyx_t_16;
          goto __pyx_L8_except_error;
        }
      }
    }
    goto __pyx_L8_except_error;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0892</span>:         raise RuntimeError(f"Failed to install '{name}{extra}': {e}") from e</pre>
<pre class='cython code score-44 '>        <span class='trace'>__Pyx_TraceLine</span>(892,0,<span class='error_goto'>__PYX_ERR(0, 892, __pyx_L26_error)</span>)
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 892, __pyx_L26_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_11 = 0;
        __pyx_t_12 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Failed_to_install);
        __pyx_t_11 += 19;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Failed_to_install);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_Failed_to_install);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyUnicode_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_name);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 892, __pyx_L26_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_14) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_14) : __pyx_t_12;
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_14);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_14);
        __pyx_t_14 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
        __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_cur_scope-&gt;__pyx_v_extra) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_cur_scope-&gt;__pyx_v_extra) : __pyx_t_12;
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_cur_scope-&gt;__pyx_v_extra);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__64);
        __pyx_t_11 += 3;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__64);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_kp_u__64);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_e, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 892, __pyx_L26_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_14) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_14) : __pyx_t_12;
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_14);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4, __pyx_t_14);
        __pyx_t_14 = 0;
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 5, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 892, __pyx_L26_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_RuntimeError, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 892, __pyx_L26_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, __pyx_v_e);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='error_goto'>__PYX_ERR(0, 892, __pyx_L26_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">0893</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0894</span>: def _check_conda_installed() -&gt; bool:</pre>
<pre class='cython code score-30 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_37_check_conda_installed(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_36_check_conda_installed, "\n    Check if conda is installed and available in the system's PATH.\n\n    Returns\n    -------\n    bool\n        True if conda is found, False otherwise.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_37_check_conda_installed = {"_check_conda_installed", (PyCFunction)__pyx_pw_6gofast_5tools_9funcutils_37_check_conda_installed, METH_NOARGS, __pyx_doc_6gofast_5tools_9funcutils_36_check_conda_installed};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_37_check_conda_installed(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_check_conda_installed (wrapper)", 0);
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_36_check_conda_installed(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_36_check_conda_installed(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__65)
  <span class='trace'>__Pyx_TraceCall</span>("_check_conda_installed", __pyx_f[0], 894, 0, <span class='error_goto'>__PYX_ERR(0, 894, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_conda_installed", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(894,0,<span class='error_goto'>__PYX_ERR(0, 894, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 894, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_37_check_conda_installed, 0, __pyx_n_s_check_conda_installed, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__65));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_conda_installed, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 894, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/*  */
  __pyx_codeobj__65 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_check_conda_installed, 894, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__65)) __PYX_ERR(0, 894, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0895</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0896</span>:     Check if conda is installed and available in the system's PATH.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0897</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0898</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0900</span>:     bool</pre>
<pre class="cython line score-0">&#xA0;<span class="">0901</span>:         True if conda is found, False otherwise.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0902</span>:     """</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0903</span>:     try:</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(903,0,<span class='error_goto'>__PYX_ERR(0, 903, __pyx_L1_error)</span>)
  {
    /*try:*/ {
/*  */
    }
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/*  */
    __pyx_L5_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L7_try_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L0;
    __pyx_L6_except_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L0;
  }
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0904</span>:         subprocess.check_call(['conda', '--version'], stdout=subprocess.DEVNULL,</pre>
<pre class='cython code score-42 '>      <span class='trace'>__Pyx_TraceLine</span>(904,0,<span class='error_goto'>__PYX_ERR(0, 904, __pyx_L3_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_subprocess);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 904, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_check_call);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 904, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 904, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_conda);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_conda);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_u_conda)) <span class='error_goto'>__PYX_ERR(0, 904, __pyx_L3_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_version);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_version);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_kp_u_version)) <span class='error_goto'>__PYX_ERR(0, 904, __pyx_L3_error)</span>;
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 904, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 904, __pyx_L3_error)</span>;
      __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 904, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_subprocess);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 904, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_DEVNULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 904, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_stdout, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 904, __pyx_L3_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(904,0,<span class='error_goto'>__PYX_ERR(0, 904, __pyx_L3_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 904, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0905</span>:                               stderr=subprocess.DEVNULL)</pre>
<pre class='cython code score-11 '>      <span class='trace'>__Pyx_TraceLine</span>(905,0,<span class='error_goto'>__PYX_ERR(0, 905, __pyx_L3_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_subprocess);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 905, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_DEVNULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 905, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_stderr, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 904, __pyx_L3_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0906</span>:         return True</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(906,0,<span class='error_goto'>__PYX_ERR(0, 906, __pyx_L3_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
      __pyx_r = Py_True;
      goto __pyx_L7_try_return;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0907</span>:     except (subprocess.CalledProcessError, FileNotFoundError):</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(907,0,<span class='error_goto'>__PYX_ERR(0, 907, __pyx_L5_except_error)</span>)
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_7, &amp;__pyx_t_4, &amp;__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_subprocess);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 907, __pyx_L5_except_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_CalledProcessError);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 907, __pyx_L5_except_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_FileNotFoundError);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 907, __pyx_L5_except_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_9 = __Pyx_PyErr_GivenExceptionMatches2(__pyx_t_7, __pyx_t_8, __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_7, __pyx_t_4, __pyx_t_6);
    __pyx_t_7 = 0; __pyx_t_4 = 0; __pyx_t_6 = 0;
    if (__pyx_t_9) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_conda_installed", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_6, &amp;__pyx_t_4, &amp;__pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 907, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0908</span>:         return False</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(908,0,<span class='error_goto'>__PYX_ERR(0, 908, __pyx_L5_except_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
      __pyx_r = Py_False;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L6_except_return;
    }
    goto __pyx_L5_except_error;
</pre><pre class="cython line score-0">&#xA0;<span class="">0909</span>: </pre>
<pre class="cython line score-126" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0910</span>: def ensure_pkg(</pre>
<pre class='cython code score-126 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_39ensure_pkg(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_38ensure_pkg, "\n    Decorator to ensure a Python package is installed before function execution.\n\n    If the specified package is not installed, or if its installed version does\n    not meet the minimum version requirement, this decorator can optionally \n    install or upgrade the package automatically using either pip or conda.\n\n    Parameters\n    ----------\n    name : str\n        The name of the package.\n    extra : str, optional\n        Additional specification for the package, such as version or extras.\n    errors : str, optional\n        Error handling strategy if the package is missing: 'raise', 'ignore',\n        or 'warn'.\n    min_version : str or None, optional\n        The minimum required version of the package. If not met, triggers \n        installation.\n    exception : Exception, optional\n        A custom exception to raise if the package is missing and `errors`\n        is 'raise'.\n    dist_name : str, optional\n        The distribution name of the package as known by package managers (e.g., pip).\n        If provided and the module import fails, an additional check based on the\n        distribution name is performed. This parameter is useful for packages where\n        the distribution name differs from the importable module name.\n    infer_dist_name : bool, optional\n        If True, attempt to infer the distribution name for pip installation,\n        defaults to False.\n    auto_install : bool, optional\n        Whether to automatically install the package if missing. \n        Defaults to False.\n    use_conda : bool, optional\n        Prefer conda over pip for automatic installation. Defaults to False.\n    partial_check : bool, optional\n        If True, checks the existence of the package only if the `condition` \n        is met. This allows for conditional package checking based on the \n        function's arguments or other criteria. If `False`, the check is always\n        performed. Defaults to False.\n    condition : Any, optional""\n        A condition that determines whether to check for the package's existence. \n        This can be a callable that takes the same arguments as the decorated function \n        and returns a boolean, a specific argument name to check for truthiness, or \n        any other value that will be evaluated as a boolean. If `None`, the package \n        check is performed unconditionally unless `partial_check` is False.\n    verbose : bool, optional\n        Enable verbose output during the installation process. Defaults to False.\n\n    Returns\n    -------\n    Callable\n        A decorator that wraps functions to ensure the specified package \n        is installed.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import ensure_pkg\n    &gt;&gt;&gt; @ensure_pkg(\"numpy\", auto_install=True)\n    ... def use_numpy():\n    ...     import numpy as np\n    ...     return np.array([1, 2, 3])\n\n    &gt;&gt;&gt; @ensure_pkg(\"pandas\", min_version=\"1.1.0\", errors=\"warn\", use_conda=True)\n    ... def use_pandas():\n    ...     import pandas as pd\n    ...     return pd.DataFrame([[1, 2], [3, 4]])\n\n    &gt;&gt;&gt; @ensure_pkg(\"matplotlib\", partial_check=True, condition=lambda x, y: x &gt; 0)\n    ... def plot_data(x, y):\n    ...     import matplotlib.pyplot as plt\n    ...     plt.plot(x, y)\n    ...     plt.show()\n    \n    &gt;&gt;&gt; @ensure_pkg(\"skimage\", partial_check=True, condition=(\n    ...     lambda *args, **kwargs: 'method' in kwargs and kwargs['method'] == 'hog')\n    ...     )\n    &gt;&gt;&gt; def check_package_installed(data, method='hog', **kwargs):\n    ...     extractor_function = None\n    ...     if method == 'hog':\n    ...         from skimage.feature import hog\n    ...         extractor_function = lambda image: hog(image, **kwargs)\n    ...     return extractor_function\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_39ensure_pkg = {"ensure_pkg", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_39ensure_pkg, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_38ensure_pkg};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_39ensure_pkg(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_extra = 0;
  PyObject *__pyx_v_errors = 0;
  PyObject *__pyx_v_min_version = 0;
  PyObject *__pyx_v_exception = 0;
  PyObject *__pyx_v_dist_name = 0;
  PyObject *__pyx_v_infer_dist_name = 0;
  PyObject *__pyx_v_auto_install = 0;
  PyObject *__pyx_v_use_conda = 0;
  PyObject *__pyx_v_partial_check = 0;
  PyObject *__pyx_v_condition = 0;
  PyObject *__pyx_v_verbose = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("ensure_pkg (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_extra,&amp;__pyx_n_s_errors,&amp;__pyx_n_s_min_version,&amp;__pyx_n_s_exception,&amp;__pyx_n_s_dist_name,&amp;__pyx_n_s_infer_dist_name,&amp;__pyx_n_s_auto_install,&amp;__pyx_n_s_use_conda,&amp;__pyx_n_s_partial_check,&amp;__pyx_n_s_condition,&amp;__pyx_n_s_verbose,0};
  PyObject* values[12] = {0,0,0,0,0,0,0,0,0,0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_kp_u__57)));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_raise)));
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_38ensure_pkg(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_name, PyObject *__pyx_v_extra, PyObject *__pyx_v_errors, PyObject *__pyx_v_min_version, PyObject *__pyx_v_exception, PyObject *__pyx_v_dist_name, PyObject *__pyx_v_infer_dist_name, PyObject *__pyx_v_auto_install, PyObject *__pyx_v_use_conda, PyObject *__pyx_v_partial_check, PyObject *__pyx_v_condition, PyObject *__pyx_v_verbose) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_16_ensure_pkg *__pyx_cur_scope;
  PyObject *__pyx_v_decorator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__68)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_16_ensure_pkg *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_16_ensure_pkg(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_16_ensure_pkg, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_16_ensure_pkg *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("ensure_pkg", __pyx_f[0], 910, 0, <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_name = __pyx_v_name;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_name);
  __pyx_cur_scope-&gt;__pyx_v_extra = __pyx_v_extra;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_extra);
  __pyx_cur_scope-&gt;__pyx_v_errors = __pyx_v_errors;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_errors);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_errors);
  __pyx_cur_scope-&gt;__pyx_v_min_version = __pyx_v_min_version;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_min_version);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_min_version);
  __pyx_cur_scope-&gt;__pyx_v_exception = __pyx_v_exception;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_exception);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_exception);
  __pyx_cur_scope-&gt;__pyx_v_dist_name = __pyx_v_dist_name;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_dist_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_dist_name);
  __pyx_cur_scope-&gt;__pyx_v_infer_dist_name = __pyx_v_infer_dist_name;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_infer_dist_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_infer_dist_name);
  __pyx_cur_scope-&gt;__pyx_v_auto_install = __pyx_v_auto_install;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_auto_install);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_auto_install);
  __pyx_cur_scope-&gt;__pyx_v_use_conda = __pyx_v_use_conda;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_use_conda);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_use_conda);
  __pyx_cur_scope-&gt;__pyx_v_partial_check = __pyx_v_partial_check;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_partial_check);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_partial_check);
  __pyx_cur_scope-&gt;__pyx_v_condition = __pyx_v_condition;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_condition);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_condition);
  __pyx_cur_scope-&gt;__pyx_v_verbose = __pyx_v_verbose;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_verbose);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_verbose);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.ensure_pkg", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_decorator);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__169 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_name, __pyx_n_s_extra, __pyx_n_s_errors, __pyx_n_s_min_version, __pyx_n_s_exception, __pyx_n_s_dist_name, __pyx_n_s_infer_dist_name, __pyx_n_s_auto_install, __pyx_n_s_use_conda, __pyx_n_s_partial_check, __pyx_n_s_condition, __pyx_n_s_verbose, __pyx_n_s_decorator, __pyx_n_s_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__169)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__169);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__169);
  __pyx_codeobj__68 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(12, 0, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__169, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_ensure_pkg, 910, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__68)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(910,0,<span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_name, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_extra, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_errors, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_min_version, __pyx_kp_s_str_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_exception, __pyx_n_s_Exception) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dist_name, __pyx_kp_s_Optional_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_infer_dist_name, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_auto_install, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_use_conda, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_partial_check, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_condition, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_verbose, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return, __pyx_kp_s_Callable__T__T) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_39ensure_pkg, 0, __pyx_n_s_ensure_pkg, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__68));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__170);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ensure_pkg, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__170 = <span class='py_c_api'>PyTuple_Pack</span>(11, ((PyObject*)__pyx_kp_u__57), ((PyObject*)__pyx_n_u_raise), Py_None, Py_None, Py_None, ((PyObject *)Py_False), ((PyObject *)Py_False), ((PyObject *)Py_False), ((PyObject *)Py_False), Py_None, ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__170)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__170);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__170);
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_16_ensure_pkg {
  PyObject_HEAD
  PyObject *__pyx_v_auto_install;
  PyObject *__pyx_v_condition;
  PyObject *__pyx_v_dist_name;
  PyObject *__pyx_v_errors;
  PyObject *__pyx_v_exception;
  PyObject *__pyx_v_extra;
  PyObject *__pyx_v_infer_dist_name;
  PyObject *__pyx_v_min_version;
  PyObject *__pyx_v_name;
  PyObject *__pyx_v_partial_check;
  PyObject *__pyx_v_use_conda;
  PyObject *__pyx_v_verbose;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">0911</span>:     name: str,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0912</span>:     extra: str = "",</pre>
<pre class="cython line score-0">&#xA0;<span class="">0913</span>:     errors: str = "raise",</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0914</span>:     min_version: str | None = None,</pre>
<pre class='cython code score-2 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0915</span>:     exception: Exception = None,</pre>
<pre class='cython code score-2 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0916</span>:     dist_name: Optional[str]=None,</pre>
<pre class='cython code score-2 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0917</span>:     infer_dist_name: bool=False,</pre>
<pre class='cython code score-2 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0918</span>:     auto_install: bool = False,</pre>
<pre class='cython code score-2 '>    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0919</span>:     use_conda: bool = False,</pre>
<pre class='cython code score-2 '>    values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0920</span>:     partial_check: bool = False,</pre>
<pre class='cython code score-2 '>    values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0921</span>:     condition: Any = None,</pre>
<pre class='cython code score-2 '>    values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-176" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0922</span>:     verbose: bool = False</pre>
<pre class='cython code score-176 '>    values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_name)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_extra);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_errors);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_min_version);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_exception);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dist_name);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_infer_dist_name);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_auto_install);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_use_conda);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_partial_check);
          if (value) { values[9] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 10:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_condition);
          if (value) { values[10] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case 11:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_verbose);
          if (value) { values[11] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "ensure_pkg") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case 12: values[11] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 11);
        CYTHON_FALLTHROUGH;
        case 11: values[10] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 10);
        CYTHON_FALLTHROUGH;
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_name = ((PyObject*)values[0]);
    __pyx_v_extra = ((PyObject*)values[1]);
    __pyx_v_errors = ((PyObject*)values[2]);
    __pyx_v_min_version = values[3];
    __pyx_v_exception = ((PyObject*)values[4]);
    __pyx_v_dist_name = values[5];
    __pyx_v_infer_dist_name = values[6];
    __pyx_v_auto_install = values[7];
    __pyx_v_use_conda = values[8];
    __pyx_v_partial_check = values[9];
    __pyx_v_condition = values[10];
    __pyx_v_verbose = values[11];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("ensure_pkg", 0, 1, 12, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.ensure_pkg", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyUnicode_Type), 0, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 911, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_extra), (&amp;PyUnicode_Type), 0, "extra", 1))) <span class='error_goto'>__PYX_ERR(0, 912, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_errors), (&amp;PyUnicode_Type), 0, "errors", 1))) <span class='error_goto'>__PYX_ERR(0, 913, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_exception), (&amp;((PyTypeObject*)PyExc_Exception)[0]), 1, "exception", 0))) <span class='error_goto'>__PYX_ERR(0, 915, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_38ensure_pkg(__pyx_self, __pyx_v_name, __pyx_v_extra, __pyx_v_errors, __pyx_v_min_version, __pyx_v_exception, __pyx_v_dist_name, __pyx_v_infer_dist_name, __pyx_v_auto_install, __pyx_v_use_conda, __pyx_v_partial_check, __pyx_v_condition, __pyx_v_verbose);
</pre><pre class="cython line score-0">&#xA0;<span class="">0923</span>: ) -&gt; Callable[[_T], _T]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0924</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0925</span>:     Decorator to ensure a Python package is installed before function execution.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0926</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0927</span>:     If the specified package is not installed, or if its installed version does</pre>
<pre class="cython line score-0">&#xA0;<span class="">0928</span>:     not meet the minimum version requirement, this decorator can optionally</pre>
<pre class="cython line score-0">&#xA0;<span class="">0929</span>:     install or upgrade the package automatically using either pip or conda.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0930</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0931</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0932</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0933</span>:     name : str</pre>
<pre class="cython line score-0">&#xA0;<span class="">0934</span>:         The name of the package.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0935</span>:     extra : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0936</span>:         Additional specification for the package, such as version or extras.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0937</span>:     errors : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0938</span>:         Error handling strategy if the package is missing: 'raise', 'ignore',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0939</span>:         or 'warn'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0940</span>:     min_version : str or None, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0941</span>:         The minimum required version of the package. If not met, triggers</pre>
<pre class="cython line score-0">&#xA0;<span class="">0942</span>:         installation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0943</span>:     exception : Exception, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0944</span>:         A custom exception to raise if the package is missing and `errors`</pre>
<pre class="cython line score-0">&#xA0;<span class="">0945</span>:         is 'raise'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0946</span>:     dist_name : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0947</span>:         The distribution name of the package as known by package managers (e.g., pip).</pre>
<pre class="cython line score-0">&#xA0;<span class="">0948</span>:         If provided and the module import fails, an additional check based on the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0949</span>:         distribution name is performed. This parameter is useful for packages where</pre>
<pre class="cython line score-0">&#xA0;<span class="">0950</span>:         the distribution name differs from the importable module name.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0951</span>:     infer_dist_name : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0952</span>:         If True, attempt to infer the distribution name for pip installation,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>:         defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0954</span>:     auto_install : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>:         Whether to automatically install the package if missing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>:         Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>:     use_conda : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0958</span>:         Prefer conda over pip for automatic installation. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0959</span>:     partial_check : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>:         If True, checks the existence of the package only if the `condition`</pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>:         is met. This allows for conditional package checking based on the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>:         function's arguments or other criteria. If `False`, the check is always</pre>
<pre class="cython line score-0">&#xA0;<span class="">0963</span>:         performed. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0964</span>:     condition : Any, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0965</span>:         A condition that determines whether to check for the package's existence.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>:         This can be a callable that takes the same arguments as the decorated function</pre>
<pre class="cython line score-0">&#xA0;<span class="">0967</span>:         and returns a boolean, a specific argument name to check for truthiness, or</pre>
<pre class="cython line score-0">&#xA0;<span class="">0968</span>:         any other value that will be evaluated as a boolean. If `None`, the package</pre>
<pre class="cython line score-0">&#xA0;<span class="">0969</span>:         check is performed unconditionally unless `partial_check` is False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0970</span>:     verbose : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0971</span>:         Enable verbose output during the installation process. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0972</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0973</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0974</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0975</span>:     Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0976</span>:         A decorator that wraps functions to ensure the specified package</pre>
<pre class="cython line score-0">&#xA0;<span class="">0977</span>:         is installed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0978</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0979</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0980</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0981</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import ensure_pkg</pre>
<pre class="cython line score-0">&#xA0;<span class="">0982</span>:     &gt;&gt;&gt; @ensure_pkg("numpy", auto_install=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0983</span>:     ... def use_numpy():</pre>
<pre class="cython line score-0">&#xA0;<span class="">0984</span>:     ...     import numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">0985</span>:     ...     return np.array([1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0986</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0987</span>:     &gt;&gt;&gt; @ensure_pkg("pandas", min_version="1.1.0", errors="warn", use_conda=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0988</span>:     ... def use_pandas():</pre>
<pre class="cython line score-0">&#xA0;<span class="">0989</span>:     ...     import pandas as pd</pre>
<pre class="cython line score-0">&#xA0;<span class="">0990</span>:     ...     return pd.DataFrame([[1, 2], [3, 4]])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0991</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0992</span>:     &gt;&gt;&gt; @ensure_pkg("matplotlib", partial_check=True, condition=lambda x, y: x &gt; 0)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0993</span>:     ... def plot_data(x, y):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0994</span>:     ...     import matplotlib.pyplot as plt</pre>
<pre class="cython line score-0">&#xA0;<span class="">0995</span>:     ...     plt.plot(x, y)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0996</span>:     ...     plt.show()</pre>
<pre class="cython line score-0">&#xA0;<span class="">0997</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0998</span>:     &gt;&gt;&gt; @ensure_pkg("skimage", partial_check=True, condition=(</pre>
<pre class="cython line score-0">&#xA0;<span class="">0999</span>:     ...     lambda *args, **kwargs: 'method' in kwargs and kwargs['method'] == 'hog')</pre>
<pre class="cython line score-0">&#xA0;<span class="">1000</span>:     ...     )</pre>
<pre class="cython line score-0">&#xA0;<span class="">1001</span>:     &gt;&gt;&gt; def check_package_installed(data, method='hog', **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1002</span>:     ...     extractor_function = None</pre>
<pre class="cython line score-0">&#xA0;<span class="">1003</span>:     ...     if method == 'hog':</pre>
<pre class="cython line score-0">&#xA0;<span class="">1004</span>:     ...         from skimage.feature import hog</pre>
<pre class="cython line score-0">&#xA0;<span class="">1005</span>:     ...         extractor_function = lambda image: hog(image, **kwargs)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1006</span>:     ...     return extractor_function</pre>
<pre class="cython line score-0">&#xA0;<span class="">1007</span>:     """</pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1008</span>:     def decorator(func: _T) -&gt; _T:</pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_10ensure_pkg_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_10ensure_pkg_1decorator = {"decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_10ensure_pkg_1decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_10ensure_pkg_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1008, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1008, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decorator", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1008, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.ensure_pkg.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_10ensure_pkg_decorator(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_10ensure_pkg_decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_17_decorator *__pyx_cur_scope;
  PyObject *__pyx_v_wrapper = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_17_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_17_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_17_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_17_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1008, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_16_ensure_pkg *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("decorator", __pyx_f[0], 1008, 0, <span class='error_goto'>__PYX_ERR(0, 1008, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.ensure_pkg.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_wrapper);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1008,0,<span class='error_goto'>__PYX_ERR(0, 1008, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_func, __pyx_n_s_T) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1008, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_n_s_T) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1008, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_10ensure_pkg_1decorator, 0, __pyx_n_s_ensure_pkg_locals_decorator, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__69));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1008, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_decorator = __pyx_t_2;
  __pyx_t_2 = 0;
/*  */
  __pyx_codeobj__69 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_decorator, 1008, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__69)) __PYX_ERR(0, 1008, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_17_decorator {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_16_ensure_pkg *__pyx_outer_scope;
  PyObject *__pyx_v_func;
};

</pre><pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1009</span>:         @functools.wraps(func)</pre>
<pre class='cython code score-74 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_10ensure_pkg_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_10ensure_pkg_9decorator_1wrapper = {"wrapper", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_10ensure_pkg_9decorator_1wrapper, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_10ensure_pkg_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("wrapper (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "wrapper", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_10ensure_pkg_9decorator_wrapper(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_10ensure_pkg_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_17_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_17_decorator *__pyx_outer_scope;
  int __pyx_v_bound_method;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_17_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("wrapper", __pyx_f[0], 1009, 0, <span class='error_goto'>__PYX_ERR(0, 1009, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.ensure_pkg.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1009,0,<span class='error_goto'>__PYX_ERR(0, 1009, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1009, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1009, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1009, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
/*  */
  __pyx_tuple__66 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_bound_method);<span class='error_goto'> if (unlikely(!__pyx_tuple__66)) __PYX_ERR(0, 1009, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__66);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__66);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_10ensure_pkg_9decorator_1wrapper, 0, __pyx_n_s_ensure_pkg_locals_decorator_loca, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__67));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1009, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1009, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_wrapper = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__67 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__66, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_wrapper, 1009, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__67)) __PYX_ERR(0, 1009, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1010</span>:         def wrapper(*args, **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1011</span>:             # Determine if this is a method or a function based on the first argument</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1012</span>:             bound_method = hasattr(args[0], func.__name__) if args else False #</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1012,0,<span class='error_goto'>__PYX_ERR(0, 1012, __pyx_L1_error)</span>)
  __pyx_t_2 = (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_args) != 0);
  if (__pyx_t_2) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(__pyx_v_args, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1012, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 1012, __pyx_L1_error)</span> }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1012, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 1012, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_1 = __pyx_t_5;
  } else {
    __pyx_t_1 = 0;
  }
  __pyx_v_bound_method = __pyx_t_1;
</pre><pre class="cython line score-0">&#xA0;<span class="">1013</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1014</span>:             # If partial_check is True, check condition before performing actions</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1015</span>:             if not partial_check or  _should_check_condition(</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(1015,0,<span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_partial_check)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("partial_check"); <span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_partial_check); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>
  __pyx_t_5 = (!__pyx_t_2);
  if (!__pyx_t_5) {
  } else {
    __pyx_t_1 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_should_check_condition);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1015, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1015,0,<span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1015, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_condition);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_condition);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_condition)) <span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>;
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1016,0,<span class='error_goto'>__PYX_ERR(0, 1016, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_args);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1015, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1015, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_1 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1016</span>:                     condition, *args, **kwargs):</pre>
<pre class='cython code score-7 '>  <span class='trace'>__Pyx_TraceLine</span>(1016,0,<span class='error_goto'>__PYX_ERR(0, 1016, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_condition)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("condition"); <span class='error_goto'>__PYX_ERR(0, 1016, __pyx_L1_error)</span> }
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1015,0,<span class='error_goto'>__PYX_ERR(0, 1015, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1016, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1017</span>:                 try:</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(1017,0,<span class='error_goto'>__PYX_ERR(0, 1017, __pyx_L1_error)</span>)
    {
      /*try:*/ {
/*  */
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L11_try_end;
      __pyx_L6_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/*  */
      __pyx_L8_except_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      goto __pyx_L1_error;
      __pyx_L7_exception_handled:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_8, __pyx_t_9, __pyx_t_10);
      __pyx_L11_try_end:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1018</span>:                     # Attempt to import the package, handling installation</pre>
<pre class="cython line score-0">&#xA0;<span class="">1019</span>:                     # if necessary and permitted</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1020</span>:                     import_optional_dependency(</pre>
<pre class='cython code score-16 '>        <span class='trace'>__Pyx_TraceLine</span>(1020,0,<span class='error_goto'>__PYX_ERR(0, 1020, __pyx_L6_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_import_optional_dependency);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1020, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(1020,0,<span class='error_goto'>__PYX_ERR(0, 1020, __pyx_L6_error)</span>)
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1020, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_name);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_name);
        if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_name)) <span class='error_goto'>__PYX_ERR(0, 1020, __pyx_L6_error)</span>;
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(1020,0,<span class='error_goto'>__PYX_ERR(0, 1020, __pyx_L6_error)</span>)
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1020, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1021</span>:                         name, extra=extra, errors=errors,</pre>
<pre class='cython code score-18 '>        <span class='trace'>__Pyx_TraceLine</span>(1021,0,<span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L6_error)</span>)
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_name)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("name"); <span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L6_error)</span> }
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(1021,0,<span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L6_error)</span>)
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1021, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_extra)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("extra"); <span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L6_error)</span> }
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_extra, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_extra) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L6_error)</span>
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_errors)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("errors"); <span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L6_error)</span> }
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_errors, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_errors) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L6_error)</span>
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1022</span>:                         min_version=min_version, exception=exception</pre>
<pre class='cython code score-14 '>        <span class='trace'>__Pyx_TraceLine</span>(1022,0,<span class='error_goto'>__PYX_ERR(0, 1022, __pyx_L6_error)</span>)
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_min_version)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("min_version"); <span class='error_goto'>__PYX_ERR(0, 1022, __pyx_L6_error)</span> }
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_min_version, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_min_version) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L6_error)</span>
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_exception)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("exception"); <span class='error_goto'>__PYX_ERR(0, 1022, __pyx_L6_error)</span> }
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_exception, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_exception) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1021, __pyx_L6_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1023</span>:                     )</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1024</span>:                 except (ModuleNotFoundError, ImportError):</pre>
<pre class='cython code score-11 '>      <span class='trace'>__Pyx_TraceLine</span>(1024,0,<span class='error_goto'>__PYX_ERR(0, 1024, __pyx_L8_except_error)</span>)
      <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_4, &amp;__pyx_t_6, &amp;__pyx_t_3);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_ModuleNotFoundError);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1024, __pyx_L8_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_11 = __Pyx_PyErr_GivenExceptionMatches2(__pyx_t_4, __pyx_t_7, __pyx_builtin_ImportError);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_4, __pyx_t_6, __pyx_t_3);
      __pyx_t_4 = 0; __pyx_t_6 = 0; __pyx_t_3 = 0;
      if (__pyx_t_11) {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.ensure_pkg.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_3, &amp;__pyx_t_6, &amp;__pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1024, __pyx_L8_except_error)</span>
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1025</span>:                     if auto_install:</pre>
<pre class='cython code score-4 '>        <span class='trace'>__Pyx_TraceLine</span>(1025,0,<span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L8_except_error)</span>)
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_auto_install)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("auto_install"); <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L8_except_error)</span> }
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_auto_install); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1025, __pyx_L8_except_error)</span>
        if (likely(__pyx_t_1)) {
/*  */
          goto __pyx_L14;
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1026</span>:                         # Install the package if auto-install is enabled</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1027</span>:                         install_package(</pre>
<pre class='cython code score-16 '>          <span class='trace'>__Pyx_TraceLine</span>(1027,0,<span class='error_goto'>__PYX_ERR(0, 1027, __pyx_L8_except_error)</span>)
          <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_install_package);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1027, __pyx_L8_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
/*  */
          <span class='trace'>__Pyx_TraceLine</span>(1027,0,<span class='error_goto'>__PYX_ERR(0, 1027, __pyx_L8_except_error)</span>)
          __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1027, __pyx_L8_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_name);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_name);
          if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_name)) <span class='error_goto'>__PYX_ERR(0, 1027, __pyx_L8_except_error)</span>;
/*  */
          <span class='trace'>__Pyx_TraceLine</span>(1027,0,<span class='error_goto'>__PYX_ERR(0, 1027, __pyx_L8_except_error)</span>)
          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_12, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 1027, __pyx_L8_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1028</span>:                             name, dist_name=dist_name,</pre>
<pre class='cython code score-11 '>          <span class='trace'>__Pyx_TraceLine</span>(1028,0,<span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L8_except_error)</span>)
          if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_name)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("name"); <span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L8_except_error)</span> }
/*  */
          <span class='trace'>__Pyx_TraceLine</span>(1028,0,<span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L8_except_error)</span>)
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1028, __pyx_L8_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
          if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_dist_name)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("dist_name"); <span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L8_except_error)</span> }
          if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_dist_name, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_dist_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L8_except_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1029</span>:                             infer_dist_name=infer_dist_name,</pre>
<pre class='cython code score-7 '>          <span class='trace'>__Pyx_TraceLine</span>(1029,0,<span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L8_except_error)</span>)
          if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_infer_dist_name)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("infer_dist_name"); <span class='error_goto'>__PYX_ERR(0, 1029, __pyx_L8_except_error)</span> }
          if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_infer_dist_name, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_infer_dist_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L8_except_error)</span>
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1030</span>:                             extra=extra, use_conda=use_conda, verbose=verbose</pre>
<pre class='cython code score-21 '>          <span class='trace'>__Pyx_TraceLine</span>(1030,0,<span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L8_except_error)</span>)
          if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_extra)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("extra"); <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L8_except_error)</span> }
          if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_extra, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_extra) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L8_except_error)</span>
          if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_use_conda)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("use_conda"); <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L8_except_error)</span> }
          if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_use_conda, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_use_conda) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L8_except_error)</span>
          if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("verbose"); <span class='error_goto'>__PYX_ERR(0, 1030, __pyx_L8_except_error)</span> }
          if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_13, __pyx_n_s_verbose, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1028, __pyx_L8_except_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1031</span>:                         )</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1032</span>:                     elif exception is not None:</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(1032,0,<span class='error_goto'>__PYX_ERR(0, 1032, __pyx_L8_except_error)</span>)
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_exception)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("exception"); <span class='error_goto'>__PYX_ERR(0, 1032, __pyx_L8_except_error)</span> }
        __pyx_t_1 = (__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_exception != ((PyObject*)Py_None));
        if (unlikely(__pyx_t_1)) {
/*  */
        }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1033</span>:                         raise exception</pre>
<pre class='cython code score-4 '>          <span class='trace'>__Pyx_TraceLine</span>(1033,0,<span class='error_goto'>__PYX_ERR(0, 1033, __pyx_L8_except_error)</span>)
          if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_exception)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("exception"); <span class='error_goto'>__PYX_ERR(0, 1033, __pyx_L8_except_error)</span> }
          <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_exception, 0, 0, 0);
          <span class='error_goto'>__PYX_ERR(0, 1033, __pyx_L8_except_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1034</span>:                     else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1035</span>:                         raise</pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(1035,0,<span class='error_goto'>__PYX_ERR(0, 1035, __pyx_L8_except_error)</span>)
        /*else*/ {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
          <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_3, __pyx_t_6, __pyx_t_4);
          __pyx_t_3 = 0; __pyx_t_6 = 0; __pyx_t_4 = 0; 
          <span class='error_goto'>__PYX_ERR(0, 1035, __pyx_L8_except_error)</span>
        }
        __pyx_L14:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        goto __pyx_L7_exception_handled;
      }
      goto __pyx_L8_except_error;
</pre><pre class="cython line score-0">&#xA0;<span class="">1036</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1037</span>:             # If the function is a bound method, call it with 'self' or 'cls'</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1038</span>:             if bound_method:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1038,0,<span class='error_goto'>__PYX_ERR(0, 1038, __pyx_L1_error)</span>)
  if (__pyx_v_bound_method) {
/*  */
  }
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1039</span>:                 return func(args[0], *args[1:], **kwargs)</pre>
<pre class='cython code score-30 '>    <span class='trace'>__Pyx_TraceLine</span>(1039,0,<span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L1_error)</span> }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(__pyx_v_args, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1039, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1039, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1039, __pyx_L1_error)</span>;
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyTuple_GetSlice</span>(__pyx_v_args, 1, PY_SSIZE_T_MAX);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1039, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1039, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1039, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1039, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_6;
    __pyx_t_6 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1040</span>:             else:</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1041</span>:                 return func(*args, **kwargs) #</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1041,0,<span class='error_goto'>__PYX_ERR(0, 1041, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 1041, __pyx_L1_error)</span> }
    __pyx_t_6 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1041, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1041, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1042</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1043</span>:         return wrapper</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1043,0,<span class='error_goto'>__PYX_ERR(0, 1043, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wrapper);
  __pyx_r = __pyx_v_wrapper;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1044</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1045</span>:     return decorator</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1045,0,<span class='error_goto'>__PYX_ERR(0, 1045, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorator);
  __pyx_r = __pyx_v_decorator;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1046</span>: </pre>
<pre class="cython line score-85" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1047</span>: def _should_check_condition(condition: Any, *args, **kwargs) -&gt; bool:</pre>
<pre class='cython code score-85 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_41_should_check_condition(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_40_should_check_condition, "\n    Determines whether the condition(s) for checking a package's existence are met, \n    based on the provided arguments and keyword arguments of a decorated function.\n\n    This function offers enhanced flexibility by allowing conditions to be specified \n    as callable functions, tuples for positional argument checks, strings for keyword \n    argument checks, or a list combining any of these types for multiple conditions.\n\n    Parameters\n    ----------\n    condition : Any\n        The condition(s) that determine whether to perform the package check. Can be:\n        - A callable that takes `*args` and `**kwargs` and returns a boolean.\n        - A string specifying a keyword argument name that should be truthy.\n        - A tuple `(index, value)` for checking a specific value of a positional argument.\n        - A list of any combination of the above to specify multiple conditions.\n    *args : tuple\n        Positional arguments passed to the decorated function.\n    **kwargs : dict\n        Keyword arguments passed to the decorated function.\n\n    Returns\n    -------\n    bool\n        `True` if the package check should be performed based on the evaluation of \n        `condition`, `False` otherwise.\n\n    Examples\n    --------\n    Checking with a single callable condition for partial_check is ``True``:\n\n    &gt;&gt;&gt; _should_check_condition(lambda x, y: x &gt; y, 5, 3)\n    True\n\n    Checking with a string condition (keyword argument name):\n\n    &gt;&gt;&gt; _should_check_condition('method', method='hog')\n    True\n\n    Checking with a tuple for positional argument value:\n\n    &gt;&gt;&gt; _should_check_condition((0, 'data'), 'data', method='hog')\n    True\n\n    Checking with multiple conditions:\n\n    &gt;&gt;&gt; conditions = [(1, 'hog'), lambda *args, **kwargs: kwargs.get('filter', False)]\n    &gt;&gt;&gt; _should_check_condition( conditions, 'data', 'hog', filter=True)\n    True\n\n    In the last example, the package check is performed because both conditions are met:""\n    the second positional argument equals 'hog', and the 'filter' keyword argument is `True`.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_41_should_check_condition = {"_should_check_condition", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_41_should_check_condition, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_40_should_check_condition};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_41_should_check_condition(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_condition = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_should_check_condition (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  __pyx_v_args = <span class='pyx_c_api'>__Pyx_ArgsSlice_FASTCALL</span>(__pyx_args, 1, __pyx_nargs);
  if (unlikely(!__pyx_v_args)) {
    <span class='pyx_macro_api'>__Pyx_CLEAR</span>(__pyx_v_kwargs);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return NULL;
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_args);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_condition,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        default:
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_condition)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1047, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        const Py_ssize_t used_pos_args = (kwd_pos_args &lt; 1) ? kwd_pos_args : 1;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, used_pos_args, "_should_check_condition") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1047, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs &lt; 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_condition = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_should_check_condition", 0, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1047, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_CLEAR</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_CLEAR</span>(__pyx_v_kwargs);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._should_check_condition", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_40_should_check_condition(__pyx_self, __pyx_v_condition, __pyx_v_args, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_40_should_check_condition(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_condition, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_18__should_check_condition *__pyx_cur_scope;
  PyObject *__pyx_gb_6gofast_5tools_9funcutils_23_should_check_condition_4generator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__70)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_18__should_check_condition *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_18__should_check_condition(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_18__should_check_condition, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_18__should_check_condition *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1047, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("_should_check_condition", __pyx_f[0], 1047, 0, <span class='error_goto'>__PYX_ERR(0, 1047, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_args = __pyx_v_args;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_args);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_args);
  __pyx_cur_scope-&gt;__pyx_v_kwargs = __pyx_v_kwargs;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_kwargs);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._should_check_condition", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_gb_6gofast_5tools_9funcutils_23_should_check_condition_4generator);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__171 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_condition, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_eval_condition, __pyx_n_s_eval_condition, __pyx_n_s_genexpr, __pyx_n_s_genexpr);<span class='error_goto'> if (unlikely(!__pyx_tuple__171)) __PYX_ERR(0, 1047, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__171);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__171);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1047,0,<span class='error_goto'>__PYX_ERR(0, 1047, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1047, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_condition, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1047, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1047, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_41_should_check_condition, 0, __pyx_n_s_should_check_condition, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__70));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1047, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_should_check_condition, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1047, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__70 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__171, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_should_check_condition, 1047, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__70)) __PYX_ERR(0, 1047, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_18__should_check_condition {
  PyObject_HEAD
  PyObject *__pyx_v_args;
  PyObject *__pyx_v_eval_condition;
  PyObject *__pyx_v_kwargs;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">1048</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1049</span>:     Determines whether the condition(s) for checking a package's existence are met,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1050</span>:     based on the provided arguments and keyword arguments of a decorated function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1052</span>:     This function offers enhanced flexibility by allowing conditions to be specified</pre>
<pre class="cython line score-0">&#xA0;<span class="">1053</span>:     as callable functions, tuples for positional argument checks, strings for keyword</pre>
<pre class="cython line score-0">&#xA0;<span class="">1054</span>:     argument checks, or a list combining any of these types for multiple conditions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1055</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1056</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1057</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1058</span>:     condition : Any</pre>
<pre class="cython line score-0">&#xA0;<span class="">1059</span>:         The condition(s) that determine whether to perform the package check. Can be:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1060</span>:         - A callable that takes `*args` and `**kwargs` and returns a boolean.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1061</span>:         - A string specifying a keyword argument name that should be truthy.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1062</span>:         - A tuple `(index, value)` for checking a specific value of a positional argument.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1063</span>:         - A list of any combination of the above to specify multiple conditions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1064</span>:     *args : tuple</pre>
<pre class="cython line score-0">&#xA0;<span class="">1065</span>:         Positional arguments passed to the decorated function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1066</span>:     **kwargs : dict</pre>
<pre class="cython line score-0">&#xA0;<span class="">1067</span>:         Keyword arguments passed to the decorated function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1068</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1069</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1070</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1071</span>:     bool</pre>
<pre class="cython line score-0">&#xA0;<span class="">1072</span>:         `True` if the package check should be performed based on the evaluation of</pre>
<pre class="cython line score-0">&#xA0;<span class="">1073</span>:         `condition`, `False` otherwise.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1074</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1075</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1076</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1077</span>:     Checking with a single callable condition for partial_check is ``True``:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1078</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1079</span>:     &gt;&gt;&gt; _should_check_condition(lambda x, y: x &gt; y, 5, 3)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1080</span>:     True</pre>
<pre class="cython line score-0">&#xA0;<span class="">1081</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1082</span>:     Checking with a string condition (keyword argument name):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1083</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1084</span>:     &gt;&gt;&gt; _should_check_condition('method', method='hog')</pre>
<pre class="cython line score-0">&#xA0;<span class="">1085</span>:     True</pre>
<pre class="cython line score-0">&#xA0;<span class="">1086</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1087</span>:     Checking with a tuple for positional argument value:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1088</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1089</span>:     &gt;&gt;&gt; _should_check_condition((0, 'data'), 'data', method='hog')</pre>
<pre class="cython line score-0">&#xA0;<span class="">1090</span>:     True</pre>
<pre class="cython line score-0">&#xA0;<span class="">1091</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1092</span>:     Checking with multiple conditions:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1093</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1094</span>:     &gt;&gt;&gt; conditions = [(1, 'hog'), lambda *args, **kwargs: kwargs.get('filter', False)]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1095</span>:     &gt;&gt;&gt; _should_check_condition( conditions, 'data', 'hog', filter=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1096</span>:     True</pre>
<pre class="cython line score-0">&#xA0;<span class="">1097</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1098</span>:     In the last example, the package check is performed because both conditions are met:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1099</span>:     the second positional argument equals 'hog', and the 'filter' keyword argument is `True`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1100</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1101</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1102</span>:     def eval_condition(cond):</pre>
<pre class='cython code score-51 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_23_should_check_condition_1eval_condition(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_23_should_check_condition_1eval_condition = {"eval_condition", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_23_should_check_condition_1eval_condition, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_23_should_check_condition_1eval_condition(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_cond = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("eval_condition (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_cond,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_cond)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1102, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "eval_condition") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1102, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_cond = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("eval_condition", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1102, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._should_check_condition.eval_condition", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_23_should_check_condition_eval_condition(__pyx_self, __pyx_v_cond);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_23_should_check_condition_eval_condition(PyObject *__pyx_self, PyObject *__pyx_v_cond) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_18__should_check_condition *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_18__should_check_condition *__pyx_outer_scope;
  PyObject *__pyx_v_index = NULL;
  PyObject *__pyx_v_value = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_18__should_check_condition *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("eval_condition", __pyx_f[0], 1102, 0, <span class='error_goto'>__PYX_ERR(0, 1102, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._should_check_condition.eval_condition", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
static PyObject *__pyx_gb_6gofast_5tools_9funcutils_23_should_check_condition_4generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
/*  */
  __pyx_tuple__71 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_cond, __pyx_n_s_index, __pyx_n_s_value);<span class='error_goto'> if (unlikely(!__pyx_tuple__71)) __PYX_ERR(0, 1102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__71);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__71);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1102,0,<span class='error_goto'>__PYX_ERR(0, 1102, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_23_should_check_condition_1eval_condition, 0, __pyx_n_s_should_check_condition_locals_e, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__72));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_eval_condition = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__72 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__71, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_eval_condition, 1102, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__72)) __PYX_ERR(0, 1102, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1103</span>:         # Callable condition with direct application</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1104</span>:         if callable(cond):</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1104,0,<span class='error_goto'>__PYX_ERR(0, 1104, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_v_cond);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1105</span>:             return cond(*args, **kwargs)</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(1105,0,<span class='error_goto'>__PYX_ERR(0, 1105, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_args)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("args"); <span class='error_goto'>__PYX_ERR(0, 1105, __pyx_L1_error)</span> }
    if (unlikely(__pyx_cur_scope-&gt;__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
      <span class='error_goto'>__PYX_ERR(0, 1105, __pyx_L1_error)</span>
    }
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_kwargs)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("kwargs"); <span class='error_goto'>__PYX_ERR(0, 1105, __pyx_L1_error)</span> }
    if (unlikely(__pyx_cur_scope-&gt;__pyx_v_kwargs == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "argument after ** must be a mapping, not NoneType");
      <span class='error_goto'>__PYX_ERR(0, 1105, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_cur_scope-&gt;__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_cond, __pyx_cur_scope-&gt;__pyx_v_args, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1105, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1106</span>:         # String condition indicating a key in kwargs</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1107</span>:         elif isinstance(cond, str) and cond in kwargs:</pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(1107,0,<span class='error_goto'>__PYX_ERR(0, 1107, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_cond); 
  if (__pyx_t_4) {
  } else {
    __pyx_t_1 = __pyx_t_4;
    goto __pyx_L4_bool_binop_done;
  }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_kwargs)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("kwargs"); <span class='error_goto'>__PYX_ERR(0, 1107, __pyx_L1_error)</span> }
  if (unlikely(__pyx_cur_scope-&gt;__pyx_v_kwargs == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
    <span class='error_goto'>__PYX_ERR(0, 1107, __pyx_L1_error)</span>
  }
  __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_v_cond, __pyx_cur_scope-&gt;__pyx_v_kwargs, Py_EQ)); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1107, __pyx_L1_error)</span>
  __pyx_t_1 = __pyx_t_4;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1108</span>:             return bool(kwargs[cond])</pre>
<pre class='cython code score-15 '>    <span class='trace'>__Pyx_TraceLine</span>(1108,0,<span class='error_goto'>__PYX_ERR(0, 1108, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_kwargs)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("kwargs"); <span class='error_goto'>__PYX_ERR(0, 1108, __pyx_L1_error)</span> }
    if (unlikely(__pyx_cur_scope-&gt;__pyx_v_kwargs == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1108, __pyx_L1_error)</span>
    }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_kwargs, __pyx_v_cond);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1108, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((!(!__pyx_t_1)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1109</span>:         # Tuple condition indicating positional argument check</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1110</span>:         elif isinstance(cond, tuple) and len(cond) == 2:</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(1110,0,<span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyTuple_Check</span>(__pyx_v_cond); 
  if (__pyx_t_4) {
  } else {
    __pyx_t_1 = __pyx_t_4;
    goto __pyx_L6_bool_binop_done;
  }
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_cond);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
  __pyx_t_4 = (__pyx_t_5 == 2);
  __pyx_t_1 = __pyx_t_4;
  __pyx_L6_bool_binop_done:;
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1111</span>:             index, value = cond</pre>
<pre class='cython code score-44 '>    <span class='trace'>__Pyx_TraceLine</span>(1111,0,<span class='error_goto'>__PYX_ERR(0, 1111, __pyx_L1_error)</span>)
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_cond))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_cond))) {
      PyObject* sequence = __pyx_v_cond;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 1111, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      #endif
    } else {
      Py_ssize_t index = -1;
      __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_cond);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_6);
      index = 0; __pyx_t_3 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_3)) goto __pyx_L8_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      index = 1; __pyx_t_2 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_2)) goto __pyx_L8_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_6), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1111, __pyx_L1_error)</span>
      __pyx_t_7 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L9_unpacking_done;
      __pyx_L8_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 1111, __pyx_L1_error)</span>
      __pyx_L9_unpacking_done:;
    }
    __pyx_v_index = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_value = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1112</span>:             return index &lt; len(args) and args[index] == value</pre>
<pre class='cython code score-45 '>    <span class='trace'>__Pyx_TraceLine</span>(1112,0,<span class='error_goto'>__PYX_ERR(0, 1112, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_args)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("args"); <span class='error_goto'>__PYX_ERR(0, 1112, __pyx_L1_error)</span> }
    __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_args;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    if (unlikely(__pyx_t_3 == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "object of type 'NoneType' has no len()");
      <span class='error_goto'>__PYX_ERR(0, 1112, __pyx_L1_error)</span>
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1112, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1112, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_index, __pyx_t_3, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1112, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1112, __pyx_L1_error)</span>
    if (__pyx_t_1) {
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      __pyx_t_2 = __pyx_t_6;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L10_bool_binop_done;
    }
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_args)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("args"); <span class='error_goto'>__PYX_ERR(0, 1112, __pyx_L1_error)</span> }
    if (unlikely(__pyx_cur_scope-&gt;__pyx_v_args == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 1112, __pyx_L1_error)</span>
    }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_args, __pyx_v_index);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1112, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_v_value, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1112, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_2 = __pyx_t_3;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_L10_bool_binop_done:;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1113</span>:         return False</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1113,0,<span class='error_goto'>__PYX_ERR(0, 1113, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  __pyx_r = Py_False;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1114</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1115</span>:     # Support for list of conditions: all must be True</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1116</span>:     if isinstance(condition, list):</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1116,0,<span class='error_goto'>__PYX_ERR(0, 1116, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_condition); 
  if (__pyx_t_2) {
/*  */
  }
</pre><pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1117</span>:         return all(eval_condition(cond) for cond in condition)</pre>
<pre class='cython code score-84 '>static PyObject *__pyx_pf_6gofast_5tools_9funcutils_23_should_check_condition_2genexpr(PyObject *__pyx_self, PyObject *__pyx_genexpr_arg_0) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_19_genexpr *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_19_genexpr *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_19_genexpr(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_19_genexpr, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_19_genexpr *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_18__should_check_condition *) __pyx_self;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  __pyx_cur_scope-&gt;__pyx_genexpr_arg_0 = __pyx_genexpr_arg_0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0);
  {
    __pyx_CoroutineObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_coroutine_body_t) __pyx_gb_6gofast_5tools_9funcutils_23_should_check_condition_4generator, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_should_check_condition_locals_g, __pyx_n_s_gofast_tools_funcutils);<span class='error_goto'> if (unlikely(!gen)) __PYX_ERR(0, 1117, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return (PyObject *) gen;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._should_check_condition.genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_gb_6gofast_5tools_9funcutils_23_should_check_condition_4generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("genexpr", 0);
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value)) <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span>
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_genexpr_arg_0)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>(".0"); <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span> }
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0)) {
    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_genexpr_arg_0; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1117, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1117, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_cond);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_cond, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_eval_condition)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("eval_condition"); <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span> }
    __pyx_t_4 = __pyx_pf_6gofast_5tools_9funcutils_23_should_check_condition_eval_condition(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_eval_condition, __pyx_cur_scope-&gt;__pyx_v_cond);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1117, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_6 = (!__pyx_t_5);
    if (__pyx_t_6) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
      __pyx_r = Py_False;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
    __pyx_r = Py_True;
    goto __pyx_L0;
  }
  CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_Generator_Replace_StopIteration</span>(0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  #if !CYTHON_USE_EXC_INFO_STACK
  <span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);
  #endif
  __pyx_generator-&gt;resume_label = -1;
  <span class='pyx_c_api'>__Pyx_Coroutine_clear</span>((PyObject*)__pyx_generator);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(1117,0,<span class='error_goto'>__PYX_ERR(0, 1117, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = __pyx_pf_6gofast_5tools_9funcutils_23_should_check_condition_2genexpr(((PyObject*)__pyx_cur_scope), __pyx_v_condition);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1117, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Generator_Next</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1117, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_19_genexpr {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_18__should_check_condition *__pyx_outer_scope;
  PyObject *__pyx_genexpr_arg_0;
  PyObject *__pyx_v_cond;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">1118</span>:     else:</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1119</span>:         return eval_condition(condition)</pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(1119,0,<span class='error_goto'>__PYX_ERR(0, 1119, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = __pyx_pf_6gofast_5tools_9funcutils_23_should_check_condition_eval_condition(__pyx_cur_scope-&gt;__pyx_v_eval_condition, __pyx_v_condition);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1119, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1120</span>: </pre>
<pre class="cython line score-106" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1121</span>: def drop_nan_if(thresh: float, meth: str = 'drop_cols'):</pre>
<pre class='cython code score-106 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_43drop_nan_if(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_42drop_nan_if, "\n    A decorator that preprocesses the first positional argument 'data' of the\n    decorated function to ensure it is a DataFrame and then drops rows or columns \n    based on a missing value threshold. If the data is an array or Series, it is\n    converted to a DataFrame. After dropping, the data is cast back to its original\n    data types.\n\n    Parameters\n    ----------\n    thresh : float\n        The threshold for missing values. Rows or columns with missing values\n        exceeding this threshold will be dropped.\n    meth : str, optional\n        The method to apply: 'drop_rows' for dropping rows, 'drop_cols' for\n        dropping columns. Default is 'drop_cols'.\n\n    Returns\n    -------\n    Callable\n        The decorated function with data preprocessing.\n\n    Examples\n    --------\n    &gt;&gt;&gt; @drop_nan_if(thresh=1, meth='drop_rows')\n    ... def process_data(data):\n    ...     print(data.dtypes)\n    &gt;&gt;&gt; data = pd.DataFrame({\n    ...     'A': [1, np.nan, 3],\n    ...     'B': ['x', 'y', np.nan],\n    ...     'C': pd.to_datetime(['2021-01-01', np.nan, '2021-01-03'])\n    ... })\n    &gt;&gt;&gt; process_data(data)\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_43drop_nan_if = {"drop_nan_if", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_43drop_nan_if, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_42drop_nan_if};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_43drop_nan_if(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  double __pyx_v_thresh;
  PyObject *__pyx_v_meth = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("drop_nan_if (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_thresh,&amp;__pyx_n_s_meth,0};
  PyObject* values[2] = {0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_drop_cols)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_thresh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_meth);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "drop_nan_if") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_thresh = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_thresh == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L3_error)</span>
    __pyx_v_meth = ((PyObject*)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("drop_nan_if", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.drop_nan_if", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_meth), (&amp;PyUnicode_Type), 0, "meth", 1))) <span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_42drop_nan_if(__pyx_self, __pyx_v_thresh, __pyx_v_meth);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_42drop_nan_if(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_thresh, PyObject *__pyx_v_meth) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_20_drop_nan_if *__pyx_cur_scope;
  PyObject *__pyx_v_decorator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__77)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_20_drop_nan_if *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_20_drop_nan_if(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_20_drop_nan_if, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_20_drop_nan_if *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("drop_nan_if", __pyx_f[0], 1121, 0, <span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_thresh = __pyx_v_thresh;
  __pyx_cur_scope-&gt;__pyx_v_meth = __pyx_v_meth;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_meth);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_meth);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.drop_nan_if", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_decorator);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__172 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_thresh, __pyx_n_s_meth, __pyx_n_s_decorator, __pyx_n_s_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__172)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__172);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__172);
  __pyx_codeobj__77 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__172, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_drop_nan_if, 1121, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__77)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1121,0,<span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_thresh, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_meth, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_43drop_nan_if, 0, __pyx_n_s_drop_nan_if, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__77));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__173);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_drop_nan_if, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1121, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__173 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject*)__pyx_n_u_drop_cols));<span class='error_goto'> if (unlikely(!__pyx_tuple__173)) __PYX_ERR(0, 1121, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__173);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__173);
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_20_drop_nan_if {
  PyObject_HEAD
  PyObject *__pyx_v_meth;
  double __pyx_v_thresh;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">1122</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1123</span>:     A decorator that preprocesses the first positional argument 'data' of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1124</span>:     decorated function to ensure it is a DataFrame and then drops rows or columns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1125</span>:     based on a missing value threshold. If the data is an array or Series, it is</pre>
<pre class="cython line score-0">&#xA0;<span class="">1126</span>:     converted to a DataFrame. After dropping, the data is cast back to its original</pre>
<pre class="cython line score-0">&#xA0;<span class="">1127</span>:     data types.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1128</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1129</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1130</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1131</span>:     thresh : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">1132</span>:         The threshold for missing values. Rows or columns with missing values</pre>
<pre class="cython line score-0">&#xA0;<span class="">1133</span>:         exceeding this threshold will be dropped.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1134</span>:     meth : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1135</span>:         The method to apply: 'drop_rows' for dropping rows, 'drop_cols' for</pre>
<pre class="cython line score-0">&#xA0;<span class="">1136</span>:         dropping columns. Default is 'drop_cols'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1137</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1138</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1139</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1140</span>:     Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">1141</span>:         The decorated function with data preprocessing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1142</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1143</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1144</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1145</span>:     &gt;&gt;&gt; @drop_nan_if(thresh=1, meth='drop_rows')</pre>
<pre class="cython line score-0">&#xA0;<span class="">1146</span>:     ... def process_data(data):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1147</span>:     ...     print(data.dtypes)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1148</span>:     &gt;&gt;&gt; data = pd.DataFrame({</pre>
<pre class="cython line score-0">&#xA0;<span class="">1149</span>:     ...     'A': [1, np.nan, 3],</pre>
<pre class="cython line score-0">&#xA0;<span class="">1150</span>:     ...     'B': ['x', 'y', np.nan],</pre>
<pre class="cython line score-0">&#xA0;<span class="">1151</span>:     ...     'C': pd.to_datetime(['2021-01-01', np.nan, '2021-01-03'])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1152</span>:     ... })</pre>
<pre class="cython line score-0">&#xA0;<span class="">1153</span>:     &gt;&gt;&gt; process_data(data)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1154</span>:     """</pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1155</span>:     def decorator(func: Callable) -&gt; Callable:</pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11drop_nan_if_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_11drop_nan_if_1decorator = {"decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_11drop_nan_if_1decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11drop_nan_if_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1155, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1155, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decorator", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1155, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.drop_nan_if.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_11drop_nan_if_decorator(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_11drop_nan_if_decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_21_decorator *__pyx_cur_scope;
  PyObject *__pyx_v_wrapper = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_21_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_21_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_21_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_21_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1155, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_20_drop_nan_if *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("decorator", __pyx_f[0], 1155, 0, <span class='error_goto'>__PYX_ERR(0, 1155, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.drop_nan_if.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_wrapper);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1155,0,<span class='error_goto'>__PYX_ERR(0, 1155, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1155, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1155, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_11drop_nan_if_1decorator, 0, __pyx_n_s_drop_nan_if_locals_decorator, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__78));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_decorator = __pyx_t_2;
  __pyx_t_2 = 0;
/*  */
  __pyx_codeobj__78 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_decorator, 1155, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__78)) __PYX_ERR(0, 1155, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_21_decorator {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_20_drop_nan_if *__pyx_outer_scope;
  PyObject *__pyx_v_func;
};

</pre><pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1156</span>:         @functools.wraps(func)</pre>
<pre class='cython code score-77 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11drop_nan_if_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_11drop_nan_if_9decorator_1wrapper = {"wrapper", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_11drop_nan_if_9decorator_1wrapper, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_11drop_nan_if_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("wrapper (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "wrapper", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_11drop_nan_if_9decorator_wrapper(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_11drop_nan_if_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_21_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_21_decorator *__pyx_outer_scope;
  PyObject *__pyx_v_data = NULL;
  PyObject *__pyx_v_original_dtypes = NULL;
  PyObject *__pyx_v_processed_data = NULL;
  PyObject *__pyx_v_col = NULL;
  PyObject *__pyx_v_dtype = NULL;
  PyObject *__pyx_v_new_args = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_21_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("wrapper", __pyx_f[0], 1156, 0, <span class='error_goto'>__PYX_ERR(0, 1156, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.drop_nan_if.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_original_dtypes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_processed_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_col);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dtype);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_new_args);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1156,0,<span class='error_goto'>__PYX_ERR(0, 1156, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1156, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
/*  */
  __pyx_tuple__75 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_data, __pyx_n_s_original_dtypes, __pyx_n_s_processed_data, __pyx_n_s_col, __pyx_n_s_dtype, __pyx_n_s_new_args);<span class='error_goto'> if (unlikely(!__pyx_tuple__75)) __PYX_ERR(0, 1156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__75);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__75);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_11drop_nan_if_9decorator_1wrapper, 0, __pyx_n_s_drop_nan_if_locals_decorator_loc, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__76));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1156, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_wrapper = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__76 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__75, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_wrapper, 1156, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__76)) __PYX_ERR(0, 1156, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1157</span>:         def wrapper(*args, **kwargs):</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1158</span>:             data = args[0]</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1158,0,<span class='error_goto'>__PYX_ERR(0, 1158, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(__pyx_v_args, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1158, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_data = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1159</span>:             original_dtypes = None</pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(1159,0,<span class='error_goto'>__PYX_ERR(0, 1159, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_original_dtypes = Py_None;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1160</span>:             if isinstance(data, np.ndarray):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1160,0,<span class='error_goto'>__PYX_ERR(0, 1160, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1160, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1161</span>:                 data = pd.DataFrame(data)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(1161,0,<span class='error_goto'>__PYX_ERR(0, 1161, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_data};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1161, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1162</span>:             elif isinstance(data, pd.Series):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1162,0,<span class='error_goto'>__PYX_ERR(0, 1162, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1162, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_3) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1163</span>:                 data = data.to_frame()</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(1163,0,<span class='error_goto'>__PYX_ERR(0, 1163, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_to_frame);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1163, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1163, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1164</span>:             elif not isinstance(data, pd.DataFrame):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1164,0,<span class='error_goto'>__PYX_ERR(0, 1164, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1164, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1164, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = (!__pyx_t_3);
  if (unlikely(__pyx_t_6)) {
/*  */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1165</span>:                 raise TypeError("The first positional argument must be a "</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(1165,0,<span class='error_goto'>__PYX_ERR(0, 1165, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__73, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1165, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1165, __pyx_L1_error)</span>
/*  */
  __pyx_tuple__73 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_The_first_positional_argument_mu);<span class='error_goto'> if (unlikely(!__pyx_tuple__73)) __PYX_ERR(0, 1165, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__73);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__73);
</pre><pre class="cython line score-0">&#xA0;<span class="">1166</span>:                                 "pandas DataFrame, a numpy array, or a pandas"</pre>
<pre class="cython line score-0">&#xA0;<span class="">1167</span>:                                 " Series.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">1168</span>:             else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1169</span>:                 # Store original data types for later restoration</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1170</span>:                 original_dtypes = data.dtypes</pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(1170,0,<span class='error_goto'>__PYX_ERR(0, 1170, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_dtypes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1170, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_original_dtypes, __pyx_t_2);
    __pyx_t_2 = 0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1171</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1172</span>:             if meth == 'drop_rows':</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(1172,0,<span class='error_goto'>__PYX_ERR(0, 1172, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_meth)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("meth"); <span class='error_goto'>__PYX_ERR(0, 1172, __pyx_L1_error)</span> }
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_meth, __pyx_n_u_drop_rows, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1172, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/*  */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1173</span>:                 processed_data = data.dropna(axis=0, thresh=len(data.columns) * thresh)</pre>
<pre class='cython code score-32 '>    <span class='trace'>__Pyx_TraceLine</span>(1173,0,<span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_dropna);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1173, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_7 * __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_thresh));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_thresh, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1173, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_processed_data = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1174</span>:             elif meth == 'drop_cols':</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(1174,0,<span class='error_goto'>__PYX_ERR(0, 1174, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_meth)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("meth"); <span class='error_goto'>__PYX_ERR(0, 1174, __pyx_L1_error)</span> }
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_meth, __pyx_n_u_drop_cols, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1174, __pyx_L1_error)</span>
  if (likely(__pyx_t_6)) {
/*  */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1175</span>:                 processed_data = data.dropna(axis=1, thresh=len(data) * thresh)</pre>
<pre class='cython code score-29 '>    <span class='trace'>__Pyx_TraceLine</span>(1175,0,<span class='error_goto'>__PYX_ERR(0, 1175, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_dropna);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1175, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_7 * __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_thresh));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_thresh, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1175, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1175, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_processed_data = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1176</span>:             else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1177</span>:                 raise ValueError("Method argument 'meth' must be either 'drop_rows' or 'drop_cols'.")</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(1177,0,<span class='error_goto'>__PYX_ERR(0, 1177, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__74, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1177, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1177, __pyx_L1_error)</span>
  }
  __pyx_L4:;
/*  */
  __pyx_tuple__74 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Method_argument_meth_must_be_eit);<span class='error_goto'> if (unlikely(!__pyx_tuple__74)) __PYX_ERR(0, 1177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__74);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__74);
</pre><pre class="cython line score-0">&#xA0;<span class="">1178</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1179</span>:             # Restore original data types</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1180</span>:             if original_dtypes is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1180,0,<span class='error_goto'>__PYX_ERR(0, 1180, __pyx_L1_error)</span>)
  __pyx_t_6 = (__pyx_v_original_dtypes != Py_None);
  if (__pyx_t_6) {
/*  */
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1181</span>:                 for col, dtype in original_dtypes.items():</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(1181,0,<span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>)
    __pyx_t_7 = 0;
    if (unlikely(__pyx_v_original_dtypes == Py_None)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "items");
      <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
    }
    __pyx_t_4 = __Pyx_dict_iterator(__pyx_v_original_dtypes, 0, __pyx_n_s_items, (&amp;__pyx_t_8), (&amp;__pyx_t_5));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
    __pyx_t_2 = __pyx_t_4;
    __pyx_t_4 = 0;
    while (1) {
      __pyx_t_9 = __Pyx_dict_iter_next(__pyx_t_2, __pyx_t_8, &amp;__pyx_t_7, &amp;__pyx_t_4, &amp;__pyx_t_1, NULL, __pyx_t_5);
      if (unlikely(__pyx_t_9 == 0)) break;
      if (unlikely(__pyx_t_9 == -1)) <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col, __pyx_t_4);
      __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_dtype, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1182</span>:                     if col in processed_data.columns:</pre>
<pre class='cython code score-6 '>      <span class='trace'>__Pyx_TraceLine</span>(1182,0,<span class='error_goto'>__PYX_ERR(0, 1182, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_processed_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1182, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_col, __pyx_t_1, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1182, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_6) {
/*  */
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1183</span>:                         processed_data[col] = processed_data[col].astype(dtype)</pre>
<pre class='cython code score-25 '>        <span class='trace'>__Pyx_TraceLine</span>(1183,0,<span class='error_goto'>__PYX_ERR(0, 1183, __pyx_L1_error)</span>)
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_processed_data, __pyx_v_col);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1183, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1183, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = NULL;
        __pyx_t_9 = 0;
        #if CYTHON_UNPACK_METHODS
        if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
            __pyx_t_9 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_dtype};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1183, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        }
        if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_processed_data, __pyx_v_col, __pyx_t_1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1183, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1184</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1185</span>:             new_args = (processed_data,) + args[1:]</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(1185,0,<span class='error_goto'>__PYX_ERR(0, 1185, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1185, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_processed_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_processed_data);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_processed_data)) <span class='error_goto'>__PYX_ERR(0, 1185, __pyx_L1_error)</span>;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyTuple_GetSlice</span>(__pyx_v_args, 1, PY_SSIZE_T_MAX);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1185, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1185, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_new_args = ((PyObject*)__pyx_t_10);
  __pyx_t_10 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1186</span>:             return func(*new_args, **kwargs)</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1186,0,<span class='error_goto'>__PYX_ERR(0, 1186, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 1186, __pyx_L1_error)</span> }
  __pyx_t_10 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_new_args, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1187</span>:         return wrapper</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1187,0,<span class='error_goto'>__PYX_ERR(0, 1187, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wrapper);
  __pyx_r = __pyx_v_wrapper;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1188</span>:     return decorator</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1188,0,<span class='error_goto'>__PYX_ERR(0, 1188, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorator);
  __pyx_r = __pyx_v_decorator;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1189</span>: </pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1190</span>: def conditional_apply(</pre>
<pre class='cython code score-57 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_45conditional_apply(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_44conditional_apply, "\n    Decorator that conditionally applies the decorated function based \n    on a predicate.\n    \n    If the predicate returns False, a default value is returned instead.\n\n    Parameters\n    ----------\n    predicate : Callable[[Any], bool]\n        A function that takes the same arguments as the decorated function and\n        returns True if the function should be applied, False otherwise.\n    default_value : Any, optional\n        The value to return if the predicate evaluates to False. Default is None.\n\n    Returns\n    -------\n    Callable\n        The decorated function with conditional application logic.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import conditional_apply\n    &gt;&gt;&gt; @conditional_apply(predicate=lambda x: x &gt; 0, default_value=0)\n    ... def reciprocal(x):\n    ...     return 1 / x\n    &gt;&gt;&gt; print(reciprocal(2))\n    0.5\n    &gt;&gt;&gt; print(reciprocal(-1))\n    0\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_45conditional_apply = {"conditional_apply", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_45conditional_apply, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_44conditional_apply};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_45conditional_apply(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_predicate = 0;
  PyObject *__pyx_v_default_value = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("conditional_apply (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_predicate,&amp;__pyx_n_s_default_value,0};
  PyObject* values[2] = {0,0};
/*  */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_44conditional_apply(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_predicate, PyObject *__pyx_v_default_value) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_22_conditional_apply *__pyx_cur_scope;
  PyObject *__pyx_v_decorator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__80)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_22_conditional_apply *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_22_conditional_apply(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_22_conditional_apply, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_22_conditional_apply *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("conditional_apply", __pyx_f[0], 1190, 0, <span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_predicate = __pyx_v_predicate;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_predicate);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_predicate);
  __pyx_cur_scope-&gt;__pyx_v_default_value = __pyx_v_default_value;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_default_value);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_default_value);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.conditional_apply", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_decorator);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__174 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_predicate, __pyx_n_s_default_value, __pyx_n_s_decorator, __pyx_n_s_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__174)) __PYX_ERR(0, 1190, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__174);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__174);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1190,0,<span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1190, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_predicate, __pyx_kp_s_Callable_Any_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_default_value, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_45conditional_apply, 0, __pyx_n_s_conditional_apply, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__80));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1190, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_5, __pyx_tuple__139);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_conditional_apply, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__80 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__174, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_conditional_apply, 1190, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__80)) __PYX_ERR(0, 1190, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_22_conditional_apply {
  PyObject_HEAD
  PyObject *__pyx_v_default_value;
  PyObject *__pyx_v_predicate;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">1191</span>:         predicate: Callable[[Any], bool],</pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1192</span>:         default_value: Any = None</pre>
<pre class='cython code score-38 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_predicate)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_default_value);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "conditional_apply") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_predicate = values[0];
    __pyx_v_default_value = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("conditional_apply", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1190, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.conditional_apply", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_44conditional_apply(__pyx_self, __pyx_v_predicate, __pyx_v_default_value);
</pre><pre class="cython line score-0">&#xA0;<span class="">1193</span>:         ) -&gt; Callable:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1194</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1195</span>:     Decorator that conditionally applies the decorated function based</pre>
<pre class="cython line score-0">&#xA0;<span class="">1196</span>:     on a predicate.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1198</span>:     If the predicate returns False, a default value is returned instead.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1199</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1200</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1201</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1202</span>:     predicate : Callable[[Any], bool]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1203</span>:         A function that takes the same arguments as the decorated function and</pre>
<pre class="cython line score-0">&#xA0;<span class="">1204</span>:         returns True if the function should be applied, False otherwise.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1205</span>:     default_value : Any, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1206</span>:         The value to return if the predicate evaluates to False. Default is None.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1207</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1208</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1209</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1210</span>:     Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">1211</span>:         The decorated function with conditional application logic.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1213</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1214</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1215</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import conditional_apply</pre>
<pre class="cython line score-0">&#xA0;<span class="">1216</span>:     &gt;&gt;&gt; @conditional_apply(predicate=lambda x: x &gt; 0, default_value=0)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1217</span>:     ... def reciprocal(x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1218</span>:     ...     return 1 / x</pre>
<pre class="cython line score-0">&#xA0;<span class="">1219</span>:     &gt;&gt;&gt; print(reciprocal(2))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1220</span>:     0.5</pre>
<pre class="cython line score-0">&#xA0;<span class="">1221</span>:     &gt;&gt;&gt; print(reciprocal(-1))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1222</span>:     0</pre>
<pre class="cython line score-0">&#xA0;<span class="">1223</span>:     """</pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1224</span>:     def decorator(func: Callable) -&gt; Callable:</pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17conditional_apply_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_17conditional_apply_1decorator = {"decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_17conditional_apply_1decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17conditional_apply_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decorator", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.conditional_apply.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_17conditional_apply_decorator(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_17conditional_apply_decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_23_decorator *__pyx_cur_scope;
  PyObject *__pyx_v_wrapper = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_23_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_23_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_23_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_23_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_22_conditional_apply *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("decorator", __pyx_f[0], 1224, 0, <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.conditional_apply.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_wrapper);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1224,0,<span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1224, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_17conditional_apply_1decorator, 0, __pyx_n_s_conditional_apply_locals_decorat_2, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__81));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1224, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_decorator = __pyx_t_2;
  __pyx_t_2 = 0;
/*  */
  __pyx_codeobj__81 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_decorator, 1224, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__81)) __PYX_ERR(0, 1224, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_23_decorator {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_22_conditional_apply *__pyx_outer_scope;
  PyObject *__pyx_v_func;
};

</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1225</span>:         @functools.wraps(func)</pre>
<pre class='cython code score-64 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17conditional_apply_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_17conditional_apply_9decorator_1wrapper = {"wrapper", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_17conditional_apply_9decorator_1wrapper, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17conditional_apply_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("wrapper (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "wrapper", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_17conditional_apply_9decorator_wrapper(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_17conditional_apply_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_23_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_23_decorator *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_23_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("wrapper", __pyx_f[0], 1225, 0, <span class='error_goto'>__PYX_ERR(0, 1225, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.conditional_apply.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1225,0,<span class='error_goto'>__PYX_ERR(0, 1225, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1225, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1225, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1225, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_17conditional_apply_9decorator_1wrapper, 0, __pyx_n_s_conditional_apply_locals_decorat, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__79));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1225, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1225, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_wrapper = __pyx_t_1;
  __pyx_t_1 = 0;
/*  */
  __pyx_codeobj__79 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple_, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_wrapper, 1225, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__79)) __PYX_ERR(0, 1225, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1226</span>:         def wrapper(*args, **kwargs):</pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1227</span>:             if predicate(*args, **kwargs):</pre>
<pre class='cython code score-13 '>  <span class='trace'>__Pyx_TraceLine</span>(1227,0,<span class='error_goto'>__PYX_ERR(0, 1227, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_predicate)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("predicate"); <span class='error_goto'>__PYX_ERR(0, 1227, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1227, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_predicate, __pyx_v_args, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1227, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1227, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1228</span>:                 return func(*args, **kwargs)</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(1228,0,<span class='error_goto'>__PYX_ERR(0, 1228, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 1228, __pyx_L1_error)</span> }
    __pyx_t_2 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1228, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1228, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1229</span>:             else:</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1230</span>:                 return default_value</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(1230,0,<span class='error_goto'>__PYX_ERR(0, 1230, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_default_value)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("default_value"); <span class='error_goto'>__PYX_ERR(0, 1230, __pyx_L1_error)</span> }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_default_value);
    __pyx_r = __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_default_value;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1231</span>:         return wrapper</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1231,0,<span class='error_goto'>__PYX_ERR(0, 1231, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wrapper);
  __pyx_r = __pyx_v_wrapper;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1232</span>:     return decorator</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1232,0,<span class='error_goto'>__PYX_ERR(0, 1232, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorator);
  __pyx_r = __pyx_v_decorator;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1233</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1234</span>: </pre>
<pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1235</span>: def apply_transform(</pre>
<pre class='cython code score-71 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_47apply_transform(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_46apply_transform, "\n    Creates a callable that applies a sequence of transformation functions \n    to its input.\n\n    Parameters\n    ----------\n    transformations : List[Callable]\n        A list of functions that will be applied sequentially to the input data.\n\n    Returns\n    -------\n    Callable\n        A new function that takes input data and applies each transformation \n        in sequence.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import apply_transform\n    &gt;&gt;&gt; def square(x):\n    ...     return x ** 2\n    &gt;&gt;&gt; def increment(x):\n    ...     return x + 1\n    &gt;&gt;&gt; transform = apply_transform([square, increment])\n    &gt;&gt;&gt; print(transform(4))\n    17\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_47apply_transform = {"apply_transform", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_47apply_transform, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_46apply_transform};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_47apply_transform(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_transformations = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("apply_transform (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_transformations,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_transformations)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1235, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "apply_transform") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1235, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_transformations = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("apply_transform", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1235, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.apply_transform", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_46apply_transform(__pyx_self, __pyx_v_transformations);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_46apply_transform(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_transformations) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_24_apply_transform *__pyx_cur_scope;
  PyObject *__pyx_v_transformed_callable = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__82)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_24_apply_transform *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_24_apply_transform(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_24_apply_transform, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_24_apply_transform *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1235, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("apply_transform", __pyx_f[0], 1235, 0, <span class='error_goto'>__PYX_ERR(0, 1235, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_transformations = __pyx_v_transformations;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_transformations);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_transformations);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.apply_transform", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_transformed_callable);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__175 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_transformations, __pyx_n_s_transformed_callable, __pyx_n_s_transformed_callable);<span class='error_goto'> if (unlikely(!__pyx_tuple__175)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__175);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__175);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1235,0,<span class='error_goto'>__PYX_ERR(0, 1235, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_transformations, __pyx_kp_s_List_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1235, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1235, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_47apply_transform, 0, __pyx_n_s_apply_transform, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__82));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_apply_transform, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1235, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__82 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__175, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_apply_transform, 1235, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__82)) __PYX_ERR(0, 1235, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_24_apply_transform {
  PyObject_HEAD
  PyObject *__pyx_v_transformations;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">1236</span>:         transformations: List[Callable]) -&gt; Callable:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1237</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1238</span>:     Creates a callable that applies a sequence of transformation functions</pre>
<pre class="cython line score-0">&#xA0;<span class="">1239</span>:     to its input.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1240</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1241</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1242</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1243</span>:     transformations : List[Callable]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1244</span>:         A list of functions that will be applied sequentially to the input data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1245</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1246</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1247</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1248</span>:     Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">1249</span>:         A new function that takes input data and applies each transformation</pre>
<pre class="cython line score-0">&#xA0;<span class="">1250</span>:         in sequence.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1251</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1252</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1253</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1254</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import apply_transform</pre>
<pre class="cython line score-0">&#xA0;<span class="">1255</span>:     &gt;&gt;&gt; def square(x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1256</span>:     ...     return x ** 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1257</span>:     &gt;&gt;&gt; def increment(x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1258</span>:     ...     return x + 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1259</span>:     &gt;&gt;&gt; transform = apply_transform([square, increment])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1260</span>:     &gt;&gt;&gt; print(transform(4))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1261</span>:     17</pre>
<pre class="cython line score-0">&#xA0;<span class="">1262</span>:     """</pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1263</span>:     def transformed_callable(data):</pre>
<pre class='cython code score-53 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15apply_transform_1transformed_callable(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_15apply_transform_1transformed_callable = {"transformed_callable", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_15apply_transform_1transformed_callable, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15apply_transform_1transformed_callable(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("transformed_callable (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "transformed_callable") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_data = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("transformed_callable", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.apply_transform.transformed_callable", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_15apply_transform_transformed_callable(__pyx_self, __pyx_v_data);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_15apply_transform_transformed_callable(PyObject *__pyx_self, PyObject *__pyx_v_data) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_24_apply_transform *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_24_apply_transform *__pyx_outer_scope;
  PyObject *__pyx_v_transform = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_24_apply_transform *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("transformed_callable", __pyx_f[0], 1263, 0, <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.apply_transform.transformed_callable", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_transform);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__83 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_data, __pyx_n_s_transform);<span class='error_goto'> if (unlikely(!__pyx_tuple__83)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__83);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__83);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1263,0,<span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_15apply_transform_1transformed_callable, 0, __pyx_n_s_apply_transform_locals_transform, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__84));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_transformed_callable = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__84 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_transformed_callable, 1263, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__84)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1264</span>:         for transform in transformations:</pre>
<pre class='cython code score-51 '>  <span class='trace'>__Pyx_TraceLine</span>(1264,0,<span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_transformations)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("transformations"); <span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span> }
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_v_transformations)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_v_transformations)) {
    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_v_transformations; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope-&gt;__pyx_v_transformations);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1264, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1264, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1264, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1264, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_transform, __pyx_t_4);
    __pyx_t_4 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(1264,0,<span class='error_goto'>__PYX_ERR(0, 1264, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1265</span>:             data = transform(data)</pre>
<pre class='cython code score-16 '>    <span class='trace'>__Pyx_TraceLine</span>(1265,0,<span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_transform);
    __pyx_t_5 = __pyx_v_transform; __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_v_data};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1265, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1266</span>:         return data</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1266,0,<span class='error_goto'>__PYX_ERR(0, 1266, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  __pyx_r = __pyx_v_data;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1267</span>:     return transformed_callable</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1267,0,<span class='error_goto'>__PYX_ERR(0, 1267, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_transformed_callable);
  __pyx_r = __pyx_v_transformed_callable;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1268</span>: </pre>
<pre class="cython line score-100" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1269</span>: def make_data_dynamic(</pre>
<pre class='cython code score-100 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_49make_data_dynamic(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_48make_data_dynamic, "\n    A decorator for preprocessing data before passing it to a function, \n    with options for data type filtering, column selection, missing value \n    handling, and index resetting.\n\n    Parameters\n    ----------\n    expected_type : str, optional\n        Specifies the type of data the function expects: 'numeric' for numeric \n        data, 'categorical' for categorical data, or 'both' for no filtering. \n        Defaults to 'numeric'.\n    capture_columns : bool, optional\n        If True, uses the 'columns' keyword argument from the decorated function to \n        filter the DataFrame columns. Defaults to False.\n    drop_na : bool, optional\n        If True, applies missing value handling according to `meth` and `thresh`. \n        Defaults to False.\n    na_thresh : Optional[float], optional\n        Threshold for dropping rows or columns based on the proportion of missing \n        values. Used only if `drop_na` is True. Defaults to None, meaning no threshold.\n    na_meth : str, optional\n        Method for dropping missing values: 'drop_rows' to drop rows with missing \n        values, 'drop_cols' to drop columns with missing values, or any other value \n        to drop all missing values without thresholding. Defaults to 'drop_rows'.\n    reset_index : bool, optional\n        If True, resets the DataFrame index (dropping the current index) before \n        passing it to the function. Defaults to False.\n    dynamize: bool,\n        If True, the preprocessing function is attached as a method to the \n        pandas DataFrame class, allowing it to be called directly on DataFrame\n        instances. This enhances the integration and usability of the function\n        within pandas workflows, making it more accessible as part of \n        DataFrame's method chain. Defaults to True.\n    force_df: bool  \n       Determines the output format for single-column data frames. \n       If set to `True`, the function will always return a DataFrame, even if ""\n       it consists of a single column. If set to `False`, single-column \n       DataFrames may be converted to a Series, providing a more streamlined \n       representation. This option allows for flexibility in handling the \n       output format, catering to different preferences or requirements \n       for subsequent data processing steps. Default is False.\n\n       \n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import make_data_dynamic \n    &gt;&gt;&gt; @make_data_dynamic(expected_type='numeric', capture_columns=True, \n    ... drop_na=True, thresh=0.5, meth='drop_rows', reset_index=True)\n    ... def calculate_mean(data: Union[pd.DataFrame, np.ndarray]):\n    ...     return data.mean()\n    \n    &gt;&gt;&gt; data = pd.DataFrame({\"A\": [1, 2, np.nan], \"B\": [np.nan, 5, 6]})\n    &gt;&gt;&gt; print(calculate_mean(data))\n    # This will calculate the mean after preprocessing the input data \n    # according to the specified rules.\n\n    The decorated function seamlessly preprocesses input data, ensuring \n    that it meets the specified criteria for data type, column selection, \n    missing value handling, and index state.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_49make_data_dynamic = {"make_data_dynamic", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_49make_data_dynamic, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_48make_data_dynamic};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_49make_data_dynamic(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_expected_type = 0;
  PyObject *__pyx_v_capture_columns = 0;
  PyObject *__pyx_v_drop_na = 0;
  PyObject *__pyx_v_na_thresh = 0;
  PyObject *__pyx_v_na_meth = 0;
  PyObject *__pyx_v_reset_index = 0;
  PyObject *__pyx_v_dynamize = 0;
  PyObject *__pyx_v_force_df = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("make_data_dynamic (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_expected_type,&amp;__pyx_n_s_capture_columns,&amp;__pyx_n_s_drop_na,&amp;__pyx_n_s_na_thresh,&amp;__pyx_n_s_na_meth,&amp;__pyx_n_s_reset_index,&amp;__pyx_n_s_dynamize,&amp;__pyx_n_s_force_df,0};
  PyObject* values[8] = {0,0,0,0,0,0,0,0};
    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_numeric)));
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_48make_data_dynamic(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_expected_type, PyObject *__pyx_v_capture_columns, PyObject *__pyx_v_drop_na, PyObject *__pyx_v_na_thresh, PyObject *__pyx_v_na_meth, PyObject *__pyx_v_reset_index, PyObject *__pyx_v_dynamize, PyObject *__pyx_v_force_df) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_25_make_data_dynamic *__pyx_cur_scope;
  PyObject *__pyx_v_decorator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__88)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_25_make_data_dynamic *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_25_make_data_dynamic(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_25_make_data_dynamic, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_25_make_data_dynamic *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("make_data_dynamic", __pyx_f[0], 1269, 0, <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_expected_type = __pyx_v_expected_type;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_expected_type);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_expected_type);
  __pyx_cur_scope-&gt;__pyx_v_capture_columns = __pyx_v_capture_columns;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_capture_columns);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_capture_columns);
  __pyx_cur_scope-&gt;__pyx_v_drop_na = __pyx_v_drop_na;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_drop_na);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_drop_na);
  __pyx_cur_scope-&gt;__pyx_v_na_thresh = __pyx_v_na_thresh;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_na_thresh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_na_thresh);
  __pyx_cur_scope-&gt;__pyx_v_na_meth = __pyx_v_na_meth;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_na_meth);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_na_meth);
  __pyx_cur_scope-&gt;__pyx_v_reset_index = __pyx_v_reset_index;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_reset_index);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_reset_index);
  __pyx_cur_scope-&gt;__pyx_v_dynamize = __pyx_v_dynamize;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_dynamize);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_dynamize);
  __pyx_cur_scope-&gt;__pyx_v_force_df = __pyx_v_force_df;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_force_df);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_force_df);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.make_data_dynamic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_decorator);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__176 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_expected_type, __pyx_n_s_capture_columns, __pyx_n_s_drop_na, __pyx_n_s_na_thresh, __pyx_n_s_na_meth, __pyx_n_s_reset_index, __pyx_n_s_dynamize, __pyx_n_s_force_df, __pyx_n_s_decorator, __pyx_n_s_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__176)) __PYX_ERR(0, 1269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__176);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__176);
  __pyx_codeobj__88 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__176, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_make_data_dynamic, 1269, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__88)) __PYX_ERR(0, 1269, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1269,0,<span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_expected_type, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_capture_columns, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_drop_na, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_na_thresh, __pyx_kp_s_Optional_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_na_meth, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_reset_index, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dynamize, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_force_df, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_49make_data_dynamic, 0, __pyx_n_s_make_data_dynamic, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__88));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_5, __pyx_tuple__177);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_make_data_dynamic, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_tuple__177 = <span class='py_c_api'>PyTuple_Pack</span>(8, ((PyObject*)__pyx_n_u_numeric), ((PyObject *)Py_False), ((PyObject *)Py_False), Py_None, ((PyObject*)__pyx_n_u_drop_rows), ((PyObject *)Py_False), ((PyObject *)Py_True), ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__177)) __PYX_ERR(0, 1269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__177);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__177);
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_25_make_data_dynamic {
  PyObject_HEAD
  PyObject *__pyx_v_capture_columns;
  PyObject *__pyx_v_drop_na;
  PyObject *__pyx_v_dynamize;
  PyObject *__pyx_v_expected_type;
  PyObject *__pyx_v_force_df;
  PyObject *__pyx_v_na_meth;
  PyObject *__pyx_v_na_thresh;
  PyObject *__pyx_v_reset_index;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">1270</span>:     expected_type: str = 'numeric',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1271</span>:     capture_columns: bool = False,</pre>
<pre class='cython code score-2 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1272</span>:     drop_na: bool = False,</pre>
<pre class='cython code score-2 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1273</span>:     na_thresh: Optional[float] = None,</pre>
<pre class='cython code score-4 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_drop_rows)));
</pre><pre class="cython line score-0">&#xA0;<span class="">1274</span>:     na_meth: str = 'drop_rows',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1275</span>:     reset_index: bool = False,</pre>
<pre class='cython code score-2 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1276</span>:     dynamize: bool=True,</pre>
<pre class='cython code score-2 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
</pre><pre class="cython line score-120" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1277</span>:     force_df: bool=False,</pre>
<pre class='cython code score-120 '>    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_expected_type);
          if (value) { values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_capture_columns);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_drop_na);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_na_thresh);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_na_meth);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_reset_index);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dynamize);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_force_df);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "make_data_dynamic") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_expected_type = ((PyObject*)values[0]);
    __pyx_v_capture_columns = values[1];
    __pyx_v_drop_na = values[2];
    __pyx_v_na_thresh = values[3];
    __pyx_v_na_meth = ((PyObject*)values[4]);
    __pyx_v_reset_index = values[5];
    __pyx_v_dynamize = values[6];
    __pyx_v_force_df = values[7];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_data_dynamic", 0, 0, 8, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1269, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.make_data_dynamic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_expected_type), (&amp;PyUnicode_Type), 0, "expected_type", 1))) <span class='error_goto'>__PYX_ERR(0, 1270, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_na_meth), (&amp;PyUnicode_Type), 0, "na_meth", 1))) <span class='error_goto'>__PYX_ERR(0, 1274, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_48make_data_dynamic(__pyx_self, __pyx_v_expected_type, __pyx_v_capture_columns, __pyx_v_drop_na, __pyx_v_na_thresh, __pyx_v_na_meth, __pyx_v_reset_index, __pyx_v_dynamize, __pyx_v_force_df);
</pre><pre class="cython line score-0">&#xA0;<span class="">1278</span>: ) -&gt; Callable:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1279</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1280</span>:     A decorator for preprocessing data before passing it to a function,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1281</span>:     with options for data type filtering, column selection, missing value</pre>
<pre class="cython line score-0">&#xA0;<span class="">1282</span>:     handling, and index resetting.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1283</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1284</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1285</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1286</span>:     expected_type : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1287</span>:         Specifies the type of data the function expects: 'numeric' for numeric</pre>
<pre class="cython line score-0">&#xA0;<span class="">1288</span>:         data, 'categorical' for categorical data, or 'both' for no filtering.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1289</span>:         Defaults to 'numeric'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1290</span>:     capture_columns : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1291</span>:         If True, uses the 'columns' keyword argument from the decorated function to</pre>
<pre class="cython line score-0">&#xA0;<span class="">1292</span>:         filter the DataFrame columns. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1293</span>:     drop_na : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1294</span>:         If True, applies missing value handling according to `meth` and `thresh`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1295</span>:         Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1296</span>:     na_thresh : Optional[float], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1297</span>:         Threshold for dropping rows or columns based on the proportion of missing</pre>
<pre class="cython line score-0">&#xA0;<span class="">1298</span>:         values. Used only if `drop_na` is True. Defaults to None, meaning no threshold.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1299</span>:     na_meth : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1300</span>:         Method for dropping missing values: 'drop_rows' to drop rows with missing</pre>
<pre class="cython line score-0">&#xA0;<span class="">1301</span>:         values, 'drop_cols' to drop columns with missing values, or any other value</pre>
<pre class="cython line score-0">&#xA0;<span class="">1302</span>:         to drop all missing values without thresholding. Defaults to 'drop_rows'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1303</span>:     reset_index : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1304</span>:         If True, resets the DataFrame index (dropping the current index) before</pre>
<pre class="cython line score-0">&#xA0;<span class="">1305</span>:         passing it to the function. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1306</span>:     dynamize: bool,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1307</span>:         If True, the preprocessing function is attached as a method to the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1308</span>:         pandas DataFrame class, allowing it to be called directly on DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">1309</span>:         instances. This enhances the integration and usability of the function</pre>
<pre class="cython line score-0">&#xA0;<span class="">1310</span>:         within pandas workflows, making it more accessible as part of</pre>
<pre class="cython line score-0">&#xA0;<span class="">1311</span>:         DataFrame's method chain. Defaults to True.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1312</span>:     force_df: bool</pre>
<pre class="cython line score-0">&#xA0;<span class="">1313</span>:        Determines the output format for single-column data frames.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1314</span>:        If set to `True`, the function will always return a DataFrame, even if</pre>
<pre class="cython line score-0">&#xA0;<span class="">1315</span>:        it consists of a single column. If set to `False`, single-column</pre>
<pre class="cython line score-0">&#xA0;<span class="">1316</span>:        DataFrames may be converted to a Series, providing a more streamlined</pre>
<pre class="cython line score-0">&#xA0;<span class="">1317</span>:        representation. This option allows for flexibility in handling the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1318</span>:        output format, catering to different preferences or requirements</pre>
<pre class="cython line score-0">&#xA0;<span class="">1319</span>:        for subsequent data processing steps. Default is False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1320</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1321</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1322</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1323</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1324</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1325</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import make_data_dynamic</pre>
<pre class="cython line score-0">&#xA0;<span class="">1326</span>:     &gt;&gt;&gt; @make_data_dynamic(expected_type='numeric', capture_columns=True,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1327</span>:     ... drop_na=True, thresh=0.5, meth='drop_rows', reset_index=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1328</span>:     ... def calculate_mean(data: Union[pd.DataFrame, np.ndarray]):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1329</span>:     ...     return data.mean()</pre>
<pre class="cython line score-0">&#xA0;<span class="">1330</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1331</span>:     &gt;&gt;&gt; data = pd.DataFrame({"A": [1, 2, np.nan], "B": [np.nan, 5, 6]})</pre>
<pre class="cython line score-0">&#xA0;<span class="">1332</span>:     &gt;&gt;&gt; print(calculate_mean(data))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1333</span>:     # This will calculate the mean after preprocessing the input data</pre>
<pre class="cython line score-0">&#xA0;<span class="">1334</span>:     # according to the specified rules.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1335</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1336</span>:     The decorated function seamlessly preprocesses input data, ensuring</pre>
<pre class="cython line score-0">&#xA0;<span class="">1337</span>:     that it meets the specified criteria for data type, column selection,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1338</span>:     missing value handling, and index state.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1339</span>:     """</pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1340</span>:     def decorator(func: Callable) -&gt; Callable:</pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17make_data_dynamic_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_17make_data_dynamic_1decorator = {"decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_17make_data_dynamic_1decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17make_data_dynamic_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decorator", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.make_data_dynamic.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_17make_data_dynamic_decorator(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_17make_data_dynamic_decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_26_decorator *__pyx_cur_scope;
  PyObject *__pyx_v_wrapper = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_26_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_26_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_26_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_26_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_25_make_data_dynamic *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("decorator", __pyx_f[0], 1340, 0, <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.make_data_dynamic.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_wrapper);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1340,0,<span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1340, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_17make_data_dynamic_1decorator, 0, __pyx_n_s_make_data_dynamic_locals_decorat_2, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__89));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1340, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_decorator = __pyx_t_2;
  __pyx_t_2 = 0;
/*  */
  __pyx_codeobj__89 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_decorator, 1340, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__89)) __PYX_ERR(0, 1340, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_26_decorator {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_25_make_data_dynamic *__pyx_outer_scope;
  PyObject *__pyx_v_func;
};

</pre><pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1341</span>:         @functools.wraps(func)</pre>
<pre class='cython code score-73 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17make_data_dynamic_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_17make_data_dynamic_9decorator_1wrapper = {"wrapper", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_17make_data_dynamic_9decorator_1wrapper, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_17make_data_dynamic_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("wrapper (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "wrapper", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_17make_data_dynamic_9decorator_wrapper(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_17make_data_dynamic_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_26_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_26_decorator *__pyx_outer_scope;
  PyObject *__pyx_v_data = NULL;
  PyObject *__pyx_v_new_args = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_26_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("wrapper", __pyx_f[0], 1341, 0, <span class='error_goto'>__PYX_ERR(0, 1341, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.make_data_dynamic.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_new_args);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1341,0,<span class='error_goto'>__PYX_ERR(0, 1341, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1341, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1341, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1341, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
/*  */
  __pyx_tuple__86 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_data, __pyx_n_s_new_args);<span class='error_goto'> if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 1341, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__86);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__86);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_17make_data_dynamic_9decorator_1wrapper, 0, __pyx_n_s_make_data_dynamic_locals_decorat, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__87));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1341, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1341, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_wrapper = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__87 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__86, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_wrapper, 1341, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__87)) __PYX_ERR(0, 1341, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1342</span>:         def wrapper(*args, **kwargs):</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1343</span>:             if not args:</pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(1343,0,<span class='error_goto'>__PYX_ERR(0, 1343, __pyx_L1_error)</span>)
  __pyx_t_1 = (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_args) != 0);
  __pyx_t_2 = (!__pyx_t_1);
  if (unlikely(__pyx_t_2)) {
/*  */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1344</span>:                 raise ValueError("Function requires at least one argument.")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(1344,0,<span class='error_goto'>__PYX_ERR(0, 1344, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__85, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1344, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1344, __pyx_L1_error)</span>
/*  */
  __pyx_tuple__85 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Function_requires_at_least_one_a);<span class='error_goto'> if (unlikely(!__pyx_tuple__85)) __PYX_ERR(0, 1344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__85);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__85);
</pre><pre class="cython line score-0">&#xA0;<span class="">1345</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1346</span>:             data = _check_and_convert_input(args[0])</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(1346,0,<span class='error_goto'>__PYX_ERR(0, 1346, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_check_and_convert_input);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(__pyx_v_args, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_5};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1346, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_v_data = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1347</span>:             data = _preprocess_data(</pre>
<pre class='cython code score-34 '>  <span class='trace'>__Pyx_TraceLine</span>(1347,0,<span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_preprocess_data);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1347, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1347,0,<span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1347, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_data)) <span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_capture_columns);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_capture_columns);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_capture_columns)) <span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_expected_type);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_expected_type);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_expected_type)) <span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_drop_na);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_drop_na);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 3, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_drop_na)) <span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_na_thresh);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_na_thresh);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 4, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_na_thresh)) <span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_na_meth);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_na_meth);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 5, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_na_meth)) <span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_reset_index);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_reset_index);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 6, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_reset_index)) <span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>;
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1347,0,<span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1347, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1348</span>:                 data, capture_columns, expected_type, drop_na, na_thresh,</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(1348,0,<span class='error_goto'>__PYX_ERR(0, 1348, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_capture_columns)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("capture_columns"); <span class='error_goto'>__PYX_ERR(0, 1348, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_expected_type)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("expected_type"); <span class='error_goto'>__PYX_ERR(0, 1348, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_drop_na)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("drop_na"); <span class='error_goto'>__PYX_ERR(0, 1348, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_na_thresh)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("na_thresh"); <span class='error_goto'>__PYX_ERR(0, 1348, __pyx_L1_error)</span> }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1349</span>:                 na_meth, reset_index, **kwargs)</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(1349,0,<span class='error_goto'>__PYX_ERR(0, 1349, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_na_meth)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("na_meth"); <span class='error_goto'>__PYX_ERR(0, 1349, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_reset_index)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("reset_index"); <span class='error_goto'>__PYX_ERR(0, 1349, __pyx_L1_error)</span> }
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1349,0,<span class='error_goto'>__PYX_ERR(0, 1349, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-0">&#xA0;<span class="">1350</span>:             # Infer dataframe to series for single columns.</pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1351</span>:             data= to_pandas(data, convert_single_column= force_df)</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(1351,0,<span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_to_pandas);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_data)) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_force_df)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("force_df"); <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span> }
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_convert_single_column, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_force_df) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1352</span>:             new_args = (data,) + args[1:]</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(1352,0,<span class='error_goto'>__PYX_ERR(0, 1352, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_data)) <span class='error_goto'>__PYX_ERR(0, 1352, __pyx_L1_error)</span>;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyTuple_GetSlice</span>(__pyx_v_args, 1, PY_SSIZE_T_MAX);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_new_args = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1353</span>:             return func(*new_args, **kwargs)</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1353,0,<span class='error_goto'>__PYX_ERR(0, 1353, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 1353, __pyx_L1_error)</span> }
  __pyx_t_5 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_new_args, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1354</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1355</span>:         if dynamize:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(1355,0,<span class='error_goto'>__PYX_ERR(0, 1355, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_dynamize)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("dynamize"); <span class='error_goto'>__PYX_ERR(0, 1355, __pyx_L1_error)</span> }
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_dynamize); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1355, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/*  */
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1356</span>:             _add_dynamic_method (wrapper )</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(1356,0,<span class='error_goto'>__PYX_ERR(0, 1356, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_add_dynamic_method);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1356, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_wrapper};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1356, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1357</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1358</span>:         return wrapper</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1358,0,<span class='error_goto'>__PYX_ERR(0, 1358, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wrapper);
  __pyx_r = __pyx_v_wrapper;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1359</span>:     return decorator</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1359,0,<span class='error_goto'>__PYX_ERR(0, 1359, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorator);
  __pyx_r = __pyx_v_decorator;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1360</span>: </pre>
<pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1361</span>: def _check_and_convert_input(input_data):</pre>
<pre class='cython code score-58 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_51_check_and_convert_input(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_50_check_and_convert_input, "\n    Check the type of the input data and convert it to a suitable \n    format for processing.\n    \n    Parameters\n    ----------\n    input_data : any\n        The first argument passed to the decorated function, expected \n        to be either  a pd.DataFrame, dict, np.ndarray, or an iterable that can be \n        converted to an np.ndarray.\n    \n    Returns\n    -------\n    pd.DataFrame\n        The input data converted to a pandas DataFrame for further processing.\n        \n    Raises\n    ------\n    ValueError\n        If the input data is not a pd.DataFrame, dict, np.ndarray, or \n        convertible iterable.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_51_check_and_convert_input = {"_check_and_convert_input", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_51_check_and_convert_input, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_50_check_and_convert_input};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_51_check_and_convert_input(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_input_data = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_check_and_convert_input (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_input_data,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_input_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1361, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_check_and_convert_input") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1361, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_input_data = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_check_and_convert_input", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1361, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_and_convert_input", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_50_check_and_convert_input(__pyx_self, __pyx_v_input_data);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_50_check_and_convert_input(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_input_data) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__90)
  <span class='trace'>__Pyx_TraceCall</span>("_check_and_convert_input", __pyx_f[0], 1361, 0, <span class='error_goto'>__PYX_ERR(0, 1361, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_and_convert_input", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__178 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_input_data);<span class='error_goto'> if (unlikely(!__pyx_tuple__178)) __PYX_ERR(0, 1361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__178);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__178);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1361,0,<span class='error_goto'>__PYX_ERR(0, 1361, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_51_check_and_convert_input, 0, __pyx_n_s_check_and_convert_input, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__90));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_and_convert_input, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1361, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__90 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__178, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_check_and_convert_input, 1361, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__90)) __PYX_ERR(0, 1361, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1362</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1363</span>:     Check the type of the input data and convert it to a suitable</pre>
<pre class="cython line score-0">&#xA0;<span class="">1364</span>:     format for processing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1365</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1366</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1367</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1368</span>:     input_data : any</pre>
<pre class="cython line score-0">&#xA0;<span class="">1369</span>:         The first argument passed to the decorated function, expected</pre>
<pre class="cython line score-0">&#xA0;<span class="">1370</span>:         to be either  a pd.DataFrame, dict, np.ndarray, or an iterable that can be</pre>
<pre class="cython line score-0">&#xA0;<span class="">1371</span>:         converted to an np.ndarray.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1372</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1373</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1374</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1375</span>:     pd.DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">1376</span>:         The input data converted to a pandas DataFrame for further processing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1377</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1378</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">1379</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1380</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">1381</span>:         If the input data is not a pd.DataFrame, dict, np.ndarray, or</pre>
<pre class="cython line score-0">&#xA0;<span class="">1382</span>:         convertible iterable.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1383</span>:     """</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1384</span>:     if isinstance(input_data, (pd.DataFrame, np.ndarray)):</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(1384,0,<span class='error_goto'>__PYX_ERR(0, 1384, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1384, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_input_data, __pyx_t_2); 
  if (!__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_input_data, __pyx_t_3); 
  __pyx_t_4 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_4) {
/*  */
  }
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1385</span>:         return to_numeric_dtypes (pd.DataFrame(input_data))</pre>
<pre class='cython code score-37 '>    <span class='trace'>__Pyx_TraceLine</span>(1385,0,<span class='error_goto'>__PYX_ERR(0, 1385, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_to_numeric_dtypes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1385, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1385, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1385, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    __pyx_t_8 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        __pyx_t_8 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_v_input_data};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1385, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    __pyx_t_7 = NULL;
    __pyx_t_8 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_8 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_1};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1385, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1386</span>:     elif isinstance(input_data, dict):</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1386,0,<span class='error_goto'>__PYX_ERR(0, 1386, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyDict_Check</span>(__pyx_v_input_data); 
  if (__pyx_t_4) {
/*  */
  }
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1387</span>:         return to_numeric_dtypes (pd.DataFrame(input_data))</pre>
<pre class='cython code score-37 '>    <span class='trace'>__Pyx_TraceLine</span>(1387,0,<span class='error_goto'>__PYX_ERR(0, 1387, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_to_numeric_dtypes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1387, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1387, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1387, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    __pyx_t_8 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_8 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_input_data};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1387, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_t_6 = NULL;
    __pyx_t_8 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_8 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_1};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1387, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1388</span>:     elif hasattr(input_data, '__iter__'):  # Check if it's iterable</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1388,0,<span class='error_goto'>__PYX_ERR(0, 1388, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(__pyx_v_input_data, __pyx_n_u_iter);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 1388, __pyx_L1_error)</span>
  if (likely(__pyx_t_4)) {
/*  */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1389</span>:         try:</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(1389,0,<span class='error_goto'>__PYX_ERR(0, 1389, __pyx_L1_error)</span>)
    {
      /*try:*/ {
/*  */
      }
      __pyx_L6_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/*  */
      __pyx_L8_except_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
      goto __pyx_L1_error;
      __pyx_L10_try_return:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_9, __pyx_t_10, __pyx_t_11);
      goto __pyx_L0;
    }
</pre><pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1390</span>:             return to_numeric_dtypes (pd.DataFrame(np.array(input_data)))</pre>
<pre class='cython code score-57 '>        <span class='trace'>__Pyx_TraceLine</span>(1390,0,<span class='error_goto'>__PYX_ERR(0, 1390, __pyx_L6_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_to_numeric_dtypes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1390, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1390, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1390, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_12, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1390, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1390, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = NULL;
        __pyx_t_8 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
          __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
          if (likely(__pyx_t_12)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
            __pyx_t_8 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_v_input_data};
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_13, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1390, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        }
        __pyx_t_13 = NULL;
        __pyx_t_8 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
          __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
          if (likely(__pyx_t_13)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
            __pyx_t_8 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_13, __pyx_t_6};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1390, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        }
        __pyx_t_7 = NULL;
        __pyx_t_8 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_7)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
            __pyx_t_8 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_1};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1390, __pyx_L6_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        }
        __pyx_r = __pyx_t_2;
        __pyx_t_2 = 0;
        goto __pyx_L10_try_return;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1391</span>:         except Exception:</pre>
<pre class='cython code score-6 '>      <span class='trace'>__Pyx_TraceLine</span>(1391,0,<span class='error_goto'>__PYX_ERR(0, 1391, __pyx_L8_except_error)</span>)
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])));
      if (__pyx_t_8) {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_and_convert_input", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_2, &amp;__pyx_t_3, &amp;__pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1391, __pyx_L8_except_error)</span>
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1392</span>:             raise TypeError(</pre>
<pre class='cython code score-10 '>        <span class='trace'>__Pyx_TraceLine</span>(1392,0,<span class='error_goto'>__PYX_ERR(0, 1392, __pyx_L8_except_error)</span>)
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__91, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1392, __pyx_L8_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='error_goto'>__PYX_ERR(0, 1392, __pyx_L8_except_error)</span>
      }
      goto __pyx_L8_except_error;
/*  */
  __pyx_tuple__91 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Expect_the_first_argument_to_be);<span class='error_goto'> if (unlikely(!__pyx_tuple__91)) __PYX_ERR(0, 1392, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__91);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__91);
</pre><pre class="cython line score-0">&#xA0;<span class="">1393</span>:                 "Expect the first argument to be a non-string iterable object"</pre>
<pre class="cython line score-0">&#xA0;<span class="">1394</span>:                  " with minimum samples equal to two.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">1395</span>:     else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1396</span>:         raise ValueError("First argument must be a pd.DataFrame, dict,"</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(1396,0,<span class='error_goto'>__PYX_ERR(0, 1396, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__92, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1396, __pyx_L1_error)</span>
  }
/*  */
  __pyx_tuple__92 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_First_argument_must_be_a_pd_Data);<span class='error_goto'> if (unlikely(!__pyx_tuple__92)) __PYX_ERR(0, 1396, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__92);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__92);
</pre><pre class="cython line score-0">&#xA0;<span class="">1397</span>:                          " np.ndarray, or an iterable object.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">1398</span>: </pre>
<pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1399</span>: def _add_dynamic_method(func):</pre>
<pre class='cython code score-59 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_53_add_dynamic_method(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_52_add_dynamic_method, "\n    Dynamically adds a given function as a method to pandas DataFrame and\n    Series objects. Validates that `func` is callable and logs actions and\n    errors, enhancing robustness and user feedback.\n\n    Parameters\n    ----------\n    func : callable\n        The function to be added as a method. The function's name\n        (`func.__name__`) is used as the method name.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import _add_dynamic_method\n    &gt;&gt;&gt; def example_method(self, multiplier=2):\n    ...     return self * multiplier\n    &gt;&gt;&gt; _add_dynamic_method(example_method)\n    &gt;&gt;&gt; import pandas as pd\n    &gt;&gt;&gt; df = pd.DataFrame([[1, 2], [3, 4]], columns=['A', 'B'])\n    &gt;&gt;&gt; df.example_method(3)\n       A   B\n    0  3   6\n    1  9  12\n    &gt;&gt;&gt; s = pd.Series([1, 2, 3])\n    &gt;&gt;&gt; s.example_method()\n    0    2\n    1    4\n    2    6\n    dtype: int64\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_53_add_dynamic_method = {"_add_dynamic_method", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_53_add_dynamic_method, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_52_add_dynamic_method};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_53_add_dynamic_method(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_add_dynamic_method (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1399, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_add_dynamic_method") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1399, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_add_dynamic_method", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1399, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._add_dynamic_method", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_52_add_dynamic_method(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_52_add_dynamic_method(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_func) {
  PyObject *__pyx_v_pandas_class = NULL;
  PyObject *__pyx_v_method_name = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_error = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__93)
  <span class='trace'>__Pyx_TraceCall</span>("_add_dynamic_method", __pyx_f[0], 1399, 0, <span class='error_goto'>__PYX_ERR(0, 1399, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._add_dynamic_method", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pandas_class);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_method_name);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_error);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__179 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_func, __pyx_n_s_pandas_class, __pyx_n_s_method_name, __pyx_n_s_error);<span class='error_goto'> if (unlikely(!__pyx_tuple__179)) __PYX_ERR(0, 1399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__179);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__179);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1399,0,<span class='error_goto'>__PYX_ERR(0, 1399, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_53_add_dynamic_method, 0, __pyx_n_s_add_dynamic_method, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__93));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1399, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_add_dynamic_method, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1399, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__93 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__179, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_add_dynamic_method, 1399, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__93)) __PYX_ERR(0, 1399, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1400</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1401</span>:     Dynamically adds a given function as a method to pandas DataFrame and</pre>
<pre class="cython line score-0">&#xA0;<span class="">1402</span>:     Series objects. Validates that `func` is callable and logs actions and</pre>
<pre class="cython line score-0">&#xA0;<span class="">1403</span>:     errors, enhancing robustness and user feedback.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1404</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1405</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1406</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1407</span>:     func : callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">1408</span>:         The function to be added as a method. The function's name</pre>
<pre class="cython line score-0">&#xA0;<span class="">1409</span>:         (`func.__name__`) is used as the method name.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1410</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1411</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1412</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1413</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import _add_dynamic_method</pre>
<pre class="cython line score-0">&#xA0;<span class="">1414</span>:     &gt;&gt;&gt; def example_method(self, multiplier=2):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1415</span>:     ...     return self * multiplier</pre>
<pre class="cython line score-0">&#xA0;<span class="">1416</span>:     &gt;&gt;&gt; _add_dynamic_method(example_method)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1417</span>:     &gt;&gt;&gt; import pandas as pd</pre>
<pre class="cython line score-0">&#xA0;<span class="">1418</span>:     &gt;&gt;&gt; df = pd.DataFrame([[1, 2], [3, 4]], columns=['A', 'B'])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1419</span>:     &gt;&gt;&gt; df.example_method(3)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1420</span>:        A   B</pre>
<pre class="cython line score-0">&#xA0;<span class="">1421</span>:     0  3   6</pre>
<pre class="cython line score-0">&#xA0;<span class="">1422</span>:     1  9  12</pre>
<pre class="cython line score-0">&#xA0;<span class="">1423</span>:     &gt;&gt;&gt; s = pd.Series([1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1424</span>:     &gt;&gt;&gt; s.example_method()</pre>
<pre class="cython line score-0">&#xA0;<span class="">1425</span>:     0    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1426</span>:     1    4</pre>
<pre class="cython line score-0">&#xA0;<span class="">1427</span>:     2    6</pre>
<pre class="cython line score-0">&#xA0;<span class="">1428</span>:     dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">1429</span>:     """</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1430</span>:     if not callable(func):</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1430,0,<span class='error_goto'>__PYX_ERR(0, 1430, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_v_func);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 1430, __pyx_L1_error)</span>
  __pyx_t_2 = (!__pyx_t_1);
  if (__pyx_t_2) {
/*  */
  }
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1431</span>:         _logger.error(f"Provided object {func} is not callable and cannot "</pre>
<pre class='cython code score-42 '>    <span class='trace'>__Pyx_TraceLine</span>(1431,0,<span class='error_goto'>__PYX_ERR(0, 1431, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_logger_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1431, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_error);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1431, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1431, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = 0;
    __pyx_t_7 = 127;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Provided_object);
    __pyx_t_6 += 16;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Provided_object);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_kp_u_Provided_object);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_func, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1431, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_8) &gt; __pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_8) : __pyx_t_7;
    __pyx_t_6 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_8);
    __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_is_not_callable_and_cannot_be_a);
    __pyx_t_6 += 49;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_is_not_callable_and_cannot_be_a);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_kp_u_is_not_callable_and_cannot_be_a);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_4, 3, __pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1431, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_9 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_9 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_8};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1431, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1432</span>:                      "be added as a method.")</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1433</span>:         return</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1433,0,<span class='error_goto'>__PYX_ERR(0, 1433, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1434</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1435</span>:     for pandas_class in [pd.DataFrame, pd.Series]:</pre>
<pre class='cython code score-27 '>  <span class='trace'>__Pyx_TraceLine</span>(1435,0,<span class='error_goto'>__PYX_ERR(0, 1435, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1435, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1435, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1435, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1435, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1435, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1435, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 1435, __pyx_L1_error)</span>;
  __pyx_t_5 = 0;
  __pyx_t_8 = 0;
  __pyx_t_8 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
  __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (__pyx_t_6 &gt;= 2) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_6++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1435, __pyx_L1_error)</span>
    #else
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_8, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1435, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_pandas_class, __pyx_t_3);
    __pyx_t_3 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(1435,0,<span class='error_goto'>__PYX_ERR(0, 1435, __pyx_L1_error)</span>)
    __pyx_L4_continue:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1436</span>:         method_name = "go_" + func.__name__</pre>
<pre class='cython code score-9 '>    <span class='trace'>__Pyx_TraceLine</span>(1436,0,<span class='error_goto'>__PYX_ERR(0, 1436, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_func, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1436, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_n_u_go, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1436, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_method_name, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1437</span>:         if hasattr(pandas_class, method_name):</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1437,0,<span class='error_goto'>__PYX_ERR(0, 1437, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(__pyx_v_pandas_class, __pyx_v_method_name);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 1437, __pyx_L1_error)</span>
    if (__pyx_t_2) {
/*  */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1438</span>:             continue</pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(1438,0,<span class='error_goto'>__PYX_ERR(0, 1438, __pyx_L1_error)</span>)
      goto __pyx_L4_continue;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1439</span>:         try:</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(1439,0,<span class='error_goto'>__PYX_ERR(0, 1439, __pyx_L1_error)</span>)
    {
      /*try:*/ {
/*  */
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      goto __pyx_L14_try_end;
      __pyx_L7_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/*  */
      __pyx_L9_except_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_10, __pyx_t_11, __pyx_t_12);
      goto __pyx_L1_error;
      __pyx_L8_exception_handled:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_10, __pyx_t_11, __pyx_t_12);
      __pyx_L14_try_end:;
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1440</span>:             setattr(pandas_class, method_name, func)</pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(1440,0,<span class='error_goto'>__PYX_ERR(0, 1440, __pyx_L7_error)</span>)
        __pyx_t_13 = <span class='py_c_api'>PyObject_SetAttr</span>(__pyx_v_pandas_class, __pyx_v_method_name, __pyx_v_func);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 1440, __pyx_L7_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1441</span>:         except Exception as error: #noqa</pre>
<pre class='cython code score-11 '>      <span class='trace'>__Pyx_TraceLine</span>(1441,0,<span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L9_except_error)</span>)
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])));
      if (__pyx_t_9) {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._add_dynamic_method", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_5, &amp;__pyx_t_3, &amp;__pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L9_except_error)</span>
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        __pyx_v_error = __pyx_t_3;
        /*try:*/ {
        }
        /*finally:*/ {
          /*normal exit:*/{
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_error); __pyx_v_error = 0;
            goto __pyx_L21;
          }
          __pyx_L21:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        goto __pyx_L8_exception_handled;
      }
      goto __pyx_L9_except_error;
</pre><pre class="cython line score-0">&#xA0;<span class="">1442</span>:             pass</pre>
<pre class="cython line score-0">&#xA0;<span class="">1443</span>: </pre>
<pre class="cython line score-156" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1444</span>: def _preprocess_data(</pre>
<pre class='cython code score-156 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_55_preprocess_data(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_54_preprocess_data, "\n    Apply preprocessing steps to the input data based on the decorator's \n    parameters.\n    \n    Parameters\n    ----------\n    data : pd.DataFrame\n        The input data to be preprocessed.\n    capture_columns : bool\n        Whether to filter the DataFrame columns using the 'columns' \n        keyword argument.\n    expected_type : str\n        Specifies the expected data type: 'numeric', 'categorical', or 'both'.\n    drop_na : bool\n        Whether to apply missing value handling.\n    na_thresh : Optional[float]\n        Threshold for dropping rows or columns based on the proportion of \n        missing values.\n    na_meth : str\n        Method for dropping missing values.\n    reset_index : bool\n        Whether to reset the DataFrame index before passing it to the function.\n    kwargs : dict\n        Additional keyword arguments passed to the decorated function.\n    \n    Returns\n    -------\n    pd.DataFrame\n        The preprocessed data.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_55_preprocess_data = {"_preprocess_data", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_55_preprocess_data, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_54_preprocess_data};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_55_preprocess_data(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_capture_columns = 0;
  PyObject *__pyx_v_expected_type = 0;
  PyObject *__pyx_v_drop_na = 0;
  PyObject *__pyx_v_na_thresh = 0;
  PyObject *__pyx_v_na_meth = 0;
  PyObject *__pyx_v_reset_index = 0;
  PyObject *__pyx_v_kwargs = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_preprocess_data (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kwargs)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_capture_columns,&amp;__pyx_n_s_expected_type,&amp;__pyx_n_s_drop_na,&amp;__pyx_n_s_na_thresh,&amp;__pyx_n_s_na_meth,&amp;__pyx_n_s_reset_index,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_capture_columns)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_preprocess_data", 1, 7, 7, 1); <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_expected_type)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_preprocess_data", 1, 7, 7, 2); <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_drop_na)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_preprocess_data", 1, 7, 7, 3); <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_na_thresh)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_preprocess_data", 1, 7, 7, 4); <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_na_meth)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_preprocess_data", 1, 7, 7, 5); <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_reset_index)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_preprocess_data", 1, 7, 7, 6); <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kwargs, values + 0, kwd_pos_args, "_preprocess_data") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 7)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
      values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
      values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
      values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
      values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
    }
    __pyx_v_data = values[0];
    __pyx_v_capture_columns = values[1];
    __pyx_v_expected_type = values[2];
    __pyx_v_drop_na = values[3];
    __pyx_v_na_thresh = values[4];
    __pyx_v_na_meth = values[5];
    __pyx_v_reset_index = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_preprocess_data", 1, 7, 7, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs); __pyx_v_kwargs = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._preprocess_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_54_preprocess_data(__pyx_self, __pyx_v_data, __pyx_v_capture_columns, __pyx_v_expected_type, __pyx_v_drop_na, __pyx_v_na_thresh, __pyx_v_na_meth, __pyx_v_reset_index, __pyx_v_kwargs);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_54_preprocess_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_capture_columns, PyObject *__pyx_v_expected_type, PyObject *__pyx_v_drop_na, PyObject *__pyx_v_na_thresh, PyObject *__pyx_v_na_meth, PyObject *__pyx_v_reset_index, PyObject *__pyx_v_kwargs) {
  PyObject *__pyx_v_columns = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__94)
  <span class='trace'>__Pyx_TraceCall</span>("_preprocess_data", __pyx_f[0], 1444, 0, <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._preprocess_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_columns);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__180 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_data, __pyx_n_s_capture_columns, __pyx_n_s_expected_type, __pyx_n_s_drop_na, __pyx_n_s_na_thresh, __pyx_n_s_na_meth, __pyx_n_s_reset_index, __pyx_n_s_kwargs, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_tuple__180)) __PYX_ERR(0, 1444, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__180);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__180);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1444,0,<span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_55_preprocess_data, 0, __pyx_n_s_preprocess_data, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__94));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1444, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_preprocess_data, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1444, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__94 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__180, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_preprocess_data, 1444, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__94)) __PYX_ERR(0, 1444, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1445</span>:         data, capture_columns, expected_type, drop_na, na_thresh,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1446</span>:         na_meth, reset_index, **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1447</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1448</span>:     Apply preprocessing steps to the input data based on the decorator's</pre>
<pre class="cython line score-0">&#xA0;<span class="">1449</span>:     parameters.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1450</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1451</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1452</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1453</span>:     data : pd.DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">1454</span>:         The input data to be preprocessed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1455</span>:     capture_columns : bool</pre>
<pre class="cython line score-0">&#xA0;<span class="">1456</span>:         Whether to filter the DataFrame columns using the 'columns'</pre>
<pre class="cython line score-0">&#xA0;<span class="">1457</span>:         keyword argument.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1458</span>:     expected_type : str</pre>
<pre class="cython line score-0">&#xA0;<span class="">1459</span>:         Specifies the expected data type: 'numeric', 'categorical', or 'both'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1460</span>:     drop_na : bool</pre>
<pre class="cython line score-0">&#xA0;<span class="">1461</span>:         Whether to apply missing value handling.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1462</span>:     na_thresh : Optional[float]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1463</span>:         Threshold for dropping rows or columns based on the proportion of</pre>
<pre class="cython line score-0">&#xA0;<span class="">1464</span>:         missing values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1465</span>:     na_meth : str</pre>
<pre class="cython line score-0">&#xA0;<span class="">1466</span>:         Method for dropping missing values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1467</span>:     reset_index : bool</pre>
<pre class="cython line score-0">&#xA0;<span class="">1468</span>:         Whether to reset the DataFrame index before passing it to the function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1469</span>:     kwargs : dict</pre>
<pre class="cython line score-0">&#xA0;<span class="">1470</span>:         Additional keyword arguments passed to the decorated function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1471</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1472</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1473</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1474</span>:     pd.DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">1475</span>:         The preprocessed data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1476</span>:     """</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1477</span>:     if capture_columns and 'columns' in kwargs:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(1477,0,<span class='error_goto'>__PYX_ERR(0, 1477, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_capture_columns); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1477, __pyx_L1_error)</span>
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_n_u_columns, __pyx_v_kwargs, Py_EQ)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1477, __pyx_L1_error)</span>
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1478</span>:         columns = kwargs.pop('columns')</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1478,0,<span class='error_goto'>__PYX_ERR(0, 1478, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_Pop</span>(__pyx_v_kwargs, __pyx_n_u_columns, ((PyObject *)NULL));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1478, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_v_columns = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1479</span>:         columns = is_iterable(columns, exclude_string= True, transform=True )</pre>
<pre class='cython code score-28 '>    <span class='trace'>__Pyx_TraceLine</span>(1479,0,<span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_is_iterable);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_columns);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_columns);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_columns)) <span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_exclude_string, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_transform, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_columns, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1480</span>:         try:</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(1480,0,<span class='error_goto'>__PYX_ERR(0, 1480, __pyx_L1_error)</span>)
    {
      /*try:*/ {
/*  */
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L11_try_end;
      __pyx_L6_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/*  */
      __pyx_L8_except_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
      goto __pyx_L1_error;
      __pyx_L7_exception_handled:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
      __pyx_L11_try_end:;
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1481</span>:             data = data[columns]</pre>
<pre class='cython code score-3 '>        <span class='trace'>__Pyx_TraceLine</span>(1481,0,<span class='error_goto'>__PYX_ERR(0, 1481, __pyx_L6_error)</span>)
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_data, __pyx_v_columns);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1481, __pyx_L6_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_6);
        __pyx_t_6 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1482</span>:         except KeyError:</pre>
<pre class='cython code score-6 '>      <span class='trace'>__Pyx_TraceLine</span>(1482,0,<span class='error_goto'>__PYX_ERR(0, 1482, __pyx_L8_except_error)</span>)
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(__pyx_builtin_KeyError);
      if (__pyx_t_10) {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._preprocess_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_6, &amp;__pyx_t_5, &amp;__pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1482, __pyx_L8_except_error)</span>
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1483</span>:             print("Specified columns do not match, ignoring columns.")</pre>
<pre class='cython code score-11 '>        <span class='trace'>__Pyx_TraceLine</span>(1483,0,<span class='error_goto'>__PYX_ERR(0, 1483, __pyx_L8_except_error)</span>)
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_tuple__95, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1483, __pyx_L8_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        goto __pyx_L7_exception_handled;
      }
      goto __pyx_L8_except_error;
/*  */
  __pyx_tuple__95 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Specified_columns_do_not_match_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__95)) __PYX_ERR(0, 1483, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__95);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__95);
</pre><pre class="cython line score-0">&#xA0;<span class="">1484</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1485</span>:     if expected_type == 'numeric':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1485,0,<span class='error_goto'>__PYX_ERR(0, 1485, __pyx_L1_error)</span>)
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_expected_type, __pyx_n_u_numeric, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1485, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
    goto __pyx_L14;
  }
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1486</span>:         data = data.select_dtypes([np.number])</pre>
<pre class='cython code score-30 '>    <span class='trace'>__Pyx_TraceLine</span>(1486,0,<span class='error_goto'>__PYX_ERR(0, 1486, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_select_dtypes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_number);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1486, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1486, __pyx_L1_error)</span>;
    __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_10 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_10 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_6};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1486, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1487</span>:     elif expected_type == 'categorical':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1487,0,<span class='error_goto'>__PYX_ERR(0, 1487, __pyx_L1_error)</span>)
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_expected_type, __pyx_n_u_categorical, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1487, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
  __pyx_L14:;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1488</span>:         data = data.select_dtypes(None, [np.number])</pre>
<pre class='cython code score-30 '>    <span class='trace'>__Pyx_TraceLine</span>(1488,0,<span class='error_goto'>__PYX_ERR(0, 1488, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_select_dtypes);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1488, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1488, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_number);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1488, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1488, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1488, __pyx_L1_error)</span>;
    __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_10 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_10 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_3, Py_None, __pyx_t_6};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 2+__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1488, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1489</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1490</span>:     if drop_na:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1490,0,<span class='error_goto'>__PYX_ERR(0, 1490, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_drop_na); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1490, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1491</span>:         if na_meth == 'drop_rows':</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1491,0,<span class='error_goto'>__PYX_ERR(0, 1491, __pyx_L1_error)</span>)
    __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_na_meth, __pyx_n_u_drop_rows, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1491, __pyx_L1_error)</span>
    if (__pyx_t_1) {
/*  */
      goto __pyx_L16;
    }
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1492</span>:             data = data.dropna(axis=0, thresh=(na_thresh * len(</pre>
<pre class='cython code score-31 '>      <span class='trace'>__Pyx_TraceLine</span>(1492,0,<span class='error_goto'>__PYX_ERR(0, 1492, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_dropna);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1492, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1492, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1492, __pyx_L1_error)</span>
        __pyx_t_11 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1492, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1492, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_na_thresh, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1492, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_6 = __pyx_t_12;
        __pyx_t_12 = 0;
      } else {
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(1492,0,<span class='error_goto'>__PYX_ERR(0, 1492, __pyx_L1_error)</span>)
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1492, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_6);
      __pyx_t_6 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1493</span>:                 data.columns) if na_thresh is not None else None))</pre>
<pre class='cython code score-9 '>      <span class='trace'>__Pyx_TraceLine</span>(1493,0,<span class='error_goto'>__PYX_ERR(0, 1493, __pyx_L1_error)</span>)
      __pyx_t_1 = (__pyx_v_na_thresh != Py_None);
      if (__pyx_t_1) {
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(1492,0,<span class='error_goto'>__PYX_ERR(0, 1492, __pyx_L1_error)</span>)
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1493, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(1493,0,<span class='error_goto'>__PYX_ERR(0, 1493, __pyx_L1_error)</span>)
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_t_6 = Py_None;
      }
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_thresh, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1492, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1494</span>:         elif na_meth == 'drop_cols':</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1494,0,<span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>)
    __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_na_meth, __pyx_n_u_drop_cols, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>
    if (__pyx_t_1) {
/*  */
      goto __pyx_L16;
    }
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1495</span>:             data = data.dropna(axis=1, thresh=(na_thresh * len(</pre>
<pre class='cython code score-30 '>      <span class='trace'>__Pyx_TraceLine</span>(1495,0,<span class='error_goto'>__PYX_ERR(0, 1495, __pyx_L1_error)</span>)
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_dropna);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1495, __pyx_L1_error)</span>
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(1495,0,<span class='error_goto'>__PYX_ERR(0, 1495, __pyx_L1_error)</span>)
        __pyx_t_11 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
        __pyx_t_12 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_na_thresh, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_4 = __pyx_t_3;
        __pyx_t_3 = 0;
      } else {
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(1495,0,<span class='error_goto'>__PYX_ERR(0, 1495, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_empty_tuple, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1495, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1496</span>:                 data) if na_thresh is not None else None))</pre>
<pre class='cython code score-7 '>      <span class='trace'>__Pyx_TraceLine</span>(1496,0,<span class='error_goto'>__PYX_ERR(0, 1496, __pyx_L1_error)</span>)
      __pyx_t_1 = (__pyx_v_na_thresh != Py_None);
      if (__pyx_t_1) {
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(1496,0,<span class='error_goto'>__PYX_ERR(0, 1496, __pyx_L1_error)</span>)
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_t_4 = Py_None;
      }
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_thresh, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1495, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1497</span>:         else:</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1498</span>:             data = data.dropna()</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(1498,0,<span class='error_goto'>__PYX_ERR(0, 1498, __pyx_L1_error)</span>)
    /*else*/ {
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_dropna);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1498, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = NULL;
      __pyx_t_10 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_10 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 0+__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1498, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
      __pyx_t_4 = 0;
    }
    __pyx_L16:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1499</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1500</span>:     if reset_index:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1500,0,<span class='error_goto'>__PYX_ERR(0, 1500, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_reset_index); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1500, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1501</span>:         data = data.reset_index(drop=True)</pre>
<pre class='cython code score-14 '>    <span class='trace'>__Pyx_TraceLine</span>(1501,0,<span class='error_goto'>__PYX_ERR(0, 1501, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_reset_index);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1501, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1501, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_drop, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1501, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1501, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1502</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1503</span>:     return data</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1503,0,<span class='error_goto'>__PYX_ERR(0, 1503, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  __pyx_r = __pyx_v_data;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1504</span>: </pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1505</span>: def preserve_input_type(</pre>
<pre class='cython code score-74 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_57preserve_input_type(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_56preserve_input_type, "\n    A decorator that preserves the input data type of the first positional\n    argument of the decorated function. If the function's output type is\n    different from its input, this decorator attempts to convert the output\n    back to the input's original type.\n\n    Parameters\n    ----------\n    keep_columns_intact : bool, optional\n        When True and the input is a pandas DataFrame, attempts to preserve\n        the original DataFrame's columns in the returned DataFrame. This is\n        only applicable if the result can logically map to the original\n        columns. Defaults to False.\n    custom_convert : Optional[Callable[[Any, Type, Any], Any]], optional\n        A custom conversion function provided by the user that takes three\n        arguments: the result of the decorated function, the original type\n        of the first positional argument, and the original columns (if the\n        input was a pandas DataFrame). This function should return the\n        converted result. If None, the decorator uses default conversion\n        logic. Defaults to None.\n    fallback_on_error : bool, optional\n        If True, the decorator will return the unconverted result when a\n        conversion attempt raises an error or when the custom_convert\n        function fails. If False, the error is propagated. Defaults to True.\n    \n    specific_type : Type, optional\n        Specifies the type to preserve. If None, the type of the first positional\n        argument or a specified keyword argument is used. Defaults to None.\n        \n    Returns\n    -------\n    Callable\n        A wrapped version of the original function that ensures the output\n        type matches the input type of the first positional argument.\n\n    Examples\n    --------\n    &gt;&gt;&gt; import numpy as np\n    &gt;&gt;&gt; import pandas as pd\n    &gt;&gt;&gt; from gofast.tools.funcutils import preserve_input_type\n    &gt;&gt;&gt; @preserve_input_type()\n    ... def add_one(data):\n    ...     return data + 1\n    ...""\n    &gt;&gt;&gt; add_one(np.array([1, 2, 3]))\n    array([2, 3, 4])\n    &gt;&gt;&gt; add_one(pd.Series([1, 2, 3]))\n    0    2\n    1    3\n    2    4\n    dtype: int64\n    &gt;&gt;&gt; add_one([1, 2, 3])\n    [2, 3, 4]\n\n    Using custom conversion logic:\n    &gt;&gt;&gt; @preserve_input_type(custom_convert=lambda res, orig_type, _: orig_type(\n    ...                      [x * 2 for x in res]))\n    ... def multiply_by_two(data):\n    ...     return data * 2\n    ...\n    &gt;&gt;&gt; multiply_by_two(np.array([1, 2, 3]))\n    array([2, 4, 6])\n    &gt;&gt;&gt; multiply_by_two(pd.Series([1, 2, 3]))\n    0    2\n    1    4\n    2    6\n    dtype: int64\n    &gt;&gt;&gt; multiply_by_two([1, 2, 3])\n    [2, 4, 6]\n\n    Note\n    ----\n    This decorator is particularly useful for functions that may return a\n    type different from their input type, but where maintaining the input\n    type is desired for consistency in the calling code.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_57preserve_input_type = {"preserve_input_type", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_57preserve_input_type, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_56preserve_input_type};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_57preserve_input_type(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_keep_columns_intact = 0;
  PyObject *__pyx_v_custom_convert = 0;
  PyObject *__pyx_v_fallback_on_error = 0;
  PyObject *__pyx_v_specific_type = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("preserve_input_type (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_keep_columns_intact,&amp;__pyx_n_s_custom_convert,&amp;__pyx_n_s_fallback_on_error,&amp;__pyx_n_s_specific_type,0};
  PyObject* values[4] = {0,0,0,0};
/*  */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_56preserve_input_type(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_keep_columns_intact, PyObject *__pyx_v_custom_convert, PyObject *__pyx_v_fallback_on_error, PyObject *__pyx_v_specific_type) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_27_preserve_input_type *__pyx_cur_scope;
  PyObject *__pyx_v_decorator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__98)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_27_preserve_input_type *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_27_preserve_input_type(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_27_preserve_input_type, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_27_preserve_input_type *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("preserve_input_type", __pyx_f[0], 1505, 0, <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_keep_columns_intact = __pyx_v_keep_columns_intact;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_keep_columns_intact);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_keep_columns_intact);
  __pyx_cur_scope-&gt;__pyx_v_custom_convert = __pyx_v_custom_convert;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_custom_convert);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_custom_convert);
  __pyx_cur_scope-&gt;__pyx_v_fallback_on_error = __pyx_v_fallback_on_error;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_fallback_on_error);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_fallback_on_error);
  __pyx_cur_scope-&gt;__pyx_v_specific_type = __pyx_v_specific_type;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_specific_type);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_specific_type);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.preserve_input_type", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_decorator);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__181 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_keep_columns_intact, __pyx_n_s_custom_convert, __pyx_n_s_fallback_on_error, __pyx_n_s_specific_type, __pyx_n_s_decorator, __pyx_n_s_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__181)) __PYX_ERR(0, 1505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__181);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__181);
  __pyx_codeobj__98 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__181, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_preserve_input_type, 1505, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__98)) __PYX_ERR(0, 1505, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1505,0,<span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_keep_columns_intact, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_custom_convert, __pyx_kp_s_Optional_Callable_Any_Type_Any_A) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_fallback_on_error, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_specific_type, __pyx_kp_s_Optional_Type) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_57preserve_input_type, 0, __pyx_n_s_preserve_input_type, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__98));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__182);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_preserve_input_type, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__182 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject *)Py_False), Py_None, ((PyObject *)Py_True), Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__182)) __PYX_ERR(0, 1505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__182);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__182);
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_27_preserve_input_type {
  PyObject_HEAD
  PyObject *__pyx_v_custom_convert;
  PyObject *__pyx_v_fallback_on_error;
  PyObject *__pyx_v_keep_columns_intact;
  PyObject *__pyx_v_specific_type;
};

</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1506</span>:     keep_columns_intact: bool = False,</pre>
<pre class='cython code score-2 '>    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1507</span>:     custom_convert: Optional[Callable[[Any, Type, Any], Any]] = None,</pre>
<pre class='cython code score-2 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1508</span>:     fallback_on_error: bool = True,</pre>
<pre class='cython code score-2 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1509</span>:     specific_type: Optional[Type] = None</pre>
<pre class='cython code score-64 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_keep_columns_intact);
          if (value) { values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_custom_convert);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_fallback_on_error);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_specific_type);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "preserve_input_type") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_keep_columns_intact = values[0];
    __pyx_v_custom_convert = values[1];
    __pyx_v_fallback_on_error = values[2];
    __pyx_v_specific_type = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("preserve_input_type", 0, 0, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.preserve_input_type", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_56preserve_input_type(__pyx_self, __pyx_v_keep_columns_intact, __pyx_v_custom_convert, __pyx_v_fallback_on_error, __pyx_v_specific_type);
</pre><pre class="cython line score-0">&#xA0;<span class="">1510</span>: ) -&gt; Callable:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1511</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1512</span>:     A decorator that preserves the input data type of the first positional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1513</span>:     argument of the decorated function. If the function's output type is</pre>
<pre class="cython line score-0">&#xA0;<span class="">1514</span>:     different from its input, this decorator attempts to convert the output</pre>
<pre class="cython line score-0">&#xA0;<span class="">1515</span>:     back to the input's original type.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1516</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1517</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1518</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1519</span>:     keep_columns_intact : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1520</span>:         When True and the input is a pandas DataFrame, attempts to preserve</pre>
<pre class="cython line score-0">&#xA0;<span class="">1521</span>:         the original DataFrame's columns in the returned DataFrame. This is</pre>
<pre class="cython line score-0">&#xA0;<span class="">1522</span>:         only applicable if the result can logically map to the original</pre>
<pre class="cython line score-0">&#xA0;<span class="">1523</span>:         columns. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1524</span>:     custom_convert : Optional[Callable[[Any, Type, Any], Any]], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1525</span>:         A custom conversion function provided by the user that takes three</pre>
<pre class="cython line score-0">&#xA0;<span class="">1526</span>:         arguments: the result of the decorated function, the original type</pre>
<pre class="cython line score-0">&#xA0;<span class="">1527</span>:         of the first positional argument, and the original columns (if the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1528</span>:         input was a pandas DataFrame). This function should return the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1529</span>:         converted result. If None, the decorator uses default conversion</pre>
<pre class="cython line score-0">&#xA0;<span class="">1530</span>:         logic. Defaults to None.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1531</span>:     fallback_on_error : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1532</span>:         If True, the decorator will return the unconverted result when a</pre>
<pre class="cython line score-0">&#xA0;<span class="">1533</span>:         conversion attempt raises an error or when the custom_convert</pre>
<pre class="cython line score-0">&#xA0;<span class="">1534</span>:         function fails. If False, the error is propagated. Defaults to True.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1535</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1536</span>:     specific_type : Type, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1537</span>:         Specifies the type to preserve. If None, the type of the first positional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1538</span>:         argument or a specified keyword argument is used. Defaults to None.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1539</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1540</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1541</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1542</span>:     Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">1543</span>:         A wrapped version of the original function that ensures the output</pre>
<pre class="cython line score-0">&#xA0;<span class="">1544</span>:         type matches the input type of the first positional argument.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1545</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1546</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1547</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1548</span>:     &gt;&gt;&gt; import numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">1549</span>:     &gt;&gt;&gt; import pandas as pd</pre>
<pre class="cython line score-0">&#xA0;<span class="">1550</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import preserve_input_type</pre>
<pre class="cython line score-0">&#xA0;<span class="">1551</span>:     &gt;&gt;&gt; @preserve_input_type()</pre>
<pre class="cython line score-0">&#xA0;<span class="">1552</span>:     ... def add_one(data):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1553</span>:     ...     return data + 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1554</span>:     ...</pre>
<pre class="cython line score-0">&#xA0;<span class="">1555</span>:     &gt;&gt;&gt; add_one(np.array([1, 2, 3]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1556</span>:     array([2, 3, 4])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1557</span>:     &gt;&gt;&gt; add_one(pd.Series([1, 2, 3]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1558</span>:     0    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1559</span>:     1    3</pre>
<pre class="cython line score-0">&#xA0;<span class="">1560</span>:     2    4</pre>
<pre class="cython line score-0">&#xA0;<span class="">1561</span>:     dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">1562</span>:     &gt;&gt;&gt; add_one([1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1563</span>:     [2, 3, 4]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1564</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1565</span>:     Using custom conversion logic:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1566</span>:     &gt;&gt;&gt; @preserve_input_type(custom_convert=lambda res, orig_type, _: orig_type(</pre>
<pre class="cython line score-0">&#xA0;<span class="">1567</span>:     ...                      [x * 2 for x in res]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1568</span>:     ... def multiply_by_two(data):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1569</span>:     ...     return data * 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1570</span>:     ...</pre>
<pre class="cython line score-0">&#xA0;<span class="">1571</span>:     &gt;&gt;&gt; multiply_by_two(np.array([1, 2, 3]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1572</span>:     array([2, 4, 6])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1573</span>:     &gt;&gt;&gt; multiply_by_two(pd.Series([1, 2, 3]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1574</span>:     0    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1575</span>:     1    4</pre>
<pre class="cython line score-0">&#xA0;<span class="">1576</span>:     2    6</pre>
<pre class="cython line score-0">&#xA0;<span class="">1577</span>:     dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">1578</span>:     &gt;&gt;&gt; multiply_by_two([1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1579</span>:     [2, 4, 6]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1580</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1581</span>:     Note</pre>
<pre class="cython line score-0">&#xA0;<span class="">1582</span>:     ----</pre>
<pre class="cython line score-0">&#xA0;<span class="">1583</span>:     This decorator is particularly useful for functions that may return a</pre>
<pre class="cython line score-0">&#xA0;<span class="">1584</span>:     type different from their input type, but where maintaining the input</pre>
<pre class="cython line score-0">&#xA0;<span class="">1585</span>:     type is desired for consistency in the calling code.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1586</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1587</span>: </pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1588</span>:     def decorator(func: Callable) -&gt; Callable:</pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_19preserve_input_type_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_19preserve_input_type_1decorator = {"decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_19preserve_input_type_1decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_19preserve_input_type_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decorator", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.preserve_input_type.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_19preserve_input_type_decorator(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_19preserve_input_type_decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_28_decorator *__pyx_cur_scope;
  PyObject *__pyx_v_wrapper = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_28_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_28_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_28_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_28_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_27_preserve_input_type *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("decorator", __pyx_f[0], 1588, 0, <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.preserve_input_type.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_wrapper);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1588,0,<span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1588, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_19preserve_input_type_1decorator, 0, __pyx_n_s_preserve_input_type_locals_decor_2, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__99));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_decorator = __pyx_t_2;
  __pyx_t_2 = 0;
/*  */
  __pyx_codeobj__99 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_decorator, 1588, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__99)) __PYX_ERR(0, 1588, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_28_decorator {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_27_preserve_input_type *__pyx_outer_scope;
  PyObject *__pyx_v_func;
};

</pre><pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1589</span>:         @functools.wraps(func)</pre>
<pre class='cython code score-86 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_19preserve_input_type_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_19preserve_input_type_9decorator_1wrapper = {"wrapper", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_19preserve_input_type_9decorator_1wrapper, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_19preserve_input_type_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("wrapper (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "wrapper", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_19preserve_input_type_9decorator_wrapper(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_19preserve_input_type_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_28_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_28_decorator *__pyx_outer_scope;
  PyObject *__pyx_v_original_input = NULL;
  PyObject *__pyx_v_original_type = NULL;
  PyObject *__pyx_v_original_columns = NULL;
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_e = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_28_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("wrapper", __pyx_f[0], 1589, 0, <span class='error_goto'>__PYX_ERR(0, 1589, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.preserve_input_type.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_original_input);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_original_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_original_columns);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_e);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1589,0,<span class='error_goto'>__PYX_ERR(0, 1589, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1589, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1589, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1589, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
/*  */
  __pyx_tuple__96 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_original_input, __pyx_n_s_original_type, __pyx_n_s_original_columns, __pyx_n_s_result, __pyx_n_s_e);<span class='error_goto'> if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 1589, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__96);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__96);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1589, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1589, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_19preserve_input_type_9decorator_1wrapper, 0, __pyx_n_s_preserve_input_type_locals_decor, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__97));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1589, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1589, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_wrapper = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__97 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__96, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_wrapper, 1589, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__97)) __PYX_ERR(0, 1589, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1590</span>:         def wrapper(*args, **kwargs) -&gt; Any:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1591</span>:             # Determine the original input and type to preserve.</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1592</span>:             original_input = specific_type or (</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1592,0,<span class='error_goto'>__PYX_ERR(0, 1592, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_specific_type)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("specific_type"); <span class='error_goto'>__PYX_ERR(0, 1592, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_specific_type); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1592, __pyx_L1_error)</span>
  if (!__pyx_t_2) {
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_specific_type);
    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_specific_type;
    goto __pyx_L3_bool_binop_done;
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1593</span>:                 args[0] if args else next(iter(kwargs.values()), None))</pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(1593,0,<span class='error_goto'>__PYX_ERR(0, 1593, __pyx_L1_error)</span>)
  __pyx_t_2 = (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_v_args) != 0);
  if (__pyx_t_2) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt_Tuple</span>(__pyx_v_args, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1593, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = __pyx_t_4;
    __pyx_t_4 = 0;
  } else {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_Values</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1593, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1593, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = __Pyx_PyIter_Next2(__pyx_t_5, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1593, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_3 = __pyx_t_4;
    __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_1 = __pyx_t_3;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_L3_bool_binop_done:;
  __pyx_v_original_input = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1594</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1595</span>:             if original_input is None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1595,0,<span class='error_goto'>__PYX_ERR(0, 1595, __pyx_L1_error)</span>)
  __pyx_t_2 = (__pyx_v_original_input == Py_None);
  if (__pyx_t_2) {
/*  */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1596</span>:                 return func(*args, **kwargs)</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(1596,0,<span class='error_goto'>__PYX_ERR(0, 1596, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 1596, __pyx_L1_error)</span> }
    __pyx_t_1 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1596, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1596, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1597</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1598</span>:             original_type = specific_type or type(original_input)</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(1598,0,<span class='error_goto'>__PYX_ERR(0, 1598, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_specific_type)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("specific_type"); <span class='error_goto'>__PYX_ERR(0, 1598, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_specific_type); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1598, __pyx_L1_error)</span>
  if (!__pyx_t_2) {
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_specific_type);
    __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_specific_type;
    goto __pyx_L6_bool_binop_done;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_TYPE(__pyx_v_original_input)));
  __pyx_t_3 = ((PyObject *)Py_TYPE(__pyx_v_original_input));
  __pyx_L6_bool_binop_done:;
  __pyx_v_original_type = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1599</span>:             original_columns = getattr(original_input, 'columns', None) if isinstance(</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(1599,0,<span class='error_goto'>__PYX_ERR(0, 1599, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_original_input, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 1599, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_2) {
    __pyx_t_4 = __Pyx_GetAttr3(__pyx_v_original_input, __pyx_n_u_columns, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1599, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = __pyx_t_4;
    __pyx_t_4 = 0;
  } else {
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1600</span>:                 original_input, pd.DataFrame) else None</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(1600,0,<span class='error_goto'>__PYX_ERR(0, 1600, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1600, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1600, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(1600,0,<span class='error_goto'>__PYX_ERR(0, 1600, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    __pyx_t_3 = Py_None;
  }
  __pyx_v_original_columns = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1601</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1602</span>:             try:</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(1602,0,<span class='error_goto'>__PYX_ERR(0, 1602, __pyx_L1_error)</span>)
  {
    /*try:*/ {
/*  */
    }
    __pyx_L8_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/*  */
    __pyx_L10_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_6, __pyx_t_7, __pyx_t_8);
    goto __pyx_L1_error;
    __pyx_L12_try_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_6, __pyx_t_7, __pyx_t_8);
    goto __pyx_L0;
    __pyx_L11_except_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_6, __pyx_t_7, __pyx_t_8);
    goto __pyx_L0;
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1603</span>:                 result = func(*args, **kwargs)</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(1603,0,<span class='error_goto'>__PYX_ERR(0, 1603, __pyx_L8_error)</span>)
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 1603, __pyx_L8_error)</span> }
      __pyx_t_3 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1603, __pyx_L8_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1603, __pyx_L8_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_result = __pyx_t_4;
      __pyx_t_4 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1604</span>:                 if custom_convert:</pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(1604,0,<span class='error_goto'>__PYX_ERR(0, 1604, __pyx_L8_error)</span>)
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_custom_convert)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("custom_convert"); <span class='error_goto'>__PYX_ERR(0, 1604, __pyx_L8_error)</span> }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_custom_convert); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1604, __pyx_L8_error)</span>
      if (__pyx_t_2) {
/*  */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1605</span>:                     # Use custom conversion logic if provided.</pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1606</span>:                     return custom_convert(result, original_type, original_columns)</pre>
<pre class='cython code score-18 '>        <span class='trace'>__Pyx_TraceLine</span>(1606,0,<span class='error_goto'>__PYX_ERR(0, 1606, __pyx_L8_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_custom_convert)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("custom_convert"); <span class='error_goto'>__PYX_ERR(0, 1606, __pyx_L8_error)</span> }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_custom_convert);
        __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_custom_convert; __pyx_t_1 = NULL;
        __pyx_t_9 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_1)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
            __pyx_t_9 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[4] = {__pyx_t_1, __pyx_v_result, __pyx_v_original_type, __pyx_v_original_columns};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_9, 3+__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1606, __pyx_L8_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        }
        __pyx_r = __pyx_t_4;
        __pyx_t_4 = 0;
        goto __pyx_L12_try_return;
</pre><pre class="cython line score-0">&#xA0;<span class="">1607</span>:                 else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1608</span>:                     # Convert to original type using default logic.</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1609</span>:                     return _convert_to_original_type(</pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(1609,0,<span class='error_goto'>__PYX_ERR(0, 1609, __pyx_L8_error)</span>)
      /*else*/ {
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_convert_to_original_type);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1609, __pyx_L8_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">1610</span>:                         result, original_type, original_columns,</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1611</span>:                         keep_columns_intact)</pre>
<pre class='cython code score-16 '>        <span class='trace'>__Pyx_TraceLine</span>(1611,0,<span class='error_goto'>__PYX_ERR(0, 1611, __pyx_L8_error)</span>)
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_keep_columns_intact)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("keep_columns_intact"); <span class='error_goto'>__PYX_ERR(0, 1611, __pyx_L8_error)</span> }
        __pyx_t_1 = NULL;
        __pyx_t_9 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_1)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
            __pyx_t_9 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[5] = {__pyx_t_1, __pyx_v_result, __pyx_v_original_type, __pyx_v_original_columns, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_keep_columns_intact};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_9, 4+__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1609, __pyx_L8_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        }
        __pyx_r = __pyx_t_4;
        __pyx_t_4 = 0;
        goto __pyx_L12_try_return;
      }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1612</span>:             except Exception as e:</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(1612,0,<span class='error_goto'>__PYX_ERR(0, 1612, __pyx_L10_except_error)</span>)
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])));
    if (__pyx_t_9) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.preserve_input_type.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_4, &amp;__pyx_t_3, &amp;__pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1612, __pyx_L10_except_error)</span>
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_v_e = __pyx_t_3;
      /*try:*/ {
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(1612,0,<span class='error_goto'>__PYX_ERR(0, 1612, __pyx_L20_error)</span>)
      /*finally:*/ {
        __pyx_L20_error:;
        /*exception exit:*/{
          __Pyx_PyThreadState_declare
          __Pyx_PyThreadState_assign
          __pyx_t_12 = 0; __pyx_t_13 = 0; __pyx_t_14 = 0; __pyx_t_15 = 0; __pyx_t_16 = 0; __pyx_t_17 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_15, &amp;__pyx_t_16, &amp;__pyx_t_17);
          if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_12, &amp;__pyx_t_13, &amp;__pyx_t_14) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_12, &amp;__pyx_t_13, &amp;__pyx_t_14);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_12);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_13);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_15);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_16);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_17);
          __pyx_t_9 = __pyx_lineno; __pyx_t_10 = __pyx_clineno; __pyx_t_11 = __pyx_filename;
          {
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
          }
          if (PY_MAJOR_VERSION &gt;= 3) {
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_15);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_16);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_17);
            <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_15, __pyx_t_16, __pyx_t_17);
          }
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);
          <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);
          __pyx_t_12 = 0; __pyx_t_13 = 0; __pyx_t_14 = 0; __pyx_t_15 = 0; __pyx_t_16 = 0; __pyx_t_17 = 0;
          __pyx_lineno = __pyx_t_9; __pyx_clineno = __pyx_t_10; __pyx_filename = __pyx_t_11;
          goto __pyx_L10_except_error;
        }
        __pyx_L19_return: {
          __pyx_t_17 = __pyx_r;
          __pyx_r = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
          __pyx_r = __pyx_t_17;
          __pyx_t_17 = 0;
          goto __pyx_L11_except_return;
        }
      }
    }
    goto __pyx_L10_except_error;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1613</span>:                 if fallback_on_error:</pre>
<pre class='cython code score-4 '>        <span class='trace'>__Pyx_TraceLine</span>(1613,0,<span class='error_goto'>__PYX_ERR(0, 1613, __pyx_L20_error)</span>)
        if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_fallback_on_error)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("fallback_on_error"); <span class='error_goto'>__PYX_ERR(0, 1613, __pyx_L20_error)</span> }
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_fallback_on_error); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1613, __pyx_L20_error)</span>
        if (likely(__pyx_t_2)) {
/*  */
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">1614</span>:                     # Return unconverted result if conversion fails.</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1615</span>:                     return result</pre>
<pre class='cython code score-7 '>          <span class='trace'>__Pyx_TraceLine</span>(1615,0,<span class='error_goto'>__PYX_ERR(0, 1615, __pyx_L20_error)</span>)
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
          if (unlikely(!__pyx_v_result)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("result"); <span class='error_goto'>__PYX_ERR(0, 1615, __pyx_L20_error)</span> }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
          __pyx_r = __pyx_v_result;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          goto __pyx_L19_return;
</pre><pre class="cython line score-0">&#xA0;<span class="">1616</span>:                 else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1617</span>:                     raise e</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(1617,0,<span class='error_goto'>__PYX_ERR(0, 1617, __pyx_L20_error)</span>)
        /*else*/ {
          <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_v_e, 0, 0, 0);
          <span class='error_goto'>__PYX_ERR(0, 1617, __pyx_L20_error)</span>
        }
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1618</span>:         return wrapper</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1618,0,<span class='error_goto'>__PYX_ERR(0, 1618, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wrapper);
  __pyx_r = __pyx_v_wrapper;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1619</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1620</span>:     return decorator</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1620,0,<span class='error_goto'>__PYX_ERR(0, 1620, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorator);
  __pyx_r = __pyx_v_decorator;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1621</span>: </pre>
<pre class="cython line score-129" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1622</span>: def _convert_to_original_type(</pre>
<pre class='cython code score-129 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_59_convert_to_original_type(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_58_convert_to_original_type, "\n    Converts the result to the original input type, using specific conversion functions\n    based on the original type.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_59_convert_to_original_type = {"_convert_to_original_type", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_59_convert_to_original_type, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_58_convert_to_original_type};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_59_convert_to_original_type(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_result = 0;
  PyObject *__pyx_v_original_type = 0;
  PyObject *__pyx_v_original_columns = 0;
  PyObject *__pyx_v_keep_columns_intact = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_convert_to_original_type (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_result,&amp;__pyx_n_s_original_type,&amp;__pyx_n_s_original_columns,&amp;__pyx_n_s_keep_columns_intact,0};
  PyObject* values[4] = {0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_result)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_original_type)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_to_original_type", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_original_columns)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_to_original_type", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_keep_columns_intact)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_to_original_type", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_convert_to_original_type") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
      values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
    }
    __pyx_v_result = values[0];
    __pyx_v_original_type = values[1];
    __pyx_v_original_columns = values[2];
    __pyx_v_keep_columns_intact = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_to_original_type", 1, 4, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_to_original_type", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_58_convert_to_original_type(__pyx_self, __pyx_v_result, __pyx_v_original_type, __pyx_v_original_columns, __pyx_v_keep_columns_intact);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_58_convert_to_original_type(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_result, PyObject *__pyx_v_original_type, PyObject *__pyx_v_original_columns, PyObject *__pyx_v_keep_columns_intact) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__100)
  <span class='trace'>__Pyx_TraceCall</span>("_convert_to_original_type", __pyx_f[0], 1622, 0, <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_to_original_type", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__183 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_result, __pyx_n_s_original_type, __pyx_n_s_original_columns, __pyx_n_s_keep_columns_intact);<span class='error_goto'> if (unlikely(!__pyx_tuple__183)) __PYX_ERR(0, 1622, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__183);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__183);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1622,0,<span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1622, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_result, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_original_type, __pyx_n_s_Type) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_original_columns, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_keep_columns_intact, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_59_convert_to_original_type, 0, __pyx_n_s_convert_to_original_type, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__100));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1622, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convert_to_original_type, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1622, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__100 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__183, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_convert_to_original_type, 1622, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__100)) __PYX_ERR(0, 1622, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1623</span>:         result: Any, original_type: Type, original_columns: Any,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1624</span>:         keep_columns_intact: bool) -&gt; Any:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1625</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1626</span>:     Converts the result to the original input type, using specific conversion functions</pre>
<pre class="cython line score-0">&#xA0;<span class="">1627</span>:     based on the original type.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1628</span>:     """</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1629</span>:     if original_type is pd.DataFrame:</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(1629,0,<span class='error_goto'>__PYX_ERR(0, 1629, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (__pyx_v_original_type == __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1630</span>:         return _convert_to_dataframe(result, original_columns, keep_columns_intact)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(1630,0,<span class='error_goto'>__PYX_ERR(0, 1630, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_convert_to_dataframe);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1630, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_4, __pyx_v_result, __pyx_v_original_columns, __pyx_v_keep_columns_intact};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 3+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1630, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1631</span>:     elif original_type is pd.Series:</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(1631,0,<span class='error_goto'>__PYX_ERR(0, 1631, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = (__pyx_v_original_type == __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1632</span>:         return _convert_to_series(result, original_columns)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(1632,0,<span class='error_goto'>__PYX_ERR(0, 1632, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_convert_to_series);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1632, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_v_result, __pyx_v_original_columns};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1632, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1633</span>:     elif original_type is np.ndarray:</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(1633,0,<span class='error_goto'>__PYX_ERR(0, 1633, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1633, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (__pyx_v_original_type == __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1634</span>:         return _convert_to_ndarray(result)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(1634,0,<span class='error_goto'>__PYX_ERR(0, 1634, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_convert_to_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1634, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_result};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1634, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1635</span>:     elif original_type is list:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1635,0,<span class='error_goto'>__PYX_ERR(0, 1635, __pyx_L1_error)</span>)
  __pyx_t_3 = (__pyx_v_original_type == ((PyObject *)(&amp;PyList_Type)));
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1636</span>:         return _convert_to_list(result)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(1636,0,<span class='error_goto'>__PYX_ERR(0, 1636, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_convert_to_list);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_result};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1636, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1637</span>:     return result</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1637,0,<span class='error_goto'>__PYX_ERR(0, 1637, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1638</span>: </pre>
<pre class="cython line score-110" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1639</span>: def _convert_to_dataframe(</pre>
<pre class='cython code score-110 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_61_convert_to_dataframe(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_60_convert_to_dataframe, "\n    Converts the result to a DataFrame, optionally preserving original columns.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_61_convert_to_dataframe = {"_convert_to_dataframe", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_61_convert_to_dataframe, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_60_convert_to_dataframe};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_61_convert_to_dataframe(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_result = 0;
  PyObject *__pyx_v_original_columns = 0;
  PyObject *__pyx_v_keep_columns_intact = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_convert_to_dataframe (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_result,&amp;__pyx_n_s_original_columns,&amp;__pyx_n_s_keep_columns_intact,0};
  PyObject* values[3] = {0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_result)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_original_columns)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_to_dataframe", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_keep_columns_intact)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_to_dataframe", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_convert_to_dataframe") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
    }
    __pyx_v_result = values[0];
    __pyx_v_original_columns = values[1];
    __pyx_v_keep_columns_intact = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_to_dataframe", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_to_dataframe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_60_convert_to_dataframe(__pyx_self, __pyx_v_result, __pyx_v_original_columns, __pyx_v_keep_columns_intact);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_60_convert_to_dataframe(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_result, PyObject *__pyx_v_original_columns, PyObject *__pyx_v_keep_columns_intact) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__101)
  <span class='trace'>__Pyx_TraceCall</span>("_convert_to_dataframe", __pyx_f[0], 1639, 0, <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_to_dataframe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__184 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_result, __pyx_n_s_original_columns, __pyx_n_s_keep_columns_intact);<span class='error_goto'> if (unlikely(!__pyx_tuple__184)) __PYX_ERR(0, 1639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__184);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__184);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1639,0,<span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_result, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_original_columns, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_keep_columns_intact, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return, __pyx_kp_s_pd_DataFrame) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_61_convert_to_dataframe, 0, __pyx_n_s_convert_to_dataframe, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__101));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convert_to_dataframe, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1639, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__101 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__184, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_convert_to_dataframe, 1639, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__101)) __PYX_ERR(0, 1639, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1640</span>:         result: Any, original_columns: Any,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1641</span>:         keep_columns_intact: bool) -&gt; pd.DataFrame:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1642</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1643</span>:     Converts the result to a DataFrame, optionally preserving original columns.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1644</span>:     """</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1645</span>:     if isinstance(result, (pd.Series, np.ndarray, list)):</pre>
<pre class='cython code score-27 '>  <span class='trace'>__Pyx_TraceLine</span>(1645,0,<span class='error_goto'>__PYX_ERR(0, 1645, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1645, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1645, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1645, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1645, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_result, __pyx_t_2); 
  if (!__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_result, __pyx_t_3); 
  if (!__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_5 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_result); 
  __pyx_t_4 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_4) {
/*  */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1646</span>:         if keep_columns_intact and original_columns is not None:</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1646,0,<span class='error_goto'>__PYX_ERR(0, 1646, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_keep_columns_intact); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1646, __pyx_L1_error)</span>
    if (__pyx_t_5) {
    } else {
      __pyx_t_4 = __pyx_t_5;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_5 = (__pyx_v_original_columns != Py_None);
    __pyx_t_4 = __pyx_t_5;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_4) {
/*  */
    }
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1647</span>:             return pd.DataFrame([result], columns=original_columns)</pre>
<pre class='cython code score-33 '>      <span class='trace'>__Pyx_TraceLine</span>(1647,0,<span class='error_goto'>__PYX_ERR(0, 1647, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_result);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_result)) <span class='error_goto'>__PYX_ERR(0, 1647, __pyx_L1_error)</span>;
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1647, __pyx_L1_error)</span>;
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_columns, __pyx_v_original_columns) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1647, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1647, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_r = __pyx_t_6;
      __pyx_t_6 = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1648</span>:         else:</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1649</span>:             return pd.DataFrame(result)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(1649,0,<span class='error_goto'>__PYX_ERR(0, 1649, __pyx_L1_error)</span>)
    /*else*/ {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1649, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1649, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = NULL;
      __pyx_t_7 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_7 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_result};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1649, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_r = __pyx_t_6;
      __pyx_t_6 = 0;
      goto __pyx_L0;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1650</span>:     return result</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1650,0,<span class='error_goto'>__PYX_ERR(0, 1650, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1651</span>: </pre>
<pre class="cython line score-90" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1652</span>: def _convert_to_series(</pre>
<pre class='cython code score-90 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_63_convert_to_series(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_62_convert_to_series, "\n    Converts the result to a Series, preserving original columns as index if applicable.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_63_convert_to_series = {"_convert_to_series", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_63_convert_to_series, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_62_convert_to_series};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_63_convert_to_series(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_result = 0;
  PyObject *__pyx_v_original_columns = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_convert_to_series (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_result,&amp;__pyx_n_s_original_columns,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_result)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1652, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_original_columns)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1652, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_to_series", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1652, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_convert_to_series") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1652, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_result = values[0];
    __pyx_v_original_columns = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_to_series", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1652, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_to_series", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_62_convert_to_series(__pyx_self, __pyx_v_result, __pyx_v_original_columns);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_62_convert_to_series(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_result, PyObject *__pyx_v_original_columns) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__102)
  <span class='trace'>__Pyx_TraceCall</span>("_convert_to_series", __pyx_f[0], 1652, 0, <span class='error_goto'>__PYX_ERR(0, 1652, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_to_series", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__185 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_result, __pyx_n_s_original_columns);<span class='error_goto'> if (unlikely(!__pyx_tuple__185)) __PYX_ERR(0, 1652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__185);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__185);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1652,0,<span class='error_goto'>__PYX_ERR(0, 1652, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_result, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1652, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_original_columns, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1652, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_kp_s_pd_Series) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1652, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_63_convert_to_series, 0, __pyx_n_s_convert_to_series, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__102));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convert_to_series, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1652, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__102 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__185, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_convert_to_series, 1652, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__102)) __PYX_ERR(0, 1652, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1653</span>:         result: Any, original_columns: Any) -&gt; pd.Series:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1654</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1655</span>:     Converts the result to a Series, preserving original columns as index if applicable.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1656</span>:     """</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1657</span>:     if isinstance(result, (np.ndarray, list)):</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(1657,0,<span class='error_goto'>__PYX_ERR(0, 1657, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_result, __pyx_t_2); 
  if (!__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_4 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_result); 
  __pyx_t_3 = __pyx_t_4;
  __pyx_L4_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1658</span>:         return pd.Series(</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(1658,0,<span class='error_goto'>__PYX_ERR(0, 1658, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1658, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1658, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(1659,0,<span class='error_goto'>__PYX_ERR(0, 1659, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1658, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_result);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_result)) <span class='error_goto'>__PYX_ERR(0, 1658, __pyx_L1_error)</span>;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(1658,0,<span class='error_goto'>__PYX_ERR(0, 1658, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1658, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_r = __pyx_t_6;
    __pyx_t_6 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1659</span>:             result, index=original_columns if original_columns is not None else None)</pre>
<pre class='cython code score-10 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1659, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = (__pyx_v_original_columns != Py_None);
    if (__pyx_t_3) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_original_columns);
      __pyx_t_6 = __pyx_v_original_columns;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
      __pyx_t_6 = Py_None;
    }
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_index, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1659, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1660</span>:     return result</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1660,0,<span class='error_goto'>__PYX_ERR(0, 1660, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1661</span>: </pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1662</span>: def _convert_to_ndarray(result: Any) -&gt; np.ndarray:</pre>
<pre class='cython code score-69 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_65_convert_to_ndarray(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_64_convert_to_ndarray, "\n    Converts the result to a NumPy ndarray, suitable for array-like results.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_65_convert_to_ndarray = {"_convert_to_ndarray", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_65_convert_to_ndarray, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_64_convert_to_ndarray};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_65_convert_to_ndarray(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_result = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_convert_to_ndarray (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_result,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_result)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_convert_to_ndarray") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_result = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_to_ndarray", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_to_ndarray", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_64_convert_to_ndarray(__pyx_self, __pyx_v_result);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_64_convert_to_ndarray(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_result) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__103)
  <span class='trace'>__Pyx_TraceCall</span>("_convert_to_ndarray", __pyx_f[0], 1662, 0, <span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_to_ndarray", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__186 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_result);<span class='error_goto'> if (unlikely(!__pyx_tuple__186)) __PYX_ERR(0, 1662, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__186);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__186);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1662,0,<span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1662, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_result, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return, __pyx_kp_s_np_ndarray) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_65_convert_to_ndarray, 0, __pyx_n_s_convert_to_ndarray, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__103));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1662, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convert_to_ndarray, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1662, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__103 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__186, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_convert_to_ndarray, 1662, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__103)) __PYX_ERR(0, 1662, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1663</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1664</span>:     Converts the result to a NumPy ndarray, suitable for array-like results.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1665</span>:     """</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1666</span>:     if isinstance(result, (pd.Series, pd.DataFrame, list)):</pre>
<pre class='cython code score-27 '>  <span class='trace'>__Pyx_TraceLine</span>(1666,0,<span class='error_goto'>__PYX_ERR(0, 1666, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_result, __pyx_t_2); 
  if (!__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_result, __pyx_t_3); 
  if (!__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_5 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_result); 
  __pyx_t_4 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_4) {
/*  */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1667</span>:         return np.array(result)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(1667,0,<span class='error_goto'>__PYX_ERR(0, 1667, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1667, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1667, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_result};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1667, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1668</span>:     return result</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1668,0,<span class='error_goto'>__PYX_ERR(0, 1668, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1669</span>: </pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1670</span>: def _convert_to_list(result: Any) -&gt; list:</pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_67_convert_to_list(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_66_convert_to_list, "\n    Converts the result to a list, suitable for list-like results.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_67_convert_to_list = {"_convert_to_list", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_67_convert_to_list, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_66_convert_to_list};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_67_convert_to_list(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_result = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_convert_to_list (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_result,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_result)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_convert_to_list") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_result = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_to_list", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_to_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_66_convert_to_list(__pyx_self, __pyx_v_result);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_66_convert_to_list(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_result) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__104)
  <span class='trace'>__Pyx_TraceCall</span>("_convert_to_list", __pyx_f[0], 1670, 0, <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_to_list", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1670,0,<span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_result, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_s_list) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_67_convert_to_list, 0, __pyx_n_s_convert_to_list, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__104));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convert_to_list, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/*  */
  __pyx_codeobj__104 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__186, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_convert_to_list, 1670, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__104)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1671</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1672</span>:     Converts the result to a list, suitable for list-like results.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1673</span>:     """</pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1674</span>:     if isinstance(result, (pd.Series, pd.DataFrame, np.ndarray)):</pre>
<pre class='cython code score-33 '>  <span class='trace'>__Pyx_TraceLine</span>(1674,0,<span class='error_goto'>__PYX_ERR(0, 1674, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_result, __pyx_t_2); 
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_6 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_result, __pyx_t_3); 
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_6 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_result, __pyx_t_4); 
  __pyx_t_5 = __pyx_t_6;
  __pyx_L4_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {
/*  */
  }
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1675</span>:         return result.tolist()</pre>
<pre class='cython code score-24 '>    <span class='trace'>__Pyx_TraceLine</span>(1675,0,<span class='error_goto'>__PYX_ERR(0, 1675, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_result, __pyx_n_s_tolist);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1675, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("list", __pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 1675, __pyx_L1_error)</span>
    __pyx_r = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1676</span>:     return result</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(1676,0,<span class='error_goto'>__PYX_ERR(0, 1676, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_result))||((__pyx_v_result) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("list", __pyx_v_result))) <span class='error_goto'>__PYX_ERR(0, 1676, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = ((PyObject*)__pyx_v_result);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1677</span>: </pre>
<pre class="cython line score-76" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1678</span>: def to_pandas(</pre>
<pre class='cython code score-76 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_69to_pandas(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_68to_pandas, "\n    Attempts to convert input data into a Pandas DataFrame or Series. \n    \n    Intelligently handling various input types and applying an optional \n    transformation. Converts single-column DataFrames to Series if specified.\n\n    Parameters\n    ----------\n    data : Any\n        Input data to convert. Supports lists, arrays, dictionaries, and more.\n    prefer : str, optional\n        Preference for ambiguous conversion ('auto', 'series', 'dataframe').\n        Defaults to 'auto'.\n    convert_single_column : bool, optional\n        Converts single-column DataFrames to Series if True. Defaults to False.\n    transform : Callable[[Any], Any], optional\n        A function to apply to the data before conversion. The function should\n        accept the input data as its argument and return the transformed data.\n        Defaults to None.\n\n    Returns\n    -------\n    Union[pd.DataFrame, pd.Series]\n        The converted and potentially transformed Pandas object.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import to_pandas \n    &gt;&gt;&gt; to_pandas([1, 2, 3], prefer='series')\n    0    1\n    1    2\n    2    3\n    dtype: int64\n\n    &gt;&gt;&gt; to_pandas([[1], [2], [3]], convert_single_column=True)\n    0    1\n    1    2\n    2    3\n    Name: 0, dtype: int64\n\n    &gt;&gt;&gt; to_pandas({'A': [1, 2], 'B': [3, 4]})\n       A  B\n    0  1  3\n    1  2  4\n\n    &gt;&gt;&gt; def custom_transform(x):\n    ...     return x * 2\n    &gt;&gt;&gt; to_pandas([1, 2, 3], transform=custom_transform)\n    0    2\n    1    4\n    2    6\n    dtype: int64\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_69to_pandas = {"to_pandas", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_69to_pandas, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_68to_pandas};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_69to_pandas(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_prefer = 0;
  PyObject *__pyx_v_convert_single_column = 0;
  PyObject *__pyx_v_transform = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("to_pandas (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_prefer,&amp;__pyx_n_s_convert_single_column,&amp;__pyx_n_s_transform,0};
  PyObject* values[4] = {0,0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_auto)));
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_68to_pandas(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_prefer, PyObject *__pyx_v_convert_single_column, PyObject *__pyx_v_transform) {
  PyObject *__pyx_v_direct_result = NULL;
  PyObject *__pyx_v_e = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__105)
  <span class='trace'>__Pyx_TraceCall</span>("to_pandas", __pyx_f[0], 1678, 0, <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.to_pandas", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_direct_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_e);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__187 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_data, __pyx_n_s_prefer, __pyx_n_s_convert_single_column, __pyx_n_s_transform, __pyx_n_s_direct_result, __pyx_n_s_e);<span class='error_goto'> if (unlikely(!__pyx_tuple__187)) __PYX_ERR(0, 1678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__187);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__187);
  __pyx_codeobj__105 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__187, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_to_pandas, 1678, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__105)) __PYX_ERR(0, 1678, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1678,0,<span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_data, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_prefer, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_convert_single_column, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_transform, __pyx_kp_s_Callable_Any_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return, __pyx_kp_s_Union_DataFrame_Series) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_69to_pandas, 0, __pyx_n_s_to_pandas, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__105));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__188);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_to_pandas, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__188 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject*)__pyx_n_u_auto), ((PyObject *)Py_False), Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__188)) __PYX_ERR(0, 1678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__188);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__188);
</pre><pre class="cython line score-0">&#xA0;<span class="">1679</span>:     data: Any,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1680</span>:     prefer: str = 'auto',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1681</span>:     convert_single_column: bool = False,</pre>
<pre class='cython code score-2 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1682</span>:     transform: Callable[[Any], Any] = None</pre>
<pre class='cython code score-66 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_prefer);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_convert_single_column);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_transform);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "to_pandas") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_data = values[0];
    __pyx_v_prefer = ((PyObject*)values[1]);
    __pyx_v_convert_single_column = values[2];
    __pyx_v_transform = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("to_pandas", 0, 1, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.to_pandas", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_prefer), (&amp;PyUnicode_Type), 0, "prefer", 1))) <span class='error_goto'>__PYX_ERR(0, 1680, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_68to_pandas(__pyx_self, __pyx_v_data, __pyx_v_prefer, __pyx_v_convert_single_column, __pyx_v_transform);
</pre><pre class="cython line score-0">&#xA0;<span class="">1683</span>: ) -&gt; Union[DataFrame, Series]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1684</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1685</span>:     Attempts to convert input data into a Pandas DataFrame or Series.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1686</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1687</span>:     Intelligently handling various input types and applying an optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1688</span>:     transformation. Converts single-column DataFrames to Series if specified.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1689</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1690</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1691</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1692</span>:     data : Any</pre>
<pre class="cython line score-0">&#xA0;<span class="">1693</span>:         Input data to convert. Supports lists, arrays, dictionaries, and more.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1694</span>:     prefer : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1695</span>:         Preference for ambiguous conversion ('auto', 'series', 'dataframe').</pre>
<pre class="cython line score-0">&#xA0;<span class="">1696</span>:         Defaults to 'auto'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1697</span>:     convert_single_column : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1698</span>:         Converts single-column DataFrames to Series if True. Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1699</span>:     transform : Callable[[Any], Any], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1700</span>:         A function to apply to the data before conversion. The function should</pre>
<pre class="cython line score-0">&#xA0;<span class="">1701</span>:         accept the input data as its argument and return the transformed data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1702</span>:         Defaults to None.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1703</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1704</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1705</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1706</span>:     Union[pd.DataFrame, pd.Series]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1707</span>:         The converted and potentially transformed Pandas object.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1708</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1709</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1710</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1711</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import to_pandas</pre>
<pre class="cython line score-0">&#xA0;<span class="">1712</span>:     &gt;&gt;&gt; to_pandas([1, 2, 3], prefer='series')</pre>
<pre class="cython line score-0">&#xA0;<span class="">1713</span>:     0    1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1714</span>:     1    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1715</span>:     2    3</pre>
<pre class="cython line score-0">&#xA0;<span class="">1716</span>:     dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">1717</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1718</span>:     &gt;&gt;&gt; to_pandas([[1], [2], [3]], convert_single_column=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1719</span>:     0    1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1720</span>:     1    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1721</span>:     2    3</pre>
<pre class="cython line score-0">&#xA0;<span class="">1722</span>:     Name: 0, dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">1723</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1724</span>:     &gt;&gt;&gt; to_pandas({'A': [1, 2], 'B': [3, 4]})</pre>
<pre class="cython line score-0">&#xA0;<span class="">1725</span>:        A  B</pre>
<pre class="cython line score-0">&#xA0;<span class="">1726</span>:     0  1  3</pre>
<pre class="cython line score-0">&#xA0;<span class="">1727</span>:     1  2  4</pre>
<pre class="cython line score-0">&#xA0;<span class="">1728</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1729</span>:     &gt;&gt;&gt; def custom_transform(x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1730</span>:     ...     return x * 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1731</span>:     &gt;&gt;&gt; to_pandas([1, 2, 3], transform=custom_transform)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1732</span>:     0    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1733</span>:     1    4</pre>
<pre class="cython line score-0">&#xA0;<span class="">1734</span>:     2    6</pre>
<pre class="cython line score-0">&#xA0;<span class="">1735</span>:     dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">1736</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1737</span>:     # Apply transformation if a callable is provided</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1738</span>:     if transform and callable(transform):</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(1738,0,<span class='error_goto'>__PYX_ERR(0, 1738, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_transform); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1738, __pyx_L1_error)</span>
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_v_transform);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 1738, __pyx_L1_error)</span>
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1739</span>:         data = transform(data)</pre>
<pre class='cython code score-16 '>    <span class='trace'>__Pyx_TraceLine</span>(1739,0,<span class='error_goto'>__PYX_ERR(0, 1739, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_transform);
    __pyx_t_4 = __pyx_v_transform; __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_data};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1739, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1740</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1741</span>:     direct_result = _handle_direct_conversion(data, convert_single_column)</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(1741,0,<span class='error_goto'>__PYX_ERR(0, 1741, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_handle_direct_conversion);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1741, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_v_data, __pyx_v_convert_single_column};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_v_direct_result = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1742</span>:     if direct_result is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1742,0,<span class='error_goto'>__PYX_ERR(0, 1742, __pyx_L1_error)</span>)
  __pyx_t_1 = (__pyx_v_direct_result != Py_None);
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1743</span>:         return direct_result  # Return if already a Series or DataFrame</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1743,0,<span class='error_goto'>__PYX_ERR(0, 1743, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_direct_result);
    __pyx_r = __pyx_v_direct_result;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1744</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1745</span>:     try:</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(1745,0,<span class='error_goto'>__PYX_ERR(0, 1745, __pyx_L1_error)</span>)
  {
    /*try:*/ {
/*  */
    }
    __pyx_L7_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/*  */
    __pyx_L9_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
    goto __pyx_L1_error;
    __pyx_L11_try_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
    goto __pyx_L0;
    __pyx_L10_except_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
    goto __pyx_L0;
  }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1746</span>:         if isinstance(data, (list, np.ndarray)):</pre>
<pre class='cython code score-16 '>      <span class='trace'>__Pyx_TraceLine</span>(1746,0,<span class='error_goto'>__PYX_ERR(0, 1746, __pyx_L7_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1746, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1746, __pyx_L7_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_data); 
      if (!__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L14_bool_binop_done;
      }
      __pyx_t_2 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_4); 
      __pyx_t_1 = __pyx_t_2;
      __pyx_L14_bool_binop_done:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_1) {
/*  */
      }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1747</span>:             data = np.array(data)</pre>
<pre class='cython code score-20 '>        <span class='trace'>__Pyx_TraceLine</span>(1747,0,<span class='error_goto'>__PYX_ERR(0, 1747, __pyx_L7_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1747, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1747, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = NULL;
        __pyx_t_6 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
          __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
          if (likely(__pyx_t_3)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
            __pyx_t_6 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_data};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1747, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
        __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1748</span>:             if data.ndim == 1 or (</pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(1748,0,<span class='error_goto'>__PYX_ERR(0, 1748, __pyx_L7_error)</span>)
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1748, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1748, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (!__pyx_t_2) {
        } else {
          __pyx_t_1 = __pyx_t_2;
          goto __pyx_L17_bool_binop_done;
        }
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(1748,0,<span class='error_goto'>__PYX_ERR(0, 1748, __pyx_L7_error)</span>)
        if (__pyx_t_1) {
/*  */
        }
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1749</span>:                     data.ndim == 2 and data.shape[1] == 1 and prefer != 'dataframe'):</pre>
<pre class='cython code score-15 '>        <span class='trace'>__Pyx_TraceLine</span>(1749,0,<span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L7_error)</span>)
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1749, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_4, __pyx_int_2, 2, 0)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (__pyx_t_2) {
        } else {
          __pyx_t_1 = __pyx_t_2;
          goto __pyx_L17_bool_binop_done;
        }
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1749, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1749, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_5, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L7_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (__pyx_t_2) {
        } else {
          __pyx_t_1 = __pyx_t_2;
          goto __pyx_L17_bool_binop_done;
        }
        __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_prefer, __pyx_n_u_dataframe, Py_NE)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1749, __pyx_L7_error)</span>
        __pyx_t_1 = __pyx_t_2;
        __pyx_L17_bool_binop_done:;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1750</span>:                 return _convert_2_series(data)</pre>
<pre class='cython code score-17 '>          <span class='trace'>__Pyx_TraceLine</span>(1750,0,<span class='error_goto'>__PYX_ERR(0, 1750, __pyx_L7_error)</span>)
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
          <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_convert_2_series);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1750, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          __pyx_t_3 = NULL;
          __pyx_t_6 = 0;
          #if CYTHON_UNPACK_METHODS
          if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
            __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
            if (likely(__pyx_t_3)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
              __pyx_t_6 = 1;
            }
          }
          #endif
          {
            PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_data};
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1750, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          }
          __pyx_r = __pyx_t_5;
          __pyx_t_5 = 0;
          goto __pyx_L11_try_return;
</pre><pre class="cython line score-0">&#xA0;<span class="">1751</span>:             else:</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1752</span>:                 return _convert_2_dataframe(data, convert_single_column)</pre>
<pre class='cython code score-17 '>        <span class='trace'>__Pyx_TraceLine</span>(1752,0,<span class='error_goto'>__PYX_ERR(0, 1752, __pyx_L7_error)</span>)
        /*else*/ {
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
          <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_convert_2_dataframe);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1752, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          __pyx_t_3 = NULL;
          __pyx_t_6 = 0;
          #if CYTHON_UNPACK_METHODS
          if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
            __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
            if (likely(__pyx_t_3)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
              __pyx_t_6 = 1;
            }
          }
          #endif
          {
            PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_data, __pyx_v_convert_single_column};
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1752, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          }
          __pyx_r = __pyx_t_5;
          __pyx_t_5 = 0;
          goto __pyx_L11_try_return;
        }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1753</span>:         elif isinstance(data, dict):</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(1753,0,<span class='error_goto'>__PYX_ERR(0, 1753, __pyx_L7_error)</span>)
      __pyx_t_1 = <span class='py_c_api'>PyDict_Check</span>(__pyx_v_data); 
      if (likely(__pyx_t_1)) {
/*  */
      }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1754</span>:             return _convert_to_dataframe(data, convert_single_column)</pre>
<pre class='cython code score-17 '>        <span class='trace'>__Pyx_TraceLine</span>(1754,0,<span class='error_goto'>__PYX_ERR(0, 1754, __pyx_L7_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_convert_to_dataframe);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1754, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_3 = NULL;
        __pyx_t_6 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
          __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
          if (likely(__pyx_t_3)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
            __pyx_t_6 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_data, __pyx_v_convert_single_column};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1754, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        }
        __pyx_r = __pyx_t_5;
        __pyx_t_5 = 0;
        goto __pyx_L11_try_return;
</pre><pre class="cython line score-0">&#xA0;<span class="">1755</span>:         else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1756</span>:             raise TypeError("Unsupported data type for conversion.")</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(1756,0,<span class='error_goto'>__PYX_ERR(0, 1756, __pyx_L7_error)</span>)
      /*else*/ {
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__106, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1756, __pyx_L7_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='error_goto'>__PYX_ERR(0, 1756, __pyx_L7_error)</span>
      }
/*  */
  __pyx_tuple__106 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Unsupported_data_type_for_conver);<span class='error_goto'> if (unlikely(!__pyx_tuple__106)) __PYX_ERR(0, 1756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__106);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__106);
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1757</span>:     except Exception as e:</pre>
<pre class='cython code score-21 '>    <span class='trace'>__Pyx_TraceLine</span>(1757,0,<span class='error_goto'>__PYX_ERR(0, 1757, __pyx_L9_except_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])));
    if (__pyx_t_6) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.to_pandas", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1757, __pyx_L9_except_error)</span>
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      __pyx_v_e = __pyx_t_4;
      /*try:*/ {
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(1757,0,<span class='error_goto'>__PYX_ERR(0, 1757, __pyx_L26_error)</span>)
      /*finally:*/ {
        __pyx_L26_error:;
        /*exception exit:*/{
          __Pyx_PyThreadState_declare
          __Pyx_PyThreadState_assign
          __pyx_t_14 = 0; __pyx_t_15 = 0; __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_17, &amp;__pyx_t_18, &amp;__pyx_t_19);
          if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_14, &amp;__pyx_t_15, &amp;__pyx_t_16) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_14, &amp;__pyx_t_15, &amp;__pyx_t_16);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_15);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_16);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_17);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_18);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_19);
          __pyx_t_6 = __pyx_lineno; __pyx_t_12 = __pyx_clineno; __pyx_t_13 = __pyx_filename;
          {
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
          }
          if (PY_MAJOR_VERSION &gt;= 3) {
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_17);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_18);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_19);
            <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_17, __pyx_t_18, __pyx_t_19);
          }
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_15);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_16);
          <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_14, __pyx_t_15, __pyx_t_16);
          __pyx_t_14 = 0; __pyx_t_15 = 0; __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0;
          __pyx_lineno = __pyx_t_6; __pyx_clineno = __pyx_t_12; __pyx_filename = __pyx_t_13;
          goto __pyx_L9_except_error;
        }
        __pyx_L25_return: {
          __pyx_t_19 = __pyx_r;
          __pyx_r = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
          __pyx_r = __pyx_t_19;
          __pyx_t_19 = 0;
          goto __pyx_L10_except_return;
        }
      }
    }
    goto __pyx_L9_except_error;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1758</span>:         print(f"Conversion failed: {e}")</pre>
<pre class='cython code score-9 '>        <span class='trace'>__Pyx_TraceLine</span>(1758,0,<span class='error_goto'>__PYX_ERR(0, 1758, __pyx_L26_error)</span>)
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_e, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1758, __pyx_L26_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_Conversion_failed, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1758, __pyx_L26_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1758, __pyx_L26_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1759</span>:         return data  # Return original data if conversion is not feasible</pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(1759,0,<span class='error_goto'>__PYX_ERR(0, 1759, __pyx_L26_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
        __pyx_r = __pyx_v_data;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        goto __pyx_L25_return;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">1760</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1761</span>: </pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1762</span>: def _convert_2_series(data):</pre>
<pre class='cython code score-57 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_71_convert_2_series(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_70_convert_2_series, "\n    Converts the input data to a Pandas Series, ensuring flat structures are\n    appropriately handled.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_71_convert_2_series = {"_convert_2_series", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_71_convert_2_series, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_70_convert_2_series};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_71_convert_2_series(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_convert_2_series (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1762, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_convert_2_series") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1762, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_data = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_2_series", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1762, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_2_series", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_70_convert_2_series(__pyx_self, __pyx_v_data);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_70_convert_2_series(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__107)
  <span class='trace'>__Pyx_TraceCall</span>("_convert_2_series", __pyx_f[0], 1762, 0, <span class='error_goto'>__PYX_ERR(0, 1762, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_2_series", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__189 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_tuple__189)) __PYX_ERR(0, 1762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__189);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__189);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1762,0,<span class='error_goto'>__PYX_ERR(0, 1762, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_71_convert_2_series, 0, __pyx_n_s_convert_2_series, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__107));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convert_2_series, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1762, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__107 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__189, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_convert_2_series, 1762, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__107)) __PYX_ERR(0, 1762, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1763</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1764</span>:     Converts the input data to a Pandas Series, ensuring flat structures are</pre>
<pre class="cython line score-0">&#xA0;<span class="">1765</span>:     appropriately handled.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1766</span>:     """</pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1767</span>:     return pd.Series(np.array(data).flatten())</pre>
<pre class='cython code score-57 '>  <span class='trace'>__Pyx_TraceLine</span>(1767,0,<span class='error_goto'>__PYX_ERR(0, 1767, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1767, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1767, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1767, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1767, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_data};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1767, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_flatten);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1767, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1767, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1767, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1768</span>: </pre>
<pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1769</span>: def _convert_2_dataframe(data, convert_single_column):</pre>
<pre class='cython code score-71 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_73_convert_2_dataframe(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_72_convert_2_dataframe, "\n    Converts the input data to a Pandas DataFrame. If `convert_single_column`\n    is True and the DataFrame contains only one column, converts it to a Series.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_73_convert_2_dataframe = {"_convert_2_dataframe", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_73_convert_2_dataframe, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_72_convert_2_dataframe};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_73_convert_2_dataframe(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_convert_single_column = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_convert_2_dataframe (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_convert_single_column,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_convert_single_column)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_2_dataframe", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_convert_2_dataframe") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_data = values[0];
    __pyx_v_convert_single_column = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_convert_2_dataframe", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_2_dataframe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_72_convert_2_dataframe(__pyx_self, __pyx_v_data, __pyx_v_convert_single_column);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_72_convert_2_dataframe(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_convert_single_column) {
  PyObject *__pyx_v_df = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__108)
  <span class='trace'>__Pyx_TraceCall</span>("_convert_2_dataframe", __pyx_f[0], 1769, 0, <span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._convert_2_dataframe", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_df);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__190 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_data, __pyx_n_s_convert_single_column, __pyx_n_s_df);<span class='error_goto'> if (unlikely(!__pyx_tuple__190)) __PYX_ERR(0, 1769, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__190);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__190);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1769,0,<span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_73_convert_2_dataframe, 0, __pyx_n_s_convert_2_dataframe, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__108));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1769, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convert_2_dataframe, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__108 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__190, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_convert_2_dataframe, 1769, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__108)) __PYX_ERR(0, 1769, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1770</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1771</span>:     Converts the input data to a Pandas DataFrame. If `convert_single_column`</pre>
<pre class="cython line score-0">&#xA0;<span class="">1772</span>:     is True and the DataFrame contains only one column, converts it to a Series.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1773</span>:     """</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1774</span>:     df = pd.DataFrame(data)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(1774,0,<span class='error_goto'>__PYX_ERR(0, 1774, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1774, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_data};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1774, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_df = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1775</span>:     if convert_single_column and df.shape[1] == 1:</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(1775,0,<span class='error_goto'>__PYX_ERR(0, 1775, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_convert_single_column); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1775, __pyx_L1_error)</span>
  if (__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1775, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1775, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1775, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = __pyx_t_6;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_5) {
/*  */
  }
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1776</span>:         return df.iloc[:, 0].rename(df.columns[0])</pre>
<pre class='cython code score-39 '>    <span class='trace'>__Pyx_TraceLine</span>(1776,0,<span class='error_goto'>__PYX_ERR(0, 1776, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/*  */
  __pyx_slice__109 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__109)) __PYX_ERR(0, 1776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__109);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__109);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_tuple__110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_rename);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_7};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1776, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  __pyx_tuple__110 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__109, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 1776, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__110);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__110);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1777</span>:     return df</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1777,0,<span class='error_goto'>__PYX_ERR(0, 1777, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
  __pyx_r = __pyx_v_df;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1778</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1779</span>: def _handle_direct_conversion(data, convert_single_column):</pre>
<pre class='cython code score-70 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_75_handle_direct_conversion(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_74_handle_direct_conversion, "\n    Directly handles conversion if the input is already a Pandas Series or DataFrame,\n    applying single-column DataFrame to Series conversion if necessary.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_75_handle_direct_conversion = {"_handle_direct_conversion", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_75_handle_direct_conversion, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_74_handle_direct_conversion};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_75_handle_direct_conversion(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_convert_single_column = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_handle_direct_conversion (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_convert_single_column,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1779, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_convert_single_column)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1779, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_handle_direct_conversion", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1779, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_handle_direct_conversion") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1779, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_data = values[0];
    __pyx_v_convert_single_column = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_handle_direct_conversion", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1779, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._handle_direct_conversion", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_74_handle_direct_conversion(__pyx_self, __pyx_v_data, __pyx_v_convert_single_column);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_74_handle_direct_conversion(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_convert_single_column) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__111)
  <span class='trace'>__Pyx_TraceCall</span>("_handle_direct_conversion", __pyx_f[0], 1779, 0, <span class='error_goto'>__PYX_ERR(0, 1779, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._handle_direct_conversion", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__191 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_data, __pyx_n_s_convert_single_column);<span class='error_goto'> if (unlikely(!__pyx_tuple__191)) __PYX_ERR(0, 1779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__191);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__191);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1779,0,<span class='error_goto'>__PYX_ERR(0, 1779, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_75_handle_direct_conversion, 0, __pyx_n_s_handle_direct_conversion, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__111));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_handle_direct_conversion, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1779, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__111 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__191, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_handle_direct_conversion, 1779, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__111)) __PYX_ERR(0, 1779, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1780</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1781</span>:     Directly handles conversion if the input is already a Pandas Series or DataFrame,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1782</span>:     applying single-column DataFrame to Series conversion if necessary.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1783</span>:     """</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1784</span>:     if isinstance(data, pd.Series):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1784,0,<span class='error_goto'>__PYX_ERR(0, 1784, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1785</span>:         return data</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1785,0,<span class='error_goto'>__PYX_ERR(0, 1785, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
    __pyx_r = __pyx_v_data;
    goto __pyx_L0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1786</span>:     if isinstance(data, pd.DataFrame):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1786,0,<span class='error_goto'>__PYX_ERR(0, 1786, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1786, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1787</span>:         if convert_single_column and data.shape[1] == 1:</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(1787,0,<span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_convert_single_column); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L1_error)</span>
    if (__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1787, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1787, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_2, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1787, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
/*  */
    }
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1788</span>:             return data.iloc[:, 0].rename(data.columns[0])</pre>
<pre class='cython code score-29 '>      <span class='trace'>__Pyx_TraceLine</span>(1788,0,<span class='error_goto'>__PYX_ERR(0, 1788, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1788, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_tuple__110);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1788, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_rename);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1788, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1788, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1788, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = NULL;
      __pyx_t_7 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_7 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_6};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1788, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1789</span>:         return data</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1789,0,<span class='error_goto'>__PYX_ERR(0, 1789, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
    __pyx_r = __pyx_v_data;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1790</span>:     return None  # Indicates that direct conversion did not occur</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1790,0,<span class='error_goto'>__PYX_ERR(0, 1790, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1791</span>: </pre>
<pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1792</span>: def flatten_data_if(</pre>
<pre class='cython code score-77 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_77flatten_data_if(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_76flatten_data_if, "\n    Checks the input data's structure and flattens it if necessary to ensure\n    compatibility with functions expecting one-dimensional inputs. \n    \n    Optionally, applies a transformation to the flattened data and squeezes \n    single-element arrays to scalars if `squeeze` is True.\n\n    Parameters\n    ----------\n    data : Union[pd.DataFrame, pd.Series, np.ndarray, list]\n        The input data to be checked and potentially flattened.\n    apply_transform : Callable[[np.ndarray], np.ndarray], optional\n        A function to apply to the data after flattening. The function should\n        accept a one-dimensional NumPy array and return a NumPy array.\n    return_series : bool, optional\n        If True, returns a Pandas Series instead of a NumPy array. \n        Defaults to False.\n    series_name : str, optional\n        Name of the returned Series. Used only if `return_series` is True. \n        Defaults to 'flattened_data'.\n    squeeze: bool, optional\n        If True, attempts to squeeze the data, removing single-dimensional entries\n        from the shape of the array. For DataFrames, it attempts to return a Series\n        if only a single column exists. For arrays, it converts single-element arrays\n        to scalars.\n        \n    Returns\n    -------\n    Union[np.ndarray, pd.Series]\n        The flattened (and potentially transformed) data as a NumPy array \n        or Pandas Series.\n\n    Examples\n    --------\n    &gt;&gt;&gt; df = pd.DataFrame({'A': [1, 2, 3]})\n    &gt;&gt;&gt; flatten_data_if(df)\n    array([1, 2, 3])\n\n    &gt;&gt;&gt; series = pd.Series([4, 5, 6], name='B')\n    &gt;&gt;&gt; flatten_data_if(series, return_series=True)\n    0    4\n    1    5\n    2    6\n    Name: flattened_data, dtype: int64\n\n    &gt;&gt;&gt; def square(x):\n    ...     return x ** 2\n    &gt;&gt;&gt; flatten_data_if([1, 2, 3], apply_transform=square, return_series=True)\n    0    1\n    1    4\n    2    9\n    Name: flattened_data, dtype: int64\n    \n    &gt;&gt;&gt; def square(x):\n    ...     return x *""* 2\n    &gt;&gt;&gt; flatten_data_if([1], apply_transform=square, squeeze=True)\n    1\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_77flatten_data_if = {"flatten_data_if", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_77flatten_data_if, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_76flatten_data_if};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_77flatten_data_if(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_apply_transform = 0;
  PyObject *__pyx_v_return_series = 0;
  PyObject *__pyx_v_series_name = 0;
  PyObject *__pyx_v_squeeze = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("flatten_data_if (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_apply_transform,&amp;__pyx_n_s_return_series,&amp;__pyx_n_s_series_name,&amp;__pyx_n_s_squeeze,0};
  PyObject* values[5] = {0,0,0,0,0};
/*  */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_76flatten_data_if(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_apply_transform, PyObject *__pyx_v_return_series, PyObject *__pyx_v_series_name, PyObject *__pyx_v_squeeze) {
  PyObject *__pyx_v_flattened = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__112)
  <span class='trace'>__Pyx_TraceCall</span>("flatten_data_if", __pyx_f[0], 1792, 0, <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_series_name);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.flatten_data_if", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_flattened);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_series_name);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__192 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_data, __pyx_n_s_apply_transform, __pyx_n_s_return_series, __pyx_n_s_series_name, __pyx_n_s_squeeze, __pyx_n_s_flattened);<span class='error_goto'> if (unlikely(!__pyx_tuple__192)) __PYX_ERR(0, 1792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__192);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__192);
  __pyx_codeobj__112 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__192, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_flatten_data_if, 1792, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__112)) __PYX_ERR(0, 1792, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1792,0,<span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_data, __pyx_kp_s_Union_ArrayLike_list) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_apply_transform, __pyx_kp_s_Callable_ArrayLike_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return_series, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_series_name, __pyx_kp_s_Optional_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_squeeze, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_kp_s_Union_Array1D_Series) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_77flatten_data_if, 0, __pyx_n_s_flatten_data_if, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__112));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_5, __pyx_tuple__193);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_flatten_data_if, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_tuple__193 = <span class='py_c_api'>PyTuple_Pack</span>(4, Py_None, ((PyObject *)Py_False), Py_None, ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__193)) __PYX_ERR(0, 1792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__193);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__193);
</pre><pre class="cython line score-0">&#xA0;<span class="">1793</span>:     data: Union[ArrayLike, list],</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1794</span>:     apply_transform: Callable[[ArrayLike], ArrayLike] = None,</pre>
<pre class='cython code score-2 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1795</span>:     return_series: bool = False,</pre>
<pre class='cython code score-2 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1796</span>:     series_name: Optional[str] = None,</pre>
<pre class='cython code score-2 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1797</span>:     squeeze: bool=False,</pre>
<pre class='cython code score-77 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_apply_transform);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_series);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_series_name);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_squeeze);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "flatten_data_if") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_data = values[0];
    __pyx_v_apply_transform = values[1];
    __pyx_v_return_series = values[2];
    __pyx_v_series_name = values[3];
    __pyx_v_squeeze = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("flatten_data_if", 0, 1, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.flatten_data_if", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_76flatten_data_if(__pyx_self, __pyx_v_data, __pyx_v_apply_transform, __pyx_v_return_series, __pyx_v_series_name, __pyx_v_squeeze);
</pre><pre class="cython line score-0">&#xA0;<span class="">1798</span>: ) -&gt; Union[Array1D, Series]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1799</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1800</span>:     Checks the input data's structure and flattens it if necessary to ensure</pre>
<pre class="cython line score-0">&#xA0;<span class="">1801</span>:     compatibility with functions expecting one-dimensional inputs.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1802</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1803</span>:     Optionally, applies a transformation to the flattened data and squeezes</pre>
<pre class="cython line score-0">&#xA0;<span class="">1804</span>:     single-element arrays to scalars if `squeeze` is True.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1805</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1806</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1807</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1808</span>:     data : Union[pd.DataFrame, pd.Series, np.ndarray, list]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1809</span>:         The input data to be checked and potentially flattened.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1810</span>:     apply_transform : Callable[[np.ndarray], np.ndarray], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1811</span>:         A function to apply to the data after flattening. The function should</pre>
<pre class="cython line score-0">&#xA0;<span class="">1812</span>:         accept a one-dimensional NumPy array and return a NumPy array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1813</span>:     return_series : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1814</span>:         If True, returns a Pandas Series instead of a NumPy array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1815</span>:         Defaults to False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1816</span>:     series_name : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1817</span>:         Name of the returned Series. Used only if `return_series` is True.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1818</span>:         Defaults to 'flattened_data'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1819</span>:     squeeze: bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1820</span>:         If True, attempts to squeeze the data, removing single-dimensional entries</pre>
<pre class="cython line score-0">&#xA0;<span class="">1821</span>:         from the shape of the array. For DataFrames, it attempts to return a Series</pre>
<pre class="cython line score-0">&#xA0;<span class="">1822</span>:         if only a single column exists. For arrays, it converts single-element arrays</pre>
<pre class="cython line score-0">&#xA0;<span class="">1823</span>:         to scalars.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1824</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1825</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1826</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1827</span>:     Union[np.ndarray, pd.Series]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1828</span>:         The flattened (and potentially transformed) data as a NumPy array</pre>
<pre class="cython line score-0">&#xA0;<span class="">1829</span>:         or Pandas Series.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1830</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1831</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1832</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1833</span>:     &gt;&gt;&gt; df = pd.DataFrame({'A': [1, 2, 3]})</pre>
<pre class="cython line score-0">&#xA0;<span class="">1834</span>:     &gt;&gt;&gt; flatten_data_if(df)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1835</span>:     array([1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1836</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1837</span>:     &gt;&gt;&gt; series = pd.Series([4, 5, 6], name='B')</pre>
<pre class="cython line score-0">&#xA0;<span class="">1838</span>:     &gt;&gt;&gt; flatten_data_if(series, return_series=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1839</span>:     0    4</pre>
<pre class="cython line score-0">&#xA0;<span class="">1840</span>:     1    5</pre>
<pre class="cython line score-0">&#xA0;<span class="">1841</span>:     2    6</pre>
<pre class="cython line score-0">&#xA0;<span class="">1842</span>:     Name: flattened_data, dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">1843</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1844</span>:     &gt;&gt;&gt; def square(x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1845</span>:     ...     return x ** 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1846</span>:     &gt;&gt;&gt; flatten_data_if([1, 2, 3], apply_transform=square, return_series=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1847</span>:     0    1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1848</span>:     1    4</pre>
<pre class="cython line score-0">&#xA0;<span class="">1849</span>:     2    9</pre>
<pre class="cython line score-0">&#xA0;<span class="">1850</span>:     Name: flattened_data, dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">1851</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1852</span>:     &gt;&gt;&gt; def square(x):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1853</span>:     ...     return x ** 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1854</span>:     &gt;&gt;&gt; flatten_data_if([1], apply_transform=square, squeeze=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1855</span>:     1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1856</span>:     """</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1857</span>:     if isinstance(data, pd.DataFrame):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1857,0,<span class='error_goto'>__PYX_ERR(0, 1857, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1857, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1857, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1857, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1858</span>:         if data.shape[1] == 1:</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(1858,0,<span class='error_goto'>__PYX_ERR(0, 1858, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1858, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1858, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1858, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_3) {
/*  */
    }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1859</span>:             flattened = data.iloc[:, 0].values</pre>
<pre class='cython code score-8 '>      <span class='trace'>__Pyx_TraceLine</span>(1859,0,<span class='error_goto'>__PYX_ERR(0, 1859, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1859, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_tuple__110);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1859, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1859, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_flattened = __pyx_t_1;
      __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1860</span>:             if squeeze and flattened.size == 1:</pre>
<pre class='cython code score-7 '>      <span class='trace'>__Pyx_TraceLine</span>(1860,0,<span class='error_goto'>__PYX_ERR(0, 1860, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_squeeze); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1860, __pyx_L1_error)</span>
      if (__pyx_t_4) {
      } else {
        __pyx_t_3 = __pyx_t_4;
        goto __pyx_L6_bool_binop_done;
      }
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flattened, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1860, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1860, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_3 = __pyx_t_4;
      __pyx_L6_bool_binop_done:;
      if (__pyx_t_3) {
/*  */
      }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1861</span>:                 flattened = flattened.item()</pre>
<pre class='cython code score-17 '>        <span class='trace'>__Pyx_TraceLine</span>(1861,0,<span class='error_goto'>__PYX_ERR(0, 1861, __pyx_L1_error)</span>)
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flattened, __pyx_n_s_item);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1861, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_5 = NULL;
        __pyx_t_6 = 0;
        #if CYTHON_UNPACK_METHODS
        if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
          __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
          if (likely(__pyx_t_5)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
            __pyx_t_6 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1861, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_flattened, __pyx_t_1);
        __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1862</span>:             series_name = data.columns[0] if series_name is None else series_name</pre>
<pre class='cython code score-7 '>      <span class='trace'>__Pyx_TraceLine</span>(1862,0,<span class='error_goto'>__PYX_ERR(0, 1862, __pyx_L1_error)</span>)
      __pyx_t_3 = (__pyx_v_series_name == Py_None);
      if (__pyx_t_3) {
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1862, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1862, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_1 = __pyx_t_5;
        __pyx_t_5 = 0;
      } else {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_series_name);
        __pyx_t_1 = __pyx_v_series_name;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_series_name, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1863</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1864</span>:     elif isinstance(data, pd.Series):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1864,0,<span class='error_goto'>__PYX_ERR(0, 1864, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1864, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1864, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1864, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (__pyx_t_3) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1865</span>:         flattened = data.values</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1865,0,<span class='error_goto'>__PYX_ERR(0, 1865, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_values);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_v_flattened = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1866</span>:         if squeeze and flattened.size == 1:</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(1866,0,<span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_squeeze); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
    if (__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flattened, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1866, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_5, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1866, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_3 = __pyx_t_4;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_3) {
/*  */
    }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1867</span>:             flattened = flattened.item()</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(1867,0,<span class='error_goto'>__PYX_ERR(0, 1867, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flattened, __pyx_n_s_item);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1867, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1867, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_flattened, __pyx_t_5);
      __pyx_t_5 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1868</span>:         series_name = data.name if series_name is None else series_name</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(1868,0,<span class='error_goto'>__PYX_ERR(0, 1868, __pyx_L1_error)</span>)
    __pyx_t_3 = (__pyx_v_series_name == Py_None);
    if (__pyx_t_3) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = __pyx_t_1;
      __pyx_t_1 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_series_name);
      __pyx_t_5 = __pyx_v_series_name;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_series_name, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1869</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1870</span>:     elif isinstance(data, (np.ndarray, list, tuple)):</pre>
<pre class='cython code score-21 '>  <span class='trace'>__Pyx_TraceLine</span>(1870,0,<span class='error_goto'>__PYX_ERR(0, 1870, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1870, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1870, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_1); 
  if (!__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L11_bool_binop_done;
  }
  __pyx_t_4 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_data); 
  if (!__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L11_bool_binop_done;
  }
  __pyx_t_4 = <span class='py_c_api'>PyTuple_Check</span>(__pyx_v_data); 
  __pyx_t_3 = __pyx_t_4;
  __pyx_L11_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(__pyx_t_3)) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1871</span>:         flattened = np.array(data).flatten()</pre>
<pre class='cython code score-36 '>    <span class='trace'>__Pyx_TraceLine</span>(1871,0,<span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1871, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1871, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_data};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_flatten);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1871, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    __pyx_v_flattened = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1872</span>:         if squeeze and flattened.size == 1:</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(1872,0,<span class='error_goto'>__PYX_ERR(0, 1872, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_squeeze); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1872, __pyx_L1_error)</span>
    if (__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L15_bool_binop_done;
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flattened, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1872, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1872, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = __pyx_t_4;
    __pyx_L15_bool_binop_done:;
    if (__pyx_t_3) {
/*  */
    }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1873</span>:             flattened = flattened.item()</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(1873,0,<span class='error_goto'>__PYX_ERR(0, 1873, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_flattened, __pyx_n_s_item);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_5 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1873, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_flattened, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1874</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1875</span>:     else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1876</span>:         raise TypeError(</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(1876,0,<span class='error_goto'>__PYX_ERR(0, 1876, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__113, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1876, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1876, __pyx_L1_error)</span>
  }
  __pyx_L3:;
/*  */
  __pyx_tuple__113 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Unsupported_data_type_Expected_D);<span class='error_goto'> if (unlikely(!__pyx_tuple__113)) __PYX_ERR(0, 1876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__113);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__113);
</pre><pre class="cython line score-0">&#xA0;<span class="">1877</span>:             "Unsupported data type. Expected DataFrame, Series, ndarray, or list.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">1878</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1879</span>:     if apply_transform is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1879,0,<span class='error_goto'>__PYX_ERR(0, 1879, __pyx_L1_error)</span>)
  __pyx_t_3 = (__pyx_v_apply_transform != Py_None);
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1880</span>:         flattened = apply_transform(flattened)</pre>
<pre class='cython code score-18 '>    <span class='trace'>__Pyx_TraceLine</span>(1880,0,<span class='error_goto'>__PYX_ERR(0, 1880, __pyx_L1_error)</span>)
    if (unlikely(!__pyx_v_flattened)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("flattened"); <span class='error_goto'>__PYX_ERR(0, 1880, __pyx_L1_error)</span> }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_apply_transform);
    __pyx_t_7 = __pyx_v_apply_transform; __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_flattened};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1880, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_flattened, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1881</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1882</span>:     if return_series:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1882,0,<span class='error_goto'>__PYX_ERR(0, 1882, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_series); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1882, __pyx_L1_error)</span>
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1883</span>:         series_name = series_name or 'flattened_data'</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(1883,0,<span class='error_goto'>__PYX_ERR(0, 1883, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_series_name); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1883, __pyx_L1_error)</span>
    if (!__pyx_t_3) {
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_series_name);
      __pyx_t_1 = __pyx_v_series_name;
      goto __pyx_L19_bool_binop_done;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_flattened_data);
    __pyx_t_1 = __pyx_n_u_flattened_data;
    __pyx_L19_bool_binop_done:;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_series_name, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1884</span>:         return pd.Series(flattened, name=series_name)</pre>
<pre class='cython code score-28 '>    <span class='trace'>__Pyx_TraceLine</span>(1884,0,<span class='error_goto'>__PYX_ERR(0, 1884, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1884, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1884, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_v_flattened)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("flattened"); <span class='error_goto'>__PYX_ERR(0, 1884, __pyx_L1_error)</span> }
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1884, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flattened);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_flattened);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_flattened)) <span class='error_goto'>__PYX_ERR(0, 1884, __pyx_L1_error)</span>;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1884, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_name, __pyx_v_series_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1884, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1884, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1885</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1886</span>:     return flattened</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(1886,0,<span class='error_goto'>__PYX_ERR(0, 1886, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_flattened)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("flattened"); <span class='error_goto'>__PYX_ERR(0, 1886, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_flattened);
  __pyx_r = __pyx_v_flattened;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1887</span>: </pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1888</span>: def update_series_index(</pre>
<pre class='cython code score-84 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_79update_series_index(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_78update_series_index, "\n    Updates the index of a pandas Series with new values under certain conditions.\n\n    Parameters\n    ----------\n    series : pd.Series\n        The Series whose index is to be updated.\n    new_indexes : list of str or str, optional\n        New values to set as the Series index. If a single string is provided, \n        it's converted to a list with one element. If None, no update is performed.\n    allow_replace : bool, default False\n        If True, allows the replacement of the existing index even if it's not \n        of integer type.\n    return_series : bool, default False\n        If True, the updated Series is returned. Otherwise, the new index \n        list is returned.\n    on_error : str, default 'ignore'\n        Determines the error handling strategy. If 'raise', an error is thrown \n        on failure conditions such as index length mismatch or unsatisfied \n        conditions.\n    transform : Callable, optional\n        A function to apply to each element of `new_indexes` before updating \n        the index. It must accept a single value and return the transformed value.\n    condition : Callable[[pd.Series], bool], optional\n        A function that takes the series as input and returns True if the \n        index update should proceed. If False, the update is skipped. This \n        function is checked before any updates.\n\n    Returns\n    -------\n    pd.Series or list\n        Depending on `return_series`, either the updated Series or the new \n        index list is returned.\n\n    Raises\n    ------\n    ValueError\n        If `on_error` is set to 'raise' and any precondition fails (\n            e.g., index length mismatch, condition check fails).\n\n    Examples\n    --------\n    &gt;&gt;&gt; import pandas as pd\n    &gt;&gt;&gt; from gofast.tools.funcutils import update_series_index\n    &gt;&gt;&gt; series = pd.Series([1, 2, 3])\n\n    # Update index without conditions\n    &gt;&gt;&gt; update_series_index(series, new_indexes=['a', 'b', 'c'], return_series=True)""\n    a    1\n    b    2\n    c    3\n    dtype: int64\n\n    # Update index with a condition function\n    &gt;&gt;&gt; condition_func = lambda s: pd.api.types.is_integer_dtype(s.index.dtype)\n    &gt;&gt;&gt; update_series_index(series, new_indexes=['x', 'y', 'z'],\n                            condition=condition_func, return_series=True)\n    0    1\n    1    2\n    2    3\n    dtype: int64\n\n    # Example with transform function\n    &gt;&gt;&gt; transform_func = lambda x: f'index_{x}'\n    &gt;&gt;&gt; update_series_index(series, new_indexes=[1, 2, 3],\n                            transform=transform_func, return_series=True)\n    index_1    1\n    index_2    2\n    index_3    3\n    dtype: int64\n\n    Note: In the second example, the condition function checks if the series \n    dtype is integer, which is not met, hence the index is not updated.\n    Adjusted the condition function according to specific requirements.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_79update_series_index = {"update_series_index", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_79update_series_index, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_78update_series_index};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_79update_series_index(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_series = 0;
  PyObject *__pyx_v_new_indexes = 0;
  PyObject *__pyx_v_allow_replace = 0;
  PyObject *__pyx_v_return_series = 0;
  PyObject *__pyx_v_on_error = 0;
  PyObject *__pyx_v_transform = 0;
  PyObject *__pyx_v_condition = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_series_index (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_series,&amp;__pyx_n_s_new_indexes,&amp;__pyx_n_s_allow_replace,&amp;__pyx_n_s_return_series,&amp;__pyx_n_s_on_error,&amp;__pyx_n_s_transform,&amp;__pyx_n_s_condition,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_78update_series_index(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_series, PyObject *__pyx_v_new_indexes, PyObject *__pyx_v_allow_replace, PyObject *__pyx_v_return_series, PyObject *__pyx_v_on_error, PyObject *__pyx_v_transform, PyObject *__pyx_v_condition) {
  PyObject *__pyx_v_msg = NULL;
  PyObject *__pyx_8genexpr1__pyx_v_idx = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__114)
  <span class='trace'>__Pyx_TraceCall</span>("update_series_index", __pyx_f[0], 1888, 0, <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_indexes);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.update_series_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_msg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_new_indexes);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__194 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_series, __pyx_n_s_new_indexes, __pyx_n_s_allow_replace, __pyx_n_s_return_series, __pyx_n_s_on_error, __pyx_n_s_transform, __pyx_n_s_condition, __pyx_n_s_msg, __pyx_n_s_idx);<span class='error_goto'> if (unlikely(!__pyx_tuple__194)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__194);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__194);
  __pyx_codeobj__114 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__194, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_update_series_index, 1888, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__114)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(1888,0,<span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_series, __pyx_n_s_Series) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_new_indexes, __pyx_kp_s_Optional_Union_list_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_allow_replace, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return_series, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_on_error, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_transform, __pyx_kp_s_Optional_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_condition, __pyx_kp_s_Optional_LambdaType_Callable_Ser) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_79update_series_index, 0, __pyx_n_s_update_series_index, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__114));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__195);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_update_series_index, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__195 = <span class='py_c_api'>PyTuple_Pack</span>(6, Py_None, ((PyObject *)Py_False), ((PyObject *)Py_False), ((PyObject*)__pyx_n_u_ignore), Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__195)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__195);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__195);
</pre><pre class="cython line score-0">&#xA0;<span class="">1889</span>:     series: Series,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1890</span>:     new_indexes: Optional[Union[list, str]] = None,</pre>
<pre class='cython code score-2 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1891</span>:     allow_replace: bool = False,</pre>
<pre class='cython code score-2 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1892</span>:     return_series: bool = False,</pre>
<pre class='cython code score-4 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_ignore)));
</pre><pre class="cython line score-0">&#xA0;<span class="">1893</span>:     on_error: str = 'ignore',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1894</span>:     transform: Optional[Callable] = None,</pre>
<pre class='cython code score-2 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-105" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1895</span>:     condition: Optional[LambdaType|Callable[[Series], bool]] = None</pre>
<pre class='cython code score-105 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_series)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_new_indexes);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_allow_replace);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_series);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_error);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_transform);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_condition);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "update_series_index") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_series = values[0];
    __pyx_v_new_indexes = values[1];
    __pyx_v_allow_replace = values[2];
    __pyx_v_return_series = values[3];
    __pyx_v_on_error = ((PyObject*)values[4]);
    __pyx_v_transform = values[5];
    __pyx_v_condition = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_series_index", 0, 1, 7, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.update_series_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_on_error), (&amp;PyUnicode_Type), 0, "on_error", 1))) <span class='error_goto'>__PYX_ERR(0, 1893, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_78update_series_index(__pyx_self, __pyx_v_series, __pyx_v_new_indexes, __pyx_v_allow_replace, __pyx_v_return_series, __pyx_v_on_error, __pyx_v_transform, __pyx_v_condition);
</pre><pre class="cython line score-0">&#xA0;<span class="">1896</span>: ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1897</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1898</span>:     Updates the index of a pandas Series with new values under certain conditions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1899</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1900</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1901</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1902</span>:     series : pd.Series</pre>
<pre class="cython line score-0">&#xA0;<span class="">1903</span>:         The Series whose index is to be updated.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1904</span>:     new_indexes : list of str or str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1905</span>:         New values to set as the Series index. If a single string is provided,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1906</span>:         it's converted to a list with one element. If None, no update is performed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1907</span>:     allow_replace : bool, default False</pre>
<pre class="cython line score-0">&#xA0;<span class="">1908</span>:         If True, allows the replacement of the existing index even if it's not</pre>
<pre class="cython line score-0">&#xA0;<span class="">1909</span>:         of integer type.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1910</span>:     return_series : bool, default False</pre>
<pre class="cython line score-0">&#xA0;<span class="">1911</span>:         If True, the updated Series is returned. Otherwise, the new index</pre>
<pre class="cython line score-0">&#xA0;<span class="">1912</span>:         list is returned.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1913</span>:     on_error : str, default 'ignore'</pre>
<pre class="cython line score-0">&#xA0;<span class="">1914</span>:         Determines the error handling strategy. If 'raise', an error is thrown</pre>
<pre class="cython line score-0">&#xA0;<span class="">1915</span>:         on failure conditions such as index length mismatch or unsatisfied</pre>
<pre class="cython line score-0">&#xA0;<span class="">1916</span>:         conditions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1917</span>:     transform : Callable, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1918</span>:         A function to apply to each element of `new_indexes` before updating</pre>
<pre class="cython line score-0">&#xA0;<span class="">1919</span>:         the index. It must accept a single value and return the transformed value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1920</span>:     condition : Callable[[pd.Series], bool], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1921</span>:         A function that takes the series as input and returns True if the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1922</span>:         index update should proceed. If False, the update is skipped. This</pre>
<pre class="cython line score-0">&#xA0;<span class="">1923</span>:         function is checked before any updates.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1924</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1925</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1926</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1927</span>:     pd.Series or list</pre>
<pre class="cython line score-0">&#xA0;<span class="">1928</span>:         Depending on `return_series`, either the updated Series or the new</pre>
<pre class="cython line score-0">&#xA0;<span class="">1929</span>:         index list is returned.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1930</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1931</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">1932</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1933</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">1934</span>:         If `on_error` is set to 'raise' and any precondition fails (</pre>
<pre class="cython line score-0">&#xA0;<span class="">1935</span>:             e.g., index length mismatch, condition check fails).</pre>
<pre class="cython line score-0">&#xA0;<span class="">1936</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1937</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1938</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1939</span>:     &gt;&gt;&gt; import pandas as pd</pre>
<pre class="cython line score-0">&#xA0;<span class="">1940</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import update_series_index</pre>
<pre class="cython line score-0">&#xA0;<span class="">1941</span>:     &gt;&gt;&gt; series = pd.Series([1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1942</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1943</span>:     # Update index without conditions</pre>
<pre class="cython line score-0">&#xA0;<span class="">1944</span>:     &gt;&gt;&gt; update_series_index(series, new_indexes=['a', 'b', 'c'], return_series=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1945</span>:     a    1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1946</span>:     b    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1947</span>:     c    3</pre>
<pre class="cython line score-0">&#xA0;<span class="">1948</span>:     dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">1949</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1950</span>:     # Update index with a condition function</pre>
<pre class="cython line score-0">&#xA0;<span class="">1951</span>:     &gt;&gt;&gt; condition_func = lambda s: pd.api.types.is_integer_dtype(s.index.dtype)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1952</span>:     &gt;&gt;&gt; update_series_index(series, new_indexes=['x', 'y', 'z'],</pre>
<pre class="cython line score-0">&#xA0;<span class="">1953</span>:                             condition=condition_func, return_series=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1954</span>:     0    1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1955</span>:     1    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1956</span>:     2    3</pre>
<pre class="cython line score-0">&#xA0;<span class="">1957</span>:     dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">1958</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1959</span>:     # Example with transform function</pre>
<pre class="cython line score-0">&#xA0;<span class="">1960</span>:     &gt;&gt;&gt; transform_func = lambda x: f'index_{x}'</pre>
<pre class="cython line score-0">&#xA0;<span class="">1961</span>:     &gt;&gt;&gt; update_series_index(series, new_indexes=[1, 2, 3],</pre>
<pre class="cython line score-0">&#xA0;<span class="">1962</span>:                             transform=transform_func, return_series=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1963</span>:     index_1    1</pre>
<pre class="cython line score-0">&#xA0;<span class="">1964</span>:     index_2    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">1965</span>:     index_3    3</pre>
<pre class="cython line score-0">&#xA0;<span class="">1966</span>:     dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">1967</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1968</span>:     Note: In the second example, the condition function checks if the series</pre>
<pre class="cython line score-0">&#xA0;<span class="">1969</span>:     dtype is integer, which is not met, hence the index is not updated.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1970</span>:     Adjusted the condition function according to specific requirements.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1971</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1972</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1973</span>:     if not isinstance(series, pd.Series):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1973,0,<span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1973, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1973, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_series, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 1973, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = (!__pyx_t_3);
  if (__pyx_t_4) {
/*  */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1974</span>:         msg = ( "Expected input to be a pandas Series,"</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(1974,0,<span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1974, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = 0;
    __pyx_t_6 = 127;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Expected_input_to_be_a_pandas_Se);
    __pyx_t_5 += 48;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Expected_input_to_be_a_pandas_Se);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_Expected_input_to_be_a_pandas_Se);
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(1974,0,<span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 3, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1974, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_msg = ((PyObject*)__pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1975</span>:                f" got type '{type(series).__name__}' instead."</pre>
<pre class='cython code score-14 '>    <span class='trace'>__Pyx_TraceLine</span>(1975,0,<span class='error_goto'>__PYX_ERR(0, 1975, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)Py_TYPE(__pyx_v_series)), __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1975, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1975, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_7) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_7) : __pyx_t_6;
    __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_7);
    __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_instead);
    __pyx_t_5 += 10;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_instead);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_instead);
</pre><pre class="cython line score-0">&#xA0;<span class="">1976</span>:                )</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1977</span>:         if on_error == 'raise':</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1977,0,<span class='error_goto'>__PYX_ERR(0, 1977, __pyx_L1_error)</span>)
    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_on_error, __pyx_n_u_raise, Py_EQ)); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1977, __pyx_L1_error)</span>
    if (unlikely(__pyx_t_4)) {
/*  */
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1978</span>:             raise ValueError(msg)</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(1978,0,<span class='error_goto'>__PYX_ERR(0, 1978, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_v_msg);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1978, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='error_goto'>__PYX_ERR(0, 1978, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1979</span>:         return new_indexes if not return_series else series</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(1979,0,<span class='error_goto'>__PYX_ERR(0, 1979, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_series); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1979, __pyx_L1_error)</span>
    __pyx_t_3 = (!__pyx_t_4);
    if (__pyx_t_3) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_indexes);
      __pyx_t_7 = __pyx_v_new_indexes;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_series);
      __pyx_t_7 = __pyx_v_series;
    }
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1980</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1981</span>:     # Check condition if provided</pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1982</span>:     if condition is not None and not condition(series):</pre>
<pre class='cython code score-18 '>  <span class='trace'>__Pyx_TraceLine</span>(1982,0,<span class='error_goto'>__PYX_ERR(0, 1982, __pyx_L1_error)</span>)
  __pyx_t_4 = (__pyx_v_condition != Py_None);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L6_bool_binop_done;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_condition);
  __pyx_t_2 = __pyx_v_condition; __pyx_t_1 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_series};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 1982, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1982, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_9 = (!__pyx_t_4);
  __pyx_t_3 = __pyx_t_9;
  __pyx_L6_bool_binop_done:;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1983</span>:         if on_error == 'raise':</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1983,0,<span class='error_goto'>__PYX_ERR(0, 1983, __pyx_L1_error)</span>)
    __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_on_error, __pyx_n_u_raise, Py_EQ)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1983, __pyx_L1_error)</span>
    if (unlikely(__pyx_t_3)) {
/*  */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1984</span>:             raise ValueError("Condition for updating index is not satisfied.")</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(1984,0,<span class='error_goto'>__PYX_ERR(0, 1984, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__115, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1984, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='error_goto'>__PYX_ERR(0, 1984, __pyx_L1_error)</span>
/*  */
  __pyx_tuple__115 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Condition_for_updating_index_is);<span class='error_goto'> if (unlikely(!__pyx_tuple__115)) __PYX_ERR(0, 1984, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__115);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__115);
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1985</span>:         return series if return_series else list(series.index)</pre>
<pre class='cython code score-9 '>    <span class='trace'>__Pyx_TraceLine</span>(1985,0,<span class='error_goto'>__PYX_ERR(0, 1985, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_series); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1985, __pyx_L1_error)</span>
    if (__pyx_t_3) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_series);
      __pyx_t_7 = __pyx_v_series;
    } else {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_series, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1985, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1985, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_7 = __pyx_t_1;
      __pyx_t_1 = 0;
    }
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1986</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1987</span>:     if new_indexes is None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1987,0,<span class='error_goto'>__PYX_ERR(0, 1987, __pyx_L1_error)</span>)
  __pyx_t_3 = (__pyx_v_new_indexes == Py_None);
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1988</span>:         return series if return_series else list(series.index)</pre>
<pre class='cython code score-9 '>    <span class='trace'>__Pyx_TraceLine</span>(1988,0,<span class='error_goto'>__PYX_ERR(0, 1988, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_series); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1988, __pyx_L1_error)</span>
    if (__pyx_t_3) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_series);
      __pyx_t_7 = __pyx_v_series;
    } else {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_series, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1988, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1988, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_7 = __pyx_t_2;
      __pyx_t_2 = 0;
    }
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1989</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1990</span>:     if isinstance(new_indexes, str):</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1990,0,<span class='error_goto'>__PYX_ERR(0, 1990, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_new_indexes); 
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1991</span>:         new_indexes = [new_indexes]</pre>
<pre class='cython code score-9 '>    <span class='trace'>__Pyx_TraceLine</span>(1991,0,<span class='error_goto'>__PYX_ERR(0, 1991, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1991, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_indexes);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_new_indexes);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_new_indexes)) <span class='error_goto'>__PYX_ERR(0, 1991, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_new_indexes, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1992</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1993</span>:     if transform and callable(transform):</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(1993,0,<span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L1_error)</span>)
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_transform); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L1_error)</span>
  if (__pyx_t_9) {
  } else {
    __pyx_t_3 = __pyx_t_9;
    goto __pyx_L12_bool_binop_done;
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_v_transform);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 1993, __pyx_L1_error)</span>
  __pyx_t_3 = __pyx_t_9;
  __pyx_L12_bool_binop_done:;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1994</span>:         new_indexes = [transform(idx) for idx in new_indexes]</pre>
<pre class='cython code score-75 '>    <span class='trace'>__Pyx_TraceLine</span>(1994,0,<span class='error_goto'>__PYX_ERR(0, 1994, __pyx_L1_error)</span>)
    { /* enter inner scope */
      __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1994, __pyx_L16_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_new_indexes)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_new_indexes)) {
        __pyx_t_2 = __pyx_v_new_indexes; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        __pyx_t_5 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_5 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_new_indexes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1994, __pyx_L16_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1994, __pyx_L16_error)</span>
      }
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1994, __pyx_L16_error)</span>
              #endif
              if (__pyx_t_5 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1994, __pyx_L16_error)</span>
            #else
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1994, __pyx_L16_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            #endif
          } else {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1994, __pyx_L16_error)</span>
              #endif
              if (__pyx_t_5 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1994, __pyx_L16_error)</span>
            #else
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1994, __pyx_L16_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            #endif
          }
        } else {
          __pyx_t_1 = __pyx_t_10(__pyx_t_2);
          if (unlikely(!__pyx_t_1)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 1994, __pyx_L16_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr1__pyx_v_idx, __pyx_t_1);
        __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_transform);
        __pyx_t_11 = __pyx_v_transform; __pyx_t_12 = NULL;
        __pyx_t_8 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
          __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
          if (likely(__pyx_t_12)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
            __pyx_t_8 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_8genexpr1__pyx_v_idx};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1994, __pyx_L16_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        }
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_7, (PyObject*)__pyx_t_1))) <span class='error_goto'>__PYX_ERR(0, 1994, __pyx_L16_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_idx); __pyx_8genexpr1__pyx_v_idx = 0;
      goto __pyx_L20_exit_scope;
      __pyx_L16_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_idx); __pyx_8genexpr1__pyx_v_idx = 0;
      goto __pyx_L1_error;
      __pyx_L20_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_new_indexes, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1995</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1996</span>:     if len(series.index) != len(new_indexes):</pre>
<pre class='cython code score-13 '>  <span class='trace'>__Pyx_TraceLine</span>(1996,0,<span class='error_goto'>__PYX_ERR(0, 1996, __pyx_L1_error)</span>)
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_series, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1996, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1996, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_13 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_new_indexes);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1996, __pyx_L1_error)</span>
  __pyx_t_3 = (__pyx_t_5 != __pyx_t_13);
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1997</span>:         msg = f"Index length mismatch: expected {len(series.index)}, got {len(new_indexes)}."</pre>
<pre class='cython code score-37 '>    <span class='trace'>__Pyx_TraceLine</span>(1997,0,<span class='error_goto'>__PYX_ERR(0, 1997, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1997, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_13 = 0;
    __pyx_t_6 = 127;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Index_length_mismatch_expected);
    __pyx_t_13 += 32;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Index_length_mismatch_expected);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_kp_u_Index_length_mismatch_expected);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_series, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1997, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1997, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_5, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1997, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_13 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_got);
    __pyx_t_13 += 6;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_got);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_kp_u_got);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_new_indexes);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1997, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_5, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1997, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_13 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__49);
    __pyx_t_13 += 1;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__49);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 4, __pyx_kp_u__49);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_7, 5, __pyx_t_13, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1997, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_msg = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1998</span>:         if on_error == 'raise':</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1998,0,<span class='error_goto'>__PYX_ERR(0, 1998, __pyx_L1_error)</span>)
    __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_on_error, __pyx_n_u_raise, Py_EQ)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1998, __pyx_L1_error)</span>
    if (unlikely(__pyx_t_3)) {
/*  */
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1999</span>:             raise ValueError(msg)</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(1999,0,<span class='error_goto'>__PYX_ERR(0, 1999, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_v_msg);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1999, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 1999, __pyx_L1_error)</span>
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2000</span>:         return series.index if not return_series else series</pre>
<pre class='cython code score-6 '>    <span class='trace'>__Pyx_TraceLine</span>(2000,0,<span class='error_goto'>__PYX_ERR(0, 2000, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_series); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2000, __pyx_L1_error)</span>
    __pyx_t_9 = (!__pyx_t_3);
    if (__pyx_t_9) {
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_series, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2000, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_2 = __pyx_t_7;
      __pyx_t_7 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_series);
      __pyx_t_2 = __pyx_v_series;
    }
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2001</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2002</span>:     # Check if replacement is allowed based on index types and allow_replace flag</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2003</span>:     if allow_replace and return_series:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(2003,0,<span class='error_goto'>__PYX_ERR(0, 2003, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_allow_replace); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2003, __pyx_L1_error)</span>
  if (__pyx_t_3) {
  } else {
    __pyx_t_9 = __pyx_t_3;
    goto __pyx_L24_bool_binop_done;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_series); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2003, __pyx_L1_error)</span>
  __pyx_t_9 = __pyx_t_3;
  __pyx_L24_bool_binop_done:;
  if (__pyx_t_9) {
/*  */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2004</span>:         series.index = new_indexes</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2004,0,<span class='error_goto'>__PYX_ERR(0, 2004, __pyx_L1_error)</span>)
    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_series, __pyx_n_s_index, __pyx_v_new_indexes) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2004, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2005</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2006</span>:     # if (all(isinstance(v, int) for v in series.index) and allow_replace) or return_series:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2007</span>:     #     series.index = new_indexes</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2008</span>:     return series if return_series else new_indexes</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2008,0,<span class='error_goto'>__PYX_ERR(0, 2008, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_series); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2008, __pyx_L1_error)</span>
  if (__pyx_t_9) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_series);
    __pyx_t_2 = __pyx_v_series;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_indexes);
    __pyx_t_2 = __pyx_v_new_indexes;
  }
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2009</span>: </pre>
<pre class="cython line score-125" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2010</span>: def update_dataframe_index(</pre>
<pre class='cython code score-125 '>static PyObject *__pyx_pf_6gofast_5tools_9funcutils_110__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("__defaults__", __pyx_f[0], 2010, 0, <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2018,0,<span class='error_goto'>__PYX_ERR(0, 2018, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2010, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_axis);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_axis);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_axis)) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 3, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_ignore));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_ignore));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 4, ((PyObject*)__pyx_n_u_ignore))) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 6, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>;
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2010,0,<span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2010, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_81update_dataframe_index(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_80update_dataframe_index, "\n    Updates the index (axis=0) or columns (axis=1) of a pandas DataFrame with \n    new values under certain conditions.\n\n    Parameters\n    ----------\n    df : pd.DataFrame\n        The DataFrame whose index or columns are to be updated.\n    new_indexes : list of str or str, optional\n        New values to set as the DataFrame index or columns. If a single string \n        is provided, it's converted to a list with one element. If None, no \n        update is performed.\n    axis : int, default 0\n        The axis along which to update the index or columns. 0 for index, 1 for columns.\n    allow_replace : bool, default False\n        If True, allows the replacement of the existing index or columns even \n        if they're not of integer type.\n    return_dataframe : bool, default False\n        If True, the updated DataFrame is returned. Otherwise, the new index \n        or column list is returned.\n    on_error : str, default 'ignore'\n        Determines the error handling strategy. If 'raise', an error is thrown \n        on failure conditions such as length mismatch or unsatisfied conditions.\n    transform : Callable, optional\n        A function to apply to each element of `new_indexes` before updating \n        the index or columns. It must accept a single value and return the \n        transformed value.\n    condition : Callable[[pd.DataFrame], bool], optional\n        A function that takes the DataFrame as input and returns True if the \n        index or column update should proceed. If False, the update is skipped. \n        This function is checked before any updates.\n\n    Returns\n    -------\n    pd.DataFrame or list\n        Depending on `return_dataframe`, either the updated DataFrame or the \n        new index or column list is returned.\n\n    Raises\n    ------\n    ValueError\n        If `on_error` is set to 'raise' and any precondition fails (e.g., \n        index/column length mismatch, condition check fails).\n\n    Examples\n    --""------\n    &gt;&gt;&gt; import pandas as pd \n    &gt;&gt;&gt; import gofast.tools.funcutils import update_dataframe_index\n    &gt;&gt;&gt; df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\n    &gt;&gt;&gt; new_cols = ['X', 'Y']\n    &gt;&gt;&gt; update_dataframe_index(df, new_indexes=new_cols, axis=1, return_dataframe=True)\n       X  Y\n    0  1  4\n    1  2  5\n    2  3  6\n\n    &gt;&gt;&gt; condition_func = lambda df: pd.api.types.is_integer_dtype(df.index.dtype)\n    &gt;&gt;&gt; update_dataframe_index(df, new_indexes=['x', 'y', 'z'],\n                               condition=condition_func, return_dataframe=True)\n       A  B\n    0  1  4\n    1  2  5\n    2  3  6  # Index not updated due to condition\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_81update_dataframe_index = {"update_dataframe_index", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_81update_dataframe_index, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_80update_dataframe_index};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_81update_dataframe_index(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_df = 0;
  PyObject *__pyx_v_new_indexes = 0;
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_allow_replace = 0;
  PyObject *__pyx_v_return_df = 0;
  PyObject *__pyx_v_on_error = 0;
  PyObject *__pyx_v_transform = 0;
  PyObject *__pyx_v_condition = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_dataframe_index (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_df,&amp;__pyx_n_s_new_indexes,&amp;__pyx_n_s_axis,&amp;__pyx_n_s_allow_replace,&amp;__pyx_n_s_return_df,&amp;__pyx_n_s_on_error,&amp;__pyx_n_s_transform,&amp;__pyx_n_s_condition,0};
  PyObject* values[8] = {0,0,0,0,0,0,0,0};
    __pyx_defaults3 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self);
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_80update_dataframe_index(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_df, PyObject *__pyx_v_new_indexes, PyObject *__pyx_v_axis, PyObject *__pyx_v_allow_replace, PyObject *__pyx_v_return_df, PyObject *__pyx_v_on_error, PyObject *__pyx_v_transform, PyObject *__pyx_v_condition) {
  PyObject *__pyx_v_msg = NULL;
  PyObject *__pyx_v_target = NULL;
  PyObject *__pyx_8genexpr2__pyx_v_idx = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__116)
  <span class='trace'>__Pyx_TraceCall</span>("update_dataframe_index", __pyx_f[0], 2010, 0, <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_indexes);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.update_dataframe_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_msg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_target);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_new_indexes);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__196 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_df, __pyx_n_s_new_indexes, __pyx_n_s_axis, __pyx_n_s_allow_replace, __pyx_n_s_return_df, __pyx_n_s_on_error, __pyx_n_s_transform, __pyx_n_s_condition, __pyx_n_s_msg, __pyx_n_s_target, __pyx_n_s_idx);<span class='error_goto'> if (unlikely(!__pyx_tuple__196)) __PYX_ERR(0, 2010, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__196);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__196);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2010,0,<span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2010, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_df, __pyx_kp_s_pd_DataFrame) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_new_indexes, __pyx_kp_s_Optional_Union_list_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_allow_replace, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return_df, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_on_error, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_transform, __pyx_kp_s_Optional_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_condition, __pyx_kp_s_Optional_LambdaType_Callable_Dat) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_81update_dataframe_index, 0, __pyx_n_s_update_dataframe_index, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__116));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2010, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults3), 1)) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>
  __pyx_codeobj__116 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__196, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_update_dataframe_index, 2010, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__116)) __PYX_ERR(0, 2010, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2011</span>:     df: pd.DataFrame,</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2012</span>:     new_indexes: Optional[Union[list, str]] = None,</pre>
<pre class='cython code score-10 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_axis);
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_ignore)));
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2013</span>:     axis: int = 0,</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(2013,0,<span class='error_goto'>__PYX_ERR(0, 2013, __pyx_L1_error)</span>)
  if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_0)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_0))) <span class='error_goto'>__PYX_ERR(0, 2013, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_t_5)-&gt;__pyx_arg_axis = ((PyObject*)__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_6gofast_5tools_9funcutils_110__defaults__);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_update_dataframe_index, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2014</span>:     allow_replace: bool = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2015</span>:     return_df: bool = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2016</span>:     on_error: str = 'ignore',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2017</span>:     transform: Optional[Callable] = None,</pre>
<pre class='cython code score-2 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-120" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2018</span>:     condition: Optional[LambdaType|Callable[[DataFrame], bool]] = None</pre>
<pre class='cython code score-120 '>    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_df)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_new_indexes);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_axis);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_allow_replace);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_df);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_error);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_transform);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_condition);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "update_dataframe_index") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_df = values[0];
    __pyx_v_new_indexes = values[1];
    __pyx_v_axis = ((PyObject*)values[2]);
    __pyx_v_allow_replace = values[3];
    __pyx_v_return_df = values[4];
    __pyx_v_on_error = ((PyObject*)values[5]);
    __pyx_v_transform = values[6];
    __pyx_v_condition = values[7];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_dataframe_index", 0, 1, 8, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2010, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.update_dataframe_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_axis), (&amp;PyInt_Type), 0, "axis", 1))) <span class='error_goto'>__PYX_ERR(0, 2013, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_on_error), (&amp;PyUnicode_Type), 0, "on_error", 1))) <span class='error_goto'>__PYX_ERR(0, 2016, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_80update_dataframe_index(__pyx_self, __pyx_v_df, __pyx_v_new_indexes, __pyx_v_axis, __pyx_v_allow_replace, __pyx_v_return_df, __pyx_v_on_error, __pyx_v_transform, __pyx_v_condition);
</pre><pre class="cython line score-0">&#xA0;<span class="">2019</span>: ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2020</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2021</span>:     Updates the index (axis=0) or columns (axis=1) of a pandas DataFrame with</pre>
<pre class="cython line score-0">&#xA0;<span class="">2022</span>:     new values under certain conditions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2023</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2024</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2025</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2026</span>:     df : pd.DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">2027</span>:         The DataFrame whose index or columns are to be updated.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2028</span>:     new_indexes : list of str or str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2029</span>:         New values to set as the DataFrame index or columns. If a single string</pre>
<pre class="cython line score-0">&#xA0;<span class="">2030</span>:         is provided, it's converted to a list with one element. If None, no</pre>
<pre class="cython line score-0">&#xA0;<span class="">2031</span>:         update is performed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2032</span>:     axis : int, default 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">2033</span>:         The axis along which to update the index or columns. 0 for index, 1 for columns.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2034</span>:     allow_replace : bool, default False</pre>
<pre class="cython line score-0">&#xA0;<span class="">2035</span>:         If True, allows the replacement of the existing index or columns even</pre>
<pre class="cython line score-0">&#xA0;<span class="">2036</span>:         if they're not of integer type.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2037</span>:     return_dataframe : bool, default False</pre>
<pre class="cython line score-0">&#xA0;<span class="">2038</span>:         If True, the updated DataFrame is returned. Otherwise, the new index</pre>
<pre class="cython line score-0">&#xA0;<span class="">2039</span>:         or column list is returned.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2040</span>:     on_error : str, default 'ignore'</pre>
<pre class="cython line score-0">&#xA0;<span class="">2041</span>:         Determines the error handling strategy. If 'raise', an error is thrown</pre>
<pre class="cython line score-0">&#xA0;<span class="">2042</span>:         on failure conditions such as length mismatch or unsatisfied conditions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2043</span>:     transform : Callable, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2044</span>:         A function to apply to each element of `new_indexes` before updating</pre>
<pre class="cython line score-0">&#xA0;<span class="">2045</span>:         the index or columns. It must accept a single value and return the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2046</span>:         transformed value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2047</span>:     condition : Callable[[pd.DataFrame], bool], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2048</span>:         A function that takes the DataFrame as input and returns True if the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2049</span>:         index or column update should proceed. If False, the update is skipped.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2050</span>:         This function is checked before any updates.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2051</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2052</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2053</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2054</span>:     pd.DataFrame or list</pre>
<pre class="cython line score-0">&#xA0;<span class="">2055</span>:         Depending on `return_dataframe`, either the updated DataFrame or the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2056</span>:         new index or column list is returned.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2057</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2058</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">2059</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2060</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2061</span>:         If `on_error` is set to 'raise' and any precondition fails (e.g.,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2062</span>:         index/column length mismatch, condition check fails).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2063</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2064</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2065</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2066</span>:     &gt;&gt;&gt; import pandas as pd</pre>
<pre class="cython line score-0">&#xA0;<span class="">2067</span>:     &gt;&gt;&gt; import gofast.tools.funcutils import update_dataframe_index</pre>
<pre class="cython line score-0">&#xA0;<span class="">2068</span>:     &gt;&gt;&gt; df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})</pre>
<pre class="cython line score-0">&#xA0;<span class="">2069</span>:     &gt;&gt;&gt; new_cols = ['X', 'Y']</pre>
<pre class="cython line score-0">&#xA0;<span class="">2070</span>:     &gt;&gt;&gt; update_dataframe_index(df, new_indexes=new_cols, axis=1, return_dataframe=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2071</span>:        X  Y</pre>
<pre class="cython line score-0">&#xA0;<span class="">2072</span>:     0  1  4</pre>
<pre class="cython line score-0">&#xA0;<span class="">2073</span>:     1  2  5</pre>
<pre class="cython line score-0">&#xA0;<span class="">2074</span>:     2  3  6</pre>
<pre class="cython line score-0">&#xA0;<span class="">2075</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2076</span>:     &gt;&gt;&gt; condition_func = lambda df: pd.api.types.is_integer_dtype(df.index.dtype)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2077</span>:     &gt;&gt;&gt; update_dataframe_index(df, new_indexes=['x', 'y', 'z'],</pre>
<pre class="cython line score-0">&#xA0;<span class="">2078</span>:                                condition=condition_func, return_dataframe=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2079</span>:        A  B</pre>
<pre class="cython line score-0">&#xA0;<span class="">2080</span>:     0  1  4</pre>
<pre class="cython line score-0">&#xA0;<span class="">2081</span>:     1  2  5</pre>
<pre class="cython line score-0">&#xA0;<span class="">2082</span>:     2  3  6  # Index not updated due to condition</pre>
<pre class="cython line score-0">&#xA0;<span class="">2083</span>:     """</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2084</span>:     if not isinstance(df, pd.DataFrame):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(2084,0,<span class='error_goto'>__PYX_ERR(0, 2084, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2084, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_df, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 2084, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = (!__pyx_t_3);
  if (__pyx_t_4) {
/*  */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2085</span>:         msg = ("Expected input to be a pandas DataFrame,"</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2085,0,<span class='error_goto'>__PYX_ERR(0, 2085, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2085, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = 0;
    __pyx_t_6 = 127;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Expected_input_to_be_a_pandas_Da);
    __pyx_t_5 += 51;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Expected_input_to_be_a_pandas_Da);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_Expected_input_to_be_a_pandas_Da);
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(2085,0,<span class='error_goto'>__PYX_ERR(0, 2085, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 3, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2085, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_msg = ((PyObject*)__pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2086</span>:                f" got type '{type(df).__name__}' instead.")</pre>
<pre class='cython code score-14 '>    <span class='trace'>__Pyx_TraceLine</span>(2086,0,<span class='error_goto'>__PYX_ERR(0, 2086, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)Py_TYPE(__pyx_v_df)), __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2086, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2086, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_7) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_7) : __pyx_t_6;
    __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_7);
    __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_instead);
    __pyx_t_5 += 10;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_instead);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_instead);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2087</span>:         if on_error == 'raise':</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2087,0,<span class='error_goto'>__PYX_ERR(0, 2087, __pyx_L1_error)</span>)
    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_on_error, __pyx_n_u_raise, Py_EQ)); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2087, __pyx_L1_error)</span>
    if (unlikely(__pyx_t_4)) {
/*  */
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2088</span>:             raise ValueError(msg)</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(2088,0,<span class='error_goto'>__PYX_ERR(0, 2088, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_v_msg);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2088, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='error_goto'>__PYX_ERR(0, 2088, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2089</span>:         return new_indexes if not return_df else df</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2089,0,<span class='error_goto'>__PYX_ERR(0, 2089, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_df); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2089, __pyx_L1_error)</span>
    __pyx_t_3 = (!__pyx_t_4);
    if (__pyx_t_3) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_indexes);
      __pyx_t_7 = __pyx_v_new_indexes;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
      __pyx_t_7 = __pyx_v_df;
    }
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2090</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2091</span>:     # Check condition if provided</pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2092</span>:     if condition is not None and not condition(df):</pre>
<pre class='cython code score-18 '>  <span class='trace'>__Pyx_TraceLine</span>(2092,0,<span class='error_goto'>__PYX_ERR(0, 2092, __pyx_L1_error)</span>)
  __pyx_t_4 = (__pyx_v_condition != Py_None);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L6_bool_binop_done;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_condition);
  __pyx_t_2 = __pyx_v_condition; __pyx_t_1 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_df};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 2092, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2092, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_9 = (!__pyx_t_4);
  __pyx_t_3 = __pyx_t_9;
  __pyx_L6_bool_binop_done:;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2093</span>:         if on_error == 'raise':</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2093,0,<span class='error_goto'>__PYX_ERR(0, 2093, __pyx_L1_error)</span>)
    __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_on_error, __pyx_n_u_raise, Py_EQ)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2093, __pyx_L1_error)</span>
    if (unlikely(__pyx_t_3)) {
/*  */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2094</span>:             raise ValueError("Condition for updating index/columns is not satisfied.")</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(2094,0,<span class='error_goto'>__PYX_ERR(0, 2094, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__117, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2094, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='error_goto'>__PYX_ERR(0, 2094, __pyx_L1_error)</span>
/*  */
  __pyx_tuple__117 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Condition_for_updating_index_col);<span class='error_goto'> if (unlikely(!__pyx_tuple__117)) __PYX_ERR(0, 2094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__117);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__117);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2095</span>:         return df if return_df else (</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(2095,0,<span class='error_goto'>__PYX_ERR(0, 2095, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_df); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2095, __pyx_L1_error)</span>
    if (__pyx_t_3) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
      __pyx_t_7 = __pyx_v_df;
    } else {
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2096</span>:             df.index if axis == 0 else df.columns).tolist()</pre>
<pre class='cython code score-29 '>      <span class='trace'>__Pyx_TraceLine</span>(2096,0,<span class='error_goto'>__PYX_ERR(0, 2096, __pyx_L1_error)</span>)
      __pyx_t_10 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_axis, __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2096, __pyx_L1_error)</span>
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_10); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2096, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (__pyx_t_9) {
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_1 = __pyx_t_10;
        __pyx_t_10 = 0;
      } else {
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_1 = __pyx_t_10;
        __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_tolist);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2096, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_8 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_8 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_7 = __pyx_t_2;
      __pyx_t_2 = 0;
    }
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2097</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2098</span>:     if new_indexes is None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(2098,0,<span class='error_goto'>__PYX_ERR(0, 2098, __pyx_L1_error)</span>)
  __pyx_t_3 = (__pyx_v_new_indexes == Py_None);
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2099</span>:         return df if return_df else (</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(2099,0,<span class='error_goto'>__PYX_ERR(0, 2099, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_df); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2099, __pyx_L1_error)</span>
    if (__pyx_t_3) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
      __pyx_t_7 = __pyx_v_df;
    } else {
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2100</span>:             df.index if axis == 0 else df.columns).tolist()</pre>
<pre class='cython code score-29 '>      <span class='trace'>__Pyx_TraceLine</span>(2100,0,<span class='error_goto'>__PYX_ERR(0, 2100, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_axis, __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2100, __pyx_L1_error)</span>
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2100, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_9) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2100, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = __pyx_t_1;
        __pyx_t_1 = 0;
      } else {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2100, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = __pyx_t_1;
        __pyx_t_1 = 0;
      }
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_tolist);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2100, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = NULL;
      __pyx_t_8 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_8 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, NULL};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2100, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_7 = __pyx_t_2;
      __pyx_t_2 = 0;
    }
    __pyx_r = __pyx_t_7;
    __pyx_t_7 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2101</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2102</span>:     if isinstance(new_indexes, str):</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2102,0,<span class='error_goto'>__PYX_ERR(0, 2102, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_new_indexes); 
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2103</span>:         new_indexes = [new_indexes]</pre>
<pre class='cython code score-9 '>    <span class='trace'>__Pyx_TraceLine</span>(2103,0,<span class='error_goto'>__PYX_ERR(0, 2103, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2103, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_indexes);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_new_indexes);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_new_indexes)) <span class='error_goto'>__PYX_ERR(0, 2103, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_new_indexes, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2104</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2105</span>:     if transform and callable(transform):</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(2105,0,<span class='error_goto'>__PYX_ERR(0, 2105, __pyx_L1_error)</span>)
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_transform); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2105, __pyx_L1_error)</span>
  if (__pyx_t_9) {
  } else {
    __pyx_t_3 = __pyx_t_9;
    goto __pyx_L12_bool_binop_done;
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_v_transform);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 2105, __pyx_L1_error)</span>
  __pyx_t_3 = __pyx_t_9;
  __pyx_L12_bool_binop_done:;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2106</span>:         new_indexes = [transform(idx) for idx in new_indexes]</pre>
<pre class='cython code score-75 '>    <span class='trace'>__Pyx_TraceLine</span>(2106,0,<span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L1_error)</span>)
    { /* enter inner scope */
      __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2106, __pyx_L16_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_new_indexes)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_new_indexes)) {
        __pyx_t_2 = __pyx_v_new_indexes; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        __pyx_t_5 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_5 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_new_indexes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2106, __pyx_L16_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2106, __pyx_L16_error)</span>
      }
      for (;;) {
        if (likely(!__pyx_t_11)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L16_error)</span>
              #endif
              if (__pyx_t_5 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L16_error)</span>
            #else
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2106, __pyx_L16_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            #endif
          } else {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L16_error)</span>
              #endif
              if (__pyx_t_5 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L16_error)</span>
            #else
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2106, __pyx_L16_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            #endif
          }
        } else {
          __pyx_t_1 = __pyx_t_11(__pyx_t_2);
          if (unlikely(!__pyx_t_1)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L16_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr2__pyx_v_idx, __pyx_t_1);
        __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_transform);
        __pyx_t_10 = __pyx_v_transform; __pyx_t_12 = NULL;
        __pyx_t_8 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
          __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
          if (likely(__pyx_t_12)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
            __pyx_t_8 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_8genexpr2__pyx_v_idx};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L16_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        }
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_7, (PyObject*)__pyx_t_1))) <span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L16_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_idx); __pyx_8genexpr2__pyx_v_idx = 0;
      goto __pyx_L20_exit_scope;
      __pyx_L16_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_idx); __pyx_8genexpr2__pyx_v_idx = 0;
      goto __pyx_L1_error;
      __pyx_L20_exit_scope:;
    } /* exit inner scope */
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_new_indexes, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2107</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2108</span>:     target = df.index if axis == 0 else df.columns</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(2108,0,<span class='error_goto'>__PYX_ERR(0, 2108, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_axis, __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2108, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2108, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2108, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = __pyx_t_2;
    __pyx_t_2 = 0;
  } else {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2108, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = __pyx_t_2;
    __pyx_t_2 = 0;
  }
  __pyx_v_target = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2109</span>:     if len(target) != len(new_indexes):</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(2109,0,<span class='error_goto'>__PYX_ERR(0, 2109, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_target);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2109, __pyx_L1_error)</span>
  __pyx_t_13 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_new_indexes);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2109, __pyx_L1_error)</span>
  __pyx_t_3 = (__pyx_t_5 != __pyx_t_13);
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2110</span>:         msg = f"Length mismatch: expected {len(target)}, got {len(new_indexes)}."</pre>
<pre class='cython code score-34 '>    <span class='trace'>__Pyx_TraceLine</span>(2110,0,<span class='error_goto'>__PYX_ERR(0, 2110, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_13 = 0;
    __pyx_t_6 = 127;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Length_mismatch_expected);
    __pyx_t_13 += 26;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Length_mismatch_expected);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_kp_u_Length_mismatch_expected);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_target);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2110, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_5, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_13 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_got);
    __pyx_t_13 += 6;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_got);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_kp_u_got);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_new_indexes);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2110, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_5, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_13 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__49);
    __pyx_t_13 += 1;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__49);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 4, __pyx_kp_u__49);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_7, 5, __pyx_t_13, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_msg = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2111</span>:         if on_error == 'raise':</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2111,0,<span class='error_goto'>__PYX_ERR(0, 2111, __pyx_L1_error)</span>)
    __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_on_error, __pyx_n_u_raise, Py_EQ)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2111, __pyx_L1_error)</span>
    if (unlikely(__pyx_t_3)) {
/*  */
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2112</span>:             raise ValueError(msg)</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(2112,0,<span class='error_goto'>__PYX_ERR(0, 2112, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_v_msg);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2112, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 2112, __pyx_L1_error)</span>
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2113</span>:         return target.tolist() if not return_df else df</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(2113,0,<span class='error_goto'>__PYX_ERR(0, 2113, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_df); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2113, __pyx_L1_error)</span>
    __pyx_t_9 = (!__pyx_t_3);
    if (__pyx_t_9) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_target, __pyx_n_s_tolist);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2113, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_10 = NULL;
      __pyx_t_8 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_8 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, NULL};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_8, 0+__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 2113, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_2 = __pyx_t_7;
      __pyx_t_7 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
      __pyx_t_2 = __pyx_v_df;
    }
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2114</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2115</span>:     if allow_replace or return_df:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(2115,0,<span class='error_goto'>__PYX_ERR(0, 2115, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_allow_replace); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2115, __pyx_L1_error)</span>
  if (!__pyx_t_3) {
  } else {
    __pyx_t_9 = __pyx_t_3;
    goto __pyx_L24_bool_binop_done;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_df); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2115, __pyx_L1_error)</span>
  __pyx_t_9 = __pyx_t_3;
  __pyx_L24_bool_binop_done:;
  if (__pyx_t_9) {
/*  */
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2116</span>:         if axis == 0:</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(2116,0,<span class='error_goto'>__PYX_ERR(0, 2116, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_axis, __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2116, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2116, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_9) {
/*  */
      goto __pyx_L26;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2117</span>:             df.index = new_indexes</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2117,0,<span class='error_goto'>__PYX_ERR(0, 2117, __pyx_L1_error)</span>)
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_df, __pyx_n_s_index, __pyx_v_new_indexes) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2117, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2118</span>:         else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2119</span>:             df.columns = new_indexes</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2119,0,<span class='error_goto'>__PYX_ERR(0, 2119, __pyx_L1_error)</span>)
    /*else*/ {
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_df, __pyx_n_s_columns, __pyx_v_new_indexes) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2119, __pyx_L1_error)</span>
    }
    __pyx_L26:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2120</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2121</span>:     return df if return_df else new_indexes</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2121,0,<span class='error_goto'>__PYX_ERR(0, 2121, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_df); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2121, __pyx_L1_error)</span>
  if (__pyx_t_9) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
    __pyx_t_2 = __pyx_v_df;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_indexes);
    __pyx_t_2 = __pyx_v_new_indexes;
  }
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2122</span>: </pre>
<pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2123</span>: def convert_to_pandas(</pre>
<pre class='cython code score-62 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_83convert_to_pandas(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_82convert_to_pandas, "\n    Automatically converts input data to a pandas DataFrame or Series \n    based on its structure. \n    \n    Function uses a custom conversion function for unsupported data types.\n    If the data type is not supported for conversion and error is 'raise', \n    raises a ValueError. If error is 'ignore', returns the data as is.\n\n    Parameters\n    ----------\n    data : list, dict, array-like, pd.Series, pd.DataFrame\n        The input data to be converted.\n    error : str, optional, default 'raise'\n        Controls error handling for unsupported data types. If 'raise', an \n        error is thrown.If 'ignore', the original data is returned as is.\n    custom_convert : callable, optional\n        A custom function that takes the original data as input and returns\n        a pandas Series or  DataFrame. This function is used if the data type\n        is not directly supported for conversion.\n\n    Returns\n    -------\n    pd.Series, pd.DataFrame, or original data\n        The converted pandas Series or DataFrame, or the original data \n        if conversion is not possible and error is set to 'ignore'.\n\n    Raises\n    ------\n    ValueError\n        If the data type cannot be automatically converted, no custom \n        conversion function is provided, and error is set to 'raise'.\n\n    Examples\n    --------\n    &gt;&gt;&gt; data_list = [1, 2, 3, 4, 5]\n    &gt;&gt;&gt; print(convert_to_pandas(data_list))\n    0    1\n    1    2\n    2    3\n    3    4\n    4    5\n    dtype: int64\n\n    &gt;&gt;&gt; data_dict = {'A': [1, 2, 3], 'B': [4, 5, 6]}\n    &gt;&gt;&gt; print(convert_to_pandas(data_dict))\n       A  B\n    0  1  4\n    1  2  5\n    2  3  6\n\n    # Using a custom conversion function for a nested dictionary\n    &gt;&gt;&gt; data_nested_dict = {'A': {'a': 1, 'b': 2}, 'B': {'a': 3, 'b': 4}}\n    &gt;&gt;&gt; custom_func = lambda x: pd.DataFrame.from_dict(x)\n    &gt;&gt;&gt; print(convert_to_pandas(data_nested_dict, custom_convert=custom_func))\n       A  B\n    a  1  3\n    b  2  4\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_83convert_to_pandas = {"convert_to_pandas", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_83convert_to_pandas, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_82convert_to_pandas};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_83convert_to_pandas(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_error = 0;
  PyObject *__pyx_v_custom_convert = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("convert_to_pandas (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_error,&amp;__pyx_n_s_custom_convert,0};
  PyObject* values[3] = {0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_raise)));
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
static PyObject *__pyx_gb_6gofast_5tools_9funcutils_17convert_to_pandas_2generator1(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_82convert_to_pandas(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_error, PyObject *__pyx_v_custom_convert) {
  PyObject *__pyx_v_e = NULL;
  PyObject *__pyx_gb_6gofast_5tools_9funcutils_17convert_to_pandas_2generator1 = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__118)
  <span class='trace'>__Pyx_TraceCall</span>("convert_to_pandas", __pyx_f[0], 2123, 0, <span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.convert_to_pandas", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_e);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_gb_6gofast_5tools_9funcutils_17convert_to_pandas_2generator1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__197 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_data, __pyx_n_s_error, __pyx_n_s_custom_convert, __pyx_n_s_e, __pyx_n_s_genexpr, __pyx_n_s_genexpr);<span class='error_goto'> if (unlikely(!__pyx_tuple__197)) __PYX_ERR(0, 2123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__197);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__197);
  __pyx_codeobj__118 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__197, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_convert_to_pandas, 2123, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__118)) __PYX_ERR(0, 2123, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2123,0,<span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_data, __pyx_kp_s_ArrayLike_List) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_error, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_custom_convert, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_83convert_to_pandas, 0, __pyx_n_s_convert_to_pandas, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__118));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__198);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convert_to_pandas, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__198 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject*)__pyx_n_u_raise), Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__198)) __PYX_ERR(0, 2123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__198);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__198);
</pre><pre class="cython line score-0">&#xA0;<span class="">2124</span>:         data: ArrayLike | List,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2125</span>:         error: str='raise',</pre>
<pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2126</span>:         custom_convert: Callable=None</pre>
<pre class='cython code score-53 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_error);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_custom_convert);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "convert_to_pandas") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_data = values[0];
    __pyx_v_error = ((PyObject*)values[1]);
    __pyx_v_custom_convert = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("convert_to_pandas", 0, 1, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2123, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.convert_to_pandas", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_error), (&amp;PyUnicode_Type), 0, "error", 1))) <span class='error_goto'>__PYX_ERR(0, 2125, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_82convert_to_pandas(__pyx_self, __pyx_v_data, __pyx_v_error, __pyx_v_custom_convert);
</pre><pre class="cython line score-0">&#xA0;<span class="">2127</span>:         ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2128</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2129</span>:     Automatically converts input data to a pandas DataFrame or Series</pre>
<pre class="cython line score-0">&#xA0;<span class="">2130</span>:     based on its structure.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2131</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2132</span>:     Function uses a custom conversion function for unsupported data types.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2133</span>:     If the data type is not supported for conversion and error is 'raise',</pre>
<pre class="cython line score-0">&#xA0;<span class="">2134</span>:     raises a ValueError. If error is 'ignore', returns the data as is.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2135</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2136</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2137</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2138</span>:     data : list, dict, array-like, pd.Series, pd.DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">2139</span>:         The input data to be converted.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2140</span>:     error : str, optional, default 'raise'</pre>
<pre class="cython line score-0">&#xA0;<span class="">2141</span>:         Controls error handling for unsupported data types. If 'raise', an</pre>
<pre class="cython line score-0">&#xA0;<span class="">2142</span>:         error is thrown.If 'ignore', the original data is returned as is.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2143</span>:     custom_convert : callable, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2144</span>:         A custom function that takes the original data as input and returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2145</span>:         a pandas Series or  DataFrame. This function is used if the data type</pre>
<pre class="cython line score-0">&#xA0;<span class="">2146</span>:         is not directly supported for conversion.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2147</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2148</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2149</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2150</span>:     pd.Series, pd.DataFrame, or original data</pre>
<pre class="cython line score-0">&#xA0;<span class="">2151</span>:         The converted pandas Series or DataFrame, or the original data</pre>
<pre class="cython line score-0">&#xA0;<span class="">2152</span>:         if conversion is not possible and error is set to 'ignore'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2153</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2154</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">2155</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2156</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2157</span>:         If the data type cannot be automatically converted, no custom</pre>
<pre class="cython line score-0">&#xA0;<span class="">2158</span>:         conversion function is provided, and error is set to 'raise'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2159</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2160</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2161</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2162</span>:     &gt;&gt;&gt; data_list = [1, 2, 3, 4, 5]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2163</span>:     &gt;&gt;&gt; print(convert_to_pandas(data_list))</pre>
<pre class="cython line score-0">&#xA0;<span class="">2164</span>:     0    1</pre>
<pre class="cython line score-0">&#xA0;<span class="">2165</span>:     1    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">2166</span>:     2    3</pre>
<pre class="cython line score-0">&#xA0;<span class="">2167</span>:     3    4</pre>
<pre class="cython line score-0">&#xA0;<span class="">2168</span>:     4    5</pre>
<pre class="cython line score-0">&#xA0;<span class="">2169</span>:     dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">2170</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2171</span>:     &gt;&gt;&gt; data_dict = {'A': [1, 2, 3], 'B': [4, 5, 6]}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2172</span>:     &gt;&gt;&gt; print(convert_to_pandas(data_dict))</pre>
<pre class="cython line score-0">&#xA0;<span class="">2173</span>:        A  B</pre>
<pre class="cython line score-0">&#xA0;<span class="">2174</span>:     0  1  4</pre>
<pre class="cython line score-0">&#xA0;<span class="">2175</span>:     1  2  5</pre>
<pre class="cython line score-0">&#xA0;<span class="">2176</span>:     2  3  6</pre>
<pre class="cython line score-0">&#xA0;<span class="">2177</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2178</span>:     # Using a custom conversion function for a nested dictionary</pre>
<pre class="cython line score-0">&#xA0;<span class="">2179</span>:     &gt;&gt;&gt; data_nested_dict = {'A': {'a': 1, 'b': 2}, 'B': {'a': 3, 'b': 4}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2180</span>:     &gt;&gt;&gt; custom_func = lambda x: pd.DataFrame.from_dict(x)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2181</span>:     &gt;&gt;&gt; print(convert_to_pandas(data_nested_dict, custom_convert=custom_func))</pre>
<pre class="cython line score-0">&#xA0;<span class="">2182</span>:        A  B</pre>
<pre class="cython line score-0">&#xA0;<span class="">2183</span>:     a  1  3</pre>
<pre class="cython line score-0">&#xA0;<span class="">2184</span>:     b  2  4</pre>
<pre class="cython line score-0">&#xA0;<span class="">2185</span>:     """</pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2186</span>:     try:</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(2186,0,<span class='error_goto'>__PYX_ERR(0, 2186, __pyx_L1_error)</span>)
  {
    /*try:*/ {
/*  */
    }
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/*  */
    __pyx_L5_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L7_try_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L0;
    __pyx_L6_except_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L0;
  }
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2187</span>:         if isinstance(data, dict) or (isinstance(data, list) and all(</pre>
<pre class='cython code score-12 '>      <span class='trace'>__Pyx_TraceLine</span>(2187,0,<span class='error_goto'>__PYX_ERR(0, 2187, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(2187,0,<span class='error_goto'>__PYX_ERR(0, 2187, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(2187,0,<span class='error_goto'>__PYX_ERR(0, 2187, __pyx_L3_error)</span>)
      __pyx_t_5 = <span class='py_c_api'>PyDict_Check</span>(__pyx_v_data); 
      if (!__pyx_t_5) {
      } else {
        __pyx_t_4 = __pyx_t_5;
        goto __pyx_L10_bool_binop_done;
      }
      __pyx_t_5 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_data); 
      if (__pyx_t_5) {
      } else {
        __pyx_t_4 = __pyx_t_5;
        goto __pyx_L10_bool_binop_done;
      }
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(2187,0,<span class='error_goto'>__PYX_ERR(0, 2187, __pyx_L3_error)</span>)
      if (__pyx_t_4) {
/*  */
      }
</pre><pre class="cython line score-83" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2188</span>:                 isinstance(elem, list) for elem in data)):</pre>
<pre class='cython code score-83 '>static PyObject *__pyx_pf_6gofast_5tools_9funcutils_17convert_to_pandas_genexpr(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_genexpr_arg_0) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_29_genexpr *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_29_genexpr *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_29_genexpr(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_29_genexpr, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_29_genexpr *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_genexpr_arg_0 = __pyx_genexpr_arg_0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0);
  {
    __pyx_CoroutineObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_coroutine_body_t) __pyx_gb_6gofast_5tools_9funcutils_17convert_to_pandas_2generator1, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_convert_to_pandas_locals_genexpr, __pyx_n_s_gofast_tools_funcutils);<span class='error_goto'> if (unlikely(!gen)) __PYX_ERR(0, 2188, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return (PyObject *) gen;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.convert_to_pandas.genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_gb_6gofast_5tools_9funcutils_17convert_to_pandas_2generator1(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("genexpr", 0);
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value)) <span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span>
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_genexpr_arg_0)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>(".0"); <span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span> }
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0)) {
    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_genexpr_arg_0; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2188, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2188, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2188, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2188, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_elem);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_elem, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyList_Check</span>(__pyx_cur_scope-&gt;__pyx_v_elem); 
    __pyx_t_6 = (!__pyx_t_5);
    if (__pyx_t_6) {
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(2188,0,<span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
      __pyx_r = Py_False;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  /*else*/ {
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(2188,0,<span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
    __pyx_r = Py_True;
    goto __pyx_L0;
  }
  CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_Generator_Replace_StopIteration</span>(0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  #if !CYTHON_USE_EXC_INFO_STACK
  <span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);
  #endif
  __pyx_generator-&gt;resume_label = -1;
  <span class='pyx_c_api'>__Pyx_Coroutine_clear</span>((PyObject*)__pyx_generator);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(2188,0,<span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L3_error)</span>)
      __pyx_t_6 = __pyx_pf_6gofast_5tools_9funcutils_17convert_to_pandas_genexpr(NULL, __pyx_v_data);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2188, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_Generator_Next</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2188, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L3_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_4 = __pyx_t_5;
      __pyx_L10_bool_binop_done:;
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_29_genexpr {
  PyObject_HEAD
  PyObject *__pyx_genexpr_arg_0;
  PyObject *__pyx_v_elem;
};

</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2189</span>:             return pd.DataFrame(data)</pre>
<pre class='cython code score-20 '>        <span class='trace'>__Pyx_TraceLine</span>(2189,0,<span class='error_goto'>__PYX_ERR(0, 2189, __pyx_L3_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2189, __pyx_L3_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2189, __pyx_L3_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_6 = NULL;
        __pyx_t_9 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
          __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
          if (likely(__pyx_t_6)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
            __pyx_t_9 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_v_data};
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 2189, __pyx_L3_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        __pyx_r = __pyx_t_7;
        __pyx_t_7 = 0;
        goto __pyx_L7_try_return;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2190</span>:         elif isinstance(data, (list, np.ndarray)) and (</pre>
<pre class='cython code score-16 '>      <span class='trace'>__Pyx_TraceLine</span>(2190,0,<span class='error_goto'>__PYX_ERR(0, 2190, __pyx_L3_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2190, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2190, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_data); 
      if (!__pyx_t_10) {
      } else {
        __pyx_t_5 = __pyx_t_10;
        goto __pyx_L15_bool_binop_done;
      }
      __pyx_t_10 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_8); 
      __pyx_t_5 = __pyx_t_10;
      __pyx_L15_bool_binop_done:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (__pyx_t_5) {
      } else {
        __pyx_t_4 = __pyx_t_5;
        goto __pyx_L13_bool_binop_done;
      }
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(2190,0,<span class='error_goto'>__PYX_ERR(0, 2190, __pyx_L3_error)</span>)
      if (__pyx_t_4) {
/*  */
      }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2191</span>:                 not data or not isinstance(data[0], list)):</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(2191,0,<span class='error_goto'>__PYX_ERR(0, 2191, __pyx_L3_error)</span>)
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_data); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2191, __pyx_L3_error)</span>
      __pyx_t_10 = (!__pyx_t_5);
      if (!__pyx_t_10) {
      } else {
        __pyx_t_4 = __pyx_t_10;
        goto __pyx_L13_bool_binop_done;
      }
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_data, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2191, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_10 = <span class='py_c_api'>PyList_Check</span>(__pyx_t_8); 
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_5 = (!__pyx_t_10);
      __pyx_t_4 = __pyx_t_5;
      __pyx_L13_bool_binop_done:;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2192</span>:             return pd.Series(data)</pre>
<pre class='cython code score-20 '>        <span class='trace'>__Pyx_TraceLine</span>(2192,0,<span class='error_goto'>__PYX_ERR(0, 2192, __pyx_L3_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2192, __pyx_L3_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2192, __pyx_L3_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_7 = NULL;
        __pyx_t_9 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
          __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
          if (likely(__pyx_t_7)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
            __pyx_t_9 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_data};
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 2192, __pyx_L3_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        }
        __pyx_r = __pyx_t_8;
        __pyx_t_8 = 0;
        goto __pyx_L7_try_return;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2193</span>:         elif isinstance(data, (pd.Series, pd.DataFrame)):</pre>
<pre class='cython code score-22 '>      <span class='trace'>__Pyx_TraceLine</span>(2193,0,<span class='error_goto'>__PYX_ERR(0, 2193, __pyx_L3_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2193, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2193, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2193, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2193, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_6); 
      if (!__pyx_t_5) {
      } else {
        __pyx_t_4 = __pyx_t_5;
        goto __pyx_L18_bool_binop_done;
      }
      __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_7); 
      __pyx_t_4 = __pyx_t_5;
      __pyx_L18_bool_binop_done:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_4) {
/*  */
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2194</span>:             return data</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(2194,0,<span class='error_goto'>__PYX_ERR(0, 2194, __pyx_L3_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
        __pyx_r = __pyx_v_data;
        goto __pyx_L7_try_return;
</pre><pre class="cython line score-0">&#xA0;<span class="">2195</span>:         else:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2196</span>:             if callable(custom_convert):</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2196,0,<span class='error_goto'>__PYX_ERR(0, 2196, __pyx_L3_error)</span>)
      /*else*/ {
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_v_custom_convert);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 2196, __pyx_L3_error)</span>
        if (likely(__pyx_t_4)) {
/*  */
        }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2197</span>:                 return custom_convert(data)</pre>
<pre class='cython code score-16 '>          <span class='trace'>__Pyx_TraceLine</span>(2197,0,<span class='error_goto'>__PYX_ERR(0, 2197, __pyx_L3_error)</span>)
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_custom_convert);
          __pyx_t_7 = __pyx_v_custom_convert; __pyx_t_8 = NULL;
          __pyx_t_9 = 0;
          #if CYTHON_UNPACK_METHODS
          if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
            __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
            if (likely(__pyx_t_8)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
              __pyx_t_9 = 1;
            }
          }
          #endif
          {
            PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_data};
            __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2197, __pyx_L3_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          }
          __pyx_r = __pyx_t_6;
          __pyx_t_6 = 0;
          goto __pyx_L7_try_return;
</pre><pre class="cython line score-0">&#xA0;<span class="">2198</span>:             else:</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2199</span>:                 raise ValueError(</pre>
<pre class='cython code score-6 '>        <span class='trace'>__Pyx_TraceLine</span>(2199,0,<span class='error_goto'>__PYX_ERR(0, 2199, __pyx_L3_error)</span>)
        /*else*/ {
/*  */
          <span class='trace'>__Pyx_TraceLine</span>(2199,0,<span class='error_goto'>__PYX_ERR(0, 2199, __pyx_L3_error)</span>)
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2199, __pyx_L3_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='error_goto'>__PYX_ERR(0, 2199, __pyx_L3_error)</span>
        }
      }
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2200</span>:                     f"Cannot auto-convert data of type {type(data).__name__}.")</pre>
<pre class='cython code score-24 '>          <span class='trace'>__Pyx_TraceLine</span>(2200,0,<span class='error_goto'>__PYX_ERR(0, 2200, __pyx_L3_error)</span>)
          __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2200, __pyx_L3_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          __pyx_t_11 = 0;
          __pyx_t_12 = 127;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Cannot_auto_convert_data_of_type);
          __pyx_t_11 += 33;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Cannot_auto_convert_data_of_type);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_kp_u_Cannot_auto_convert_data_of_type);
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)Py_TYPE(__pyx_v_data)), __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2200, __pyx_L3_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_7, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2200, __pyx_L3_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_8) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_8) : __pyx_t_12;
          __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_8);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_8);
          __pyx_t_8 = 0;
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__49);
          __pyx_t_11 += 1;
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__49);
          <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_kp_u__49);
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_6, 3, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2200, __pyx_L3_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2201</span>:     except ValueError as e:</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(2201,0,<span class='error_goto'>__PYX_ERR(0, 2201, __pyx_L5_except_error)</span>)
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(__pyx_builtin_ValueError);
    if (__pyx_t_9) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.convert_to_pandas", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_6, &amp;__pyx_t_8, &amp;__pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2201, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      __pyx_v_e = __pyx_t_8;
      /*try:*/ {
/*  */
      <span class='trace'>__Pyx_TraceLine</span>(2201,0,<span class='error_goto'>__PYX_ERR(0, 2201, __pyx_L26_error)</span>)
      /*finally:*/ {
        __pyx_L26_error:;
        /*exception exit:*/{
          __Pyx_PyThreadState_declare
          __Pyx_PyThreadState_assign
          __pyx_t_15 = 0; __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0;
          if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_18, &amp;__pyx_t_19, &amp;__pyx_t_20);
          if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_15, &amp;__pyx_t_16, &amp;__pyx_t_17) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_15, &amp;__pyx_t_16, &amp;__pyx_t_17);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_15);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_16);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_17);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_18);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_19);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_20);
          __pyx_t_9 = __pyx_lineno; __pyx_t_13 = __pyx_clineno; __pyx_t_14 = __pyx_filename;
          {
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
          }
          if (PY_MAJOR_VERSION &gt;= 3) {
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_18);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_19);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_20);
            <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_18, __pyx_t_19, __pyx_t_20);
          }
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_15);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_16);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_17);
          <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_15, __pyx_t_16, __pyx_t_17);
          __pyx_t_15 = 0; __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0;
          __pyx_lineno = __pyx_t_9; __pyx_clineno = __pyx_t_13; __pyx_filename = __pyx_t_14;
          goto __pyx_L5_except_error;
        }
        __pyx_L25_return: {
          __pyx_t_20 = __pyx_r;
          __pyx_r = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
          __pyx_r = __pyx_t_20;
          __pyx_t_20 = 0;
          goto __pyx_L6_except_return;
        }
      }
    }
    goto __pyx_L5_except_error;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2202</span>:         if error == 'raise':</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(2202,0,<span class='error_goto'>__PYX_ERR(0, 2202, __pyx_L26_error)</span>)
        __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_error, __pyx_n_u_raise, Py_EQ)); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2202, __pyx_L26_error)</span>
        if (unlikely(__pyx_t_4)) {
/*  */
        }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2203</span>:             raise e</pre>
<pre class='cython code score-2 '>          <span class='trace'>__Pyx_TraceLine</span>(2203,0,<span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L26_error)</span>)
          <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_v_e, 0, 0, 0);
          <span class='error_goto'>__PYX_ERR(0, 2203, __pyx_L26_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2204</span>:         else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2205</span>:             # Return the original data if error handling is set to 'ignore'</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2206</span>:             return data</pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(2206,0,<span class='error_goto'>__PYX_ERR(0, 2206, __pyx_L26_error)</span>)
        /*else*/ {
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
          __pyx_r = __pyx_v_data;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          goto __pyx_L25_return;
        }
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">2207</span>: </pre>
<pre class="cython line score-131" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2208</span>: def update_index(</pre>
<pre class='cython code score-131 '>static PyObject *__pyx_pf_6gofast_5tools_9funcutils_112__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("__defaults__", __pyx_f[0], 2208, 0, <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2217,0,<span class='error_goto'>__PYX_ERR(0, 2217, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults4, __pyx_self)-&gt;__pyx_arg_axis);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults4, __pyx_self)-&gt;__pyx_arg_axis);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults4, __pyx_self)-&gt;__pyx_arg_axis)) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 3, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_ignore));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_ignore));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 4, ((PyObject*)__pyx_n_u_ignore))) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 5, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 6, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 7, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>;
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2208,0,<span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_85update_index(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_84update_index, "\n    Updates the index or columns of a pandas Series or DataFrame with new \n    values, with the option to automatically convert input data to a Series \n    or DataFrame before the update. \n    \n    This function provides flexibility in managing data indices, including \n    conditional updates and transformations.\n\n    Parameters\n    ----------\n    data : Union[pd.Series, pd.DataFrame, list, dict, np.ndarray]\n        The data whose index or columns are to be updated. Can be a pandas \n        Series, DataFrame, or a structure convertible to them (list, dict, \n        or ndarray).\n    new_indexes : Optional[Union[list, str]], default None\n        The new index or column values to apply. If a single string is provided, \n        it is treated as a list with one element.\n    axis : int, default 0\n        The axis along which to update the index or columns. 0 for index (rows), \n        1 for columns.\n    allow_replace : bool, default False\n        Whether to allow replacement of the index or columns if they already exist.\n    return_data : bool, default False\n        If True, returns the updated data structure (Series or DataFrame). If False, \n        returns the new index or column list.\n    on_error : str, {'ignore', 'raise'}, default 'ignore'\n        Error handling strategy when an update precondition is not met. 'raise' \n        throws a ValueError, while 'ignore' proceeds without throwing.\n    transform : Optional[Callable], default None\n        An optional function to apply to each of the `new_indexes` before the \n        update. The function must accept a single value and return a transformed value.\n    condition : Optional[Callable[[Union[pd.Series, pd.DataFrame]], bool]], default None\n        An optional predicate function to determine whether the update should \n        proceed. The function must accept the data structure (Series or DataFrame) \n        and return a boolean.\n    convert_to : Optional[str], {'series', 'dataframe',"" 'auto'}, default None\n        Controls automatic conversion of input data to a Series or DataFrame \n        before the update. If 'auto', the function decides the most appropriate \n        type based on the input data structure.\n\n    Returns\n    -------\n    Union[pd.Series, pd.DataFrame, list]\n        Depending on `return_data`, either the updated Series or DataFrame \n        or the new index or column list.\n\n    Raises\n    ------\n    ValueError\n        If `on_error` is 'raise' and any precondition fails (e.g., unsupported \n        data type for conversion, index length mismatch, or condition check fails).\n\n    Examples\n    --------\n    &gt;&gt;&gt; import pandas as pd \n    &gt;&gt;&gt; from gofast.tools.funcutils import update_index\n    &gt;&gt;&gt; df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})\n    &gt;&gt;&gt; update_index(df, new_indexes=['X', 'Y'], axis=1, return_data=True)\n       X  Y\n    0  1  4\n    1  2  5\n    2  3  6\n\n    &gt;&gt;&gt; update_index([10, 20, 30], new_indexes=['a', 'b', 'c'],\n                     convert_to='series', return_data=True)\n    a    10\n    b    20\n    c    30\n    dtype: int64\n\n    &gt;&gt;&gt; update_index({'one': [1, 2], 'two': [3, 4]}, \n                     new_indexes=['first', 'second'], axis=0, \n                     convert_to='dataframe', return_data=True)\n         one  two\n    first   1    3\n    second  2    4\n\n    Note\n    ----\n    The `convert_to` parameter with 'auto' can intelligently convert input data \n    to the most suitable pandas structure for manipulation, enhancing the function's \n    usability across different data formats.\n    \n    See Also \n    ----------\n    gofast.tools.funcutils.to_pandas: \n        onvert input data into a Pandas DataFrame or Series\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_85update_index = {"update_index", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_85update_index, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_84update_index};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_85update_index(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_new_indexes = 0;
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_allow_replace = 0;
  PyObject *__pyx_v_return_data = 0;
  PyObject *__pyx_v_on_error = 0;
  PyObject *__pyx_v_transform = 0;
  PyObject *__pyx_v_condition = 0;
  PyObject *__pyx_v_convert_to = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("update_index (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_new_indexes,&amp;__pyx_n_s_axis,&amp;__pyx_n_s_allow_replace,&amp;__pyx_n_s_return_data,&amp;__pyx_n_s_on_error,&amp;__pyx_n_s_transform,&amp;__pyx_n_s_condition,&amp;__pyx_n_s_convert_to,0};
  PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
    __pyx_defaults4 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults4, __pyx_self);
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_84update_index(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_new_indexes, PyObject *__pyx_v_axis, PyObject *__pyx_v_allow_replace, PyObject *__pyx_v_return_data, PyObject *__pyx_v_on_error, PyObject *__pyx_v_transform, PyObject *__pyx_v_condition, PyObject *__pyx_v_convert_to) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__119)
  <span class='trace'>__Pyx_TraceCall</span>("update_index", __pyx_f[0], 2208, 0, <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_convert_to);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.update_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_convert_to);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__199 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_data, __pyx_n_s_new_indexes, __pyx_n_s_axis, __pyx_n_s_allow_replace, __pyx_n_s_return_data, __pyx_n_s_on_error, __pyx_n_s_transform, __pyx_n_s_condition, __pyx_n_s_convert_to);<span class='error_goto'> if (unlikely(!__pyx_tuple__199)) __PYX_ERR(0, 2208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__199);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__199);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2208,0,<span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_data, __pyx_kp_s_Union_ArrayLike_list_dict) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_new_indexes, __pyx_kp_s_Optional_Union_list_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_allow_replace, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return_data, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_on_error, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_transform, __pyx_kp_s_Optional_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_condition, __pyx_kp_s_Optional_LambdaType_Callable_Uni) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_convert_to, __pyx_kp_s_Optional_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_85update_index, 0, __pyx_n_s_update_index, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__119));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_5, sizeof(__pyx_defaults4), 1)) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>
  __pyx_codeobj__119 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(9, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__199, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_update_index, 2208, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__119)) __PYX_ERR(0, 2208, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2209</span>:     data: Union[ArrayLike, list, dict],</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2210</span>:     new_indexes: Optional[Union[list, str]] = None,</pre>
<pre class='cython code score-10 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_axis);
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_ignore)));
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2211</span>:     axis: int = 0,</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(2211,0,<span class='error_goto'>__PYX_ERR(0, 2211, __pyx_L1_error)</span>)
  if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_0)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_0))) <span class='error_goto'>__PYX_ERR(0, 2211, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults4, __pyx_t_5)-&gt;__pyx_arg_axis = ((PyObject*)__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_5, __pyx_pf_6gofast_5tools_9funcutils_112__defaults__);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_update_index, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2212</span>:     allow_replace: bool = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2213</span>:     return_data: bool = False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2214</span>:     on_error: str = 'ignore',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2215</span>:     transform: Optional[Callable] = None,</pre>
<pre class='cython code score-2 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2216</span>:     condition: Optional[LambdaType|Callable[[Union[Series, DataFrame]], bool]] = None,</pre>
<pre class='cython code score-2 '>    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-133" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2217</span>:     convert_to: Optional[str] = None</pre>
<pre class='cython code score-133 '>    values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_new_indexes);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_axis);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_allow_replace);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_data);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_error);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_transform);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_condition);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_convert_to);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "update_index") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_data = values[0];
    __pyx_v_new_indexes = values[1];
    __pyx_v_axis = ((PyObject*)values[2]);
    __pyx_v_allow_replace = values[3];
    __pyx_v_return_data = values[4];
    __pyx_v_on_error = ((PyObject*)values[5]);
    __pyx_v_transform = values[6];
    __pyx_v_condition = values[7];
    __pyx_v_convert_to = values[8];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("update_index", 0, 1, 9, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2208, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.update_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_axis), (&amp;PyInt_Type), 0, "axis", 1))) <span class='error_goto'>__PYX_ERR(0, 2211, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_on_error), (&amp;PyUnicode_Type), 0, "on_error", 1))) <span class='error_goto'>__PYX_ERR(0, 2214, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_84update_index(__pyx_self, __pyx_v_data, __pyx_v_new_indexes, __pyx_v_axis, __pyx_v_allow_replace, __pyx_v_return_data, __pyx_v_on_error, __pyx_v_transform, __pyx_v_condition, __pyx_v_convert_to);
</pre><pre class="cython line score-0">&#xA0;<span class="">2218</span>: ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2219</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2220</span>:     Updates the index or columns of a pandas Series or DataFrame with new</pre>
<pre class="cython line score-0">&#xA0;<span class="">2221</span>:     values, with the option to automatically convert input data to a Series</pre>
<pre class="cython line score-0">&#xA0;<span class="">2222</span>:     or DataFrame before the update.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2223</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2224</span>:     This function provides flexibility in managing data indices, including</pre>
<pre class="cython line score-0">&#xA0;<span class="">2225</span>:     conditional updates and transformations.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2226</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2227</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2228</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2229</span>:     data : Union[pd.Series, pd.DataFrame, list, dict, np.ndarray]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2230</span>:         The data whose index or columns are to be updated. Can be a pandas</pre>
<pre class="cython line score-0">&#xA0;<span class="">2231</span>:         Series, DataFrame, or a structure convertible to them (list, dict,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2232</span>:         or ndarray).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2233</span>:     new_indexes : Optional[Union[list, str]], default None</pre>
<pre class="cython line score-0">&#xA0;<span class="">2234</span>:         The new index or column values to apply. If a single string is provided,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2235</span>:         it is treated as a list with one element.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2236</span>:     axis : int, default 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">2237</span>:         The axis along which to update the index or columns. 0 for index (rows),</pre>
<pre class="cython line score-0">&#xA0;<span class="">2238</span>:         1 for columns.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2239</span>:     allow_replace : bool, default False</pre>
<pre class="cython line score-0">&#xA0;<span class="">2240</span>:         Whether to allow replacement of the index or columns if they already exist.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2241</span>:     return_data : bool, default False</pre>
<pre class="cython line score-0">&#xA0;<span class="">2242</span>:         If True, returns the updated data structure (Series or DataFrame). If False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2243</span>:         returns the new index or column list.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2244</span>:     on_error : str, {'ignore', 'raise'}, default 'ignore'</pre>
<pre class="cython line score-0">&#xA0;<span class="">2245</span>:         Error handling strategy when an update precondition is not met. 'raise'</pre>
<pre class="cython line score-0">&#xA0;<span class="">2246</span>:         throws a ValueError, while 'ignore' proceeds without throwing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2247</span>:     transform : Optional[Callable], default None</pre>
<pre class="cython line score-0">&#xA0;<span class="">2248</span>:         An optional function to apply to each of the `new_indexes` before the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2249</span>:         update. The function must accept a single value and return a transformed value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2250</span>:     condition : Optional[Callable[[Union[pd.Series, pd.DataFrame]], bool]], default None</pre>
<pre class="cython line score-0">&#xA0;<span class="">2251</span>:         An optional predicate function to determine whether the update should</pre>
<pre class="cython line score-0">&#xA0;<span class="">2252</span>:         proceed. The function must accept the data structure (Series or DataFrame)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2253</span>:         and return a boolean.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2254</span>:     convert_to : Optional[str], {'series', 'dataframe', 'auto'}, default None</pre>
<pre class="cython line score-0">&#xA0;<span class="">2255</span>:         Controls automatic conversion of input data to a Series or DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">2256</span>:         before the update. If 'auto', the function decides the most appropriate</pre>
<pre class="cython line score-0">&#xA0;<span class="">2257</span>:         type based on the input data structure.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2258</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2259</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2260</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2261</span>:     Union[pd.Series, pd.DataFrame, list]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2262</span>:         Depending on `return_data`, either the updated Series or DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">2263</span>:         or the new index or column list.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2264</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2265</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">2266</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2267</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2268</span>:         If `on_error` is 'raise' and any precondition fails (e.g., unsupported</pre>
<pre class="cython line score-0">&#xA0;<span class="">2269</span>:         data type for conversion, index length mismatch, or condition check fails).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2270</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2271</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2272</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2273</span>:     &gt;&gt;&gt; import pandas as pd</pre>
<pre class="cython line score-0">&#xA0;<span class="">2274</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import update_index</pre>
<pre class="cython line score-0">&#xA0;<span class="">2275</span>:     &gt;&gt;&gt; df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})</pre>
<pre class="cython line score-0">&#xA0;<span class="">2276</span>:     &gt;&gt;&gt; update_index(df, new_indexes=['X', 'Y'], axis=1, return_data=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2277</span>:        X  Y</pre>
<pre class="cython line score-0">&#xA0;<span class="">2278</span>:     0  1  4</pre>
<pre class="cython line score-0">&#xA0;<span class="">2279</span>:     1  2  5</pre>
<pre class="cython line score-0">&#xA0;<span class="">2280</span>:     2  3  6</pre>
<pre class="cython line score-0">&#xA0;<span class="">2281</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2282</span>:     &gt;&gt;&gt; update_index([10, 20, 30], new_indexes=['a', 'b', 'c'],</pre>
<pre class="cython line score-0">&#xA0;<span class="">2283</span>:                      convert_to='series', return_data=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2284</span>:     a    10</pre>
<pre class="cython line score-0">&#xA0;<span class="">2285</span>:     b    20</pre>
<pre class="cython line score-0">&#xA0;<span class="">2286</span>:     c    30</pre>
<pre class="cython line score-0">&#xA0;<span class="">2287</span>:     dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">2288</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2289</span>:     &gt;&gt;&gt; update_index({'one': [1, 2], 'two': [3, 4]},</pre>
<pre class="cython line score-0">&#xA0;<span class="">2290</span>:                      new_indexes=['first', 'second'], axis=0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2291</span>:                      convert_to='dataframe', return_data=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2292</span>:          one  two</pre>
<pre class="cython line score-0">&#xA0;<span class="">2293</span>:     first   1    3</pre>
<pre class="cython line score-0">&#xA0;<span class="">2294</span>:     second  2    4</pre>
<pre class="cython line score-0">&#xA0;<span class="">2295</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2296</span>:     Note</pre>
<pre class="cython line score-0">&#xA0;<span class="">2297</span>:     ----</pre>
<pre class="cython line score-0">&#xA0;<span class="">2298</span>:     The `convert_to` parameter with 'auto' can intelligently convert input data</pre>
<pre class="cython line score-0">&#xA0;<span class="">2299</span>:     to the most suitable pandas structure for manipulation, enhancing the function's</pre>
<pre class="cython line score-0">&#xA0;<span class="">2300</span>:     usability across different data formats.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2301</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2302</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">2303</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2304</span>:     gofast.tools.funcutils.to_pandas:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2305</span>:         onvert input data into a Pandas DataFrame or Series</pre>
<pre class="cython line score-0">&#xA0;<span class="">2306</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2307</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2308</span>:     # Convert input data to Series or DataFrame if specified</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2309</span>:     convert_to = str(convert_to).lower()</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(2309,0,<span class='error_goto'>__PYX_ERR(0, 2309, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_v_convert_to);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2309, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2309, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_convert_to, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2310</span>:     if convert_to == 'auto':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2310,0,<span class='error_goto'>__PYX_ERR(0, 2310, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_convert_to, __pyx_n_u_auto, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2310, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2311</span>:         data = convert_to_pandas(data, error=on_error)</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(2311,0,<span class='error_goto'>__PYX_ERR(0, 2311, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_convert_to_pandas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2311, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2311, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_data)) <span class='error_goto'>__PYX_ERR(0, 2311, __pyx_L1_error)</span>;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2311, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_error, __pyx_v_on_error) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2311, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2311, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2312</span>:     elif convert_to == 'series':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2312,0,<span class='error_goto'>__PYX_ERR(0, 2312, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_convert_to, __pyx_n_u_series, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2312, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2313</span>:         data = pd.Series(data)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(2313,0,<span class='error_goto'>__PYX_ERR(0, 2313, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_data};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2313, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2314</span>:     elif convert_to == 'dataframe':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2314,0,<span class='error_goto'>__PYX_ERR(0, 2314, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_convert_to, __pyx_n_u_dataframe, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2314, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/*  */
  }
  __pyx_L3:;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2315</span>:         data = pd.DataFrame(data)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(2315,0,<span class='error_goto'>__PYX_ERR(0, 2315, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2315, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2315, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_data};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2315, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2316</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2317</span>:     # Determine if input data is Series or DataFrame and update accordingly</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2318</span>:     if isinstance(data, pd.Series):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(2318,0,<span class='error_goto'>__PYX_ERR(0, 2318, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2318, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2318, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 2318, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {
/*  */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2319</span>:         return update_series_index(</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(2319,0,<span class='error_goto'>__PYX_ERR(0, 2319, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_update_series_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(2321,0,<span class='error_goto'>__PYX_ERR(0, 2321, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_data)) <span class='error_goto'>__PYX_ERR(0, 2319, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_indexes);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_new_indexes);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_new_indexes)) <span class='error_goto'>__PYX_ERR(0, 2319, __pyx_L1_error)</span>;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(2319,0,<span class='error_goto'>__PYX_ERR(0, 2319, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2320</span>:             data,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2321</span>:             new_indexes,</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2322</span>:             allow_replace=allow_replace,</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(2322,0,<span class='error_goto'>__PYX_ERR(0, 2322, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2322, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_allow_replace, __pyx_v_allow_replace) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2322, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2323</span>:             return_series=return_data,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2323,0,<span class='error_goto'>__PYX_ERR(0, 2323, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return_series, __pyx_v_return_data) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2322, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2324</span>:             on_error =on_error,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2324,0,<span class='error_goto'>__PYX_ERR(0, 2324, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_on_error, __pyx_v_on_error) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2322, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2325</span>:             transform=transform,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2325,0,<span class='error_goto'>__PYX_ERR(0, 2325, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_transform, __pyx_v_transform) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2322, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2326</span>:             condition=condition</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2326,0,<span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_condition, __pyx_v_condition) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2322, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2327</span>:             )</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2328</span>:     elif isinstance(data, pd.DataFrame):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(2328,0,<span class='error_goto'>__PYX_ERR(0, 2328, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 2328, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(__pyx_t_5)) {
/*  */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2329</span>:         return update_dataframe_index(</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(2329,0,<span class='error_goto'>__PYX_ERR(0, 2329, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_update_dataframe_index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(2331,0,<span class='error_goto'>__PYX_ERR(0, 2331, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data)) <span class='error_goto'>__PYX_ERR(0, 2329, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_new_indexes);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_new_indexes);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_new_indexes)) <span class='error_goto'>__PYX_ERR(0, 2329, __pyx_L1_error)</span>;
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(2329,0,<span class='error_goto'>__PYX_ERR(0, 2329, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2330</span>:             data,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2331</span>:             new_indexes,</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2332</span>:             axis=axis,</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(2332,0,<span class='error_goto'>__PYX_ERR(0, 2332, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_axis, __pyx_v_axis) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2332, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2333</span>:             allow_replace=allow_replace,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2333,0,<span class='error_goto'>__PYX_ERR(0, 2333, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_allow_replace, __pyx_v_allow_replace) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2332, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2334</span>:             return_df=return_data,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2334,0,<span class='error_goto'>__PYX_ERR(0, 2334, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_return_df, __pyx_v_return_data) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2332, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2335</span>:             on_error=on_error,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2335,0,<span class='error_goto'>__PYX_ERR(0, 2335, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_on_error, __pyx_v_on_error) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2332, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2336</span>:             transform=transform,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2336,0,<span class='error_goto'>__PYX_ERR(0, 2336, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_transform, __pyx_v_transform) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2332, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2337</span>:             condition=condition</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2337,0,<span class='error_goto'>__PYX_ERR(0, 2337, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_condition, __pyx_v_condition) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2332, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2338</span>:             )</pre>
<pre class="cython line score-0">&#xA0;<span class="">2339</span>:     else:</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2340</span>:         raise ValueError("Input data must be a pandas Series or DataFrame,"</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(2340,0,<span class='error_goto'>__PYX_ERR(0, 2340, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2340, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = 0;
    __pyx_t_8 = 127;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Input_data_must_be_a_pandas_Seri);
    __pyx_t_7 += 53;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Input_data_must_be_a_pandas_Seri);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_Input_data_must_be_a_pandas_Seri);
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(2340,0,<span class='error_goto'>__PYX_ERR(0, 2340, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 3, __pyx_t_7, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2340, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2340, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2340, __pyx_L1_error)</span>
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2341</span>:                          f" got {type(data).__name__}.")</pre>
<pre class='cython code score-14 '>    <span class='trace'>__Pyx_TraceLine</span>(2341,0,<span class='error_goto'>__PYX_ERR(0, 2341, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)Py_TYPE(__pyx_v_data)), __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2341, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_6, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2341, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_8) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_8;
    __pyx_t_7 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__49);
    __pyx_t_7 += 1;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__49);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u__49);
</pre><pre class="cython line score-0">&#xA0;<span class="">2342</span>: </pre>
<pre class="cython line score-101" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2343</span>: def convert_and_format_data(</pre>
<pre class='cython code score-101 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_87convert_and_format_data(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_86convert_and_format_data, "\n    Converts the input data into a pandas DataFrame or Series, then formats it\n    according to specified parameters and an optional condition for dynamic\n    parameter adjustments. Optionally applies a custom conversion function.\n\n    Parameters\n    ----------\n    data : Any\n        The input data to be converted. Can be any type that is supported by\n        the custom conversion function or can be automatically handled by pandas.\n    return_df : bool, default False\n        If True, ensures the output is a DataFrame. If False and the data can\n        be represented as a Series (or an array if `force_array_output` is True),\n        the output will not be a DataFrame.\n    series_name : Optional[str], default None\n        Specifies a new name for the Series if the output is a Series. This parameter\n        is ignored if `return_df` is True or if the data cannot be converted\n        to a Series.\n    allow_series_conversion : bool, default True\n        Allows converting a single-column DataFrame into a Series if `return_df`\n        is False. If False, single-column DataFrames will not be converted to Series.\n    force_array_output : bool, default False\n        If True, converts the output to a numpy array, reducing its dimension \n        if possible. This parameter is considered only if `return_df` is False.\n    condense : bool, default False\n        If True, simplifies the output in the following ways when \n        `force_array_output` is True:\n        - Converts a single-value array or Series to a scalar (float or int).\n        - Reduces a two-dimensional array of shape (n, 1) or (1, n) to a \n          one-dimensional array of shape (n,).\n        This simplification is considered only if `force_array_output` is \n        True and `return_df` is False.\n\n    custom_conversion : Optional[Callable[[Any], pd.DataFrame]], default None\n        A custom function that takes the input data and returns a pandas DataFrame.\n        This function ""is used for conversion if provided.\n    condition : Optional[Callable[[Any], dict]], default None\n        A condition function that takes the input data as is and returns a dictionary\n        of parameter adjustments. For example, to modify `return_df` based on\n        data properties, return `{'return_df': True}` if the condition is met.\n    where : str, default 'before'\n        Determines when the condition is applied: 'before' applies the condition\n        before any conversion, and 'after' applies it after the initial conversion\n        but before any formatting.\n\n    Returns\n    -------\n    output : pd.DataFrame, pd.Series, or np.ndarray\n        The converted and formatted data. The specific type depends on the input\n        parameters and the nature of `data`.\n\n    Examples\n    --------\n    Convert a list to a pandas DataFrame:\n    \n    &gt;&gt;&gt; from gofast.tools.funcutils import convert_and_format_data\n    &gt;&gt;&gt; convert_and_format_data([1, 2, 3], output_as_frame=True)\n    pd.DataFrame(data=[1, 2, 3])\n\n    Convert a single-column DataFrame to a Series named 'my_series':\n\n    &gt;&gt;&gt; convert_and_format_data(pd.DataFrame({'A': [1, 2, 3]}), \n                                series_name='my_series')\n    pd.Series(data=[1, 2, 3], name='my_series')\n\n    Convert data using a custom conversion function and output as numpy array:\n\n    &gt;&gt;&gt; def my_conversion(data):\n    ...     return pd.DataFrame(data)\n    &gt;&gt;&gt; convert_and_format_data({'A': [1, 2], 'B': [3, 4]}, \n                                custom_conversion=my_conversion, \n                                force_array_output=True)\n    np.array([[1, 3], [2, 4]])\n    \n    &gt;&gt;&gt; convert_and_format_data([1, 2, 3], output_as_frame=True)\n    pd.DataFrame(data=[1, 2, 3])\n\n    Convert a single-column DataFrame to a Series named 'my_series', then to an array:\n\n    &gt;&gt;&gt; condition = lambda x: isinstance(x, pd.Series)\n    &gt;&gt;&gt; convert_and_format_data(pd.DataFrame({'A': [1, 2, 3]}),\n                   ""             series_name='my_series',\n                                force_array_output=True,\n                                condition=condition)\n    np.array([1, 2, 3])\n\n    Use a custom conversion function and force output as numpy array if data is a Series:\n\n    &gt;&gt;&gt; def my_conversion(data):\n    ...     return pd.DataFrame(data)\n    &gt;&gt;&gt; convert_and_format_data({'A': [1, 2], 'B': [3, 4]},\n                                custom_conversion=my_conversion,\n                                force_array_output=True,\n                                condition=lambda x: isinstance(x, pd.Series))\n    np.array([[1, 3], [2, 4]])\n\n    &gt;&gt;&gt; convert_and_format_data(pd.DataFrame({'A': [1, 2, 3]}), series_name='my_series')\n    pd.Series(data=[1, 2, 3], name='my_series')\n\n    &gt;&gt;&gt; condition = lambda x: {'return_df': True} if isinstance(x, list) else {}\n    &gt;&gt;&gt; convert_and_format_data([1, 2, 3], condition=condition, where='before')\n    pd.DataFrame(data=[1, 2, 3])\n    \n\n    Convert a list to a pandas DataFrame:\n    \n    &gt;&gt;&gt; convert_and_format_data([1, 2, 3], return_df=True)\n    pd.DataFrame(data=[1, 2, 3])\n    \n    Convert a single-column DataFrame to a Series named 'my_series',\n    then simplify to a one-dimensional array:\n    \n    &gt;&gt;&gt; convert_and_format_data(pd.DataFrame({'A': [1, 2, 3]}), \n    ...                            series_name='my_series',\n    ...                            force_array_output=True,\n    ...                            condense=True)\n    array([1, 2, 3])\n    \n    Simplify a two-dimensional array to a one-dimensional array:\n    \n    &gt;&gt;&gt; convert_and_format_data(np.array([[1], [2], [3]]), \n    ...                            force_array_output=True,\n    ...                            condense=True)\n    array([1, 2, 3])\n    \n    Convert a single-value Series to a scalar:\n    \n    &gt;&gt;&gt; convert_and_format_data(pd.Series([100]), \n                                force_array_output=True, condense=True)\n    100\n\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_87convert_and_format_data = {"convert_and_format_data", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_87convert_and_format_data, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_86convert_and_format_data};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_87convert_and_format_data(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_return_df = 0;
  PyObject *__pyx_v_series_name = 0;
  PyObject *__pyx_v_allow_series_conversion = 0;
  PyObject *__pyx_v_force_array_output = 0;
  PyObject *__pyx_v_condense = 0;
  PyObject *__pyx_v_custom_conversion = 0;
  PyObject *__pyx_v_condition = 0;
  PyObject *__pyx_v_where = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("convert_and_format_data (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_return_df,&amp;__pyx_n_s_series_name,&amp;__pyx_n_s_allow_series_conversion,&amp;__pyx_n_s_force_array_output,&amp;__pyx_n_s_condense,&amp;__pyx_n_s_custom_conversion,&amp;__pyx_n_s_condition,&amp;__pyx_n_s_where,0};
  PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
/*  */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_86convert_and_format_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_return_df, PyObject *__pyx_v_series_name, PyObject *__pyx_v_allow_series_conversion, PyObject *__pyx_v_force_array_output, PyObject *__pyx_v_condense, PyObject *__pyx_v_custom_conversion, PyObject *__pyx_v_condition, PyObject *__pyx_v_where) {
  PyObject *__pyx_v_adjustments = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__120)
  <span class='trace'>__Pyx_TraceCall</span>("convert_and_format_data", __pyx_f[0], 2343, 0, <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_return_df);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_series_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_allow_series_conversion);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_force_array_output);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.convert_and_format_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_adjustments);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_return_df);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_series_name);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_allow_series_conversion);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_force_array_output);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__200 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_data, __pyx_n_s_return_df, __pyx_n_s_series_name, __pyx_n_s_allow_series_conversion, __pyx_n_s_force_array_output, __pyx_n_s_condense, __pyx_n_s_custom_conversion, __pyx_n_s_condition, __pyx_n_s_where, __pyx_n_s_adjustments);<span class='error_goto'> if (unlikely(!__pyx_tuple__200)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__200);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__200);
  __pyx_codeobj__120 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(9, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__200, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_convert_and_format_data, 2343, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__120)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2343,0,<span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_data, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return_df, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_series_name, __pyx_kp_s_Optional_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_allow_series_conversion, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_force_array_output, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_condense, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_custom_conversion, __pyx_kp_s_Optional_Callable_Any_Union_Data) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_condition, __pyx_kp_s_Optional_LambdaType_Callable_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_where, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_87convert_and_format_data, 0, __pyx_n_s_convert_and_format_data, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__120));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__201);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convert_and_format_data, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__201 = <span class='py_c_api'>PyTuple_Pack</span>(8, ((PyObject *)Py_False), Py_None, ((PyObject *)Py_True), ((PyObject *)Py_False), ((PyObject *)Py_False), Py_None, Py_None, ((PyObject*)__pyx_n_u_before));<span class='error_goto'> if (unlikely(!__pyx_tuple__201)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__201);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__201);
</pre><pre class="cython line score-0">&#xA0;<span class="">2344</span>:     data: Any,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2345</span>:     return_df: bool = False,</pre>
<pre class='cython code score-2 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2346</span>:     series_name: Optional[str] = None,</pre>
<pre class='cython code score-2 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2347</span>:     allow_series_conversion: bool = True,</pre>
<pre class='cython code score-2 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2348</span>:     force_array_output: bool = False,</pre>
<pre class='cython code score-2 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2349</span>:     condense: bool = False,</pre>
<pre class='cython code score-2 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2350</span>:     custom_conversion: Optional[Callable[[Any], Union[DataFrame, Series]]] = None,</pre>
<pre class='cython code score-2 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-133" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2351</span>:     condition: Optional[LambdaType | Callable[[Any], dict]] = None,</pre>
<pre class='cython code score-133 '>    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_before)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_df);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_series_name);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_allow_series_conversion);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_force_array_output);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_condense);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_custom_conversion);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_condition);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_where);
          if (value) { values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "convert_and_format_data") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_data = values[0];
    __pyx_v_return_df = values[1];
    __pyx_v_series_name = values[2];
    __pyx_v_allow_series_conversion = values[3];
    __pyx_v_force_array_output = values[4];
    __pyx_v_condense = values[5];
    __pyx_v_custom_conversion = values[6];
    __pyx_v_condition = values[7];
    __pyx_v_where = ((PyObject*)values[8]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("convert_and_format_data", 0, 1, 9, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.convert_and_format_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_where), (&amp;PyUnicode_Type), 0, "where", 1))) <span class='error_goto'>__PYX_ERR(0, 2352, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_86convert_and_format_data(__pyx_self, __pyx_v_data, __pyx_v_return_df, __pyx_v_series_name, __pyx_v_allow_series_conversion, __pyx_v_force_array_output, __pyx_v_condense, __pyx_v_custom_conversion, __pyx_v_condition, __pyx_v_where);
</pre><pre class="cython line score-0">&#xA0;<span class="">2352</span>:     where: str = 'before'</pre>
<pre class="cython line score-0">&#xA0;<span class="">2353</span>: ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2354</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2355</span>:     Converts the input data into a pandas DataFrame or Series, then formats it</pre>
<pre class="cython line score-0">&#xA0;<span class="">2356</span>:     according to specified parameters and an optional condition for dynamic</pre>
<pre class="cython line score-0">&#xA0;<span class="">2357</span>:     parameter adjustments. Optionally applies a custom conversion function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2358</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2359</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2360</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2361</span>:     data : Any</pre>
<pre class="cython line score-0">&#xA0;<span class="">2362</span>:         The input data to be converted. Can be any type that is supported by</pre>
<pre class="cython line score-0">&#xA0;<span class="">2363</span>:         the custom conversion function or can be automatically handled by pandas.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2364</span>:     return_df : bool, default False</pre>
<pre class="cython line score-0">&#xA0;<span class="">2365</span>:         If True, ensures the output is a DataFrame. If False and the data can</pre>
<pre class="cython line score-0">&#xA0;<span class="">2366</span>:         be represented as a Series (or an array if `force_array_output` is True),</pre>
<pre class="cython line score-0">&#xA0;<span class="">2367</span>:         the output will not be a DataFrame.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2368</span>:     series_name : Optional[str], default None</pre>
<pre class="cython line score-0">&#xA0;<span class="">2369</span>:         Specifies a new name for the Series if the output is a Series. This parameter</pre>
<pre class="cython line score-0">&#xA0;<span class="">2370</span>:         is ignored if `return_df` is True or if the data cannot be converted</pre>
<pre class="cython line score-0">&#xA0;<span class="">2371</span>:         to a Series.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2372</span>:     allow_series_conversion : bool, default True</pre>
<pre class="cython line score-0">&#xA0;<span class="">2373</span>:         Allows converting a single-column DataFrame into a Series if `return_df`</pre>
<pre class="cython line score-0">&#xA0;<span class="">2374</span>:         is False. If False, single-column DataFrames will not be converted to Series.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2375</span>:     force_array_output : bool, default False</pre>
<pre class="cython line score-0">&#xA0;<span class="">2376</span>:         If True, converts the output to a numpy array, reducing its dimension</pre>
<pre class="cython line score-0">&#xA0;<span class="">2377</span>:         if possible. This parameter is considered only if `return_df` is False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2378</span>:     condense : bool, default False</pre>
<pre class="cython line score-0">&#xA0;<span class="">2379</span>:         If True, simplifies the output in the following ways when</pre>
<pre class="cython line score-0">&#xA0;<span class="">2380</span>:         `force_array_output` is True:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2381</span>:         - Converts a single-value array or Series to a scalar (float or int).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2382</span>:         - Reduces a two-dimensional array of shape (n, 1) or (1, n) to a</pre>
<pre class="cython line score-0">&#xA0;<span class="">2383</span>:           one-dimensional array of shape (n,).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2384</span>:         This simplification is considered only if `force_array_output` is</pre>
<pre class="cython line score-0">&#xA0;<span class="">2385</span>:         True and `return_df` is False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2386</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2387</span>:     custom_conversion : Optional[Callable[[Any], pd.DataFrame]], default None</pre>
<pre class="cython line score-0">&#xA0;<span class="">2388</span>:         A custom function that takes the input data and returns a pandas DataFrame.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2389</span>:         This function is used for conversion if provided.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2390</span>:     condition : Optional[Callable[[Any], dict]], default None</pre>
<pre class="cython line score-0">&#xA0;<span class="">2391</span>:         A condition function that takes the input data as is and returns a dictionary</pre>
<pre class="cython line score-0">&#xA0;<span class="">2392</span>:         of parameter adjustments. For example, to modify `return_df` based on</pre>
<pre class="cython line score-0">&#xA0;<span class="">2393</span>:         data properties, return `{'return_df': True}` if the condition is met.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2394</span>:     where : str, default 'before'</pre>
<pre class="cython line score-0">&#xA0;<span class="">2395</span>:         Determines when the condition is applied: 'before' applies the condition</pre>
<pre class="cython line score-0">&#xA0;<span class="">2396</span>:         before any conversion, and 'after' applies it after the initial conversion</pre>
<pre class="cython line score-0">&#xA0;<span class="">2397</span>:         but before any formatting.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2398</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2399</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2400</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2401</span>:     output : pd.DataFrame, pd.Series, or np.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2402</span>:         The converted and formatted data. The specific type depends on the input</pre>
<pre class="cython line score-0">&#xA0;<span class="">2403</span>:         parameters and the nature of `data`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2404</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2405</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2406</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2407</span>:     Convert a list to a pandas DataFrame:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2408</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2409</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import convert_and_format_data</pre>
<pre class="cython line score-0">&#xA0;<span class="">2410</span>:     &gt;&gt;&gt; convert_and_format_data([1, 2, 3], output_as_frame=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2411</span>:     pd.DataFrame(data=[1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2412</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2413</span>:     Convert a single-column DataFrame to a Series named 'my_series':</pre>
<pre class="cython line score-0">&#xA0;<span class="">2414</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2415</span>:     &gt;&gt;&gt; convert_and_format_data(pd.DataFrame({'A': [1, 2, 3]}),</pre>
<pre class="cython line score-0">&#xA0;<span class="">2416</span>:                                 series_name='my_series')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2417</span>:     pd.Series(data=[1, 2, 3], name='my_series')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2418</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2419</span>:     Convert data using a custom conversion function and output as numpy array:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2420</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2421</span>:     &gt;&gt;&gt; def my_conversion(data):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2422</span>:     ...     return pd.DataFrame(data)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2423</span>:     &gt;&gt;&gt; convert_and_format_data({'A': [1, 2], 'B': [3, 4]},</pre>
<pre class="cython line score-0">&#xA0;<span class="">2424</span>:                                 custom_conversion=my_conversion,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2425</span>:                                 force_array_output=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2426</span>:     np.array([[1, 3], [2, 4]])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2427</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2428</span>:     &gt;&gt;&gt; convert_and_format_data([1, 2, 3], output_as_frame=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2429</span>:     pd.DataFrame(data=[1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2430</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2431</span>:     Convert a single-column DataFrame to a Series named 'my_series', then to an array:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2432</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2433</span>:     &gt;&gt;&gt; condition = lambda x: isinstance(x, pd.Series)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2434</span>:     &gt;&gt;&gt; convert_and_format_data(pd.DataFrame({'A': [1, 2, 3]}),</pre>
<pre class="cython line score-0">&#xA0;<span class="">2435</span>:                                 series_name='my_series',</pre>
<pre class="cython line score-0">&#xA0;<span class="">2436</span>:                                 force_array_output=True,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2437</span>:                                 condition=condition)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2438</span>:     np.array([1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2439</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2440</span>:     Use a custom conversion function and force output as numpy array if data is a Series:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2441</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2442</span>:     &gt;&gt;&gt; def my_conversion(data):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2443</span>:     ...     return pd.DataFrame(data)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2444</span>:     &gt;&gt;&gt; convert_and_format_data({'A': [1, 2], 'B': [3, 4]},</pre>
<pre class="cython line score-0">&#xA0;<span class="">2445</span>:                                 custom_conversion=my_conversion,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2446</span>:                                 force_array_output=True,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2447</span>:                                 condition=lambda x: isinstance(x, pd.Series))</pre>
<pre class="cython line score-0">&#xA0;<span class="">2448</span>:     np.array([[1, 3], [2, 4]])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2449</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2450</span>:     &gt;&gt;&gt; convert_and_format_data(pd.DataFrame({'A': [1, 2, 3]}), series_name='my_series')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2451</span>:     pd.Series(data=[1, 2, 3], name='my_series')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2452</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2453</span>:     &gt;&gt;&gt; condition = lambda x: {'return_df': True} if isinstance(x, list) else {}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2454</span>:     &gt;&gt;&gt; convert_and_format_data([1, 2, 3], condition=condition, where='before')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2455</span>:     pd.DataFrame(data=[1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2456</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2457</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2458</span>:     Convert a list to a pandas DataFrame:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2459</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2460</span>:     &gt;&gt;&gt; convert_and_format_data([1, 2, 3], return_df=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2461</span>:     pd.DataFrame(data=[1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2462</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2463</span>:     Convert a single-column DataFrame to a Series named 'my_series',</pre>
<pre class="cython line score-0">&#xA0;<span class="">2464</span>:     then simplify to a one-dimensional array:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2465</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2466</span>:     &gt;&gt;&gt; convert_and_format_data(pd.DataFrame({'A': [1, 2, 3]}),</pre>
<pre class="cython line score-0">&#xA0;<span class="">2467</span>:     ...                            series_name='my_series',</pre>
<pre class="cython line score-0">&#xA0;<span class="">2468</span>:     ...                            force_array_output=True,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2469</span>:     ...                            condense=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2470</span>:     array([1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2471</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2472</span>:     Simplify a two-dimensional array to a one-dimensional array:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2473</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2474</span>:     &gt;&gt;&gt; convert_and_format_data(np.array([[1], [2], [3]]),</pre>
<pre class="cython line score-0">&#xA0;<span class="">2475</span>:     ...                            force_array_output=True,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2476</span>:     ...                            condense=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2477</span>:     array([1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2478</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2479</span>:     Convert a single-value Series to a scalar:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2480</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2481</span>:     &gt;&gt;&gt; convert_and_format_data(pd.Series([100]),</pre>
<pre class="cython line score-0">&#xA0;<span class="">2482</span>:                                 force_array_output=True, condense=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2483</span>:     100</pre>
<pre class="cython line score-0">&#xA0;<span class="">2484</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2485</span>:     """</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2486</span>:     adjustments = {}</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2486,0,<span class='error_goto'>__PYX_ERR(0, 2486, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2486, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_adjustments = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2487</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2488</span>:     # Apply condition based on 'where' parameter</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2489</span>:     if where == 'before':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2489,0,<span class='error_goto'>__PYX_ERR(0, 2489, __pyx_L1_error)</span>)
  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_where, __pyx_n_u_before, Py_EQ)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2489, __pyx_L1_error)</span>
  if (__pyx_t_2) {
/*  */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2490</span>:         if condition:</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2490,0,<span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_condition); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2490, __pyx_L1_error)</span>
    if (__pyx_t_2) {
/*  */
    }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2491</span>:             adjustments = condition(data)</pre>
<pre class='cython code score-16 '>      <span class='trace'>__Pyx_TraceLine</span>(2491,0,<span class='error_goto'>__PYX_ERR(0, 2491, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_condition);
      __pyx_t_3 = __pyx_v_condition; __pyx_t_4 = NULL;
      __pyx_t_5 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_5 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_data};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2491, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_adjustments, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2492</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2493</span>:     if custom_conversion:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2493,0,<span class='error_goto'>__PYX_ERR(0, 2493, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_custom_conversion); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2493, __pyx_L1_error)</span>
  if (__pyx_t_2) {
/*  */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2494</span>:         data = custom_conversion(data)</pre>
<pre class='cython code score-16 '>    <span class='trace'>__Pyx_TraceLine</span>(2494,0,<span class='error_goto'>__PYX_ERR(0, 2494, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_custom_conversion);
    __pyx_t_3 = __pyx_v_custom_conversion; __pyx_t_4 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_data};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2494, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2495</span>:     else:</pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2496</span>:         data = to_pandas(data, convert_single_column=allow_series_conversion)</pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(2496,0,<span class='error_goto'>__PYX_ERR(0, 2496, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_to_pandas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2496, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2496, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_data)) <span class='error_goto'>__PYX_ERR(0, 2496, __pyx_L1_error)</span>;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2496, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_convert_single_column, __pyx_v_allow_series_conversion) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2496, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2496, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_6);
    __pyx_t_6 = 0;
  }
  __pyx_L5:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2497</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2498</span>:     # Apply condition after initial conversion if 'where' is 'after'</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2499</span>:     if where == 'after':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2499,0,<span class='error_goto'>__PYX_ERR(0, 2499, __pyx_L1_error)</span>)
  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_where, __pyx_n_u_after, Py_EQ)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2499, __pyx_L1_error)</span>
  if (__pyx_t_2) {
/*  */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2500</span>:         if condition:</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2500,0,<span class='error_goto'>__PYX_ERR(0, 2500, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_condition); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2500, __pyx_L1_error)</span>
    if (__pyx_t_2) {
/*  */
    }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2501</span>:             adjustments = condition(data)</pre>
<pre class='cython code score-16 '>      <span class='trace'>__Pyx_TraceLine</span>(2501,0,<span class='error_goto'>__PYX_ERR(0, 2501, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_condition);
      __pyx_t_4 = __pyx_v_condition; __pyx_t_3 = NULL;
      __pyx_t_5 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_5 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_data};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2501, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_adjustments, __pyx_t_6);
      __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2502</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2503</span>:     # Apply adjustments</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2504</span>:     return_df = adjustments.get('return_df', return_df)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(2504,0,<span class='error_goto'>__PYX_ERR(0, 2504, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_adjustments, __pyx_n_s_get);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2504, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_n_u_return_df, __pyx_v_return_df};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2504, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_return_df, __pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2505</span>:     series_name = adjustments.get('series_name', series_name)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(2505,0,<span class='error_goto'>__PYX_ERR(0, 2505, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_adjustments, __pyx_n_s_get);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_n_u_series_name, __pyx_v_series_name};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2505, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_series_name, __pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2506</span>:     allow_series_conversion = adjustments.get(</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2506,0,<span class='error_goto'>__PYX_ERR(0, 2506, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_adjustments, __pyx_n_s_get);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2506, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2507</span>:         'allow_series_conversion', allow_series_conversion)</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(2507,0,<span class='error_goto'>__PYX_ERR(0, 2507, __pyx_L1_error)</span>)
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_n_u_allow_series_conversion, __pyx_v_allow_series_conversion};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2506, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_allow_series_conversion, __pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2508</span>:     force_array_output = adjustments.get(</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2508,0,<span class='error_goto'>__PYX_ERR(0, 2508, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_adjustments, __pyx_n_s_get);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2508, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2509</span>:         'force_array_output', force_array_output)</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(2509,0,<span class='error_goto'>__PYX_ERR(0, 2509, __pyx_L1_error)</span>)
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_n_u_force_array_output, __pyx_v_force_array_output};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2508, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_force_array_output, __pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2510</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2511</span>:     # Proceed with data formatting based on adjusted parameters</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2512</span>:     if isinstance(data, pd.Series):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(2512,0,<span class='error_goto'>__PYX_ERR(0, 2512, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_2) {
/*  */
    goto __pyx_L8;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2513</span>:         if series_name is not None:</pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(2513,0,<span class='error_goto'>__PYX_ERR(0, 2513, __pyx_L1_error)</span>)
    __pyx_t_2 = (__pyx_v_series_name != Py_None);
    if (__pyx_t_2) {
/*  */
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2514</span>:             data.name = series_name</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2514,0,<span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L1_error)</span>)
      if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_data, __pyx_n_s_name, __pyx_v_series_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2515</span>:         if return_df:</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2515,0,<span class='error_goto'>__PYX_ERR(0, 2515, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_df); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2515, __pyx_L1_error)</span>
    if (__pyx_t_2) {
/*  */
      goto __pyx_L10;
    }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2516</span>:             data = pd.DataFrame(data)</pre>
<pre class='cython code score-20 '>      <span class='trace'>__Pyx_TraceLine</span>(2516,0,<span class='error_goto'>__PYX_ERR(0, 2516, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2516, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2516, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = NULL;
      __pyx_t_5 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_5 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_v_data};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2516, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2517</span>:         elif force_array_output:</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2517,0,<span class='error_goto'>__PYX_ERR(0, 2517, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_force_array_output); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2517, __pyx_L1_error)</span>
    if (__pyx_t_2) {
/*  */
    }
    __pyx_L10:;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2518</span>:             data = data.to_numpy()</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(2518,0,<span class='error_goto'>__PYX_ERR(0, 2518, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_to_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2518, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_6 = NULL;
      __pyx_t_5 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_5 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2518, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2519</span>:     elif isinstance(data, pd.DataFrame) and not return_df:</pre>
<pre class='cython code score-13 '>  <span class='trace'>__Pyx_TraceLine</span>(2519,0,<span class='error_goto'>__PYX_ERR(0, 2519, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2519, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 2519, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_7) {
  } else {
    __pyx_t_2 = __pyx_t_7;
    goto __pyx_L11_bool_binop_done;
  }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_df); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2519, __pyx_L1_error)</span>
  __pyx_t_8 = (!__pyx_t_7);
  __pyx_t_2 = __pyx_t_8;
  __pyx_L11_bool_binop_done:;
  if (__pyx_t_2) {
/*  */
  }
  __pyx_L8:;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2520</span>:         if allow_series_conversion and data.shape[1] == 1:</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2520,0,<span class='error_goto'>__PYX_ERR(0, 2520, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_allow_series_conversion); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2520, __pyx_L1_error)</span>
    if (__pyx_t_8) {
    } else {
      __pyx_t_2 = __pyx_t_8;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2520, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2520, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2520, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = __pyx_t_8;
    __pyx_L14_bool_binop_done:;
    if (__pyx_t_2) {
/*  */
    }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2521</span>:             data = data.squeeze()</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(2521,0,<span class='error_goto'>__PYX_ERR(0, 2521, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_squeeze);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2521, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_6 = NULL;
      __pyx_t_5 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_5 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2521, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2522</span>:             if series_name:</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2522,0,<span class='error_goto'>__PYX_ERR(0, 2522, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_series_name); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2522, __pyx_L1_error)</span>
      if (__pyx_t_2) {
/*  */
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2523</span>:                 data.name = series_name</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(2523,0,<span class='error_goto'>__PYX_ERR(0, 2523, __pyx_L1_error)</span>)
        if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_data, __pyx_n_s_name, __pyx_v_series_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2523, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2524</span>:         if force_array_output:</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2524,0,<span class='error_goto'>__PYX_ERR(0, 2524, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_force_array_output); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2524, __pyx_L1_error)</span>
    if (__pyx_t_2) {
/*  */
    }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2525</span>:             data = data.to_numpy()</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(2525,0,<span class='error_goto'>__PYX_ERR(0, 2525, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_to_numpy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2525, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_6 = NULL;
      __pyx_t_5 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_5 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2525, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2526</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2527</span>:     # Simplify output based on requested dimensions and content.</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2528</span>:     if condense: # and if force_array_outpout</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2528,0,<span class='error_goto'>__PYX_ERR(0, 2528, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_condense); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2528, __pyx_L1_error)</span>
  if (__pyx_t_2) {
/*  */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2529</span>:         # Use a single process to handle both DataFrame and Series to avoid repetition.</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2530</span>:         if isinstance(data, (pd.DataFrame, pd.Series)):</pre>
<pre class='cython code score-22 '>    <span class='trace'>__Pyx_TraceLine</span>(2530,0,<span class='error_goto'>__PYX_ERR(0, 2530, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2530, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2530, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2530, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2530, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_3); 
    if (!__pyx_t_8) {
    } else {
      __pyx_t_2 = __pyx_t_8;
      goto __pyx_L20_bool_binop_done;
    }
    __pyx_t_8 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_6); 
    __pyx_t_2 = __pyx_t_8;
    __pyx_L20_bool_binop_done:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_2) {
/*  */
      goto __pyx_L19;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2531</span>:             # Directly extract the scalar value if the data contains only one element.</pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2532</span>:             data = data.squeeze().item() if data.size == 1 else data.squeeze()</pre>
<pre class='cython code score-55 '>      <span class='trace'>__Pyx_TraceLine</span>(2532,0,<span class='error_goto'>__PYX_ERR(0, 2532, __pyx_L1_error)</span>)
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2532, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_6, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2532, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_2) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_squeeze);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2532, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_9 = NULL;
        __pyx_t_5 = 0;
        #if CYTHON_UNPACK_METHODS
        if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
          __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
          if (likely(__pyx_t_9)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
            __pyx_t_5 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_9, NULL};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2532, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        }
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_item);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2532, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = NULL;
        __pyx_t_5 = 0;
        #if CYTHON_UNPACK_METHODS
        if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
            __pyx_t_5 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2532, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        }
        __pyx_t_3 = __pyx_t_6;
        __pyx_t_6 = 0;
      } else {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_squeeze);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2532, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_4 = NULL;
        __pyx_t_5 = 0;
        #if CYTHON_UNPACK_METHODS
        if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
            __pyx_t_5 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2532, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        }
        __pyx_t_3 = __pyx_t_6;
        __pyx_t_6 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2533</span>:         elif isinstance(data, np.ndarray):</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(2533,0,<span class='error_goto'>__PYX_ERR(0, 2533, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2533, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2533, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((int)-1))) __PYX_ERR(0, 2533, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (__pyx_t_2) {
/*  */
    }
    __pyx_L19:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2534</span>:             # For numpy arrays, `.squeeze()` removes axes of length one,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2535</span>:             # which simplifies the data to a lower dimension while `.item()`</pre>
<pre class="cython line score-0">&#xA0;<span class="">2536</span>:             # converts a single-value array to a scalar.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2537</span>:             # Use `.squeeze()` first to handle both (n, 1) and (1, n) cases,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2538</span>:             # then `.item()` if the result is a single value.</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2539</span>:             data = data.squeeze()</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(2539,0,<span class='error_goto'>__PYX_ERR(0, 2539, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_squeeze);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2539, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = NULL;
      __pyx_t_5 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_5 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2539, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_6);
      __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2540</span>:             if data.size == 1:</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(2540,0,<span class='error_goto'>__PYX_ERR(0, 2540, __pyx_L1_error)</span>)
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2540, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_6, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2540, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (__pyx_t_2) {
/*  */
      }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2541</span>:                 data = data.item()  # Converts to a scalar</pre>
<pre class='cython code score-17 '>        <span class='trace'>__Pyx_TraceLine</span>(2541,0,<span class='error_goto'>__PYX_ERR(0, 2541, __pyx_L1_error)</span>)
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_item);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2541, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_1 = NULL;
        __pyx_t_5 = 0;
        #if CYTHON_UNPACK_METHODS
        if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
          __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
          if (likely(__pyx_t_1)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
            __pyx_t_5 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2541, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_6);
        __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2542</span>:     return data</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2542,0,<span class='error_goto'>__PYX_ERR(0, 2542, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  __pyx_r = __pyx_v_data;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2543</span>: </pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2544</span>: def cast_numeric(</pre>
<pre class='cython code score-44 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_89cast_numeric(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_88cast_numeric, "\n    Checks whether a given value is convertible to a numeric type (int or float).\n\n    Parameters\n    ----------\n    value : Any\n        The value to check for numeric convertibility.\n    error : str, optional\n        Specifies the error handling strategy. If 'raise', raises a ValueError\n        when `value` cannot be converted to a numeric type. If 'ignore', the function\n        returns False without raising an error. Default is 'ignore'.\n    on_success : Callable[[Union[int, float]], Any], optional\n        A callable that is executed with the converted numeric value if the conversion\n        is successful. The callable should accept a single numeric argument (int or float)\n        and return any value. If None, this step is skipped. Default is None.\n    on_failure : Callable[[Any], Any], optional\n        A callable that is executed if the conversion fails. The callable should\n        accept the original `value` as an argument and return any value. This allows\n        for custom handling or logging of failures. If None, this step is skipped.\n        Default is None.\n\n    Returns\n    -------\n    bool or Any\n        Returns True if the value is convertible to a numeric type, False otherwise.\n        If `on_success` is provided and the conversion is successful, returns\n        the result of `on_success` instead.\n\n    Raises\n    ------\n    ValueError\n        Raised if `error` is set to 'raise' and the value cannot be converted to\n        a numeric type.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.funcutils import cast_numeric\n    &gt;&gt;&gt; cast_numeric(\"100.5\")\n    True\n\n    &gt;&gt;&gt; cast_numeric(\"abc\", error='raise')\n    ValueError: Value 'abc' is not convertible to numeric.\n\n    &gt;&gt;&gt; cast_numeric(\"123\", on_success=lambda x: x*2)\n    246\n\n    &gt;&gt;&gt; cast_numeric(\"abc\", on_failure=lambda x: f\"Not convertible: {x}\")\n    'Not convertible: abc'\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_89cast_numeric = {"cast_numeric", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_89cast_numeric, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_88cast_numeric};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_89cast_numeric(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_value = 0;
  PyObject *__pyx_v_error = 0;
  PyObject *__pyx_v_on_success = 0;
  PyObject *__pyx_v_on_failure = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cast_numeric (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_value,&amp;__pyx_n_s_error,&amp;__pyx_n_s_on_success,&amp;__pyx_n_s_on_failure,0};
  PyObject* values[4] = {0,0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_ignore)));
/*  */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_88cast_numeric(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_value, PyObject *__pyx_v_error, PyObject *__pyx_v_on_success, PyObject *__pyx_v_on_failure) {
  PyObject *__pyx_v_converted_value = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__121)
  <span class='trace'>__Pyx_TraceCall</span>("cast_numeric", __pyx_f[0], 2544, 0, <span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.cast_numeric", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_converted_value);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__202 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_value, __pyx_n_s_error, __pyx_n_s_on_success, __pyx_n_s_on_failure, __pyx_n_s_converted_value);<span class='error_goto'> if (unlikely(!__pyx_tuple__202)) __PYX_ERR(0, 2544, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__202);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__202);
  __pyx_codeobj__121 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__202, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_cast_numeric, 2544, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__121)) __PYX_ERR(0, 2544, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2544,0,<span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_89cast_numeric, 0, __pyx_n_s_cast_numeric, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__121));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2544, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__203);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cast_numeric, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__203 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject*)__pyx_n_u_ignore), Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__203)) __PYX_ERR(0, 2544, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__203);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__203);
</pre><pre class="cython line score-0">&#xA0;<span class="">2545</span>:     value, error='ignore',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2546</span>:     on_success=None,</pre>
<pre class='cython code score-2 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2547</span>:     on_failure=None</pre>
<pre class='cython code score-64 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_value)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_error);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_success);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_on_failure);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "cast_numeric") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_value = values[0];
    __pyx_v_error = values[1];
    __pyx_v_on_success = values[2];
    __pyx_v_on_failure = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cast_numeric", 0, 1, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2544, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.cast_numeric", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_88cast_numeric(__pyx_self, __pyx_v_value, __pyx_v_error, __pyx_v_on_success, __pyx_v_on_failure);
</pre><pre class="cython line score-0">&#xA0;<span class="">2548</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2549</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2550</span>:     Checks whether a given value is convertible to a numeric type (int or float).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2551</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2552</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2553</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2554</span>:     value : Any</pre>
<pre class="cython line score-0">&#xA0;<span class="">2555</span>:         The value to check for numeric convertibility.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2556</span>:     error : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2557</span>:         Specifies the error handling strategy. If 'raise', raises a ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2558</span>:         when `value` cannot be converted to a numeric type. If 'ignore', the function</pre>
<pre class="cython line score-0">&#xA0;<span class="">2559</span>:         returns False without raising an error. Default is 'ignore'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2560</span>:     on_success : Callable[[Union[int, float]], Any], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2561</span>:         A callable that is executed with the converted numeric value if the conversion</pre>
<pre class="cython line score-0">&#xA0;<span class="">2562</span>:         is successful. The callable should accept a single numeric argument (int or float)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2563</span>:         and return any value. If None, this step is skipped. Default is None.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2564</span>:     on_failure : Callable[[Any], Any], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2565</span>:         A callable that is executed if the conversion fails. The callable should</pre>
<pre class="cython line score-0">&#xA0;<span class="">2566</span>:         accept the original `value` as an argument and return any value. This allows</pre>
<pre class="cython line score-0">&#xA0;<span class="">2567</span>:         for custom handling or logging of failures. If None, this step is skipped.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2568</span>:         Default is None.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2569</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2570</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2571</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2572</span>:     bool or Any</pre>
<pre class="cython line score-0">&#xA0;<span class="">2573</span>:         Returns True if the value is convertible to a numeric type, False otherwise.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2574</span>:         If `on_success` is provided and the conversion is successful, returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2575</span>:         the result of `on_success` instead.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2576</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2577</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">2578</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2579</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2580</span>:         Raised if `error` is set to 'raise' and the value cannot be converted to</pre>
<pre class="cython line score-0">&#xA0;<span class="">2581</span>:         a numeric type.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2582</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2583</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2584</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2585</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import cast_numeric</pre>
<pre class="cython line score-0">&#xA0;<span class="">2586</span>:     &gt;&gt;&gt; cast_numeric("100.5")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2587</span>:     True</pre>
<pre class="cython line score-0">&#xA0;<span class="">2588</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2589</span>:     &gt;&gt;&gt; cast_numeric("abc", error='raise')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2590</span>:     ValueError: Value 'abc' is not convertible to numeric.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2591</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2592</span>:     &gt;&gt;&gt; cast_numeric("123", on_success=lambda x: x*2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2593</span>:     246</pre>
<pre class="cython line score-0">&#xA0;<span class="">2594</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2595</span>:     &gt;&gt;&gt; cast_numeric("abc", on_failure=lambda x: f"Not convertible: {x}")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2596</span>:     'Not convertible: abc'</pre>
<pre class="cython line score-0">&#xA0;<span class="">2597</span>:     """</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2598</span>:     try:</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(2598,0,<span class='error_goto'>__PYX_ERR(0, 2598, __pyx_L1_error)</span>)
  {
    /*try:*/ {
/*  */
    }
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/*  */
    __pyx_L5_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L7_try_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L0;
    __pyx_L6_except_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2599</span>:         # First, try converting directly to an integer or float, without assuming it's a string</pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2600</span>:         if isinstance(value, (int, float, np.integer, np.floating)):</pre>
<pre class='cython code score-32 '>      <span class='trace'>__Pyx_TraceLine</span>(2600,0,<span class='error_goto'>__PYX_ERR(0, 2600, __pyx_L3_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2600, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_integer);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2600, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2600, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_floating);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2600, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_8 = <span class='py_c_api'>PyInt_Check</span>(__pyx_v_value); 
      if (!__pyx_t_8) {
      } else {
        __pyx_t_7 = __pyx_t_8;
        goto __pyx_L10_bool_binop_done;
      }
      __pyx_t_8 = <span class='py_c_api'>PyFloat_Check</span>(__pyx_v_value); 
      if (!__pyx_t_8) {
      } else {
        __pyx_t_7 = __pyx_t_8;
        goto __pyx_L10_bool_binop_done;
      }
      __pyx_t_8 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_value, __pyx_t_5); 
      if (!__pyx_t_8) {
      } else {
        __pyx_t_7 = __pyx_t_8;
        goto __pyx_L10_bool_binop_done;
      }
      __pyx_t_8 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_value, __pyx_t_6); 
      __pyx_t_7 = __pyx_t_8;
      __pyx_L10_bool_binop_done:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_7) {
/*  */
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2601</span>:             return True  # Already numeric, no conversion needed</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(2601,0,<span class='error_goto'>__PYX_ERR(0, 2601, __pyx_L3_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
        __pyx_r = Py_True;
        goto __pyx_L7_try_return;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2602</span>:         converted_value = float(value) if '.' in value or 'e' in value.lower() else int(value)</pre>
<pre class='cython code score-25 '>      <span class='trace'>__Pyx_TraceLine</span>(2602,0,<span class='error_goto'>__PYX_ERR(0, 2602, __pyx_L3_error)</span>)
      __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_kp_u__49, __pyx_v_value, Py_EQ)); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2602, __pyx_L3_error)</span>
      if (!__pyx_t_8) {
      } else {
        __pyx_t_7 = __pyx_t_8;
        goto __pyx_L14_bool_binop_done;
      }
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_value, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2602, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_9 = NULL;
      __pyx_t_10 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_9)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_10 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_9, NULL};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_10, 0+__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2602, __pyx_L3_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_u_e, __pyx_t_6, Py_EQ)); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2602, __pyx_L3_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_7 = __pyx_t_8;
      __pyx_L14_bool_binop_done:;
      if (__pyx_t_7) {
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyNumber_Float</span>(__pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2602, __pyx_L3_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_5 = __pyx_t_6;
        __pyx_t_6 = 0;
      } else {
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_value);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2602, __pyx_L3_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_5 = __pyx_t_6;
        __pyx_t_6 = 0;
      }
      __pyx_v_converted_value = __pyx_t_5;
      __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2603</span>:         if on_success:</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2603,0,<span class='error_goto'>__PYX_ERR(0, 2603, __pyx_L3_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_on_success); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2603, __pyx_L3_error)</span>
      if (__pyx_t_7) {
/*  */
      }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2604</span>:             return on_success(converted_value)</pre>
<pre class='cython code score-16 '>        <span class='trace'>__Pyx_TraceLine</span>(2604,0,<span class='error_goto'>__PYX_ERR(0, 2604, __pyx_L3_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_on_success);
        __pyx_t_6 = __pyx_v_on_success; __pyx_t_4 = NULL;
        __pyx_t_10 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
            __pyx_t_10 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_converted_value};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2604, __pyx_L3_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        }
        __pyx_r = __pyx_t_5;
        __pyx_t_5 = 0;
        goto __pyx_L7_try_return;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2605</span>:         return True</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2605,0,<span class='error_goto'>__PYX_ERR(0, 2605, __pyx_L3_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
      __pyx_r = Py_True;
      goto __pyx_L7_try_return;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2606</span>:     except (ValueError, TypeError):</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(2606,0,<span class='error_goto'>__PYX_ERR(0, 2606, __pyx_L5_except_error)</span>)
    __pyx_t_10 = __Pyx_PyErr_ExceptionMatches2(__pyx_builtin_ValueError, __pyx_builtin_TypeError);
    if (__pyx_t_10) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.cast_numeric", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_5, &amp;__pyx_t_6, &amp;__pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2606, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2607</span>:         if error == 'raise':</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2607,0,<span class='error_goto'>__PYX_ERR(0, 2607, __pyx_L5_except_error)</span>)
      __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_error, __pyx_n_u_raise, Py_EQ)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2607, __pyx_L5_except_error)</span>
      if (unlikely(__pyx_t_7)) {
/*  */
      }
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2608</span>:             raise ValueError(f"Value '{value}' is not convertible to numeric.")</pre>
<pre class='cython code score-27 '>        <span class='trace'>__Pyx_TraceLine</span>(2608,0,<span class='error_goto'>__PYX_ERR(0, 2608, __pyx_L5_except_error)</span>)
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2608, __pyx_L5_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_11 = 0;
        __pyx_t_12 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Value);
        __pyx_t_11 += 7;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Value);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_kp_u_Value);
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_value, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 2608, __pyx_L5_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_13) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_13) : __pyx_t_12;
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_13);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_13);
        __pyx_t_13 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_is_not_convertible_to_numeric);
        __pyx_t_11 += 32;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_is_not_convertible_to_numeric);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_kp_u_is_not_convertible_to_numeric);
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_9, 3, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 2608, __pyx_L5_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2608, __pyx_L5_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_9, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='error_goto'>__PYX_ERR(0, 2608, __pyx_L5_except_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2609</span>:         if on_failure:</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2609,0,<span class='error_goto'>__PYX_ERR(0, 2609, __pyx_L5_except_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_on_failure); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2609, __pyx_L5_except_error)</span>
      if (__pyx_t_7) {
/*  */
      }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2610</span>:             return on_failure(value)</pre>
<pre class='cython code score-19 '>        <span class='trace'>__Pyx_TraceLine</span>(2610,0,<span class='error_goto'>__PYX_ERR(0, 2610, __pyx_L5_except_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_on_failure);
        __pyx_t_13 = __pyx_v_on_failure; __pyx_t_14 = NULL;
        __pyx_t_10 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
          __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
          if (likely(__pyx_t_14)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
            __pyx_t_10 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_14, __pyx_v_value};
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_13, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 2610, __pyx_L5_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        }
        __pyx_r = __pyx_t_9;
        __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        goto __pyx_L6_except_return;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2611</span>:         return False</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(2611,0,<span class='error_goto'>__PYX_ERR(0, 2611, __pyx_L5_except_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
      __pyx_r = Py_False;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L6_except_return;
    }
    goto __pyx_L5_except_error;
</pre><pre class="cython line score-0">&#xA0;<span class="">2612</span>: </pre>
<pre class="cython line score-101" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2613</span>: def series_naming(name, data=None, error='ignore'):</pre>
<pre class='cython code score-101 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_91series_naming(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_90series_naming, "\n    Generates a condition function for renaming a pandas Series or single-column\n    DataFrame and optionally transforms and directly renames the provided data.\n\n    If `data` is provided, attempts to convert it to a pandas Series (if it's an\n    array-like structure) or rename it (if it's a single-column DataFrame) with\n    the specified name. If `data` is None, returns a condition function that can\n    be used to dynamically rename Series or single-column DataFrame based on\n    runtime evaluation.\n\n    Parameters\n    ----------\n    name : str\n        The new name to assign to the Series or single-column DataFrame.\n        This name is applied only if the current Series name or DataFrame \n        column name is numeric or not explicitly set.\n    data : array-like, pd.DataFrame, optional\n        The data to be converted to a Series or whose single column is to be\n        renamed. Supported types include list, tuple, np.ndarray, and pd.DataFrame.\n        If None, no direct conversion or renaming is performed.\n    error : str, {'ignore', 'raise'}, default 'ignore'\n        Error handling strategy. If 'raise', errors during data conversion or\n        renaming will raise an exception. If 'ignore', errors are suppressed.\n\n    Returns\n    -------\n    function or pd.Series or pd.DataFrame\n        If `data` is None, returns a lambda function that applies the new name\n        based on conditions. If `data` is provided, attempts the conversion or\n        renaming operation and returns the transformed data.\n\n    Examples\n    --------\n    &gt;&gt;&gt; import pandas as pd\n    &gt;&gt;&gt; from gofast.tools.funcutils import series_naming\n    \n    &gt;&gt;&gt; df = pd.DataFrame({'1': [1, 2, 3]})\n    &gt;&gt;&gt; condition = serie_naming('NewName')\n    &gt;&gt;&gt; result = condition(df)\n    &gt;&gt;&gt; print(result)\n    {'series_name': 'NewName'}\n\n    &gt;&gt;&gt; series = pd.Series([1, 2, 3], name='2')\n    &gt;&gt;&gt; condition = series_naming('SeriesName')\n    &gt;&gt;&gt; result = condition(series)\n    &gt;&gt;&gt; prin""t(result)\n    {'series_name': 'SeriesName'}\n\n    &gt;&gt;&gt; series = pd.Series([1, 2, 3], name='ExistingName')\n    &gt;&gt;&gt; condition = series_naming('NewSeriesName')\n    &gt;&gt;&gt; result = condition(series)\n    &gt;&gt;&gt; print(result)\n    {}\n    &gt;&gt;&gt; serie_naming('NewName', data=[1, 2, 3])\n    0    1\n    1    2\n    2    3\n    Name: NewName, dtype: int64\n\n    &gt;&gt;&gt; df = pd.DataFrame({'A': [1, 2, 3]})\n    &gt;&gt;&gt; series_naming('SingleCol', data=df)\n    0    1\n    1    2\n    2    3\n    Name: SingleCol, dtype: int64\n\n    &gt;&gt;&gt; condition = series_naming('DynamicName')\n    &gt;&gt;&gt; series = pd.Series([1, 2, 3], name='1')\n    &gt;&gt;&gt; condition(series)\n    {'series_name': 'DynamicName'}\n\n    Note\n    ----\n    This function supports both static and dynamic renaming of Series or DataFrame\n    columns. It facilitates maintaining consistent naming conventions across data\n    transformation workflows, especially when dealing with dynamically generated\n    or transformed data.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_91series_naming = {"series_naming", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_91series_naming, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_90series_naming};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_91series_naming(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_name = 0;
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_error = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("series_naming (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_name,&amp;__pyx_n_s_data,&amp;__pyx_n_s_error,0};
  PyObject* values[3] = {0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_ignore)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_name)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2613, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2613, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_error);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2613, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "series_naming") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2613, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_name = values[0];
    __pyx_v_data = values[1];
    __pyx_v_error = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("series_naming", 0, 1, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2613, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.series_naming", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_90series_naming(__pyx_self, __pyx_v_name, __pyx_v_data, __pyx_v_error);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_90series_naming(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_name, PyObject *__pyx_v_data, PyObject *__pyx_v_error) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_30_series_naming *__pyx_cur_scope;
  PyObject *__pyx_v_e = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__122)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_30_series_naming *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_30_series_naming(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_30_series_naming, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_30_series_naming *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 2613, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("series_naming", __pyx_f[0], 2613, 0, <span class='error_goto'>__PYX_ERR(0, 2613, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_name = __pyx_v_name;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_name);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_name);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.series_naming", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_e);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__204 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_name, __pyx_n_s_data, __pyx_n_s_error, __pyx_n_s_e);<span class='error_goto'> if (unlikely(!__pyx_tuple__204)) __PYX_ERR(0, 2613, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__204);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__204);
  __pyx_codeobj__122 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__204, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_series_naming, 2613, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__122)) __PYX_ERR(0, 2613, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2613,0,<span class='error_goto'>__PYX_ERR(0, 2613, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_91series_naming, 0, __pyx_n_s_series_naming, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__122));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2613, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__205);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_series_naming, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2613, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__205 = <span class='py_c_api'>PyTuple_Pack</span>(2, Py_None, ((PyObject*)__pyx_n_u_ignore));<span class='error_goto'> if (unlikely(!__pyx_tuple__205)) __PYX_ERR(0, 2613, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__205);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__205);
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_30_series_naming {
  PyObject_HEAD
  PyObject *__pyx_v_name;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">2614</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2615</span>:     Generates a condition function for renaming a pandas Series or single-column</pre>
<pre class="cython line score-0">&#xA0;<span class="">2616</span>:     DataFrame and optionally transforms and directly renames the provided data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2617</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2618</span>:     If `data` is provided, attempts to convert it to a pandas Series (if it's an</pre>
<pre class="cython line score-0">&#xA0;<span class="">2619</span>:     array-like structure) or rename it (if it's a single-column DataFrame) with</pre>
<pre class="cython line score-0">&#xA0;<span class="">2620</span>:     the specified name. If `data` is None, returns a condition function that can</pre>
<pre class="cython line score-0">&#xA0;<span class="">2621</span>:     be used to dynamically rename Series or single-column DataFrame based on</pre>
<pre class="cython line score-0">&#xA0;<span class="">2622</span>:     runtime evaluation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2623</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2624</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2625</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2626</span>:     name : str</pre>
<pre class="cython line score-0">&#xA0;<span class="">2627</span>:         The new name to assign to the Series or single-column DataFrame.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2628</span>:         This name is applied only if the current Series name or DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">2629</span>:         column name is numeric or not explicitly set.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2630</span>:     data : array-like, pd.DataFrame, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2631</span>:         The data to be converted to a Series or whose single column is to be</pre>
<pre class="cython line score-0">&#xA0;<span class="">2632</span>:         renamed. Supported types include list, tuple, np.ndarray, and pd.DataFrame.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2633</span>:         If None, no direct conversion or renaming is performed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2634</span>:     error : str, {'ignore', 'raise'}, default 'ignore'</pre>
<pre class="cython line score-0">&#xA0;<span class="">2635</span>:         Error handling strategy. If 'raise', errors during data conversion or</pre>
<pre class="cython line score-0">&#xA0;<span class="">2636</span>:         renaming will raise an exception. If 'ignore', errors are suppressed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2637</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2638</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2639</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2640</span>:     function or pd.Series or pd.DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">2641</span>:         If `data` is None, returns a lambda function that applies the new name</pre>
<pre class="cython line score-0">&#xA0;<span class="">2642</span>:         based on conditions. If `data` is provided, attempts the conversion or</pre>
<pre class="cython line score-0">&#xA0;<span class="">2643</span>:         renaming operation and returns the transformed data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2644</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2645</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2646</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2647</span>:     &gt;&gt;&gt; import pandas as pd</pre>
<pre class="cython line score-0">&#xA0;<span class="">2648</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import series_naming</pre>
<pre class="cython line score-0">&#xA0;<span class="">2649</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2650</span>:     &gt;&gt;&gt; df = pd.DataFrame({'1': [1, 2, 3]})</pre>
<pre class="cython line score-0">&#xA0;<span class="">2651</span>:     &gt;&gt;&gt; condition = serie_naming('NewName')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2652</span>:     &gt;&gt;&gt; result = condition(df)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2653</span>:     &gt;&gt;&gt; print(result)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2654</span>:     {'series_name': 'NewName'}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2655</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2656</span>:     &gt;&gt;&gt; series = pd.Series([1, 2, 3], name='2')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2657</span>:     &gt;&gt;&gt; condition = series_naming('SeriesName')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2658</span>:     &gt;&gt;&gt; result = condition(series)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2659</span>:     &gt;&gt;&gt; print(result)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2660</span>:     {'series_name': 'SeriesName'}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2661</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2662</span>:     &gt;&gt;&gt; series = pd.Series([1, 2, 3], name='ExistingName')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2663</span>:     &gt;&gt;&gt; condition = series_naming('NewSeriesName')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2664</span>:     &gt;&gt;&gt; result = condition(series)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2665</span>:     &gt;&gt;&gt; print(result)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2666</span>:     {}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2667</span>:     &gt;&gt;&gt; serie_naming('NewName', data=[1, 2, 3])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2668</span>:     0    1</pre>
<pre class="cython line score-0">&#xA0;<span class="">2669</span>:     1    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">2670</span>:     2    3</pre>
<pre class="cython line score-0">&#xA0;<span class="">2671</span>:     Name: NewName, dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">2672</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2673</span>:     &gt;&gt;&gt; df = pd.DataFrame({'A': [1, 2, 3]})</pre>
<pre class="cython line score-0">&#xA0;<span class="">2674</span>:     &gt;&gt;&gt; series_naming('SingleCol', data=df)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2675</span>:     0    1</pre>
<pre class="cython line score-0">&#xA0;<span class="">2676</span>:     1    2</pre>
<pre class="cython line score-0">&#xA0;<span class="">2677</span>:     2    3</pre>
<pre class="cython line score-0">&#xA0;<span class="">2678</span>:     Name: SingleCol, dtype: int64</pre>
<pre class="cython line score-0">&#xA0;<span class="">2679</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2680</span>:     &gt;&gt;&gt; condition = series_naming('DynamicName')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2681</span>:     &gt;&gt;&gt; series = pd.Series([1, 2, 3], name='1')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2682</span>:     &gt;&gt;&gt; condition(series)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2683</span>:     {'series_name': 'DynamicName'}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2684</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2685</span>:     Note</pre>
<pre class="cython line score-0">&#xA0;<span class="">2686</span>:     ----</pre>
<pre class="cython line score-0">&#xA0;<span class="">2687</span>:     This function supports both static and dynamic renaming of Series or DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">2688</span>:     columns. It facilitates maintaining consistent naming conventions across data</pre>
<pre class="cython line score-0">&#xA0;<span class="">2689</span>:     transformation workflows, especially when dealing with dynamically generated</pre>
<pre class="cython line score-0">&#xA0;<span class="">2690</span>:     or transformed data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2691</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2692</span>:     if data is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(2692,0,<span class='error_goto'>__PYX_ERR(0, 2692, __pyx_L1_error)</span>)
  __pyx_t_1 = (__pyx_v_data != Py_None);
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2693</span>:         try:</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(2693,0,<span class='error_goto'>__PYX_ERR(0, 2693, __pyx_L1_error)</span>)
    {
      /*try:*/ {
/*  */
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L9_try_end;
      __pyx_L4_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/*  */
      __pyx_L6_except_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);
      goto __pyx_L1_error;
      __pyx_L5_exception_handled:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);
      __pyx_L9_try_end:;
    }
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2694</span>:             if isinstance(data, (list, tuple, np.ndarray)):</pre>
<pre class='cython code score-21 '>        <span class='trace'>__Pyx_TraceLine</span>(2694,0,<span class='error_goto'>__PYX_ERR(0, 2694, __pyx_L4_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2694, __pyx_L4_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2694, __pyx_L4_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_7 = <span class='py_c_api'>PyList_Check</span>(__pyx_v_data); 
        if (!__pyx_t_7) {
        } else {
          __pyx_t_1 = __pyx_t_7;
          goto __pyx_L11_bool_binop_done;
        }
        __pyx_t_7 = <span class='py_c_api'>PyTuple_Check</span>(__pyx_v_data); 
        if (!__pyx_t_7) {
        } else {
          __pyx_t_1 = __pyx_t_7;
          goto __pyx_L11_bool_binop_done;
        }
        __pyx_t_7 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_6); 
        __pyx_t_1 = __pyx_t_7;
        __pyx_L11_bool_binop_done:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (__pyx_t_1) {
/*  */
          goto __pyx_L10;
        }
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2695</span>:                 data = pd.Series(data, name=name)</pre>
<pre class='cython code score-26 '>          <span class='trace'>__Pyx_TraceLine</span>(2695,0,<span class='error_goto'>__PYX_ERR(0, 2695, __pyx_L4_error)</span>)
          <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2695, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2695, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2695, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
          if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_data)) <span class='error_goto'>__PYX_ERR(0, 2695, __pyx_L4_error)</span>;
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2695, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_name, __pyx_cur_scope-&gt;__pyx_v_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2695, __pyx_L4_error)</span>
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2695, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_9);
          __pyx_t_9 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2696</span>:             elif isinstance(data, pd.DataFrame) and data.shape[1] == 1:</pre>
<pre class='cython code score-19 '>        <span class='trace'>__Pyx_TraceLine</span>(2696,0,<span class='error_goto'>__PYX_ERR(0, 2696, __pyx_L4_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2696, __pyx_L4_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2696, __pyx_L4_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_7 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_8);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 2696, __pyx_L4_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (__pyx_t_7) {
        } else {
          __pyx_t_1 = __pyx_t_7;
          goto __pyx_L14_bool_binop_done;
        }
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2696, __pyx_L4_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_8, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2696, __pyx_L4_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_9, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2696, __pyx_L4_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_1 = __pyx_t_7;
        __pyx_L14_bool_binop_done:;
        if (__pyx_t_1) {
/*  */
          goto __pyx_L10;
        }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2697</span>:                 data = data.iloc[:, 0].rename(name)</pre>
<pre class='cython code score-23 '>          <span class='trace'>__Pyx_TraceLine</span>(2697,0,<span class='error_goto'>__PYX_ERR(0, 2697, __pyx_L4_error)</span>)
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2697, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_8, __pyx_tuple__110);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2697, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_rename);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2697, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          __pyx_t_6 = NULL;
          __pyx_t_10 = 0;
          #if CYTHON_UNPACK_METHODS
          if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
            __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
            if (likely(__pyx_t_6)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
              __pyx_t_10 = 1;
            }
          }
          #endif
          {
            PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_cur_scope-&gt;__pyx_v_name};
            __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 2697, __pyx_L4_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_9);
          __pyx_t_9 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2698</span>:             elif error == 'raise':</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(2698,0,<span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L4_error)</span>)
        __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_error, __pyx_n_u_raise, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L4_error)</span>
        if (unlikely(__pyx_t_1)) {
/*  */
        }
        __pyx_L10:;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2699</span>:                 raise ValueError("Data must be convertible to a Series.")</pre>
<pre class='cython code score-10 '>          <span class='trace'>__Pyx_TraceLine</span>(2699,0,<span class='error_goto'>__PYX_ERR(0, 2699, __pyx_L4_error)</span>)
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__123, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2699, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_9, 0, 0, 0);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='error_goto'>__PYX_ERR(0, 2699, __pyx_L4_error)</span>
/*  */
  __pyx_tuple__123 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Data_must_be_convertible_to_a_Se);<span class='error_goto'> if (unlikely(!__pyx_tuple__123)) __PYX_ERR(0, 2699, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__123);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__123);
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2700</span>:         except Exception as e:</pre>
<pre class='cython code score-26 '>      <span class='trace'>__Pyx_TraceLine</span>(2700,0,<span class='error_goto'>__PYX_ERR(0, 2700, __pyx_L6_except_error)</span>)
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])));
      if (__pyx_t_10) {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.series_naming", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_9, &amp;__pyx_t_8, &amp;__pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2700, __pyx_L6_except_error)</span>
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        __pyx_v_e = __pyx_t_8;
        /*try:*/ {
/*  */
        <span class='trace'>__Pyx_TraceLine</span>(2700,0,<span class='error_goto'>__PYX_ERR(0, 2700, __pyx_L21_error)</span>)
        /*finally:*/ {
          /*normal exit:*/{
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
            goto __pyx_L22;
          }
          __pyx_L21_error:;
          /*exception exit:*/{
            __Pyx_PyThreadState_declare
            __Pyx_PyThreadState_assign
            __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0; __pyx_t_21 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            if (PY_MAJOR_VERSION &gt;= 3) <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_19, &amp;__pyx_t_20, &amp;__pyx_t_21);
            if ((PY_MAJOR_VERSION &lt; 3) || unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_16);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_17);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_18);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_19);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_20);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_21);
            __pyx_t_10 = __pyx_lineno; __pyx_t_14 = __pyx_clineno; __pyx_t_15 = __pyx_filename;
            {
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_e); __pyx_v_e = 0;
            }
            if (PY_MAJOR_VERSION &gt;= 3) {
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_19);
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_20);
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_21);
              <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_19, __pyx_t_20, __pyx_t_21);
            }
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_16);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_17);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_18);
            <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);
            __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0; __pyx_t_21 = 0;
            __pyx_lineno = __pyx_t_10; __pyx_clineno = __pyx_t_14; __pyx_filename = __pyx_t_15;
            goto __pyx_L6_except_error;
          }
          __pyx_L22:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        goto __pyx_L5_exception_handled;
      }
      goto __pyx_L6_except_error;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2701</span>:             if error == 'raise':</pre>
<pre class='cython code score-2 '>          <span class='trace'>__Pyx_TraceLine</span>(2701,0,<span class='error_goto'>__PYX_ERR(0, 2701, __pyx_L21_error)</span>)
          __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_error, __pyx_n_u_raise, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2701, __pyx_L21_error)</span>
          if (unlikely(__pyx_t_1)) {
/*  */
          }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2702</span>:                 raise e</pre>
<pre class='cython code score-2 '>            <span class='trace'>__Pyx_TraceLine</span>(2702,0,<span class='error_goto'>__PYX_ERR(0, 2702, __pyx_L21_error)</span>)
            <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_v_e, 0, 0, 0);
            <span class='error_goto'>__PYX_ERR(0, 2702, __pyx_L21_error)</span>
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2703</span>:             warnings.warn(f"Warning: {e}")</pre>
<pre class='cython code score-26 '>          <span class='trace'>__Pyx_TraceLine</span>(2703,0,<span class='error_goto'>__PYX_ERR(0, 2703, __pyx_L21_error)</span>)
          <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2703, __pyx_L21_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2703, __pyx_L21_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_e, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2703, __pyx_L21_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_Warning, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 2703, __pyx_L21_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          __pyx_t_11 = NULL;
          __pyx_t_10 = 0;
          #if CYTHON_UNPACK_METHODS
          if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
            __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
            if (likely(__pyx_t_11)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
              __pyx_t_10 = 1;
            }
          }
          #endif
          {
            PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_13};
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_12, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
            if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2703, __pyx_L21_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2704</span>:         return data</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2704,0,<span class='error_goto'>__PYX_ERR(0, 2704, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
    __pyx_r = __pyx_v_data;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2705</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2706</span>:     # Return a condition function for dynamic renaming if data is not directly provided</pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2707</span>:     return lambda s: {"series_name": name} if (</pre>
<pre class='cython code score-55 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_13series_naming_lambda2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_13series_naming_lambda2 = {"lambda2", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_13series_naming_lambda2, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_13series_naming_lambda2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_s = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda2 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_s,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2707, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "lambda2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2707, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_s = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lambda2", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2707, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.series_naming.lambda2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_lambda_funcdef_lambda2(__pyx_self, __pyx_v_s);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda2(PyObject *__pyx_self, PyObject *__pyx_v_s) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_30_series_naming *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_30_series_naming *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_30_series_naming *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("lambda2", __pyx_f[0], 2707, 0, <span class='error_goto'>__PYX_ERR(0, 2707, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(2707,0,<span class='error_goto'>__PYX_ERR(0, 2707, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2707, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_name)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("name"); <span class='error_goto'>__PYX_ERR(0, 2707, __pyx_L1_error)</span> }
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_u_series_name, __pyx_cur_scope-&gt;__pyx_v_name) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2707, __pyx_L1_error)</span>
    __pyx_t_1 = __pyx_t_6;
    __pyx_t_6 = 0;
  } else {
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.series_naming.lambda2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2707,0,<span class='error_goto'>__PYX_ERR(0, 2707, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_13series_naming_lambda2, 0, __pyx_n_s_series_naming_locals_lambda, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2707, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2708</span>:         isinstance(s, pd.Series) and (cast_numeric(s.name, error='ignore') or s.name is None) or</pre>
<pre class='cython code score-40 '>  <span class='trace'>__Pyx_TraceLine</span>(2708,0,<span class='error_goto'>__PYX_ERR(0, 2708, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_s, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 2708, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!__pyx_t_5) {
    goto __pyx_L4_next_or;
  } else {
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_cast_numeric);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_s, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2708, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_error, __pyx_n_u_ignore) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2708, __pyx_L1_error)</span>
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2708, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (!__pyx_t_5) {
  } else {
    __pyx_t_2 = __pyx_t_5;
    goto __pyx_L3_bool_binop_done;
  }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_s, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2708, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = (__pyx_t_7 == Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (!__pyx_t_5) {
  } else {
    __pyx_t_2 = __pyx_t_5;
    goto __pyx_L3_bool_binop_done;
  }
  __pyx_L4_next_or:;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2709</span>:         isinstance(s, pd.DataFrame) and len(s.columns) == 1 and (</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(2709,0,<span class='error_goto'>__PYX_ERR(0, 2709, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2709, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2709, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_s, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 2709, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {
  } else {
    __pyx_t_2 = __pyx_t_5;
    goto __pyx_L3_bool_binop_done;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_s, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2709, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2709, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = (__pyx_t_8 == 1);
  if (__pyx_t_5) {
  } else {
    __pyx_t_2 = __pyx_t_5;
    goto __pyx_L3_bool_binop_done;
  }
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2710</span>:             cast_numeric(s.columns[0], error='ignore') or s.columns[0] is None)</pre>
<pre class='cython code score-35 '>  <span class='trace'>__Pyx_TraceLine</span>(2710,0,<span class='error_goto'>__PYX_ERR(0, 2710, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_cast_numeric);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_s, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2710, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_error, __pyx_n_u_ignore) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2710, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_7, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2710, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!__pyx_t_5) {
  } else {
    __pyx_t_2 = __pyx_t_5;
    goto __pyx_L3_bool_binop_done;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_s, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = (__pyx_t_6 == Py_None);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_2 = __pyx_t_5;
  __pyx_L3_bool_binop_done:;
  if (__pyx_t_2) {
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2711</span>:     ) else {}</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2711,0,<span class='error_goto'>__PYX_ERR(0, 2711, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2711, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = __pyx_t_6;
    __pyx_t_6 = 0;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2712</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2713</span>: </pre>
<pre class="cython line score-83" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2714</span>: def validate_years(</pre>
<pre class='cython code score-83 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_93validate_years(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_92validate_years, "\n    Validate the years provided to a function or use as a decorator.\n    \n    This function checks if the `start_year` and `end_year` are valid integer \n    years and whether `start_year` is before `end_year`. Optionally, it \n    validates if the years are within a reasonable range defined by the \n    `range_validator`. The function can be used as a decorator to enforce \n    this validation on function arguments named `start_year` and `end_year`, \n    or as a standalone function that validates and returns the years.\n    \n    Parameters\n    ----------\n    start_year : int, str, or None, optional\n        The starting year as an integer, a string representing a year, or \n        the name of the  parameter representing the starting year in the \n        decorated function. If `None`, it will be treated as a decorator, \n        and the parameter will be dynamically determined.\n        \n    end_year : int, str, or None, optional\n        The ending year as an integer, a string representing a year, or the \n        name of the parameter representing the ending year in the decorated \n        function. If `None`, it will be treated as a decorator, and the \n        parameter will be dynamically determined.\n        \n    check_range : bool, default=True\n        If `True`, enables the range check of the years using the \n        `range_validator`. If `False`, this check is bypassed.\n        \n    range_validator : Callable[[int], bool], optional\n        A function that accepts an integer year and returns `True` if the year \n        is within an acceptable range. If not provided, the default validator \n        checks if the year is between 1900 and the current year.\n        \n    Returns\n    -------\n    Callable or tuple\n        If used as a decorator, it returns the wrapped function. If used as \n        a standalone function, it returns a tuple of validated \n        `(start_year, end_year)` as integers.\n        \n    Raises\n    ------\n    Valu""eError\n        If the years cannot be parsed as integers, `start_year` is not less \n        than `end_year`, or the years are not within the valid range as \n        determined by `range_validator`.\n        \n    Examples\n    --------\n    As a decorator, using parameter names of the decorated function:\n    \n    &gt;&gt;&gt; @validate_years(start_year='start', end_year='end')\n    ... def some_function(start: int, end: int):\n    ...     return f\"Range: {start} to {end}\"\n    \n    Using a custom `range_validator` to enforce that years must be in the\n    21st century:\n\n    &gt;&gt;&gt; def is_21st_century(year: int) -&gt; bool:\n    ...     return 2000 &lt;= year &lt;= 2100\n    &gt;&gt;&gt; start, end = validate_years('2001', '2020', range_validator=is_21st_century)\n    &gt;&gt;&gt; print(f\"Validated range: {start} to {end}\")\n    Validated range: 2001 to 2020\n    \n    As a standalone function:\n    \n    &gt;&gt;&gt; start, end = validate_years('2001', '2020')\n    &gt;&gt;&gt; print(f\"Validated range: {start} to {end}\")\n    Validated range: 2001 to 2020\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_93validate_years = {"validate_years", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_93validate_years, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_92validate_years};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_93validate_years(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_start_year = 0;
  PyObject *__pyx_v_end_year = 0;
  PyObject *__pyx_v_check_range = 0;
  PyObject *__pyx_v_range_validator = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("validate_years (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_year,&amp;__pyx_n_s_end_year,&amp;__pyx_n_s_check_range,&amp;__pyx_n_s_range_validator,0};
  PyObject* values[4] = {0,0,0,0};
/*  */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_92validate_years(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_year, PyObject *__pyx_v_end_year, PyObject *__pyx_v_check_range, PyObject *__pyx_v_range_validator) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_31_validate_years *__pyx_cur_scope;
  PyObject *__pyx_v_decorator = 0;
  PyObject *__pyx_v_sy = NULL;
  PyObject *__pyx_v_ey = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__126)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_31_validate_years *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_31_validate_years(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_31_validate_years, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_31_validate_years *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("validate_years", __pyx_f[0], 2714, 0, <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_start_year = __pyx_v_start_year;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_start_year);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_start_year);
  __pyx_cur_scope-&gt;__pyx_v_end_year = __pyx_v_end_year;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_end_year);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_end_year);
  __pyx_cur_scope-&gt;__pyx_v_check_range = __pyx_v_check_range;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_check_range);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_check_range);
  __pyx_cur_scope-&gt;__pyx_v_range_validator = __pyx_v_range_validator;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_range_validator);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_range_validator);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.validate_years", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_decorator);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ey);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__206 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_start_year, __pyx_n_s_end_year, __pyx_n_s_check_range, __pyx_n_s_range_validator, __pyx_n_s_decorator, __pyx_n_s_decorator, __pyx_n_s_sy, __pyx_n_s_ey);<span class='error_goto'> if (unlikely(!__pyx_tuple__206)) __PYX_ERR(0, 2714, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__206);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__206);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2714,0,<span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2714, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_check_range, ((PyObject *)Py_True)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2714,0,<span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2714, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_start_year, __pyx_kp_s_Optional_Union_int_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_end_year, __pyx_kp_s_Optional_Union_int_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_check_range, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_range_validator, __pyx_kp_s_Optional_Callable_int_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return, __pyx_kp_s_Union_Callable_tuple) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_93validate_years, 0, __pyx_n_s_validate_years, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__126));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2714, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__165);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_validate_years, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__126 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 2, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__206, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_validate_years, 2714, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__126)) __PYX_ERR(0, 2714, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_31_validate_years {
  PyObject_HEAD
  PyObject *__pyx_v_check_range;
  PyObject *__pyx_v_end_year;
  PyObject *__pyx_v_range_validator;
  PyObject *__pyx_v_start_year;
};

</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2715</span>:     start_year: Optional[Union[int, str]] = None,</pre>
<pre class='cython code score-2 '>    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2716</span>:     end_year: Optional[Union[int, str]] = None, *,</pre>
<pre class='cython code score-2 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2717</span>:     check_range: bool = True,</pre>
<pre class='cython code score-2 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2718</span>:     range_validator: Optional[Callable[[int], bool]] = None</pre>
<pre class='cython code score-52 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_start_year);
          if (value) { values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_end_year);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 2)) {
        Py_ssize_t index;
        for (index = 2; index &lt; 4 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "validate_years") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_start_year = values[0];
    __pyx_v_end_year = values[1];
    __pyx_v_check_range = values[2];
    __pyx_v_range_validator = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("validate_years", 0, 0, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.validate_years", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_92validate_years(__pyx_self, __pyx_v_start_year, __pyx_v_end_year, __pyx_v_check_range, __pyx_v_range_validator);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2718,0,<span class='error_goto'>__PYX_ERR(0, 2718, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_range_validator, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2714, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2719</span>: ) -&gt; Union[Callable, tuple]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2720</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2721</span>:     Validate the years provided to a function or use as a decorator.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2722</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2723</span>:     This function checks if the `start_year` and `end_year` are valid integer</pre>
<pre class="cython line score-0">&#xA0;<span class="">2724</span>:     years and whether `start_year` is before `end_year`. Optionally, it</pre>
<pre class="cython line score-0">&#xA0;<span class="">2725</span>:     validates if the years are within a reasonable range defined by the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2726</span>:     `range_validator`. The function can be used as a decorator to enforce</pre>
<pre class="cython line score-0">&#xA0;<span class="">2727</span>:     this validation on function arguments named `start_year` and `end_year`,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2728</span>:     or as a standalone function that validates and returns the years.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2729</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2730</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2731</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2732</span>:     start_year : int, str, or None, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2733</span>:         The starting year as an integer, a string representing a year, or</pre>
<pre class="cython line score-0">&#xA0;<span class="">2734</span>:         the name of the  parameter representing the starting year in the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2735</span>:         decorated function. If `None`, it will be treated as a decorator,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2736</span>:         and the parameter will be dynamically determined.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2737</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2738</span>:     end_year : int, str, or None, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2739</span>:         The ending year as an integer, a string representing a year, or the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2740</span>:         name of the parameter representing the ending year in the decorated</pre>
<pre class="cython line score-0">&#xA0;<span class="">2741</span>:         function. If `None`, it will be treated as a decorator, and the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2742</span>:         parameter will be dynamically determined.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2743</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2744</span>:     check_range : bool, default=True</pre>
<pre class="cython line score-0">&#xA0;<span class="">2745</span>:         If `True`, enables the range check of the years using the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2746</span>:         `range_validator`. If `False`, this check is bypassed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2747</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2748</span>:     range_validator : Callable[[int], bool], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2749</span>:         A function that accepts an integer year and returns `True` if the year</pre>
<pre class="cython line score-0">&#xA0;<span class="">2750</span>:         is within an acceptable range. If not provided, the default validator</pre>
<pre class="cython line score-0">&#xA0;<span class="">2751</span>:         checks if the year is between 1900 and the current year.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2752</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2753</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2754</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2755</span>:     Callable or tuple</pre>
<pre class="cython line score-0">&#xA0;<span class="">2756</span>:         If used as a decorator, it returns the wrapped function. If used as</pre>
<pre class="cython line score-0">&#xA0;<span class="">2757</span>:         a standalone function, it returns a tuple of validated</pre>
<pre class="cython line score-0">&#xA0;<span class="">2758</span>:         `(start_year, end_year)` as integers.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2759</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2760</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">2761</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2762</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2763</span>:         If the years cannot be parsed as integers, `start_year` is not less</pre>
<pre class="cython line score-0">&#xA0;<span class="">2764</span>:         than `end_year`, or the years are not within the valid range as</pre>
<pre class="cython line score-0">&#xA0;<span class="">2765</span>:         determined by `range_validator`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2766</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2767</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2768</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2769</span>:     As a decorator, using parameter names of the decorated function:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2770</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2771</span>:     &gt;&gt;&gt; @validate_years(start_year='start', end_year='end')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2772</span>:     ... def some_function(start: int, end: int):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2773</span>:     ...     return f"Range: {start} to {end}"</pre>
<pre class="cython line score-0">&#xA0;<span class="">2774</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2775</span>:     Using a custom `range_validator` to enforce that years must be in the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2776</span>:     21st century:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2777</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2778</span>:     &gt;&gt;&gt; def is_21st_century(year: int) -&gt; bool:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2779</span>:     ...     return 2000 &lt;= year &lt;= 2100</pre>
<pre class="cython line score-0">&#xA0;<span class="">2780</span>:     &gt;&gt;&gt; start, end = validate_years('2001', '2020', range_validator=is_21st_century)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2781</span>:     &gt;&gt;&gt; print(f"Validated range: {start} to {end}")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2782</span>:     Validated range: 2001 to 2020</pre>
<pre class="cython line score-0">&#xA0;<span class="">2783</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2784</span>:     As a standalone function:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2785</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2786</span>:     &gt;&gt;&gt; start, end = validate_years('2001', '2020')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2787</span>:     &gt;&gt;&gt; print(f"Validated range: {start} to {end}")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2788</span>:     Validated range: 2001 to 2020</pre>
<pre class="cython line score-0">&#xA0;<span class="">2789</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2790</span>:     if range_validator is None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(2790,0,<span class='error_goto'>__PYX_ERR(0, 2790, __pyx_L1_error)</span>)
  __pyx_t_1 = (__pyx_cur_scope-&gt;__pyx_v_range_validator == Py_None);
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-120" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2791</span>:         range_validator = lambda x: (1900 &lt;= x &lt;= datetime.now().year, (1900, datetime.now().year))</pre>
<pre class='cython code score-120 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_14validate_years_2lambda3(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_14validate_years_2lambda3 = {"lambda3", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_14validate_years_2lambda3, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_14validate_years_2lambda3(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda3 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2791, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "lambda3") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2791, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_x = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lambda3", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2791, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.validate_years.lambda3", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_lambda_funcdef_lambda3(__pyx_self, __pyx_v_x);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda3(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("lambda3", __pyx_f[0], 2791, 0, <span class='error_goto'>__PYX_ERR(0, 2791, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_int_1900, __pyx_v_x, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
  if (<span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1)) {
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_datetime);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_now);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2791, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_year);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_x, __pyx_t_4, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_datetime);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_now);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_year);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1900);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1900);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_int_1900)) <span class='error_goto'>__PYX_ERR(0, 2791, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2791, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2791, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2791, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.validate_years.lambda3", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
    <span class='trace'>__Pyx_TraceLine</span>(2791,0,<span class='error_goto'>__PYX_ERR(0, 2791, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_14validate_years_2lambda3, 0, __pyx_n_s_validate_years_locals_lambda, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2791, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_range_validator);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_range_validator, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2792</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2793</span>:     # Decorator function</pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2794</span>:     def decorator(func: Callable) -&gt; Callable:</pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_14validate_years_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_14validate_years_1decorator = {"decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_14validate_years_1decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_14validate_years_1decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("decorator", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.validate_years.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_14validate_years_decorator(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_14validate_years_decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_32_decorator *__pyx_cur_scope;
  PyObject *__pyx_v_wrapper = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_32_decorator *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_32_decorator(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_32_decorator, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_32_decorator *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_31_validate_years *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("decorator", __pyx_f[0], 2794, 0, <span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.validate_years.decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_wrapper);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2794,0,<span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_14validate_years_1decorator, 0, __pyx_n_s_validate_years_locals_decorator_2, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__127));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_decorator = __pyx_t_3;
  __pyx_t_3 = 0;
/*  */
  __pyx_codeobj__127 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__41, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_decorator, 2794, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__127)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_32_decorator {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_31_validate_years *__pyx_outer_scope;
  PyObject *__pyx_v_func;
};

</pre><pre class="cython line score-72" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2795</span>:         @functools.wraps(func)</pre>
<pre class='cython code score-72 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_14validate_years_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_14validate_years_9decorator_1wrapper = {"wrapper", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_14validate_years_9decorator_1wrapper, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_14validate_years_9decorator_1wrapper(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("wrapper (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "wrapper", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_14validate_years_9decorator_wrapper(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_14validate_years_9decorator_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_32_decorator *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_32_decorator *__pyx_outer_scope;
  PyObject *__pyx_v_sy = NULL;
  PyObject *__pyx_v_ey = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_32_decorator *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("wrapper", __pyx_f[0], 2795, 0, <span class='error_goto'>__PYX_ERR(0, 2795, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.validate_years.decorator.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ey);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2795,0,<span class='error_goto'>__PYX_ERR(0, 2795, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2795, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2795, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2795, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
/*  */
  __pyx_tuple__124 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_sy, __pyx_n_s_ey);<span class='error_goto'> if (unlikely(!__pyx_tuple__124)) __PYX_ERR(0, 2795, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__124);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__124);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_14validate_years_9decorator_1wrapper, 0, __pyx_n_s_validate_years_locals_decorator, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__125));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2795, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2795, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_wrapper = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__125 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__124, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_wrapper, 2795, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__125)) __PYX_ERR(0, 2795, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2796</span>:         def wrapper(*args, **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2797</span>:             nonlocal start_year, end_year</pre>
<pre class="cython line score-0">&#xA0;<span class="">2798</span>:             # If start_year and end_year are string, try getting the value from args or kwargs</pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2799</span>:             if isinstance(start_year, str) or isinstance(end_year, str):</pre>
<pre class='cython code score-18 '>  <span class='trace'>__Pyx_TraceLine</span>(2799,0,<span class='error_goto'>__PYX_ERR(0, 2799, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_start_year)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("start_year"); <span class='error_goto'>__PYX_ERR(0, 2799, __pyx_L1_error)</span> }
  __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_start_year;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_t_2); 
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!__pyx_t_3) {
  } else {
    __pyx_t_1 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_end_year)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("end_year"); <span class='error_goto'>__PYX_ERR(0, 2799, __pyx_L1_error)</span> }
  __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_end_year;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_t_2); 
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_1 = __pyx_t_3;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/*  */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2800</span>:                 sy = _get_param_value(start_year, args, kwargs, func)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(2800,0,<span class='error_goto'>__PYX_ERR(0, 2800, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_get_param_value);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2800, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_start_year)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("start_year"); <span class='error_goto'>__PYX_ERR(0, 2800, __pyx_L1_error)</span> }
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 2800, __pyx_L1_error)</span> }
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[5] = {__pyx_t_5, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_start_year, __pyx_v_args, __pyx_v_kwargs, __pyx_cur_scope-&gt;__pyx_v_func};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 4+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2800, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_v_sy = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2801</span>:                 ey = _get_param_value(end_year, args, kwargs, func)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(2801,0,<span class='error_goto'>__PYX_ERR(0, 2801, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_get_param_value);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2801, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_end_year)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("end_year"); <span class='error_goto'>__PYX_ERR(0, 2801, __pyx_L1_error)</span> }
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 2801, __pyx_L1_error)</span> }
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[5] = {__pyx_t_5, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_end_year, __pyx_v_args, __pyx_v_kwargs, __pyx_cur_scope-&gt;__pyx_v_func};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 4+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2801, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_v_ey = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2802</span>:             else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2803</span>:                 # Otherwise, parse them directly</pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2804</span>:                 sy = _parse_year(start_year, 'start_year')</pre>
<pre class='cython code score-18 '>  <span class='trace'>__Pyx_TraceLine</span>(2804,0,<span class='error_goto'>__PYX_ERR(0, 2804, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_parse_year);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2804, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_start_year)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("start_year"); <span class='error_goto'>__PYX_ERR(0, 2804, __pyx_L1_error)</span> }
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_start_year, __pyx_n_u_start_year};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2804, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_v_sy = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2805</span>:                 ey = _parse_year(end_year, 'end_year')</pre>
<pre class='cython code score-18 '>    <span class='trace'>__Pyx_TraceLine</span>(2805,0,<span class='error_goto'>__PYX_ERR(0, 2805, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_parse_year);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2805, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_end_year)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("end_year"); <span class='error_goto'>__PYX_ERR(0, 2805, __pyx_L1_error)</span> }
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_end_year, __pyx_n_u_end_year};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2805, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_v_ey = __pyx_t_2;
    __pyx_t_2 = 0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2806</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2807</span>:             # Validation logic remains unchanged</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2808</span>:             _check_year_order(sy, ey)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(2808,0,<span class='error_goto'>__PYX_ERR(0, 2808, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_check_year_order);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2808, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_v_sy, __pyx_v_ey};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2808, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2809</span>:             if check_range:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(2809,0,<span class='error_goto'>__PYX_ERR(0, 2809, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_check_range)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("check_range"); <span class='error_goto'>__PYX_ERR(0, 2809, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_check_range); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2809, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2810</span>:                 _check_year_range(sy, range_validator)</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(2810,0,<span class='error_goto'>__PYX_ERR(0, 2810, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_check_year_range);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2810, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_range_validator)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("range_validator"); <span class='error_goto'>__PYX_ERR(0, 2810, __pyx_L1_error)</span> }
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_v_sy, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_range_validator};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2810, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2811</span>:                 _check_year_range(ey, range_validator)</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(2811,0,<span class='error_goto'>__PYX_ERR(0, 2811, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_check_year_range);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2811, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_range_validator)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("range_validator"); <span class='error_goto'>__PYX_ERR(0, 2811, __pyx_L1_error)</span> }
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_v_ey, __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_range_validator};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2811, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2812</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2813</span>:             return func(*args, **kwargs)</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(2813,0,<span class='error_goto'>__PYX_ERR(0, 2813, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 2813, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2813, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2813, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2814</span>:         return wrapper</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2814,0,<span class='error_goto'>__PYX_ERR(0, 2814, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wrapper);
  __pyx_r = __pyx_v_wrapper;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2815</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2816</span>:     # Improved condition to determine function usage based on argument types</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2817</span>:     if ((isinstance(start_year, (int, str)) or start_year is None) and</pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(2817,0,<span class='error_goto'>__PYX_ERR(0, 2817, __pyx_L1_error)</span>)
  __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_start_year;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyInt_Check</span>(__pyx_t_3); 
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L8_bool_binop_done;
  }
  __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_start_year;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_t_3); 
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __pyx_t_5;
  __pyx_L8_bool_binop_done:;
  if (!__pyx_t_4) {
  } else {
    goto __pyx_L6_next_and;
  }
  __pyx_t_4 = (__pyx_cur_scope-&gt;__pyx_v_start_year == Py_None);
  if (__pyx_t_4) {
  } else {
    __pyx_t_1 = __pyx_t_4;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_L6_next_and:;
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2817,0,<span class='error_goto'>__PYX_ERR(0, 2817, __pyx_L1_error)</span>)
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2818</span>:         (isinstance(end_year, (int, str)) or end_year is None)):</pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(2818,0,<span class='error_goto'>__PYX_ERR(0, 2818, __pyx_L1_error)</span>)
  __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_end_year;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyInt_Check</span>(__pyx_t_3); 
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L11_bool_binop_done;
  }
  __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_end_year;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_t_3); 
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __pyx_t_5;
  __pyx_L11_bool_binop_done:;
  if (!__pyx_t_4) {
  } else {
    __pyx_t_1 = __pyx_t_4;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_4 = (__pyx_cur_scope-&gt;__pyx_v_end_year == Py_None);
  __pyx_t_1 = __pyx_t_4;
  __pyx_L5_bool_binop_done:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2819</span>:         # Direct function usage, assuming start_year and end_year are not both callables</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2820</span>:         if not callable(start_year) and not callable(end_year):</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(2820,0,<span class='error_goto'>__PYX_ERR(0, 2820, __pyx_L1_error)</span>)
    __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_start_year;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 2820, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = (!__pyx_t_4);
    if (__pyx_t_5) {
    } else {
      __pyx_t_1 = __pyx_t_5;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_end_year;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 2820, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4 = (!__pyx_t_5);
    __pyx_t_1 = __pyx_t_4;
    __pyx_L14_bool_binop_done:;
    if (__pyx_t_1) {
/*  */
    }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2821</span>:             sy = _parse_year(start_year, 'start_year') if start_year is not None else None</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(2821,0,<span class='error_goto'>__PYX_ERR(0, 2821, __pyx_L1_error)</span>)
      __pyx_t_1 = (__pyx_cur_scope-&gt;__pyx_v_start_year != Py_None);
      if (__pyx_t_1) {
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_parse_year);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2821, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_7 = NULL;
        __pyx_t_8 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
          __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
          if (likely(__pyx_t_7)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
            __pyx_t_8 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[3] = {__pyx_t_7, __pyx_cur_scope-&gt;__pyx_v_start_year, __pyx_n_u_start_year};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2821, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        }
        __pyx_t_3 = __pyx_t_2;
        __pyx_t_2 = 0;
      } else {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_t_3 = Py_None;
      }
      __pyx_v_sy = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2822</span>:             ey = _parse_year(end_year, 'end_year') if end_year is not None else None</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(2822,0,<span class='error_goto'>__PYX_ERR(0, 2822, __pyx_L1_error)</span>)
      __pyx_t_1 = (__pyx_cur_scope-&gt;__pyx_v_end_year != Py_None);
      if (__pyx_t_1) {
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_parse_year);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2822, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_7 = NULL;
        __pyx_t_8 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
          __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
          if (likely(__pyx_t_7)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
            __pyx_t_8 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[3] = {__pyx_t_7, __pyx_cur_scope-&gt;__pyx_v_end_year, __pyx_n_u_end_year};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2822, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        }
        __pyx_t_3 = __pyx_t_2;
        __pyx_t_2 = 0;
      } else {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_t_3 = Py_None;
      }
      __pyx_v_ey = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2823</span>:             if sy is not None and ey is not None:</pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(2823,0,<span class='error_goto'>__PYX_ERR(0, 2823, __pyx_L1_error)</span>)
      __pyx_t_4 = (__pyx_v_sy != Py_None);
      if (__pyx_t_4) {
      } else {
        __pyx_t_1 = __pyx_t_4;
        goto __pyx_L17_bool_binop_done;
      }
      __pyx_t_4 = (__pyx_v_ey != Py_None);
      __pyx_t_1 = __pyx_t_4;
      __pyx_L17_bool_binop_done:;
      if (__pyx_t_1) {
/*  */
      }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2824</span>:                 _check_year_order(sy, ey)</pre>
<pre class='cython code score-17 '>        <span class='trace'>__Pyx_TraceLine</span>(2824,0,<span class='error_goto'>__PYX_ERR(0, 2824, __pyx_L1_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_check_year_order);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2824, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_6 = NULL;
        __pyx_t_8 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
          __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
          if (likely(__pyx_t_6)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
            __pyx_t_8 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[3] = {__pyx_t_6, __pyx_v_sy, __pyx_v_ey};
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2824, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2825</span>:                 if check_range:</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(2825,0,<span class='error_goto'>__PYX_ERR(0, 2825, __pyx_L1_error)</span>)
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_check_range); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2825, __pyx_L1_error)</span>
        if (__pyx_t_1) {
/*  */
        }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2826</span>:                     _check_year_range(sy, range_validator)</pre>
<pre class='cython code score-17 '>          <span class='trace'>__Pyx_TraceLine</span>(2826,0,<span class='error_goto'>__PYX_ERR(0, 2826, __pyx_L1_error)</span>)
          <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_check_year_range);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2826, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_6 = NULL;
          __pyx_t_8 = 0;
          #if CYTHON_UNPACK_METHODS
          if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
            __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
            if (likely(__pyx_t_6)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
              __pyx_t_8 = 1;
            }
          }
          #endif
          {
            PyObject *__pyx_callargs[3] = {__pyx_t_6, __pyx_v_sy, __pyx_cur_scope-&gt;__pyx_v_range_validator};
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2826, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2827</span>:                     _check_year_range(ey, range_validator)</pre>
<pre class='cython code score-17 '>          <span class='trace'>__Pyx_TraceLine</span>(2827,0,<span class='error_goto'>__PYX_ERR(0, 2827, __pyx_L1_error)</span>)
          <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_check_year_range);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_6 = NULL;
          __pyx_t_8 = 0;
          #if CYTHON_UNPACK_METHODS
          if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
            __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
            if (likely(__pyx_t_6)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
              __pyx_t_8 = 1;
            }
          }
          #endif
          {
            PyObject *__pyx_callargs[3] = {__pyx_t_6, __pyx_v_ey, __pyx_cur_scope-&gt;__pyx_v_range_validator};
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2827, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2828</span>:                 return sy, ey</pre>
<pre class='cython code score-12 '>        <span class='trace'>__Pyx_TraceLine</span>(2828,0,<span class='error_goto'>__PYX_ERR(0, 2828, __pyx_L1_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2828, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sy);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sy);
        if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_sy)) <span class='error_goto'>__PYX_ERR(0, 2828, __pyx_L1_error)</span>;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ey);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ey);
        if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_ey)) <span class='error_goto'>__PYX_ERR(0, 2828, __pyx_L1_error)</span>;
        __pyx_r = __pyx_t_3;
        __pyx_t_3 = 0;
        goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2829</span>:         return decorator</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2829,0,<span class='error_goto'>__PYX_ERR(0, 2829, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorator);
    __pyx_r = __pyx_v_decorator;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2830</span>:     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2831</span>:         # Otherwise, assume decorator usage with function to decorate</pre>
<pre class="cython line score-0">&#xA0;<span class="">2832</span>:         # being passed later</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2833</span>:         return decorator</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2833,0,<span class='error_goto'>__PYX_ERR(0, 2833, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorator);
    __pyx_r = __pyx_v_decorator;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2834</span>: </pre>
<pre class="cython line score-93" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2835</span>: def _parse_year(year: Union[int, str], name: str) -&gt; int:</pre>
<pre class='cython code score-93 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_95_parse_year(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_94_parse_year, "\n    Parse the year from a string or integer to an integer.\n    \n    Parameters\n    ----------\n    year : int or str\n        The year to parse.\n    name : str\n        The name of the parameter (start_year or end_year) for error messaging.\n        \n    Returns\n    -------\n    int\n        The parsed year as an integer.\n    \n    Raises\n    ------\n    ValueError\n        If the year cannot be converted to an integer.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_95_parse_year = {"_parse_year", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_95_parse_year, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_94_parse_year};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_95_parse_year(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_year = 0;
  PyObject *__pyx_v_name = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_parse_year (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_year,&amp;__pyx_n_s_name,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_year)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_name)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_parse_year", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_parse_year") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_year = values[0];
    __pyx_v_name = ((PyObject*)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_parse_year", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._parse_year", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_name), (&amp;PyUnicode_Type), 0, "name", 1))) <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_94_parse_year(__pyx_self, __pyx_v_year, __pyx_v_name);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_94_parse_year(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_year, PyObject *__pyx_v_name) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__128)
  <span class='trace'>__Pyx_TraceCall</span>("_parse_year", __pyx_f[0], 2835, 0, <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._parse_year", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__207 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_year, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_tuple__207)) __PYX_ERR(0, 2835, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__207);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__207);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2835,0,<span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2835, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_year, __pyx_kp_s_Union_int_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_name, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_95_parse_year, 0, __pyx_n_s_parse_year, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__128));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2835, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_parse_year, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2835, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__128 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__207, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_parse_year, 2835, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__128)) __PYX_ERR(0, 2835, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2836</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2837</span>:     Parse the year from a string or integer to an integer.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2838</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2839</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2840</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2841</span>:     year : int or str</pre>
<pre class="cython line score-0">&#xA0;<span class="">2842</span>:         The year to parse.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2843</span>:     name : str</pre>
<pre class="cython line score-0">&#xA0;<span class="">2844</span>:         The name of the parameter (start_year or end_year) for error messaging.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2845</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2846</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2847</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2848</span>:     int</pre>
<pre class="cython line score-0">&#xA0;<span class="">2849</span>:         The parsed year as an integer.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2850</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2851</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">2852</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2853</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2854</span>:         If the year cannot be converted to an integer.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2855</span>:     """</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2856</span>:     try:</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2856,0,<span class='error_goto'>__PYX_ERR(0, 2856, __pyx_L1_error)</span>)
  {
    /*try:*/ {
/*  */
    }
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/*  */
    __pyx_L5_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L7_try_return:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L0;
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2857</span>:         return int(year)</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(2857,0,<span class='error_goto'>__PYX_ERR(0, 2857, __pyx_L3_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_year);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2857, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_t_4)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_t_4))) <span class='error_goto'>__PYX_ERR(0, 2857, __pyx_L3_error)</span>
      __pyx_r = ((PyObject*)__pyx_t_4);
      __pyx_t_4 = 0;
      goto __pyx_L7_try_return;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2858</span>:     except ValueError:</pre>
<pre class='cython code score-6 '>    <span class='trace'>__Pyx_TraceLine</span>(2858,0,<span class='error_goto'>__PYX_ERR(0, 2858, __pyx_L5_except_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(__pyx_builtin_ValueError);
    if (__pyx_t_5) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._parse_year", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_4, &amp;__pyx_t_6, &amp;__pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2858, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2859</span>:         raise ValueError(f"'{name}' must be convertible to an integer.")</pre>
<pre class='cython code score-26 '>      <span class='trace'>__Pyx_TraceLine</span>(2859,0,<span class='error_goto'>__PYX_ERR(0, 2859, __pyx_L5_except_error)</span>)
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2859, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = 0;
      __pyx_t_10 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__37);
      __pyx_t_9 += 1;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__37);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_kp_u__37);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_name);
      __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_v_name) &gt; __pyx_t_10) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_v_name) : __pyx_t_10;
      __pyx_t_9 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_v_name);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_name);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_name);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_must_be_convertible_to_an_integ);
      __pyx_t_9 += 36;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_must_be_convertible_to_an_integ);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_kp_u_must_be_convertible_to_an_integ);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_8, 3, __pyx_t_9, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2859, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2859, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='error_goto'>__PYX_ERR(0, 2859, __pyx_L5_except_error)</span>
    }
    goto __pyx_L5_except_error;
</pre><pre class="cython line score-0">&#xA0;<span class="">2860</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2861</span>: </pre>
<pre class="cython line score-93" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2862</span>: def _check_year_order(start_year: int, end_year: int) -&gt; None:</pre>
<pre class='cython code score-93 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_97_check_year_order(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_96_check_year_order, "\n    Check if start_year is less than end_year.\n    \n    Parameters\n    ----------\n    start_year : int\n        The starting year.\n    end_year : int\n        The ending year.\n    \n    Raises\n    ------\n    ValueError\n        If start_year is not less than end_year.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_97_check_year_order = {"_check_year_order", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_97_check_year_order, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_96_check_year_order};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_97_check_year_order(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_start_year = 0;
  PyObject *__pyx_v_end_year = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_check_year_order (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start_year,&amp;__pyx_n_s_end_year,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_start_year)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_end_year)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_check_year_order", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_check_year_order") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_start_year = ((PyObject*)values[0]);
    __pyx_v_end_year = ((PyObject*)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_check_year_order", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_year_order", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_start_year), (&amp;PyInt_Type), 0, "start_year", 1))) <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_end_year), (&amp;PyInt_Type), 0, "end_year", 1))) <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_96_check_year_order(__pyx_self, __pyx_v_start_year, __pyx_v_end_year);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_96_check_year_order(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_start_year, PyObject *__pyx_v_end_year) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__129)
  <span class='trace'>__Pyx_TraceCall</span>("_check_year_order", __pyx_f[0], 2862, 0, <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_year_order", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__208 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_start_year, __pyx_n_s_end_year);<span class='error_goto'> if (unlikely(!__pyx_tuple__208)) __PYX_ERR(0, 2862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__208);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__208);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2862,0,<span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_start_year, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_end_year, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_97_check_year_order, 0, __pyx_n_s_check_year_order, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__129));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_year_order, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2862, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__129 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__208, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_check_year_order, 2862, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__129)) __PYX_ERR(0, 2862, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2863</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2864</span>:     Check if start_year is less than end_year.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2865</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2866</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2867</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2868</span>:     start_year : int</pre>
<pre class="cython line score-0">&#xA0;<span class="">2869</span>:         The starting year.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2870</span>:     end_year : int</pre>
<pre class="cython line score-0">&#xA0;<span class="">2871</span>:         The ending year.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2872</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2873</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">2874</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2875</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2876</span>:         If start_year is not less than end_year.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2877</span>:     """</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2878</span>:     if start_year &gt;= end_year:</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(2878,0,<span class='error_goto'>__PYX_ERR(0, 2878, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_start_year, __pyx_v_end_year, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2878, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2878, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(__pyx_t_2)) {
/*  */
  }
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2879</span>:         raise ValueError(f"{start_year} must be less than {end_year}.")</pre>
<pre class='cython code score-36 '>    <span class='trace'>__Pyx_TraceLine</span>(2879,0,<span class='error_goto'>__PYX_ERR(0, 2879, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2879, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = 0;
    __pyx_t_4 = 127;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_start_year, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2879, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_4;
    __pyx_t_3 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_must_be_less_than);
    __pyx_t_3 += 19;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_must_be_less_than);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_kp_u_must_be_less_than);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_end_year, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2879, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_4;
    __pyx_t_3 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__49);
    __pyx_t_3 += 1;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__49);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_kp_u__49);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 4, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2879, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2879, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2879, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2880</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2881</span>: </pre>
<pre class="cython line score-96" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2882</span>: def _check_year_range(</pre>
<pre class='cython code score-96 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_99_check_year_range(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_98_check_year_range, "\n    Validates if a given year is within an acceptable range as determined by\n    the range_validator. The range_validator function can return either a \n    boolean indicating the validity of the year, or a tuple comprising a \n    boolean and another tuple detailing the valid range (start, end).\n\n    Parameters\n    ----------\n    year : int\n        The year to be validated.\n    range_validator : Callable[[int], Union[bool, Tuple[bool, Tuple[int, int]]]]\n        A function that returns either a boolean indicating if the year is valid,\n        or a tuple containing a boolean and the valid range. If the year is\n        not valid and a range is provided, a ValueError will be raised including\n        the valid range in its message.\n\n    Raises\n    ------\n    ValueError\n        If the year is not within the valid range. The exception message will\n        include the valid range if it is provided by the range_validator.\n\n    Examples\n    --------\n    Using a range_validator that returns a boolean:\n    \n    &gt;&gt;&gt; from gofast.tools.funcutils import _check_year_range\n    &gt;&gt;&gt; def simple_validator(year: int) -&gt; bool:\n    ...     return 2000 &lt;= year &lt;= 2100\n    &gt;&gt;&gt; try:\n    ...     _check_year_range(1999, simple_validator)\n    ... except ValueError as e:\n    ...     print(e)\n    The year 1999 is out of the valid range.\n\n    Using a range_validator that returns a tuple with the valid range:\n    \n    &gt;&gt;&gt; def detailed_validator(year: int) -&gt; Tuple[bool, Tuple[int, int]]:\n    ...     return 2000 &lt;= year &lt;= 2100, (2000, 2100)\n    &gt;&gt;&gt; try:\n    ...     _check_year_range(1999, detailed_validator)\n    ... except ValueError as e:\n    ...     print(e)\n    The year 1999 is out of the valid range. Valid range is 2000 to 2100.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_99_check_year_range = {"_check_year_range", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_99_check_year_range, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_98_check_year_range};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_99_check_year_range(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_year = 0;
  PyObject *__pyx_v_range_validator = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_check_year_range (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_year,&amp;__pyx_n_s_range_validator,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_year)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2882, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_range_validator)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2882, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_check_year_range", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 2882, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_check_year_range") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2882, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_year = ((PyObject*)values[0]);
    __pyx_v_range_validator = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_check_year_range", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2882, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_year_range", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_year), (&amp;PyInt_Type), 0, "year", 1))) <span class='error_goto'>__PYX_ERR(0, 2883, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_98_check_year_range(__pyx_self, __pyx_v_year, __pyx_v_range_validator);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_98_check_year_range(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_year, PyObject *__pyx_v_range_validator) {
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_is_valid = NULL;
  PyObject *__pyx_v_valid_range = NULL;
  PyObject *__pyx_v_error_message = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__130)
  <span class='trace'>__Pyx_TraceCall</span>("_check_year_range", __pyx_f[0], 2882, 0, <span class='error_goto'>__PYX_ERR(0, 2882, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._check_year_range", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_is_valid);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_valid_range);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_error_message);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__209 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_year, __pyx_n_s_range_validator, __pyx_n_s_result, __pyx_n_s_is_valid, __pyx_n_s_valid_range, __pyx_n_s_error_message);<span class='error_goto'> if (unlikely(!__pyx_tuple__209)) __PYX_ERR(0, 2882, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__209);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__209);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2882,0,<span class='error_goto'>__PYX_ERR(0, 2882, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2882, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_year, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2882, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_range_validator, __pyx_kp_s_Callable_int_Union_bool_Tuple_bo) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2882, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_n_s_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2882, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_99_check_year_range, 0, __pyx_n_s_check_year_range, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__130));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2882, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_year_range, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2882, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_codeobj__130 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__209, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_check_year_range, 2882, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__130)) __PYX_ERR(0, 2882, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2883</span>:         year: int,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2884</span>:         range_validator: Callable[[int], Union[bool, Tuple[bool, Tuple[int, int]]]]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2885</span>:         ) -&gt; None:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2886</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2887</span>:     Validates if a given year is within an acceptable range as determined by</pre>
<pre class="cython line score-0">&#xA0;<span class="">2888</span>:     the range_validator. The range_validator function can return either a</pre>
<pre class="cython line score-0">&#xA0;<span class="">2889</span>:     boolean indicating the validity of the year, or a tuple comprising a</pre>
<pre class="cython line score-0">&#xA0;<span class="">2890</span>:     boolean and another tuple detailing the valid range (start, end).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2891</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2892</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2893</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2894</span>:     year : int</pre>
<pre class="cython line score-0">&#xA0;<span class="">2895</span>:         The year to be validated.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2896</span>:     range_validator : Callable[[int], Union[bool, Tuple[bool, Tuple[int, int]]]]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2897</span>:         A function that returns either a boolean indicating if the year is valid,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2898</span>:         or a tuple containing a boolean and the valid range. If the year is</pre>
<pre class="cython line score-0">&#xA0;<span class="">2899</span>:         not valid and a range is provided, a ValueError will be raised including</pre>
<pre class="cython line score-0">&#xA0;<span class="">2900</span>:         the valid range in its message.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2901</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2902</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">2903</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2904</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2905</span>:         If the year is not within the valid range. The exception message will</pre>
<pre class="cython line score-0">&#xA0;<span class="">2906</span>:         include the valid range if it is provided by the range_validator.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2907</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2908</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2909</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2910</span>:     Using a range_validator that returns a boolean:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2911</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2912</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import _check_year_range</pre>
<pre class="cython line score-0">&#xA0;<span class="">2913</span>:     &gt;&gt;&gt; def simple_validator(year: int) -&gt; bool:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2914</span>:     ...     return 2000 &lt;= year &lt;= 2100</pre>
<pre class="cython line score-0">&#xA0;<span class="">2915</span>:     &gt;&gt;&gt; try:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2916</span>:     ...     _check_year_range(1999, simple_validator)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2917</span>:     ... except ValueError as e:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2918</span>:     ...     print(e)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2919</span>:     The year 1999 is out of the valid range.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2920</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2921</span>:     Using a range_validator that returns a tuple with the valid range:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2922</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2923</span>:     &gt;&gt;&gt; def detailed_validator(year: int) -&gt; Tuple[bool, Tuple[int, int]]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2924</span>:     ...     return 2000 &lt;= year &lt;= 2100, (2000, 2100)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2925</span>:     &gt;&gt;&gt; try:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2926</span>:     ...     _check_year_range(1999, detailed_validator)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2927</span>:     ... except ValueError as e:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2928</span>:     ...     print(e)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2929</span>:     The year 1999 is out of the valid range. Valid range is 2000 to 2100.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2930</span>:     """</pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2931</span>:     result = range_validator(year)</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(2931,0,<span class='error_goto'>__PYX_ERR(0, 2931, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_range_validator);
  __pyx_t_2 = __pyx_v_range_validator; __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_year};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2931, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_result = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2932</span>:     is_valid = result if isinstance(result, bool) else result[0]</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(2932,0,<span class='error_goto'>__PYX_ERR(0, 2932, __pyx_L1_error)</span>)
  __pyx_t_2 = ((PyObject*)&amp;PyBool_Type);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_result, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 2932, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
    __pyx_t_1 = __pyx_v_result;
  } else {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_result, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2932, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = __pyx_t_2;
    __pyx_t_2 = 0;
  }
  __pyx_v_is_valid = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2933</span>:     valid_range = None if isinstance(result, bool) else result[1]</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(2933,0,<span class='error_goto'>__PYX_ERR(0, 2933, __pyx_L1_error)</span>)
  __pyx_t_2 = ((PyObject*)&amp;PyBool_Type);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_result, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 2933, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    __pyx_t_1 = Py_None;
  } else {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_result, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2933, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = __pyx_t_2;
    __pyx_t_2 = 0;
  }
  __pyx_v_valid_range = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2934</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2935</span>:     if not is_valid:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2935,0,<span class='error_goto'>__PYX_ERR(0, 2935, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_is_valid); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2935, __pyx_L1_error)</span>
  __pyx_t_6 = (!__pyx_t_5);
  if (__pyx_t_6) {
/*  */
  }
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2936</span>:         error_message = f"The year {year} is out of the valid range."</pre>
<pre class='cython code score-21 '>    <span class='trace'>__Pyx_TraceLine</span>(2936,0,<span class='error_goto'>__PYX_ERR(0, 2936, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2936, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = 0;
    __pyx_t_8 = 127;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_The_year);
    __pyx_t_7 += 9;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_The_year);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_The_year);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_year, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2936, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) &gt; __pyx_t_8) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) : __pyx_t_8;
    __pyx_t_7 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_is_out_of_the_valid_range);
    __pyx_t_7 += 27;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_is_out_of_the_valid_range);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_is_out_of_the_valid_range);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 3, __pyx_t_7, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2936, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_error_message = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2937</span>:         if valid_range:</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2937,0,<span class='error_goto'>__PYX_ERR(0, 2937, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_valid_range); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2937, __pyx_L1_error)</span>
    if (__pyx_t_6) {
/*  */
    }
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2938</span>:             error_message += f" Valid range is {valid_range[0]} to {valid_range[1]}."</pre>
<pre class='cython code score-42 '>      <span class='trace'>__Pyx_TraceLine</span>(2938,0,<span class='error_goto'>__PYX_ERR(0, 2938, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2938, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = 0;
      __pyx_t_8 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Valid_range_is);
      __pyx_t_7 += 16;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Valid_range_is);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_Valid_range_is);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_valid_range, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2938, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2938, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_8) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_8;
      __pyx_t_7 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_to);
      __pyx_t_7 += 4;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_to);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_to);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_valid_range, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2938, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_3, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2938, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_8) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_8;
      __pyx_t_7 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_t_1);
      __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__49);
      __pyx_t_7 += 1;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__49);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4, __pyx_kp_u__49);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 5, __pyx_t_7, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2938, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_v_error_message, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2938, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_error_message, ((PyObject*)__pyx_t_2));
      __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2939</span>:         raise ValueError(error_message)</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2939,0,<span class='error_goto'>__PYX_ERR(0, 2939, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_v_error_message);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2939, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2939, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2940</span>: </pre>
<pre class="cython line score-115" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2941</span>: def _get_param_value(param_name: Union[int, str], args, kwargs, func) -&gt; int:</pre>
<pre class='cython code score-115 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_101_get_param_value(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_100_get_param_value, "\n    Get the value of a parameter by name from args or kwargs of a function.\n    \n    Parameters\n    ----------\n    param_name : int, str\n        The name of the parameter to retrieve the value for, or its actual value.\n    args : tuple\n        The positional arguments passed to the function.\n    kwargs : dict\n        The keyword arguments passed to the function.\n    func : Callable\n        The function from which to retrieve the parameter value.\n    \n    Returns\n    -------\n    int\n        The value of the parameter as an integer.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_101_get_param_value = {"_get_param_value", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_101_get_param_value, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_100_get_param_value};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_101_get_param_value(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_param_name = 0;
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_get_param_value (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_param_name,&amp;__pyx_n_s_args,&amp;__pyx_n_s_kwargs,&amp;__pyx_n_s_func,0};
  PyObject* values[4] = {0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_param_name)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_args)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_get_param_value", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_kwargs)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_get_param_value", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_get_param_value", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_get_param_value") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
      values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
    }
    __pyx_v_param_name = values[0];
    __pyx_v_args = values[1];
    __pyx_v_kwargs = values[2];
    __pyx_v_func = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_get_param_value", 1, 4, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._get_param_value", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_100_get_param_value(__pyx_self, __pyx_v_param_name, __pyx_v_args, __pyx_v_kwargs, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_100_get_param_value(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_param_name, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs, PyObject *__pyx_v_func) {
  PyObject *__pyx_v_param_index = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__131)
  <span class='trace'>__Pyx_TraceCall</span>("_get_param_value", __pyx_f[0], 2941, 0, <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils._get_param_value", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_param_index);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__210 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_param_name, __pyx_n_s_args, __pyx_n_s_kwargs, __pyx_n_s_func, __pyx_n_s_param_index);<span class='error_goto'> if (unlikely(!__pyx_tuple__210)) __PYX_ERR(0, 2941, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__210);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__210);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2941,0,<span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2941, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_param_name, __pyx_kp_s_Union_int_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_return, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_101_get_param_value, 0, __pyx_n_s_get_param_value, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__131));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2941, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_param_value, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__131 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__210, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_get_param_value, 2941, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__131)) __PYX_ERR(0, 2941, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2942</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2943</span>:     Get the value of a parameter by name from args or kwargs of a function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2944</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2945</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2946</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2947</span>:     param_name : int, str</pre>
<pre class="cython line score-0">&#xA0;<span class="">2948</span>:         The name of the parameter to retrieve the value for, or its actual value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2949</span>:     args : tuple</pre>
<pre class="cython line score-0">&#xA0;<span class="">2950</span>:         The positional arguments passed to the function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2951</span>:     kwargs : dict</pre>
<pre class="cython line score-0">&#xA0;<span class="">2952</span>:         The keyword arguments passed to the function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2953</span>:     func : Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">2954</span>:         The function from which to retrieve the parameter value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2955</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2956</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2957</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2958</span>:     int</pre>
<pre class="cython line score-0">&#xA0;<span class="">2959</span>:         The value of the parameter as an integer.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2960</span>:     """</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2961</span>:     if isinstance(param_name, int):</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2961,0,<span class='error_goto'>__PYX_ERR(0, 2961, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyInt_Check</span>(__pyx_v_param_name); 
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2962</span>:         return param_name</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(2962,0,<span class='error_goto'>__PYX_ERR(0, 2962, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_v_param_name))||((__pyx_v_param_name) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_v_param_name))) <span class='error_goto'>__PYX_ERR(0, 2962, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_param_name);
    __pyx_r = ((PyObject*)__pyx_v_param_name);
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2963</span>:     elif param_name in kwargs:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2963,0,<span class='error_goto'>__PYX_ERR(0, 2963, __pyx_L1_error)</span>)
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_param_name, __pyx_v_kwargs, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2963, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2964</span>:         return kwargs[param_name]</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2964,0,<span class='error_goto'>__PYX_ERR(0, 2964, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_kwargs, __pyx_v_param_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2964, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_t_2))||((__pyx_t_2) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 2964, __pyx_L1_error)</span>
    __pyx_r = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2965</span>:     else:</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2966</span>:         param_index = func.__code__.co_varnames.index(param_name)</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(2966,0,<span class='error_goto'>__PYX_ERR(0, 2966, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_func, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2966, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_co_varnames);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2966, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2966, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_param_name};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2966, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_v_param_index = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2967</span>:         if param_index &lt; len(args):</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(2967,0,<span class='error_goto'>__PYX_ERR(0, 2967, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_args);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2967, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2967, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_param_index, __pyx_t_2, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2967, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2967, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (likely(__pyx_t_1)) {
/*  */
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2968</span>:             return args[param_index]</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(2968,0,<span class='error_goto'>__PYX_ERR(0, 2968, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_args, __pyx_v_param_index);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2968, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 2968, __pyx_L1_error)</span>
      __pyx_r = ((PyObject*)__pyx_t_3);
      __pyx_t_3 = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2969</span>:         else:</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2970</span>:             raise ValueError(f"The parameter {param_name} was not provided to the function.")</pre>
<pre class='cython code score-27 '>    <span class='trace'>__Pyx_TraceLine</span>(2970,0,<span class='error_goto'>__PYX_ERR(0, 2970, __pyx_L1_error)</span>)
    /*else*/ {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2970, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_6 = 0;
      __pyx_t_7 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_The_parameter);
      __pyx_t_6 += 14;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_The_parameter);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_kp_u_The_parameter);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_param_name, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2970, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) &gt; __pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) : __pyx_t_7;
      __pyx_t_6 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_was_not_provided_to_the_functio);
      __pyx_t_6 += 34;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_was_not_provided_to_the_functio);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_kp_u_was_not_provided_to_the_functio);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 3, __pyx_t_6, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2970, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2970, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 2970, __pyx_L1_error)</span>
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">2971</span>: </pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2972</span>: def context_checker(</pre>
<pre class='cython code score-63 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_103context_checker(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_9funcutils_102context_checker, "\n    A versatile decorator to introspect and modify the behavior of functions\n    based on their context of usage. It can determine whether a function is\n    being used as a decorator for another function or called directly. This\n    decorator also supports executing with custom or default logic.\n    \n    Parameters\n    ----------\n    return_context_as_bool : bool, optional\n        If True, the decorator returns a boolean value indicating the context\n        instead of modifying or executing the target function. ``True`` means \n        the function is used as a decorator, and ``False`` indicates it is called\n        directly. Defaults to ``False``.\n    \n    custom_logic : Optional[Callable[[Callable], Callable]], optional\n        A function that defines custom logic to apply to the decorated function.\n        If provided, this logic supersedes the default decoration logic.\n        If ``None``, default logic is applied.\n        \n    verbose : bool, optional\n        If ``True``, prints messages indicating the detected usage context. \n        Useful for debugging purposes. Defaults to ``False``.\n        \n    Returns\n    -------\n    Callable\n        Depending on `return_context_as_bool`, the function either returns a\n        boolean indicating the usage context or modifies the target function\n        based on the specified logic (`custom_logic` or default).\n\n    Examples\n    --------\n    Direct call returning context as boolean:\n    \n    &gt;&gt;&gt; import functools \n    &gt;&gt;&gt; from gofast.tools.funcutils import context_checker\n    &gt;&gt;&gt; @context_checker(return_context_as_bool=True)\n    ... def my_function():\n    ...     pass\n    &gt;&gt;&gt; print(my_function())\n    Detected direct call or dual-use scenario.\n    True\n    \n    Used as a decorator with custom logic, printing before and after:\n    \n    &gt;&gt;&gt; def custom_logic(func):\n    ...     @functools.wraps(func)\n    ...     def wrapper(*args, **kwargs):\n    ...         print(\"Before function c""all\")\n    ...         result = func(*args, **kwargs)\n    ...         print(\"After function call\")\n    ...         return result\n    ...     return wrapper\n    &gt;&gt;&gt; @context_checker(custom_logic=custom_logic)\n    ... def another_function():\n    ...     print(\"Function logic here.\")\n    &gt;&gt;&gt; another_function()\n    Detected dual-use or direct call scenario.\n    Before function call\n    Function logic here.\n    After function call\n    \n    Using as a dual-use decorator without providing function (useful for\n    decorators that can operate without arguments):\n    \n    &gt;&gt;&gt; @context_checker(verbose=True)\n    ... def dual_use_decorator(func=None):\n    ...     if func is not None:\n    ...         return context_checker(func)\n    ...     def inner_decorator(f):\n    ...         @functools.wraps(f)\n    ...         def wrapper(*args, **kwargs):\n    ...             print(\"Dual-use logic applied.\")\n    ...             return f(*args, **kwargs)\n    ...         return wrapper\n    ...     return inner_decorator\n    &gt;&gt;&gt; @dual_use_decorator()\n    ... def decorated_function():\n    ...     print(\"Decorated function executed.\")\n    &gt;&gt;&gt; decorated_function()\n    Detected dual-use or direct call scenario.\n    Dual-use logic applied.\n    Decorated function executed.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_103context_checker = {"context_checker", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_103context_checker, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_9funcutils_102context_checker};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_103context_checker(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_return_context_as_bool = 0;
  PyObject *__pyx_v_custom_logic = 0;
  PyObject *__pyx_v_verbose = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("context_checker (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_return_context_as_bool,&amp;__pyx_n_s_custom_logic,&amp;__pyx_n_s_verbose,0};
  PyObject* values[3] = {0,0,0};
/*  */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_102context_checker(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_return_context_as_bool, PyObject *__pyx_v_custom_logic, PyObject *__pyx_v_verbose) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_33_context_checker *__pyx_cur_scope;
  PyObject *__pyx_v_wrapper = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__142)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_33_context_checker *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_33_context_checker(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_33_context_checker, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_33_context_checker *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("context_checker", __pyx_f[0], 2972, 0, <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_return_context_as_bool = __pyx_v_return_context_as_bool;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_return_context_as_bool);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_return_context_as_bool);
  __pyx_cur_scope-&gt;__pyx_v_custom_logic = __pyx_v_custom_logic;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_custom_logic);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_custom_logic);
  __pyx_cur_scope-&gt;__pyx_v_verbose = __pyx_v_verbose;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_verbose);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_verbose);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.context_checker", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_wrapper);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__211 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_return_context_as_bool, __pyx_n_s_custom_logic, __pyx_n_s_verbose, __pyx_n_s_wrapper, __pyx_n_s_wrapper, __pyx_n_s_apply_default_logic, __pyx_n_s_apply_default_logic);<span class='error_goto'> if (unlikely(!__pyx_tuple__211)) __PYX_ERR(0, 2972, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__211);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__211);
  __pyx_codeobj__142 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__211, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_context_checker, 2972, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__142)) __PYX_ERR(0, 2972, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(2972,0,<span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2972, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return_context_as_bool, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_custom_logic, __pyx_kp_s_Optional_Callable_Callable_Calla) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_verbose, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_103context_checker, 0, __pyx_n_s_context_checker, NULL, __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__142));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2972, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_5, __pyx_tuple__212);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_5, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_context_checker, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_33_context_checker {
  PyObject_HEAD
  PyObject *__pyx_v__apply_default_logic;
  PyObject *__pyx_v_custom_logic;
  PyObject *__pyx_v_return_context_as_bool;
  PyObject *__pyx_v_verbose;
};

</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2973</span>:     return_context_as_bool: bool = False,</pre>
<pre class='cython code score-2 '>    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2974</span>:     custom_logic: Optional[Callable[[Callable], Callable]] = None,</pre>
<pre class='cython code score-2 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2975</span>:     verbose: bool = False</pre>
<pre class='cython code score-51 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_context_as_bool);
          if (value) { values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_custom_logic);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_verbose);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "context_checker") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_return_context_as_bool = values[0];
    __pyx_v_custom_logic = values[1];
    __pyx_v_verbose = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("context_checker", 0, 0, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2972, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.context_checker", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_102context_checker(__pyx_self, __pyx_v_return_context_as_bool, __pyx_v_custom_logic, __pyx_v_verbose);
</pre><pre class="cython line score-0">&#xA0;<span class="">2976</span>:     ) -&gt; Callable:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2977</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2978</span>:     A versatile decorator to introspect and modify the behavior of functions</pre>
<pre class="cython line score-0">&#xA0;<span class="">2979</span>:     based on their context of usage. It can determine whether a function is</pre>
<pre class="cython line score-0">&#xA0;<span class="">2980</span>:     being used as a decorator for another function or called directly. This</pre>
<pre class="cython line score-0">&#xA0;<span class="">2981</span>:     decorator also supports executing with custom or default logic.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2982</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2983</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2984</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2985</span>:     return_context_as_bool : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2986</span>:         If True, the decorator returns a boolean value indicating the context</pre>
<pre class="cython line score-0">&#xA0;<span class="">2987</span>:         instead of modifying or executing the target function. ``True`` means</pre>
<pre class="cython line score-0">&#xA0;<span class="">2988</span>:         the function is used as a decorator, and ``False`` indicates it is called</pre>
<pre class="cython line score-0">&#xA0;<span class="">2989</span>:         directly. Defaults to ``False``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2990</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2991</span>:     custom_logic : Optional[Callable[[Callable], Callable]], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2992</span>:         A function that defines custom logic to apply to the decorated function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2993</span>:         If provided, this logic supersedes the default decoration logic.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2994</span>:         If ``None``, default logic is applied.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2995</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2996</span>:     verbose : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2997</span>:         If ``True``, prints messages indicating the detected usage context.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2998</span>:         Useful for debugging purposes. Defaults to ``False``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2999</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3000</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3001</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3002</span>:     Callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">3003</span>:         Depending on `return_context_as_bool`, the function either returns a</pre>
<pre class="cython line score-0">&#xA0;<span class="">3004</span>:         boolean indicating the usage context or modifies the target function</pre>
<pre class="cython line score-0">&#xA0;<span class="">3005</span>:         based on the specified logic (`custom_logic` or default).</pre>
<pre class="cython line score-0">&#xA0;<span class="">3006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3007</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">3008</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3009</span>:     Direct call returning context as boolean:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3010</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3011</span>:     &gt;&gt;&gt; import functools</pre>
<pre class="cython line score-0">&#xA0;<span class="">3012</span>:     &gt;&gt;&gt; from gofast.tools.funcutils import context_checker</pre>
<pre class="cython line score-0">&#xA0;<span class="">3013</span>:     &gt;&gt;&gt; @context_checker(return_context_as_bool=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3014</span>:     ... def my_function():</pre>
<pre class="cython line score-0">&#xA0;<span class="">3015</span>:     ...     pass</pre>
<pre class="cython line score-0">&#xA0;<span class="">3016</span>:     &gt;&gt;&gt; print(my_function())</pre>
<pre class="cython line score-0">&#xA0;<span class="">3017</span>:     Detected direct call or dual-use scenario.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3018</span>:     True</pre>
<pre class="cython line score-0">&#xA0;<span class="">3019</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3020</span>:     Used as a decorator with custom logic, printing before and after:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3021</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3022</span>:     &gt;&gt;&gt; def custom_logic(func):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3023</span>:     ...     @functools.wraps(func)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3024</span>:     ...     def wrapper(*args, **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3025</span>:     ...         print("Before function call")</pre>
<pre class="cython line score-0">&#xA0;<span class="">3026</span>:     ...         result = func(*args, **kwargs)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3027</span>:     ...         print("After function call")</pre>
<pre class="cython line score-0">&#xA0;<span class="">3028</span>:     ...         return result</pre>
<pre class="cython line score-0">&#xA0;<span class="">3029</span>:     ...     return wrapper</pre>
<pre class="cython line score-0">&#xA0;<span class="">3030</span>:     &gt;&gt;&gt; @context_checker(custom_logic=custom_logic)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3031</span>:     ... def another_function():</pre>
<pre class="cython line score-0">&#xA0;<span class="">3032</span>:     ...     print("Function logic here.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">3033</span>:     &gt;&gt;&gt; another_function()</pre>
<pre class="cython line score-0">&#xA0;<span class="">3034</span>:     Detected dual-use or direct call scenario.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3035</span>:     Before function call</pre>
<pre class="cython line score-0">&#xA0;<span class="">3036</span>:     Function logic here.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3037</span>:     After function call</pre>
<pre class="cython line score-0">&#xA0;<span class="">3038</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3039</span>:     Using as a dual-use decorator without providing function (useful for</pre>
<pre class="cython line score-0">&#xA0;<span class="">3040</span>:     decorators that can operate without arguments):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3041</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3042</span>:     &gt;&gt;&gt; @context_checker(verbose=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3043</span>:     ... def dual_use_decorator(func=None):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3044</span>:     ...     if func is not None:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3045</span>:     ...         return context_checker(func)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3046</span>:     ...     def inner_decorator(f):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3047</span>:     ...         @functools.wraps(f)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3048</span>:     ...         def wrapper(*args, **kwargs):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3049</span>:     ...             print("Dual-use logic applied.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">3050</span>:     ...             return f(*args, **kwargs)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3051</span>:     ...         return wrapper</pre>
<pre class="cython line score-0">&#xA0;<span class="">3052</span>:     ...     return inner_decorator</pre>
<pre class="cython line score-0">&#xA0;<span class="">3053</span>:     &gt;&gt;&gt; @dual_use_decorator()</pre>
<pre class="cython line score-0">&#xA0;<span class="">3054</span>:     ... def decorated_function():</pre>
<pre class="cython line score-0">&#xA0;<span class="">3055</span>:     ...     print("Decorated function executed.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">3056</span>:     &gt;&gt;&gt; decorated_function()</pre>
<pre class="cython line score-0">&#xA0;<span class="">3057</span>:     Detected dual-use or direct call scenario.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3058</span>:     Dual-use logic applied.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3059</span>:     Decorated function executed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3060</span>:     """</pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3061</span>:     def wrapper(target: Optional[Callable] = None) -&gt; Any:</pre>
<pre class='cython code score-70 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15context_checker_1wrapper(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_15context_checker_1wrapper = {"wrapper", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_15context_checker_1wrapper, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15context_checker_1wrapper(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_target = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("wrapper (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_target,0};
  PyObject* values[1] = {0};
    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_target);
          if (value) { values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3061, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "wrapper") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3061, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_target = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("wrapper", 0, 0, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3061, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.context_checker.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_15context_checker_wrapper(__pyx_self, __pyx_v_target);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_15context_checker_wrapper(PyObject *__pyx_self, PyObject *__pyx_v_target) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 3061, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_33_context_checker *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("wrapper", __pyx_f[0], 3061, 0, <span class='error_goto'>__PYX_ERR(0, 3061, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.context_checker.wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__143 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_target, __pyx_n_s_apply_logic, __pyx_n_s_apply_logic, __pyx_n_s_dual_use_decorator, __pyx_n_s_dual_use_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__143)) __PYX_ERR(0, 3061, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__143);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__143);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(3061,0,<span class='error_goto'>__PYX_ERR(0, 3061, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3061, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_target, __pyx_kp_s_Optional_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3061, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3061, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_15context_checker_1wrapper, 0, __pyx_n_s_context_checker_locals_wrapper, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__144));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3061, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__139);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_wrapper = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_codeobj__144 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__143, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_wrapper, 3061, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__144)) __PYX_ERR(0, 3061, __pyx_L1_error)</span>
/*  */
struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper {
  PyObject_HEAD
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_33_context_checker *__pyx_outer_scope;
  PyObject *__pyx_v_apply_logic;
  PyObject *__pyx_v_dual_use_decorator;
};

</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3062</span>:         def apply_logic(func: Callable) -&gt; Callable:</pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15context_checker_7wrapper_1apply_logic(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_15context_checker_7wrapper_1apply_logic = {"apply_logic", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_15context_checker_7wrapper_1apply_logic, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15context_checker_7wrapper_1apply_logic(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("apply_logic (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3062, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "apply_logic") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3062, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("apply_logic", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3062, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.context_checker.wrapper.apply_logic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_15context_checker_7wrapper_apply_logic(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_15context_checker_7wrapper_apply_logic(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper *__pyx_outer_scope;
  PyObject *__pyx_v_logic_to_apply = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("apply_logic", __pyx_f[0], 3062, 0, <span class='error_goto'>__PYX_ERR(0, 3062, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.context_checker.wrapper.apply_logic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_logic_to_apply);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__134 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_func, __pyx_n_s_logic_to_apply);<span class='error_goto'> if (unlikely(!__pyx_tuple__134)) __PYX_ERR(0, 3062, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__134);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__134);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(3062,0,<span class='error_goto'>__PYX_ERR(0, 3062, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3062, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3062, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3062, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_15context_checker_7wrapper_1apply_logic, 0, __pyx_n_s_context_checker_locals_wrapper_l, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__135));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3062, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_cur_scope-&gt;__pyx_v_apply_logic = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_codeobj__135 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__134, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_apply_logic, 3062, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__135)) __PYX_ERR(0, 3062, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3063</span>:             logic_to_apply = custom_logic if custom_logic else _apply_default_logic</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(3063,0,<span class='error_goto'>__PYX_ERR(0, 3063, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_custom_logic)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("custom_logic"); <span class='error_goto'>__PYX_ERR(0, 3063, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_custom_logic); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3063, __pyx_L1_error)</span>
  if (__pyx_t_2) {
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_custom_logic)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("custom_logic"); <span class='error_goto'>__PYX_ERR(0, 3063, __pyx_L1_error)</span> }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_custom_logic);
    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_custom_logic;
  } else {
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v__apply_default_logic)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("_apply_default_logic"); <span class='error_goto'>__PYX_ERR(0, 3063, __pyx_L1_error)</span> }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v__apply_default_logic);
    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v__apply_default_logic;
  }
  __pyx_v_logic_to_apply = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3064</span>:             return logic_to_apply(func)</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(3064,0,<span class='error_goto'>__PYX_ERR(0, 3064, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_logic_to_apply);
  __pyx_t_3 = __pyx_v_logic_to_apply; __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_func};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3064, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3065</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3066</span>:         if target and callable(target):</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(3066,0,<span class='error_goto'>__PYX_ERR(0, 3066, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_target); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3066, __pyx_L1_error)</span>
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_v_target);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((int)-1))) __PYX_ERR(0, 3066, __pyx_L1_error)</span>
  __pyx_t_3 = __pyx_t_4;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3067</span>:             if return_context_as_bool:</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(3067,0,<span class='error_goto'>__PYX_ERR(0, 3067, __pyx_L1_error)</span>)
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_return_context_as_bool)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("return_context_as_bool"); <span class='error_goto'>__PYX_ERR(0, 3067, __pyx_L1_error)</span> }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_return_context_as_bool); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3067, __pyx_L1_error)</span>
    if (__pyx_t_3) {
/*  */
    }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3068</span>:                 if verbose:</pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(3068,0,<span class='error_goto'>__PYX_ERR(0, 3068, __pyx_L1_error)</span>)
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("verbose"); <span class='error_goto'>__PYX_ERR(0, 3068, __pyx_L1_error)</span> }
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3068, __pyx_L1_error)</span>
      if (__pyx_t_3) {
/*  */
      }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3069</span>:                     print("Detected as a decorator.")</pre>
<pre class='cython code score-8 '>        <span class='trace'>__Pyx_TraceLine</span>(3069,0,<span class='error_goto'>__PYX_ERR(0, 3069, __pyx_L1_error)</span>)
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_tuple__136, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3069, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/*  */
  __pyx_tuple__136 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Detected_as_a_decorator);<span class='error_goto'> if (unlikely(!__pyx_tuple__136)) __PYX_ERR(0, 3069, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__136);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__136);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3070</span>:                 return False</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(3070,0,<span class='error_goto'>__PYX_ERR(0, 3070, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
      __pyx_r = Py_False;
      goto __pyx_L0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3071</span>:             return apply_logic(target)</pre>
<pre class='cython code score-1 '>    <span class='trace'>__Pyx_TraceLine</span>(3071,0,<span class='error_goto'>__PYX_ERR(0, 3071, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = __pyx_pf_6gofast_5tools_9funcutils_15context_checker_7wrapper_apply_logic(__pyx_cur_scope-&gt;__pyx_v_apply_logic, __pyx_v_target);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3071, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3072</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3073</span>:         if return_context_as_bool:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(3073,0,<span class='error_goto'>__PYX_ERR(0, 3073, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_return_context_as_bool)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("return_context_as_bool"); <span class='error_goto'>__PYX_ERR(0, 3073, __pyx_L1_error)</span> }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_return_context_as_bool); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3073, __pyx_L1_error)</span>
  if (__pyx_t_3) {
/*  */
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3074</span>:             if verbose:</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(3074,0,<span class='error_goto'>__PYX_ERR(0, 3074, __pyx_L1_error)</span>)
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("verbose"); <span class='error_goto'>__PYX_ERR(0, 3074, __pyx_L1_error)</span> }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3074, __pyx_L1_error)</span>
    if (__pyx_t_3) {
/*  */
    }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3075</span>:                 print("Detected direct call or dual-use scenario.")</pre>
<pre class='cython code score-8 '>      <span class='trace'>__Pyx_TraceLine</span>(3075,0,<span class='error_goto'>__PYX_ERR(0, 3075, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_tuple__137, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3075, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/*  */
  __pyx_tuple__137 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Detected_direct_call_or_dual_use);<span class='error_goto'> if (unlikely(!__pyx_tuple__137)) __PYX_ERR(0, 3075, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__137);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__137);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3076</span>:             return True</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3076,0,<span class='error_goto'>__PYX_ERR(0, 3076, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
    __pyx_r = Py_True;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3077</span>: </pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3078</span>:         def dual_use_decorator(func: Optional[Callable] = None) -&gt; Any:</pre>
<pre class='cython code score-67 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15context_checker_7wrapper_3dual_use_decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_15context_checker_7wrapper_3dual_use_decorator = {"dual_use_decorator", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_15context_checker_7wrapper_3dual_use_decorator, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15context_checker_7wrapper_3dual_use_decorator(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("dual_use_decorator (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func);
          if (value) { values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3078, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "dual_use_decorator") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3078, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("dual_use_decorator", 0, 0, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3078, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.context_checker.wrapper.dual_use_decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_15context_checker_7wrapper_2dual_use_decorator(__pyx_self, __pyx_v_func);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_15context_checker_7wrapper_2dual_use_decorator(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_34_wrapper *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("dual_use_decorator", __pyx_f[0], 3078, 0, <span class='error_goto'>__PYX_ERR(0, 3078, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.context_checker.wrapper.dual_use_decorator", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_codeobj__138 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_dual_use_decorator, 3078, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__138)) __PYX_ERR(0, 3078, __pyx_L1_error)</span>
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(3078,0,<span class='error_goto'>__PYX_ERR(0, 3078, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_func, __pyx_kp_s_Optional_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3078, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3078, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_15context_checker_7wrapper_3dual_use_decorator, 0, __pyx_n_s_context_checker_locals_wrapper_l_2, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__138));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_1, __pyx_tuple__139);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_1, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_dual_use_decorator = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__139 = <span class='py_c_api'>PyTuple_Pack</span>(1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__139)) __PYX_ERR(0, 3078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__139);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__139);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3079</span>:             if callable(func):</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3079,0,<span class='error_goto'>__PYX_ERR(0, 3079, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCallable_Check</span>(__pyx_v_func);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((int)-1))) __PYX_ERR(0, 3079, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3080</span>:                 if verbose:</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(3080,0,<span class='error_goto'>__PYX_ERR(0, 3080, __pyx_L1_error)</span>)
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("verbose"); <span class='error_goto'>__PYX_ERR(0, 3080, __pyx_L1_error)</span> }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3080, __pyx_L1_error)</span>
    if (__pyx_t_1) {
/*  */
    }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3081</span>:                     print("Detected dual-use or direct call scenario.")</pre>
<pre class='cython code score-8 '>      <span class='trace'>__Pyx_TraceLine</span>(3081,0,<span class='error_goto'>__PYX_ERR(0, 3081, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_tuple__132, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3081, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/*  */
  __pyx_tuple__132 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Detected_dual_use_or_direct_call);<span class='error_goto'> if (unlikely(!__pyx_tuple__132)) __PYX_ERR(0, 3081, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__132);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__132);
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3082</span>:                 return apply_logic(func)</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(3082,0,<span class='error_goto'>__PYX_ERR(0, 3082, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_apply_logic)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("apply_logic"); <span class='error_goto'>__PYX_ERR(0, 3082, __pyx_L1_error)</span> }
    __pyx_t_2 = __pyx_pf_6gofast_5tools_9funcutils_15context_checker_7wrapper_apply_logic(__pyx_cur_scope-&gt;__pyx_v_apply_logic, __pyx_v_func);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3082, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3083</span>:             else:</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3084</span>:                 if verbose:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(3084,0,<span class='error_goto'>__PYX_ERR(0, 3084, __pyx_L1_error)</span>)
  /*else*/ {
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("verbose"); <span class='error_goto'>__PYX_ERR(0, 3084, __pyx_L1_error)</span> }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3084, __pyx_L1_error)</span>
    if (__pyx_t_1) {
/*  */
    }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3085</span>:                     print("Detected function definition missing, applying logic directly.")</pre>
<pre class='cython code score-8 '>      <span class='trace'>__Pyx_TraceLine</span>(3085,0,<span class='error_goto'>__PYX_ERR(0, 3085, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_tuple__133, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3085, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/*  */
  __pyx_tuple__133 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Detected_function_definition_mis);<span class='error_goto'> if (unlikely(!__pyx_tuple__133)) __PYX_ERR(0, 3085, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__133);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__133);
</pre><pre class="cython line score-0">&#xA0;<span class="">3086</span>:                 # Handle the case where the decorator is used without ()</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3087</span>:                 return apply_logic(dual_use_decorator)</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(3087,0,<span class='error_goto'>__PYX_ERR(0, 3087, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_dual_use_decorator)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("dual_use_decorator"); <span class='error_goto'>__PYX_ERR(0, 3087, __pyx_L1_error)</span> }
    __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_v_dual_use_decorator;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_apply_logic)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("apply_logic"); <span class='error_goto'>__PYX_ERR(0, 3087, __pyx_L1_error)</span> }
    __pyx_t_3 = __pyx_pf_6gofast_5tools_9funcutils_15context_checker_7wrapper_apply_logic(__pyx_cur_scope-&gt;__pyx_v_apply_logic, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3087, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3088</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3089</span>:         return dual_use_decorator if not target else apply_logic(target)</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(3089,0,<span class='error_goto'>__PYX_ERR(0, 3089, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_target); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3089, __pyx_L1_error)</span>
  __pyx_t_4 = (!__pyx_t_3);
  if (__pyx_t_4) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_dual_use_decorator);
    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_v_dual_use_decorator;
  } else {
    __pyx_t_2 = __pyx_pf_6gofast_5tools_9funcutils_15context_checker_7wrapper_apply_logic(__pyx_cur_scope-&gt;__pyx_v_apply_logic, __pyx_v_target);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3089, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = __pyx_t_2;
    __pyx_t_2 = 0;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3090</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3091</span>:     def _apply_default_logic(func: Callable) -&gt; Callable:</pre>
<pre class='cython code score-70 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15context_checker_3_apply_default_logic(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_15context_checker_3_apply_default_logic = {"_apply_default_logic", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_15context_checker_3_apply_default_logic, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15context_checker_3_apply_default_logic(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_func = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_apply_default_logic (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_func,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3091, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_apply_default_logic") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3091, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_func = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_apply_default_logic", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3091, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.context_checker._apply_default_logic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_15context_checker_2_apply_default_logic(__pyx_self, __pyx_v_func);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
static PyObject *__pyx_pf_6gofast_5tools_9funcutils_15context_checker_2_apply_default_logic(PyObject *__pyx_self, PyObject *__pyx_v_func) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_35__apply_default_logic *__pyx_cur_scope;
  PyObject *__pyx_v_decorated = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_35__apply_default_logic *)__pyx_tp_new_6gofast_5tools_9funcutils___pyx_scope_struct_35__apply_default_logic(__pyx_ptype_6gofast_5tools_9funcutils___pyx_scope_struct_35__apply_default_logic, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_35__apply_default_logic *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 3091, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_33_context_checker *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_outer_scope);
  <span class='trace'>__Pyx_TraceCall</span>("_apply_default_logic", __pyx_f[0], 3091, 0, <span class='error_goto'>__PYX_ERR(0, 3091, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_func = __pyx_v_func;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_func);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.context_checker._apply_default_logic", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_decorated);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__145 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_func, __pyx_n_s_decorated, __pyx_n_s_decorated);<span class='error_goto'> if (unlikely(!__pyx_tuple__145)) __PYX_ERR(0, 3091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__145);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__145);
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(3091,0,<span class='error_goto'>__PYX_ERR(0, 3091, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_func, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3091, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_n_s_Callable) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3091, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_15context_checker_3_apply_default_logic, 0, __pyx_n_s_context_checker_locals__apply_de_2, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__146));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3091, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_1, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v__apply_default_logic = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__146 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__145, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_apply_default_logic, 3091, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__146)) __PYX_ERR(0, 3091, __pyx_L1_error)</span>
</pre><pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3092</span>:         @functools.wraps(func)</pre>
<pre class='cython code score-74 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15context_checker_20_apply_default_logic_1decorated(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_9funcutils_15context_checker_20_apply_default_logic_1decorated = {"decorated", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6gofast_5tools_9funcutils_15context_checker_20_apply_default_logic_1decorated, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_9funcutils_15context_checker_20_apply_default_logic_1decorated(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_args = 0;
  PyObject *__pyx_v_kwargs = 0;
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("decorated (wrapper)", 0);
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_VARARGS</span>(__pyx_args, __pyx_nargs);
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "decorated", 1))) return NULL;
  if (unlikely(__pyx_kwds)) {
    __pyx_v_kwargs = <span class='pyx_c_api'>__Pyx_KwargsAsDict_VARARGS</span>(__pyx_kwds, __pyx_kwvalues);
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  } else {
    __pyx_v_kwargs = <span class='py_c_api'>PyDict_New</span>();
    if (unlikely(!__pyx_v_kwargs)) return NULL;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kwargs);
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_args);
  __pyx_v_args = __pyx_args;
  __pyx_r = __pyx_pf_6gofast_5tools_9funcutils_15context_checker_20_apply_default_logic_decorated(__pyx_self, __pyx_v_args, __pyx_v_kwargs);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_args);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kwargs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_9funcutils_15context_checker_20_apply_default_logic_decorated(PyObject *__pyx_self, PyObject *__pyx_v_args, PyObject *__pyx_v_kwargs) {
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_35__apply_default_logic *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_35__apply_default_logic *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_9funcutils___pyx_scope_struct_35__apply_default_logic *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("decorated", __pyx_f[0], 3092, 0, <span class='error_goto'>__PYX_ERR(0, 3092, __pyx_L1_error)</span>);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.funcutils.context_checker._apply_default_logic.decorated", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  <span class='trace'>__Pyx_TraceLine</span>(3092,0,<span class='error_goto'>__PYX_ERR(0, 3092, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_functools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_wraps);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_func};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3092, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_return, __pyx_n_s_Any) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3092, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_9funcutils_15context_checker_20_apply_default_logic_1decorated, 0, __pyx_n_s_context_checker_locals__apply_de, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_funcutils, __pyx_d, ((PyObject *)__pyx_codeobj__141));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3092, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_decorated = __pyx_t_1;
  __pyx_t_1 = 0;
/*  */
  __pyx_codeobj__141 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARARGS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple_, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_funcutils_pyx, __pyx_n_s_decorated, 3092, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__141)) __PYX_ERR(0, 3092, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3093</span>:         def decorated(*args, **kwargs) -&gt; Any:</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3094</span>:             if verbose:</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(3094,0,<span class='error_goto'>__PYX_ERR(0, 3094, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("verbose"); <span class='error_goto'>__PYX_ERR(0, 3094, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_outer_scope-&gt;__pyx_v_verbose); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3094, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/*  */
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3095</span>:                 print("Default decoration logic applied.")</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(3095,0,<span class='error_goto'>__PYX_ERR(0, 3095, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_print, __pyx_tuple__140, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3095, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/*  */
  __pyx_tuple__140 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Default_decoration_logic_applied);<span class='error_goto'> if (unlikely(!__pyx_tuple__140)) __PYX_ERR(0, 3095, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__140);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__140);
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3096</span>:             return func(*args, **kwargs)</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(3096,0,<span class='error_goto'>__PYX_ERR(0, 3096, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_func)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("func"); <span class='error_goto'>__PYX_ERR(0, 3096, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kwargs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_cur_scope-&gt;__pyx_v_func, __pyx_v_args, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3097</span>:         return decorated</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3097,0,<span class='error_goto'>__PYX_ERR(0, 3097, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_decorated);
  __pyx_r = __pyx_v_decorated;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3098</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3099</span>:     return wrapper if not return_context_as_bool else wrapper(None)</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(3099,0,<span class='error_goto'>__PYX_ERR(0, 3099, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_cur_scope-&gt;__pyx_v_return_context_as_bool); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3099, __pyx_L1_error)</span>
  __pyx_t_4 = (!__pyx_t_3);
  if (__pyx_t_4) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_wrapper);
    __pyx_t_1 = __pyx_v_wrapper;
  } else {
    __pyx_t_2 = __pyx_pf_6gofast_5tools_9funcutils_15context_checker_wrapper(__pyx_v_wrapper, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3099, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = __pyx_t_2;
    __pyx_t_2 = 0;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3100</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3101</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3102</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3103</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3104</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3105</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3106</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3107</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3108</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3109</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3110</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3111</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3112</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3113</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3114</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3115</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3116</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3117</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3118</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3119</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3120</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3121</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3122</span>: </pre>
</div></body></html>
