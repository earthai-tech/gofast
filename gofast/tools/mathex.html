<!DOCTYPE html>
<!-- Generated by Cython 3.0.9 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: mathex.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { color: #000000; margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 3.0.9</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="mathex.c">mathex.c</a></p>
<div class="cython"><pre class="cython line score-233" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0001</span>: # -*- coding: utf-8 -*-</pre>
<pre class='cython code score-233 '>  <span class='trace'>__Pyx_TraceLine</span>(1,0,<span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(45);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_compute_p_values_line_97, __pyx_kp_u_Compute_p_values_for_the_correl) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_compute_balance_accuracy_line_24, __pyx_kp_u_Compute_the_balanced_accuracy_f) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_compute_cost_based_threshold_lin, __pyx_kp_u_Compute_threshold_using_a_cost) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_compute_youdens_index_line_466, __pyx_kp_u_Compute_Youden_s_Index_and_opti) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_calculate_multiclass_avg_lr_line, __pyx_kp_u_Calculate_the_average_likelihoo) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_calculate_multiclass_lr_line_662, __pyx_kp_u_Calculate_the_multiclass_likeli) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_calculate_adjusted_lr_line_809, __pyx_kp_u_Calculate_the_likelihood_ratio) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_compute_sensitivity_specificity_3, __pyx_kp_u_Calculate_sensitivity_and_speci) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_compute_sensitivity_specificity_4, __pyx_kp_u_Calculate_sensitivity_and_speci_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_compute_ovo_sens_spec_line_1140, __pyx_kp_u_Compute_sensitivity_and_specifi) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_calculate_histogram_bins_line_12, __pyx_kp_u_Calculates_histogram_bin_edges) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_rank_data_line_1263, __pyx_kp_u_Assigns_ranks_to_data_handling) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_optimized_spearmanr_line_1351, __pyx_kp_u_Compute_Spearman_s_rank_correla) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_adjust_for_control_vars_line_150, __pyx_kp_u_Adjusts_y_true_and_y_pred_for_e) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_adjust_for_control_vars_regressi_2, __pyx_kp_u_Adjust_y_true_and_y_pred_for_re) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_adjust_for_control_vars_classifi_2, __pyx_kp_u_Adjusts_y_true_and_y_pred_in_a) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_weighted_spearman_rank_line_1795, __pyx_kp_u_Compute_Spearman_s_rank_correla_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_calculate_optimal_bins_line_1895, __pyx_kp_u_Calculate_the_optimal_number_of) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_calculate_binary_iv_line_1993, __pyx_kp_u_Calculate_the_Information_Value) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_calculate_residuals_line_2195, __pyx_kp_u_Calculate_the_residuals_for_reg) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_infer_sankey_columns_line_2272, __pyx_kp_u_Infers_source_target_and_value) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_compute_sunburst_data_line_2348, __pyx_kp_u_Computes_the_data_structure_req) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_compute_effort_yield_line_2440, __pyx_kp_u_Compute_effort_and_yield_values) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_make_mxs_line_2514, __pyx_kp_u_Compute_the_similarity_between) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_label_importance_line_2612, __pyx_kp_u_Compute_the_importance_of_each) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_standard_scaler_line_2896, __pyx_kp_u_Scales_features_to_have_zero_me) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_minmax_scaler_line_2947, __pyx_kp_u_Scales_each_feature_to_a_given) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_normalize_line_2997, __pyx_kp_u_Scales_individual_samples_to_ha) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_moving_average_line_3046, __pyx_kp_u_A_moving_average_is_used_with_t) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_count_local_minima_line_3171, __pyx_kp_u_Count_the_number_of_local_minim) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_get_azimuth_line_3229, __pyx_kp_u_Compute_azimuth_from_coordinate) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_scalePosition_line_3596, __pyx_kp_u_Correct_data_location_or_positi) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_detect_station_position_line_374, __pyx_kp_u_Detect_station_position_and_ret) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_savgol_coeffs_line_3949, __pyx_kp_u_Compute_the_coefficients_for_a_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_savgol_filter_line_4159, __pyx_kp_u_Apply_a_Savitzky_Golay_filter_t) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_compute_errors_line_4287, __pyx_kp_u_Compute_Errors_Standard_Deviati) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_quality_control2_line_4409, __pyx_kp_u_Check_the_quality_control_in_th) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_get_distance_line_4518, __pyx_kp_u_Compute_distance_between_points) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_scale_positions_line_4567, __pyx_kp_u_Correct_the_position_coordinate) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_get_bearing_line_4703, __pyx_kp_u_Calculate_the_bearing_between_t) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_find_closest_line_4771, __pyx_kp_u_Get_the_closest_value_in_array_f) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_gradient_descent_line_4820, __pyx_kp_u_Gradient_descent_algorithm_to_f) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_adaptive_moving_average_line_494, __pyx_kp_u_Adaptative_moving_average_as_sm) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_torres_verdin_filter_line_4997, __pyx_kp_u_Calculates_the_adaptive_moving) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_kp_u_gradient_boosting_regressor_line, __pyx_kp_u_Implement_a_simple_version_of_G) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0002</span>: #   License: BSD-3-Clause</pre>
<pre class="cython line score-0">&#xA0;<span class="">0003</span>: #   Author: LKouadio &lt;etanoyau@gmail.com&gt;</pre>
<pre class="cython line score-0">&#xA0;<span class="">0004</span>: """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0005</span>: Utilities to process and compute parameters. Module for Algebra calculus.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0006</span>: """</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0007</span>: import copy</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(7,0,<span class='error_goto'>__PYX_ERR(0, 7, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_copy, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_copy, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 7, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0008</span>: import inspect</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(8,0,<span class='error_goto'>__PYX_ERR(0, 8, __pyx_L1_error)</span>)
  __pyx_t_2 = __Pyx_patch_inspect(<span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_inspect, NULL));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 8, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_inspect, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 8, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0009</span>: import warnings</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(9,0,<span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_warnings, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_warnings, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0010</span>: import itertools</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(10,0,<span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_itertools, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_itertools, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0011</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(11,0,<span class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_numpy, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0012</span>: import pandas as pd</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(12,0,<span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_pandas, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pd, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0013</span>: import matplotlib.pyplot as plt</pre>
<pre class='cython code score-13 '>  <span class='trace'>__Pyx_TraceLine</span>(13,0,<span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_matplotlib_pyplot, __pyx_tuple__150);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_plt, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__150 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_matplotlib, __pyx_n_s_pyplot);<span class='error_goto'> if (unlikely(!__pyx_tuple__150)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__150);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__150);
</pre><pre class="cython line score-0">&#xA0;<span class="">0014</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0015</span>: import scipy.stats as spstats</pre>
<pre class='cython code score-13 '>  <span class='trace'>__Pyx_TraceLine</span>(15,0,<span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_n_s_scipy_stats, __pyx_tuple__151);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_spstats, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__151 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_scipy, __pyx_n_s_stats);<span class='error_goto'> if (unlikely(!__pyx_tuple__151)) __PYX_ERR(0, 15, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__151);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__151);
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0016</span>: from scipy._lib._util import float_factorial</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(16,0,<span class='error_goto'>__PYX_ERR(0, 16, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_float_factorial);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_float_factorial);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_float_factorial)) <span class='error_goto'>__PYX_ERR(0, 16, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy__lib__util, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_float_factorial);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_float_factorial, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0017</span>: from scipy.cluster.hierarchy import linkage</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(17,0,<span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_linkage);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_linkage);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_linkage)) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_cluster_hierarchy, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_linkage);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_linkage, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0018</span>: from scipy.linalg import lstsq</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(18,0,<span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_lstsq);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_lstsq);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_lstsq)) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_linalg, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_lstsq);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_lstsq, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 18, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0019</span>: from scipy.ndimage import convolve1d</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(19,0,<span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_convolve1d);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_convolve1d);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_convolve1d)) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_ndimage, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_convolve1d);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convolve1d, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 19, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0020</span>: from scipy.stats import rankdata</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(20,0,<span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_rankdata);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_rankdata);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_rankdata)) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_stats, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_rankdata);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_rankdata, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 20, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0021</span>: from scipy.signal import argrelextrema</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(21,0,<span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_argrelextrema);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_argrelextrema);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_argrelextrema)) <span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_signal, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_argrelextrema);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_argrelextrema, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 21, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0022</span>: from scipy.optimize import curve_fit</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(22,0,<span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_curve_fit);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_curve_fit);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_curve_fit)) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_optimize, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_curve_fit);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_curve_fit, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0023</span>: from scipy.spatial.distance import pdist, squareform</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(23,0,<span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_pdist);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_pdist);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_pdist)) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_squareform);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_squareform);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_squareform)) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_spatial_distance, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_pdist);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pdist, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_squareform);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_squareform, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 23, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0024</span>: from scipy.stats import pearsonr, spearmanr, kendalltau</pre>
<pre class='cython code score-42 '>  <span class='trace'>__Pyx_TraceLine</span>(24,0,<span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_pearsonr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_pearsonr);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_pearsonr)) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_spearmanr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_spearmanr);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_spearmanr)) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_kendalltau);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_kendalltau);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_kendalltau)) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_stats, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_pearsonr);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_pearsonr, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_spearmanr);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_spearmanr, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_kendalltau);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_kendalltau, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 24, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0025</span>: </pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0026</span>: from sklearn.metrics import confusion_matrix, roc_curve, roc_auc_score</pre>
<pre class='cython code score-42 '>  <span class='trace'>__Pyx_TraceLine</span>(26,0,<span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_confusion_matrix);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_confusion_matrix);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_confusion_matrix)) <span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_roc_curve);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_roc_curve);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_roc_curve)) <span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_roc_auc_score);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_roc_auc_score);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_s_roc_auc_score)) <span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_metrics, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_confusion_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_confusion_matrix, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_roc_curve);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_roc_curve, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_roc_auc_score);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_roc_auc_score, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 26, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0027</span>: from sklearn.utils.multiclass import unique_labels</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(27,0,<span class='error_goto'>__PYX_ERR(0, 27, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 27, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_unique_labels);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_unique_labels);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_unique_labels)) <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_utils_multiclass, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 27, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_unique_labels);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 27, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_unique_labels, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0028</span>: from sklearn.preprocessing import label_binarize, LabelEncoder</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(28,0,<span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_label_binarize);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_label_binarize);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_label_binarize)) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_LabelEncoder);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_LabelEncoder);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_LabelEncoder)) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_preprocessing, __pyx_t_3, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_label_binarize);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_label_binarize, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_LabelEncoder);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_LabelEncoder, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0029</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0030</span>: from .._gofastlog import gofastlog</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(30,0,<span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_gofastlog_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_gofastlog_2);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_gofastlog_2)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_gofastlog, __pyx_t_2, 2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_gofastlog_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gofastlog_2, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0031</span>: from ..api.box import KeyBox</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(31,0,<span class='error_goto'>__PYX_ERR(0, 31, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_KeyBox);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_KeyBox);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_KeyBox)) <span class='error_goto'>__PYX_ERR(0, 31, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_api_box, __pyx_t_3, 2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_KeyBox);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_KeyBox, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 31, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0032</span>: from ..api.docstring import refglossary</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(32,0,<span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_refglossary);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_refglossary);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_refglossary)) <span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_api_docstring, __pyx_t_2, 2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_refglossary);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_refglossary, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0033</span>: from ..api.types import _T, _F,_SP, List, Tuple, Union</pre>
<pre class='cython code score-75 '>  <span class='trace'>__Pyx_TraceLine</span>(33,0,<span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_T);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_T);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_T)) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_F);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_F);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_F)) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_SP);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_SP);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_s_SP)) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_List);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_List);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_n_s_List)) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Tuple);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Tuple);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 4, __pyx_n_s_Tuple)) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Union);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Union);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 5, __pyx_n_s_Union)) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_api_types, __pyx_t_3, 2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_T, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_F);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_F, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_SP);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_SP, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_List);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_List, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Tuple);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Tuple, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Union);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Union, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 33, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0034</span>: from ..api.types import ArrayLike, NDArray, Optional</pre>
<pre class='cython code score-42 '>  <span class='trace'>__Pyx_TraceLine</span>(34,0,<span class='error_goto'>__PYX_ERR(0, 34, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 34, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ArrayLike);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ArrayLike);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_ArrayLike)) <span class='error_goto'>__PYX_ERR(0, 34, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_NDArray);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_NDArray);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_NDArray)) <span class='error_goto'>__PYX_ERR(0, 34, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Optional);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Optional);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_Optional)) <span class='error_goto'>__PYX_ERR(0, 34, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_api_types, __pyx_t_2, 2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 34, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_ArrayLike);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 34, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ArrayLike, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 34, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_NDArray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 34, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_NDArray, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 34, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_Optional);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 34, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Optional, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 34, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0035</span>: from ..api.types import Series, DataFrame,  Dict</pre>
<pre class='cython code score-42 '>  <span class='trace'>__Pyx_TraceLine</span>(35,0,<span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Series);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Series);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_Series)) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_DataFrame);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_DataFrame);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_DataFrame)) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Dict);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Dict);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_s_Dict)) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_api_types, __pyx_t_3, 2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Series, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_DataFrame, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Dict);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Dict, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 35, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0036</span>: from ..api.summary import ResultSummary</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(36,0,<span class='error_goto'>__PYX_ERR(0, 36, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ResultSummary);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ResultSummary);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_ResultSummary)) <span class='error_goto'>__PYX_ERR(0, 36, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_api_summary, __pyx_t_2, 2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_ResultSummary);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ResultSummary, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 36, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0037</span>: from ..decorators import AppendDocReferences</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(37,0,<span class='error_goto'>__PYX_ERR(0, 37, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_AppendDocReferences);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_AppendDocReferences);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_AppendDocReferences)) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_decorators, __pyx_t_3, 2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_AppendDocReferences);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_AppendDocReferences, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0038</span>: from ..exceptions import SiteError</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(38,0,<span class='error_goto'>__PYX_ERR(0, 38, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_SiteError);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_SiteError);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_SiteError)) <span class='error_goto'>__PYX_ERR(0, 38, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_exceptions, __pyx_t_2, 2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_SiteError);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_SiteError, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 38, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0039</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0040</span>: from ._arraytools import axis_slice</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(40,0,<span class='error_goto'>__PYX_ERR(0, 40, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_axis_slice);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_axis_slice);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_axis_slice)) <span class='error_goto'>__PYX_ERR(0, 40, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_arraytools, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_axis_slice);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_axis_slice, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 40, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0041</span>: from .coreutils import _assert_all_types, _validate_name_in</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(41,0,<span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_assert_all_types);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_assert_all_types);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_assert_all_types)) <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_validate_name_in);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_validate_name_in);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_validate_name_in)) <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_coreutils, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_assert_all_types);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_assert_all_types, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_validate_name_in);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_validate_name_in, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0042</span>: from .coreutils import concat_array_from_list</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(42,0,<span class='error_goto'>__PYX_ERR(0, 42, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_concat_array_from_list);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_concat_array_from_list);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_concat_array_from_list)) <span class='error_goto'>__PYX_ERR(0, 42, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_coreutils, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_concat_array_from_list);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 42, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_concat_array_from_list, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 42, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0043</span>: from .coreutils import find_close_position, normalize_string</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(43,0,<span class='error_goto'>__PYX_ERR(0, 43, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_find_close_position);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_find_close_position);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_find_close_position)) <span class='error_goto'>__PYX_ERR(0, 43, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_normalize_string);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_normalize_string);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_normalize_string)) <span class='error_goto'>__PYX_ERR(0, 43, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_coreutils, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_find_close_position);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_find_close_position, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_normalize_string);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_normalize_string, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 43, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0044</span>: from .coreutils import to_numeric_dtypes, ellipsis2false</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(44,0,<span class='error_goto'>__PYX_ERR(0, 44, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_to_numeric_dtypes);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_to_numeric_dtypes);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_to_numeric_dtypes)) <span class='error_goto'>__PYX_ERR(0, 44, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ellipsis2false);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ellipsis2false);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_ellipsis2false)) <span class='error_goto'>__PYX_ERR(0, 44, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_coreutils, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_to_numeric_dtypes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_to_numeric_dtypes, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_ellipsis2false);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ellipsis2false, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 44, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0045</span>: from .coreutils import smart_format, type_of_target, is_iterable</pre>
<pre class='cython code score-42 '>  <span class='trace'>__Pyx_TraceLine</span>(45,0,<span class='error_goto'>__PYX_ERR(0, 45, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_smart_format);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_smart_format);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_smart_format)) <span class='error_goto'>__PYX_ERR(0, 45, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_type_of_target);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_type_of_target);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_type_of_target)) <span class='error_goto'>__PYX_ERR(0, 45, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_is_iterable);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_is_iterable);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_is_iterable)) <span class='error_goto'>__PYX_ERR(0, 45, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_coreutils, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_smart_format);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_smart_format, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_type_of_target);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_type_of_target, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_is_iterable);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_is_iterable, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 45, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0046</span>: from .coreutils import reshape, assert_ratio</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(46,0,<span class='error_goto'>__PYX_ERR(0, 46, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_reshape);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_reshape);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_reshape)) <span class='error_goto'>__PYX_ERR(0, 46, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_assert_ratio);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_assert_ratio);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_assert_ratio)) <span class='error_goto'>__PYX_ERR(0, 46, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_coreutils, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_reshape, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_assert_ratio);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_assert_ratio, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 46, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0047</span>: from .validator import _is_arraylike_1d, _is_numeric_dtype, validate_multioutput</pre>
<pre class='cython code score-42 '>  <span class='trace'>__Pyx_TraceLine</span>(47,0,<span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_is_arraylike_1d);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_is_arraylike_1d);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_is_arraylike_1d)) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_is_numeric_dtype);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_is_numeric_dtype);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_is_numeric_dtype)) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_validate_multioutput);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_validate_multioutput);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_validate_multioutput)) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_validator, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_is_arraylike_1d);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_is_arraylike_1d, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_is_numeric_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_is_numeric_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_validate_multioutput);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_validate_multioutput, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 47, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0048</span>: from .validator import check_consistent_length</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(48,0,<span class='error_goto'>__PYX_ERR(0, 48, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 48, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_check_consistent_length);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_check_consistent_length);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_check_consistent_length)) <span class='error_goto'>__PYX_ERR(0, 48, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_validator, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 48, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_check_consistent_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 48, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_consistent_length, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 48, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0049</span>: from .validator import check_classification_targets, check_y</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(49,0,<span class='error_goto'>__PYX_ERR(0, 49, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_check_classification_targets);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_check_classification_targets);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_check_classification_targets)) <span class='error_goto'>__PYX_ERR(0, 49, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_check_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_check_y);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_check_y)) <span class='error_goto'>__PYX_ERR(0, 49, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_validator, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_check_classification_targets);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_classification_targets, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_check_y);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_y, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 49, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0050</span>: from .validator import assert_xy_in, _ensure_y_is_valid, ensure_non_negative</pre>
<pre class='cython code score-42 '>  <span class='trace'>__Pyx_TraceLine</span>(50,0,<span class='error_goto'>__PYX_ERR(0, 50, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_assert_xy_in);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_assert_xy_in);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_assert_xy_in)) <span class='error_goto'>__PYX_ERR(0, 50, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ensure_y_is_valid);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ensure_y_is_valid);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_ensure_y_is_valid)) <span class='error_goto'>__PYX_ERR(0, 50, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ensure_non_negative);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ensure_non_negative);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_s_ensure_non_negative)) <span class='error_goto'>__PYX_ERR(0, 50, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_validator, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_assert_xy_in);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_assert_xy_in, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_ensure_y_is_valid);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ensure_y_is_valid, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_ensure_non_negative);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ensure_non_negative, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 50, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0051</span>: from .validator import check_epsilon, parameter_validator, is_binary_class</pre>
<pre class='cython code score-42 '>  <span class='trace'>__Pyx_TraceLine</span>(51,0,<span class='error_goto'>__PYX_ERR(0, 51, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 51, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_check_epsilon);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_check_epsilon);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_check_epsilon)) <span class='error_goto'>__PYX_ERR(0, 51, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_parameter_validator);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_parameter_validator);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_parameter_validator)) <span class='error_goto'>__PYX_ERR(0, 51, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_is_binary_class);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_is_binary_class);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_is_binary_class)) <span class='error_goto'>__PYX_ERR(0, 51, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_validator, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 51, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_check_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 51, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_check_epsilon, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 51, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_parameter_validator);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 51, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_parameter_validator, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 51, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_is_binary_class);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 51, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_is_binary_class, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 51, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0052</span>: from .validator import validate_sample_weights, validate_multiclass_target</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(52,0,<span class='error_goto'>__PYX_ERR(0, 52, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_validate_sample_weights);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_validate_sample_weights);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_validate_sample_weights)) <span class='error_goto'>__PYX_ERR(0, 52, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_validate_multiclass_target);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_validate_multiclass_target);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_s_validate_multiclass_target)) <span class='error_goto'>__PYX_ERR(0, 52, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_validator, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_validate_sample_weights);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_validate_sample_weights, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_validate_multiclass_target);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_validate_multiclass_target, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0053</span>: from .validator import validate_length_range, validate_scores, ensure_2d</pre>
<pre class='cython code score-42 '>  <span class='trace'>__Pyx_TraceLine</span>(53,0,<span class='error_goto'>__PYX_ERR(0, 53, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_validate_length_range);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_validate_length_range);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_validate_length_range)) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_validate_scores);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_validate_scores);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_s_validate_scores)) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ensure_2d);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ensure_2d);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_s_ensure_2d)) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_validator, __pyx_t_2, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_validate_length_range);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_validate_length_range, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_validate_scores);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_validate_scores, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_3, __pyx_n_s_ensure_2d);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ensure_2d, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0054</span>: from .validator import is_frame</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(54,0,<span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_is_frame);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_is_frame);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_s_is_frame)) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_validator, __pyx_t_3, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_is_frame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_is_frame, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0055</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0056</span>: _logger =gofastlog.get_gofast_logger(__name__)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(56,0,<span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_gofastlog_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_get_gofast_logger);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_logger, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0057</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0058</span>: mu0 = 4 * np.pi * 1e-7</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(58,0,<span class='error_goto'>__PYX_ERR(0, 58, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_pi);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyCObj</span>(__pyx_int_4, __pyx_t_2, 4, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_float_1eneg_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_mu0, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 58, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0059</span>: </pre>
<pre class="cython line score-113" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0060</span>: __all__=[</pre>
<pre class='cython code score-113 '>  <span class='trace'>__Pyx_TraceLine</span>(60,0,<span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(34);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_adaptive_moving_average);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_adaptive_moving_average);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_adaptive_moving_average)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_adjust_for_control_vars);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_adjust_for_control_vars);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_u_adjust_for_control_vars)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_calculate_adjusted_lr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_calculate_adjusted_lr);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 2, __pyx_n_u_calculate_adjusted_lr)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_calculate_binary_iv);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_calculate_binary_iv);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 3, __pyx_n_u_calculate_binary_iv)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_calculate_optimal_bins);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_calculate_optimal_bins);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 4, __pyx_n_u_calculate_optimal_bins)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_calculate_residuals);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_calculate_residuals);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 5, __pyx_n_u_calculate_residuals)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_compute_balance_accuracy);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_compute_balance_accuracy);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 6, __pyx_n_u_compute_balance_accuracy)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_compute_effort_yield);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_compute_effort_yield);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 7, __pyx_n_u_compute_effort_yield)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_compute_errors);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_compute_errors);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 8, __pyx_n_u_compute_errors)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_compute_sunburst_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_compute_sunburst_data);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 9, __pyx_n_u_compute_sunburst_data)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_compute_cost_based_threshold);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_compute_cost_based_threshold);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 10, __pyx_n_u_compute_cost_based_threshold)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_compute_sensitivity_specificity_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_compute_sensitivity_specificity_2);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 11, __pyx_n_u_compute_sensitivity_specificity_2)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_compute_youdens_index);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_compute_youdens_index);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 12, __pyx_n_u_compute_youdens_index)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_cubic_regression);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_cubic_regression);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 13, __pyx_n_u_cubic_regression)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_exponential_regression);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_exponential_regression);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 14, __pyx_n_u_exponential_regression)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_get_bearing);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_get_bearing);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 15, __pyx_n_u_get_bearing)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_get_distance);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_get_distance);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 16, __pyx_n_u_get_distance)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_infer_sankey_columns);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_infer_sankey_columns);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 17, __pyx_n_u_infer_sankey_columns)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_label_importance);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_label_importance);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 18, __pyx_n_u_label_importance)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_linear_regression);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_linear_regression);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 19, __pyx_n_u_linear_regression)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_linkage_matrix);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_linkage_matrix);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 20, __pyx_n_u_linkage_matrix)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_logarithmic_regression);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_logarithmic_regression);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 21, __pyx_n_u_logarithmic_regression)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_make_mxs);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_make_mxs);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 22, __pyx_n_u_make_mxs)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_minmax_scaler);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_minmax_scaler);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 23, __pyx_n_u_minmax_scaler)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_normalize);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_normalize);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 24, __pyx_n_u_normalize)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_optimized_spearmanr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_optimized_spearmanr);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 25, __pyx_n_u_optimized_spearmanr)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_quadratic_regression);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_quadratic_regression);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 26, __pyx_n_u_quadratic_regression)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_rank_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_rank_data);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 27, __pyx_n_u_rank_data)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_savgol_filter);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_savgol_filter);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 28, __pyx_n_u_savgol_filter)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_sinusoidal_regression);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_sinusoidal_regression);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 29, __pyx_n_u_sinusoidal_regression)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_standard_scaler);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_standard_scaler);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 30, __pyx_n_u_standard_scaler)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_step_regression);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_step_regression);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 31, __pyx_n_u_step_regression)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_weighted_spearman_rank);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_weighted_spearman_rank);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 32, __pyx_n_u_weighted_spearman_rank)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_compute_p_values);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_compute_p_values);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 33, __pyx_n_u_compute_p_values)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_all_2, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0061</span>:     'adaptive_moving_average',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0062</span>:     'adjust_for_control_vars',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0063</span>:     'calculate_adjusted_lr',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0064</span>:     'calculate_binary_iv',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0065</span>:     'calculate_optimal_bins',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0066</span>:     'calculate_residuals',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0067</span>:     'compute_balance_accuracy',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0068</span>:     'compute_effort_yield',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0069</span>:     'compute_errors',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0070</span>:     'compute_sunburst_data',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0071</span>:     'compute_cost_based_threshold',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0072</span>:     'compute_sensitivity_specificity',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0073</span>:     'compute_youdens_index',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0074</span>:     'cubic_regression',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0075</span>:     'exponential_regression',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0076</span>:     'get_bearing',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0077</span>:     'get_distance',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0078</span>:     'infer_sankey_columns',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0079</span>:     'label_importance',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0080</span>:     'linear_regression',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0081</span>:     'linkage_matrix',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0082</span>:     'logarithmic_regression',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0083</span>:     'make_mxs',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0084</span>:     'minmax_scaler',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0085</span>:     'normalize',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0086</span>:     'optimized_spearmanr',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0087</span>:     'quadratic_regression',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0088</span>:     'rank_data',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0089</span>:     'savgol_filter',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0090</span>:     'sinusoidal_regression',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0091</span>:     'standard_scaler',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0092</span>:     'step_regression',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0093</span>:     'weighted_spearman_rank',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0094</span>:     'compute_p_values'</pre>
<pre class="cython line score-0">&#xA0;<span class="">0095</span>:     ]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0096</span>: </pre>
<pre class="cython line score-85" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0097</span>: def compute_p_values(</pre>
<pre class='cython code score-85 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_1compute_p_values(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_compute_p_values, "\n    Compute p-values for the correlation between each independent variable\n    and a dependent variable.\n\n    Parameters\n    ----------\n    data : pandas DataFrame\n        The DataFrame containing the dataset.\n    depvar : str or pandas Series\n        The name of the dependent variable as a string or a pandas Series.\n    method : {'pearson', 'spearman', 'kendall'}, optional\n        The correlation method to use. Default is 'pearson'.\n    significance_threshold : float, optional\n        The significance threshold for p-values. Default is 0.05.\n    ignore : str or list, optional\n        Columns to ignore during computation.\n\n    Returns\n    -------\n    p_values : :class:`gofast.api.summary.ResultSummary` object \n        A dictionary containing independent variables as keys and their \n        corresponding p-values.\n\n    Raises\n    ------\n    ValueError\n        If depvar is not found in DataFrame columns or if an invalid \n        correlation method is specified.\n\n    Notes\n    -----\n    - If depvar is a string, it checks whether it exists in the DataFrame's \n      columns. If it doesn't exist, it raises a ValueError.\n    - The function computes p-values for the specified correlation method \n      between each independent variable\n      and the dependent variable. It excludes the depvar column from the \n      computation if it's in the DataFrame.\n\n    Examples\n    --------\n    &gt;&gt;&gt; import pandas as pd\n    &gt;&gt;&gt; import numpy as np\n    &gt;&gt;&gt; from gofast.tools.mathex import compute_p_values\n    &gt;&gt;&gt; np.random.seed(0)\n    &gt;&gt;&gt; data = pd.DataFrame({\n    ...     'x1': np.random.randn(100),\n    ...     'x2': np.random.randn(100),\n    ...     'y': np.random.randn(100)\n    ... })\n    &gt;&gt;&gt; p_values = compute_p_values(data, 'y', method='pearson') \n    &gt;&gt;&gt; print(p_values ) \n    P-values(\n      {\n\n           x1 : None\n           x2 : None\n\n      }\n    )\n\n    [ 2 entries ]\n    &gt;&gt;&gt; p_values = compute_p_values(data, 'y', method='pea""rson',\n    ...                             significance_threshold=None)\n    &gt;&gt;&gt; p_values\n    Out[76]: &lt;P-values with 2 entries. Use print() to see detailed contents.&gt;\n\n    &gt;&gt;&gt; print(p_values)\n    P-values(\n      {\n\n           x1 : 0.4516405974318084\n           x2 : 0.5797578201347333\n\n      }\n    )\n\n    [ 2 entries ]\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_1compute_p_values = {"compute_p_values", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_1compute_p_values, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_compute_p_values};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_1compute_p_values(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_depvar = 0;
  PyObject *__pyx_v_method = 0;
  double __pyx_v_significance_threshold;
  PyObject *__pyx_v_ignore = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_p_values (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_depvar,&amp;__pyx_n_s_method,&amp;__pyx_n_s_significance_threshold,&amp;__pyx_n_s_ignore,0};
  PyObject* values[5] = {0,0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_pearson)));
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_compute_p_values(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_depvar, PyObject *__pyx_v_method, double __pyx_v_significance_threshold, PyObject *__pyx_v_ignore) {
  PyObject *__pyx_v_column2ignore = NULL;
  PyObject *__pyx_v_corr_methods = NULL;
  PyObject *__pyx_v_p_values = NULL;
  PyObject *__pyx_v_column = NULL;
  PyObject *__pyx_v_corr_func = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_corr = NULL;
  PyObject *__pyx_v_p_value = NULL;
  PyObject *__pyx_7genexpr__pyx_v_col = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj_)
  <span class='trace'>__Pyx_TraceCall</span>("compute_p_values", __pyx_f[0], 97, 0, <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_depvar);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ignore);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_p_values", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_column2ignore);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_corr_methods);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_p_values);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_column);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_corr_func);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_corr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_p_value);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_col);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_depvar);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ignore);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__152 = <span class='py_c_api'>PyTuple_Pack</span>(13, __pyx_n_s_data, __pyx_n_s_depvar, __pyx_n_s_method, __pyx_n_s_significance_threshold, __pyx_n_s_ignore, __pyx_n_s_column2ignore, __pyx_n_s_corr_methods, __pyx_n_s_p_values, __pyx_n_s_column, __pyx_n_s_corr_func, __pyx_n_s_corr, __pyx_n_s_p_value, __pyx_n_s_col);<span class='error_goto'> if (unlikely(!__pyx_tuple__152)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__152);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__152);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(97,0,<span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_pearson));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_pearson));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, ((PyObject*)__pyx_n_u_pearson))) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, Py_None)) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_method, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_significance_threshold, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_ignore, __pyx_kp_s_Optional_Union_str_list) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_1compute_p_values, 0, __pyx_n_s_compute_p_values, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj_));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_p_values, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj_ = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__152, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_p_values, 97, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj_)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0098</span>:     data, depvar,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0099</span>:     method: str='pearson',</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0100</span>:     significance_threshold: float=0.05,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(100,0,<span class='error_goto'>__PYX_ERR(0, 100, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.05));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-91" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0101</span>:     ignore: Optional [Union [str, list]]=None</pre>
<pre class='cython code score-91 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_depvar)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_p_values", 0, 2, 5, 1); <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_method);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_significance_threshold);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ignore);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_p_values") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_data = values[0];
    __pyx_v_depvar = values[1];
    __pyx_v_method = ((PyObject*)values[2]);
    if (values[3]) {
      __pyx_v_significance_threshold = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_significance_threshold == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 100, __pyx_L3_error)</span>
    } else {
      __pyx_v_significance_threshold = ((double)((double)0.05));
    }
    __pyx_v_ignore = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_p_values", 0, 2, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_p_values", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_method), (&amp;PyUnicode_Type), 0, "method", 1))) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_compute_p_values(__pyx_self, __pyx_v_data, __pyx_v_depvar, __pyx_v_method, __pyx_v_significance_threshold, __pyx_v_ignore);
</pre><pre class="cython line score-0">&#xA0;<span class="">0102</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0103</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0104</span>:     Compute p-values for the correlation between each independent variable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0105</span>:     and a dependent variable.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0106</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0107</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0108</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0109</span>:     data : pandas DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">0110</span>:         The DataFrame containing the dataset.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0111</span>:     depvar : str or pandas Series</pre>
<pre class="cython line score-0">&#xA0;<span class="">0112</span>:         The name of the dependent variable as a string or a pandas Series.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0113</span>:     method : {'pearson', 'spearman', 'kendall'}, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0114</span>:         The correlation method to use. Default is 'pearson'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0115</span>:     significance_threshold : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0116</span>:         The significance threshold for p-values. Default is 0.05.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0117</span>:     ignore : str or list, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0118</span>:         Columns to ignore during computation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0119</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0120</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0121</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0122</span>:     p_values : :class:`gofast.api.summary.ResultSummary` object</pre>
<pre class="cython line score-0">&#xA0;<span class="">0123</span>:         A dictionary containing independent variables as keys and their</pre>
<pre class="cython line score-0">&#xA0;<span class="">0124</span>:         corresponding p-values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0125</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0126</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">0127</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0128</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">0129</span>:         If depvar is not found in DataFrame columns or if an invalid</pre>
<pre class="cython line score-0">&#xA0;<span class="">0130</span>:         correlation method is specified.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0131</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0132</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">0133</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">0134</span>:     - If depvar is a string, it checks whether it exists in the DataFrame's</pre>
<pre class="cython line score-0">&#xA0;<span class="">0135</span>:       columns. If it doesn't exist, it raises a ValueError.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0136</span>:     - The function computes p-values for the specified correlation method</pre>
<pre class="cython line score-0">&#xA0;<span class="">0137</span>:       between each independent variable</pre>
<pre class="cython line score-0">&#xA0;<span class="">0138</span>:       and the dependent variable. It excludes the depvar column from the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0139</span>:       computation if it's in the DataFrame.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0140</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0141</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0142</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0143</span>:     &gt;&gt;&gt; import pandas as pd</pre>
<pre class="cython line score-0">&#xA0;<span class="">0144</span>:     &gt;&gt;&gt; import numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">0145</span>:     &gt;&gt;&gt; from gofast.tools.mathex import compute_p_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">0146</span>:     &gt;&gt;&gt; np.random.seed(0)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0147</span>:     &gt;&gt;&gt; data = pd.DataFrame({</pre>
<pre class="cython line score-0">&#xA0;<span class="">0148</span>:     ...     'x1': np.random.randn(100),</pre>
<pre class="cython line score-0">&#xA0;<span class="">0149</span>:     ...     'x2': np.random.randn(100),</pre>
<pre class="cython line score-0">&#xA0;<span class="">0150</span>:     ...     'y': np.random.randn(100)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0151</span>:     ... })</pre>
<pre class="cython line score-0">&#xA0;<span class="">0152</span>:     &gt;&gt;&gt; p_values = compute_p_values(data, 'y', method='pearson')</pre>
<pre class="cython line score-0">&#xA0;<span class="">0153</span>:     &gt;&gt;&gt; print(p_values )</pre>
<pre class="cython line score-0">&#xA0;<span class="">0154</span>:     P-values(</pre>
<pre class="cython line score-0">&#xA0;<span class="">0155</span>:       {</pre>
<pre class="cython line score-0">&#xA0;<span class="">0156</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0157</span>:            x1 : None</pre>
<pre class="cython line score-0">&#xA0;<span class="">0158</span>:            x2 : None</pre>
<pre class="cython line score-0">&#xA0;<span class="">0159</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0160</span>:       }</pre>
<pre class="cython line score-0">&#xA0;<span class="">0161</span>:     )</pre>
<pre class="cython line score-0">&#xA0;<span class="">0162</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0163</span>:     [ 2 entries ]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0164</span>:     &gt;&gt;&gt; p_values = compute_p_values(data, 'y', method='pearson',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0165</span>:     ...                             significance_threshold=None)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0166</span>:     &gt;&gt;&gt; p_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">0167</span>:     Out[76]: &lt;P-values with 2 entries. Use print() to see detailed contents.&gt;</pre>
<pre class="cython line score-0">&#xA0;<span class="">0168</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0169</span>:     &gt;&gt;&gt; print(p_values)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0170</span>:     P-values(</pre>
<pre class="cython line score-0">&#xA0;<span class="">0171</span>:       {</pre>
<pre class="cython line score-0">&#xA0;<span class="">0172</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0173</span>:            x1 : 0.4516405974318084</pre>
<pre class="cython line score-0">&#xA0;<span class="">0174</span>:            x2 : 0.5797578201347333</pre>
<pre class="cython line score-0">&#xA0;<span class="">0175</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0176</span>:       }</pre>
<pre class="cython line score-0">&#xA0;<span class="">0177</span>:     )</pre>
<pre class="cython line score-0">&#xA0;<span class="">0178</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0179</span>:     [ 2 entries ]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0180</span>:     """</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0181</span>:     if isinstance (data, pd.Series):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(181,0,<span class='error_goto'>__PYX_ERR(0, 181, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 181, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0182</span>:         data = data.to_frame()</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(182,0,<span class='error_goto'>__PYX_ERR(0, 182, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_to_frame);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 182, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 182, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0183</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0184</span>:     if not isinstance (data, pd.DataFrame):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(184,0,<span class='error_goto'>__PYX_ERR(0, 184, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 184, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 184, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_data, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 184, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = (!__pyx_t_3);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0185</span>:         raise TypeError(f"'data' should be a frame, not {type(data).__name__!r}")</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(185,0,<span class='error_goto'>__PYX_ERR(0, 185, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)Py_TYPE(__pyx_v_data)), __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Repr</span>(__pyx_t_1), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_data_should_be_a_frame_not, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 185, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0186</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0187</span>:     if isinstance (depvar, str):</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(187,0,<span class='error_goto'>__PYX_ERR(0, 187, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_depvar); 
  if (__pyx_t_6) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0188</span>:         if depvar not in data.columns:</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(188,0,<span class='error_goto'>__PYX_ERR(0, 188, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 188, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_depvar, __pyx_t_2, Py_NE)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(__pyx_t_6)) {
/* … */
    }
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0189</span>:             raise ValueError(f"'{depvar}' not found in DataFrame columns.")</pre>
<pre class='cython code score-27 '>      <span class='trace'>__Pyx_TraceLine</span>(189,0,<span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = 0;
      __pyx_t_8 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__2);
      __pyx_t_7 += 1;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u__2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_depvar, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_8) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_8;
      __pyx_t_7 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
      __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_not_found_in_DataFrame_columns);
      __pyx_t_7 += 33;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_not_found_in_DataFrame_columns);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_not_found_in_DataFrame_columns);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 3, __pyx_t_7, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L1_error)</span>
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0190</span>:         depvar = data[depvar]</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(190,0,<span class='error_goto'>__PYX_ERR(0, 190, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_data, __pyx_v_depvar);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 190, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_depvar, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0191</span>:         data = data.drop(columns=depvar.name)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(191,0,<span class='error_goto'>__PYX_ERR(0, 191, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_drop);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 191, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 191, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_depvar, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 191, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_columns, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 191, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 191, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0192</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0193</span>:     elif hasattr (depvar, '__array__'):</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(193,0,<span class='error_goto'>__PYX_ERR(0, 193, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(__pyx_v_depvar, __pyx_n_u_array);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 193, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/* … */
  }
  __pyx_L5:;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0194</span>:         depvar = depvar.squeeze ()</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(194,0,<span class='error_goto'>__PYX_ERR(0, 194, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_depvar, __pyx_n_s_squeeze);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 194, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 194, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_depvar, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0195</span>:         if depvar.ndim ==2:</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(195,0,<span class='error_goto'>__PYX_ERR(0, 195, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_depvar, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_4, __pyx_int_2, 2, 0)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 195, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(__pyx_t_6)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0196</span>:             raise TypeError ("Dependent variable 'depvar' should be Series or"</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(196,0,<span class='error_goto'>__PYX_ERR(0, 196, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 196, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Dependent_variable_depvar_should);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 196, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class="cython line score-0">&#xA0;<span class="">0197</span>:                              " one-dimensional array, not a two-dimensional.")</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0198</span>:         if not isinstance (depvar, pd.Series):</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(198,0,<span class='error_goto'>__PYX_ERR(0, 198, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_depvar, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 198, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_3 = (!__pyx_t_6);
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0199</span>:             depvar = pd.Series ( depvar, name = 'depvar')</pre>
<pre class='cython code score-26 '>      <span class='trace'>__Pyx_TraceLine</span>(199,0,<span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_depvar);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_depvar);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_depvar)) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_name_2, __pyx_n_u_depvar) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 199, __pyx_L1_error)</span>
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 199, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_depvar, __pyx_t_9);
      __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0200</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0201</span>:     if ignore is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(201,0,<span class='error_goto'>__PYX_ERR(0, 201, __pyx_L1_error)</span>)
  __pyx_t_3 = (__pyx_v_ignore != Py_None);
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0202</span>:         if isinstance ( ignore, str):</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(202,0,<span class='error_goto'>__PYX_ERR(0, 202, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_ignore); 
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0203</span>:             ignore =[ignore]</pre>
<pre class='cython code score-9 '>      <span class='trace'>__Pyx_TraceLine</span>(203,0,<span class='error_goto'>__PYX_ERR(0, 203, __pyx_L1_error)</span>)
      __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 203, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ignore);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ignore);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_ignore)) <span class='error_goto'>__PYX_ERR(0, 203, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ignore, __pyx_t_9);
      __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0204</span>:         # check whether column is in data</pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0205</span>:         column2ignore = [ col for col in ignore if col in data.columns]</pre>
<pre class='cython code score-63 '>    <span class='trace'>__Pyx_TraceLine</span>(205,0,<span class='error_goto'>__PYX_ERR(0, 205, __pyx_L1_error)</span>)
    { /* enter inner scope */
      __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 205, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_ignore)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_ignore)) {
        __pyx_t_2 = __pyx_v_ignore; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        __pyx_t_7 = 0;
        __pyx_t_10 = NULL;
      } else {
        __pyx_t_7 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_ignore);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 205, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 205, __pyx_L13_error)</span>
      }
      for (;;) {
        if (likely(!__pyx_t_10)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L13_error)</span>
              #endif
              if (__pyx_t_7 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L13_error)</span>
            #else
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 205, __pyx_L13_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            #endif
          } else {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L13_error)</span>
              #endif
              if (__pyx_t_7 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L13_error)</span>
            #else
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 205, __pyx_L13_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            #endif
          }
        } else {
          __pyx_t_1 = __pyx_t_10(__pyx_t_2);
          if (unlikely(!__pyx_t_1)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L13_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_7genexpr__pyx_v_col, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 205, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_7genexpr__pyx_v_col, __pyx_t_1, Py_EQ)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L13_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (__pyx_t_3) {
          if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_9, (PyObject*)__pyx_7genexpr__pyx_v_col))) <span class='error_goto'>__PYX_ERR(0, 205, __pyx_L13_error)</span>
        }
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_col); __pyx_7genexpr__pyx_v_col = 0;
      goto __pyx_L18_exit_scope;
      __pyx_L13_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_7genexpr__pyx_v_col); __pyx_7genexpr__pyx_v_col = 0;
      goto __pyx_L1_error;
      __pyx_L18_exit_scope:;
    } /* exit inner scope */
    __pyx_v_column2ignore = ((PyObject*)__pyx_t_9);
    __pyx_t_9 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0206</span>:         data = data.drop (columns= column2ignore)</pre>
<pre class='cython code score-14 '>    <span class='trace'>__Pyx_TraceLine</span>(206,0,<span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>)
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_drop);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_columns, __pyx_v_column2ignore) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 206, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0207</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0208</span>:     check_consistent_length(data, depvar)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(208,0,<span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_check_consistent_length);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 208, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_9, __pyx_v_data, __pyx_v_depvar};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 208, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0209</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0210</span>:     corr_methods = {</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0211</span>:         'pearson': pearsonr,</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(211,0,<span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 211, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pearsonr);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 211, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_pearson, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0212</span>:         'spearman': spearmanr,</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(212,0,<span class='error_goto'>__PYX_ERR(0, 212, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_spearmanr);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_spearman, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0213</span>:         'kendall': kendalltau</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(213,0,<span class='error_goto'>__PYX_ERR(0, 213, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_kendalltau);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 213, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_kendall, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 211, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_corr_methods = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0214</span>:     }</pre>
<pre class="cython line score-0">&#xA0;<span class="">0215</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0216</span>:     # Select only numeric columns</pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0217</span>:     data = data.select_dtypes([np.number])</pre>
<pre class='cython code score-30 '>  <span class='trace'>__Pyx_TraceLine</span>(217,0,<span class='error_goto'>__PYX_ERR(0, 217, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_select_dtypes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 217, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 217, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_number);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 217, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 217, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 217, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_9};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 217, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0218</span>:     if data.empty:</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(218,0,<span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 218, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 218, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0219</span>:         raise ValueError("P-value calculations expect numeric data, but"</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(219,0,<span class='error_goto'>__PYX_ERR(0, 219, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 219, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 219, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_P_value_calculations_expect_nume);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 219, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
</pre><pre class="cython line score-0">&#xA0;<span class="">0220</span>:                          " the DataFrame contains no numeric data.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0221</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0222</span>:     if method not in corr_methods:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(222,0,<span class='error_goto'>__PYX_ERR(0, 222, __pyx_L1_error)</span>)
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyDict_ContainsTF</span>(__pyx_v_method, __pyx_v_corr_methods, Py_NE)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 222, __pyx_L1_error)</span>
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0223</span>:         raise ValueError("Invalid correlation method. Supported methods:"</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(223,0,<span class='error_goto'>__PYX_ERR(0, 223, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 223, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Invalid_correlation_method_Suppo);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 223, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
</pre><pre class="cython line score-0">&#xA0;<span class="">0224</span>:                          " 'pearson', 'spearman', 'kendall'.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0225</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0226</span>:     p_values = {}</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(226,0,<span class='error_goto'>__PYX_ERR(0, 226, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_p_values = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0227</span>:     for column in data.columns:</pre>
<pre class='cython code score-52 '>  <span class='trace'>__Pyx_TraceLine</span>(227,0,<span class='error_goto'>__PYX_ERR(0, 227, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 227, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_t_7 = 0;
    __pyx_t_10 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 227, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 227, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_10)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 227, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_7 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 227, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 227, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 227, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_7 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 227, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 227, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_10(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 227, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_column, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(227,0,<span class='error_goto'>__PYX_ERR(0, 227, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0228</span>:         if column != depvar.name and (ignore is None or column not in ignore):</pre>
<pre class='cython code score-13 '>    <span class='trace'>__Pyx_TraceLine</span>(228,0,<span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_depvar, __pyx_n_s_name_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_9 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_column, __pyx_t_1, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_9); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (__pyx_t_6) {
    } else {
      __pyx_t_3 = __pyx_t_6;
      goto __pyx_L24_bool_binop_done;
    }
    __pyx_t_6 = (__pyx_v_ignore == Py_None);
    if (!__pyx_t_6) {
    } else {
      __pyx_t_3 = __pyx_t_6;
      goto __pyx_L24_bool_binop_done;
    }
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_column, __pyx_v_ignore, Py_NE)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 228, __pyx_L1_error)</span>
    __pyx_t_3 = __pyx_t_6;
    __pyx_L24_bool_binop_done:;
    if (__pyx_t_3) {
/* … */
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0229</span>:             corr_func = corr_methods[method]</pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(229,0,<span class='error_goto'>__PYX_ERR(0, 229, __pyx_L1_error)</span>)
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_corr_methods, __pyx_v_method);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 229, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_corr_func, __pyx_t_9);
      __pyx_t_9 = 0;
</pre><pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0230</span>:             corr, p_value = corr_func(data[column], depvar)</pre>
<pre class='cython code score-66 '>      <span class='trace'>__Pyx_TraceLine</span>(230,0,<span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_data, __pyx_v_column);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 230, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_corr_func);
      __pyx_t_4 = __pyx_v_corr_func; __pyx_t_11 = NULL;
      __pyx_t_5 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_5 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_11, __pyx_t_1, __pyx_v_depvar};
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_9))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
        PyObject* sequence = __pyx_t_9;
        Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 230, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 230, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_11 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 230, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_11);
        index = 0; __pyx_t_4 = __pyx_t_12(__pyx_t_11); if (unlikely(!__pyx_t_4)) goto __pyx_L27_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        index = 1; __pyx_t_1 = __pyx_t_12(__pyx_t_11); if (unlikely(!__pyx_t_1)) goto __pyx_L27_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_11), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>
        __pyx_t_12 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        goto __pyx_L28_unpacking_done;
        __pyx_L27_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        __pyx_t_12 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>__PYX_ERR(0, 230, __pyx_L1_error)</span>
        __pyx_L28_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_corr, __pyx_t_4);
      __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_p_value, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0231</span>:             if significance_threshold:</pre>
<pre class='cython code score-0 '>      <span class='trace'>__Pyx_TraceLine</span>(231,0,<span class='error_goto'>__PYX_ERR(0, 231, __pyx_L1_error)</span>)
      __pyx_t_3 = (__pyx_v_significance_threshold != 0);
      if (__pyx_t_3) {
/* … */
        goto __pyx_L29;
      }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0232</span>:                 p_values[column] = (</pre>
<pre class='cython code score-6 '>        <span class='trace'>__Pyx_TraceLine</span>(232,0,<span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>)
        if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_p_values, __pyx_v_column, __pyx_t_9) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 232, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0233</span>:                     p_value if p_value &lt;= significance_threshold else "reject"</pre>
<pre class='cython code score-16 '>        <span class='trace'>__Pyx_TraceLine</span>(233,0,<span class='error_goto'>__PYX_ERR(0, 233, __pyx_L1_error)</span>)
        __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_significance_threshold);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 233, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_p_value, __pyx_t_1, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 233, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 233, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (__pyx_t_3) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_p_value);
          __pyx_t_9 = __pyx_v_p_value;
        } else {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_reject);
          __pyx_t_9 = __pyx_n_u_reject;
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">0234</span>:                     )</pre>
<pre class="cython line score-0">&#xA0;<span class="">0235</span>:             else:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0236</span>:                 p_values[column] = p_value</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(236,0,<span class='error_goto'>__PYX_ERR(0, 236, __pyx_L1_error)</span>)
      /*else*/ {
        if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_p_values, __pyx_v_column, __pyx_v_p_value) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 236, __pyx_L1_error)</span>
      }
      __pyx_L29:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0237</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0238</span>:     p_values = ResultSummary("P-values").add_results(p_values)</pre>
<pre class='cython code score-34 '>  <span class='trace'>__Pyx_TraceLine</span>(238,0,<span class='error_goto'>__PYX_ERR(0, 238, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_ResultSummary);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_kp_u_P_values};
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 238, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_add_results);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_v_p_values};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 238, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_p_values, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0239</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0240</span>:     return p_values</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(240,0,<span class='error_goto'>__PYX_ERR(0, 240, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_p_values);
  __pyx_r = __pyx_v_p_values;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0241</span>: </pre>
<pre class="cython line score-113" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0242</span>: def compute_balance_accuracy(</pre>
<pre class='cython code score-113 '>static PyObject *__pyx_pf_6gofast_5tools_6mathex_134__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("__defaults__", __pyx_f[0], 242, 0, <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(242,0,<span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_zero_division);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_zero_division);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self)-&gt;__pyx_arg_zero_division)) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_ovr));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_ovr));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject*)__pyx_n_u_ovr))) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 3, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 4, Py_None)) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_3compute_balance_accuracy(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_2compute_balance_accuracy, "\n    Compute the balanced accuracy for binary or multiclass classification \n    problems, determining the appropriate calculation method based on the \n    label type and specified strategy.\n\n    Parameters\n    ----------\n    y_true : array-like of shape (n_samples,)\n        True labels for the classification task.\n    y_pred : array-like of shape (n_samples,)\n        Predicted labels from the classifier.\n    epsilon : float, default=1e-15\n        A small constant added to the denominator in calculations to prevent\n        division by zero.\n    zero_division : int, default=0\n        The value to return when a zero division occurs during calculation, \n        typically encountered when a class is missing in the predictions.\n    strategy : {'ovr', 'ovo'}, default='ovr'\n        Strategy for handling multiclass classification:\n        - 'ovr': One-vs-Rest, calculates balanced accuracy for each class\n          against all others.\n        - 'ovo': One-vs-One, calculates balanced accuracy for each pair \n          of classes.\n    normalize : bool, default=False\n        If True, normalizes the confusion matrix before calculating the \n        balanced accuracy.\n    sample_weight : array-like of shape (n_samples,), optional\n        Weights for each sample. If provided, the calculation will take \n        these into account.\n\n    Returns\n    -------\n    float or np.ndarray\n        The balanced accuracy score. Returns a single float for binary \n        classification or an array of scores for multiclass classification, \n        depending on the strategy.\n\n    Notes\n    -----\n    Balanced accuracy is particularly useful for evaluating classifiers \n    on imbalanced datasets. It calculates the average of recall obtained on \n    each class, effectively handling classes without bias.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import compute_balance_accuracy\n    &gt;&gt;&gt; y_true = [0, 1, 1, 0, 1]\n    &gt;&gt;&gt; y_pred = [0, 1, 0, 0, 1]""\n    &gt;&gt;&gt; compute_balance_accuracy(y_true, y_pred)\n    0.833333333333333\n\n    For multiclass using One-vs-Rest strategy:\n    &gt;&gt;&gt; y_true = [0, 1, 2, 0, 1]\n    &gt;&gt;&gt; y_pred = [0, 2, 1, 0, 1]\n    &gt;&gt;&gt; compute_balance_accuracy(y_true, y_pred, strategy='ovr')\n    array([1.        , 0.58333333, 0.375     ])\n\n    For multiclass using One-vs-One strategy:\n    &gt;&gt;&gt; compute_balance_accuracy(y_true, y_pred, strategy='ovo')\n    array([1.        , 0.16666667, 0.16666667])\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_3compute_balance_accuracy = {"compute_balance_accuracy", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_3compute_balance_accuracy, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_2compute_balance_accuracy};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_3compute_balance_accuracy(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  double __pyx_v_epsilon;
  PyObject *__pyx_v_zero_division = 0;
  PyObject *__pyx_v_strategy = 0;
  PyObject *__pyx_v_normalize = 0;
  PyObject *__pyx_v_sample_weight = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_balance_accuracy (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_epsilon,&amp;__pyx_n_s_zero_division,&amp;__pyx_n_s_strategy,&amp;__pyx_n_s_normalize,&amp;__pyx_n_s_sample_weight,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
    __pyx_defaults *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_self);
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_zero_division);
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_ovr)));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_2compute_balance_accuracy(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, double __pyx_v_epsilon, PyObject *__pyx_v_zero_division, PyObject *__pyx_v_strategy, PyObject *__pyx_v_normalize, PyObject *__pyx_v_sample_weight) {
  PyObject *__pyx_v_labels = NULL;
  PyObject *__pyx_v_scores = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__6)
  <span class='trace'>__Pyx_TraceCall</span>("compute_balance_accuracy", __pyx_f[0], 242, 0, <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_strategy);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_balance_accuracy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_labels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_scores);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_strategy);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__153 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_epsilon, __pyx_n_s_zero_division, __pyx_n_s_strategy, __pyx_n_s_normalize, __pyx_n_s_sample_weight, __pyx_n_s_labels, __pyx_n_s_scores);<span class='error_goto'> if (unlikely(!__pyx_tuple__153)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__153);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__153);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(242,0,<span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_epsilon, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_zero_division, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_strategy, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_normalize, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_sample_weight, __pyx_kp_s_Optional_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_3compute_balance_accuracy, 0, __pyx_n_s_compute_balance_accuracy, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__6));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_2, sizeof(__pyx_defaults), 1)) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
  __pyx_codeobj__6 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__153, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_balance_accuracy, 242, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__6)) __PYX_ERR(0, 242, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0243</span>:     y_true, y_pred,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0244</span>:     epsilon:float=1e-15,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(244,0,<span class='error_goto'>__PYX_ERR(0, 244, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)1e-15));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0245</span>:     zero_division: int=0,</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(245,0,<span class='error_goto'>__PYX_ERR(0, 245, __pyx_L1_error)</span>)
  if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_0)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_0))) <span class='error_goto'>__PYX_ERR(0, 245, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults, __pyx_t_2)-&gt;__pyx_arg_zero_division = ((PyObject*)__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_2, __pyx_pf_6gofast_5tools_6mathex_134__defaults__);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_balance_accuracy, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0246</span>:     strategy: str="ovr",</pre>
<pre class="cython line score-0">&#xA0;<span class="">0247</span>:     normalize: bool=False,</pre>
<pre class="cython line score-119" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0248</span>:     sample_weight:Optional[ArrayLike]=None):</pre>
<pre class='cython code score-119 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_balance_accuracy", 0, 2, 7, 1); <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_epsilon);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zero_division);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_strategy);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_normalize);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sample_weight);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_balance_accuracy") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    if (values[2]) {
      __pyx_v_epsilon = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_epsilon == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 244, __pyx_L3_error)</span>
    } else {
      __pyx_v_epsilon = ((double)((double)1e-15));
    }
    __pyx_v_zero_division = ((PyObject*)values[3]);
    __pyx_v_strategy = ((PyObject*)values[4]);
    __pyx_v_normalize = values[5];
    __pyx_v_sample_weight = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_balance_accuracy", 0, 2, 7, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 242, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_balance_accuracy", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_zero_division), (&amp;PyInt_Type), 0, "zero_division", 1))) <span class='error_goto'>__PYX_ERR(0, 245, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_strategy), (&amp;PyUnicode_Type), 0, "strategy", 1))) <span class='error_goto'>__PYX_ERR(0, 246, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_2compute_balance_accuracy(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_epsilon, __pyx_v_zero_division, __pyx_v_strategy, __pyx_v_normalize, __pyx_v_sample_weight);
</pre><pre class="cython line score-0">&#xA0;<span class="">0249</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0250</span>:     Compute the balanced accuracy for binary or multiclass classification</pre>
<pre class="cython line score-0">&#xA0;<span class="">0251</span>:     problems, determining the appropriate calculation method based on the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0252</span>:     label type and specified strategy.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0253</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0254</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0255</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0256</span>:     y_true : array-like of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0257</span>:         True labels for the classification task.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0258</span>:     y_pred : array-like of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0259</span>:         Predicted labels from the classifier.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0260</span>:     epsilon : float, default=1e-15</pre>
<pre class="cython line score-0">&#xA0;<span class="">0261</span>:         A small constant added to the denominator in calculations to prevent</pre>
<pre class="cython line score-0">&#xA0;<span class="">0262</span>:         division by zero.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0263</span>:     zero_division : int, default=0</pre>
<pre class="cython line score-0">&#xA0;<span class="">0264</span>:         The value to return when a zero division occurs during calculation,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0265</span>:         typically encountered when a class is missing in the predictions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0266</span>:     strategy : {'ovr', 'ovo'}, default='ovr'</pre>
<pre class="cython line score-0">&#xA0;<span class="">0267</span>:         Strategy for handling multiclass classification:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0268</span>:         - 'ovr': One-vs-Rest, calculates balanced accuracy for each class</pre>
<pre class="cython line score-0">&#xA0;<span class="">0269</span>:           against all others.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0270</span>:         - 'ovo': One-vs-One, calculates balanced accuracy for each pair</pre>
<pre class="cython line score-0">&#xA0;<span class="">0271</span>:           of classes.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0272</span>:     normalize : bool, default=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">0273</span>:         If True, normalizes the confusion matrix before calculating the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0274</span>:         balanced accuracy.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0275</span>:     sample_weight : array-like of shape (n_samples,), optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0276</span>:         Weights for each sample. If provided, the calculation will take</pre>
<pre class="cython line score-0">&#xA0;<span class="">0277</span>:         these into account.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0278</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0279</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0280</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0281</span>:     float or np.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">0282</span>:         The balanced accuracy score. Returns a single float for binary</pre>
<pre class="cython line score-0">&#xA0;<span class="">0283</span>:         classification or an array of scores for multiclass classification,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0284</span>:         depending on the strategy.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0285</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0286</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">0287</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">0288</span>:     Balanced accuracy is particularly useful for evaluating classifiers</pre>
<pre class="cython line score-0">&#xA0;<span class="">0289</span>:     on imbalanced datasets. It calculates the average of recall obtained on</pre>
<pre class="cython line score-0">&#xA0;<span class="">0290</span>:     each class, effectively handling classes without bias.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0291</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0292</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0293</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0294</span>:     &gt;&gt;&gt; from gofast.tools.mathex import compute_balance_accuracy</pre>
<pre class="cython line score-0">&#xA0;<span class="">0295</span>:     &gt;&gt;&gt; y_true = [0, 1, 1, 0, 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0296</span>:     &gt;&gt;&gt; y_pred = [0, 1, 0, 0, 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0297</span>:     &gt;&gt;&gt; compute_balance_accuracy(y_true, y_pred)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0298</span>:     0.833333333333333</pre>
<pre class="cython line score-0">&#xA0;<span class="">0299</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0300</span>:     For multiclass using One-vs-Rest strategy:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0301</span>:     &gt;&gt;&gt; y_true = [0, 1, 2, 0, 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0302</span>:     &gt;&gt;&gt; y_pred = [0, 2, 1, 0, 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0303</span>:     &gt;&gt;&gt; compute_balance_accuracy(y_true, y_pred, strategy='ovr')</pre>
<pre class="cython line score-0">&#xA0;<span class="">0304</span>:     array([1.        , 0.58333333, 0.375     ])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0305</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0306</span>:     For multiclass using One-vs-One strategy:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0307</span>:     &gt;&gt;&gt; compute_balance_accuracy(y_true, y_pred, strategy='ovo')</pre>
<pre class="cython line score-0">&#xA0;<span class="">0308</span>:     array([1.        , 0.16666667, 0.16666667])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0309</span>:     """</pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0310</span>:     y_true, y_pred = _ensure_y_is_valid(y_true, y_pred, y_numeric=True)</pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(310,0,<span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_ensure_y_is_valid);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_numeric, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
    index = 0; __pyx_t_3 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 310, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0311</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0312</span>:     # Check whether y_true is binary and compute balanced accuracy accordingly</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0313</span>:     if is_binary_class(y_true):</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(313,0,<span class='error_goto'>__PYX_ERR(0, 313, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_is_binary_class);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 313, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_true};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 313, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 313, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0314</span>:         return _compute_balanced_accuracy_binary(</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(314,0,<span class='error_goto'>__PYX_ERR(0, 314, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_compute_balanced_accuracy_binar);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(314,0,<span class='error_goto'>__PYX_ERR(0, 314, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0315</span>:             y_true=y_true, y_pred=y_pred,</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(315,0,<span class='error_goto'>__PYX_ERR(0, 315, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 315, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_y_true, __pyx_v_y_true) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_y_pred, __pyx_v_y_pred) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0316</span>:             zero_division=zero_division,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(316,0,<span class='error_goto'>__PYX_ERR(0, 316, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_zero_division, __pyx_v_zero_division) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0317</span>:             normalize=normalize,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(317,0,<span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_normalize, __pyx_v_normalize) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0318</span>:             sample_weight=sample_weight)</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(318,0,<span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0319</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0320</span>:     # Validate the strategy parameter</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0321</span>:     strategy = parameter_validator(</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(321,0,<span class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_parameter_validator);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(321,0,<span class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__7, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_strategy);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0322</span>:         "strategy", target_strs={"ovr", "ovo"})(strategy)</pre>
<pre class='cython code score-45 '>  <span class='trace'>__Pyx_TraceLine</span>(322,0,<span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PySet_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_1, __pyx_n_u_ovr) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_1, __pyx_n_u_ovo) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_target_strs, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(322,0,<span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>)
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_strategy};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  if (!(likely(<span class='py_c_api'>PyUnicode_CheckExact</span>(__pyx_t_3))||((__pyx_t_3) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("unicode", __pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_strategy, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0323</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0324</span>:     labels = unique_labels(y_true, y_pred)</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(324,0,<span class='error_goto'>__PYX_ERR(0, 324, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_unique_labels);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_v_y_true, __pyx_v_y_pred};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_v_labels = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0325</span>:     labels = np.unique(np.concatenate([y_true, y_pred]))</pre>
<pre class='cython code score-52 '>  <span class='trace'>__Pyx_TraceLine</span>(325,0,<span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_unique);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>;
  __pyx_t_9 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  __pyx_t_8 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_t_1};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_labels, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0326</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0327</span>:     # Compute balanced accuracy based on the specified strategy</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0328</span>:     if strategy == 'ovr':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(328,0,<span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>)
  __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_strategy, __pyx_n_u_ovr, Py_EQ)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 328, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0329</span>:         scores = _balanced_accuracy_ovr(</pre>
<pre class='cython code score-6 '>    <span class='trace'>__Pyx_TraceLine</span>(329,0,<span class='error_goto'>__PYX_ERR(0, 329, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_balanced_accuracy_ovr);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(329,0,<span class='error_goto'>__PYX_ERR(0, 329, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_scores = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0330</span>:             y_true=y_true, y_pred=y_pred,</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(330,0,<span class='error_goto'>__PYX_ERR(0, 330, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_y_true, __pyx_v_y_true) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 330, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_y_pred, __pyx_v_y_pred) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 330, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0331</span>:             labels=labels,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(331,0,<span class='error_goto'>__PYX_ERR(0, 331, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_labels, __pyx_v_labels) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 330, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0332</span>:             epsilon=epsilon,</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(332,0,<span class='error_goto'>__PYX_ERR(0, 332, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_epsilon, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 330, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0333</span>:             zero_division=zero_division,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(333,0,<span class='error_goto'>__PYX_ERR(0, 333, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_zero_division, __pyx_v_zero_division) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 330, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0334</span>:             normalize=normalize,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(334,0,<span class='error_goto'>__PYX_ERR(0, 334, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_normalize, __pyx_v_normalize) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 330, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0335</span>:             sample_weight=sample_weight)</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(335,0,<span class='error_goto'>__PYX_ERR(0, 335, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 330, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0336</span>:     elif strategy == 'ovo':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(336,0,<span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>)
  __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_strategy, __pyx_n_u_ovo, Py_EQ)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
  }
  __pyx_L6:;
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0337</span>:         labels = np.unique(np.concatenate([y_true, y_pred]))</pre>
<pre class='cython code score-52 '>    <span class='trace'>__Pyx_TraceLine</span>(337,0,<span class='error_goto'>__PYX_ERR(0, 337, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_unique);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 337, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 337, __pyx_L1_error)</span>;
    __pyx_t_9 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_8};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 337, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 337, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_labels, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0338</span>:         scores = _balanced_accuracy_ovo(</pre>
<pre class='cython code score-6 '>    <span class='trace'>__Pyx_TraceLine</span>(338,0,<span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_balanced_accuracy_ovo);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(338,0,<span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_scores = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0339</span>:             y_true=y_true, y_pred=y_pred,</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(339,0,<span class='error_goto'>__PYX_ERR(0, 339, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 339, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_true, __pyx_v_y_true) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 339, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_pred, __pyx_v_y_pred) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 339, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0340</span>:             labels=labels, sample_weight=sample_weight)</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(340,0,<span class='error_goto'>__PYX_ERR(0, 340, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_labels, __pyx_v_labels) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 339, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 339, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0341</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0342</span>:     return scores</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(342,0,<span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_scores)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("scores"); <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_scores);
  __pyx_r = __pyx_v_scores;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0343</span>: </pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0344</span>: def _compute_balanced_accuracy_binary(</pre>
<pre class='cython code score-46 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_5_compute_balanced_accuracy_binary(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_5_compute_balanced_accuracy_binary = {"_compute_balanced_accuracy_binary", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_5_compute_balanced_accuracy_binary, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_5_compute_balanced_accuracy_binary(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_epsilon = 0;
  PyObject *__pyx_v_zero_division = 0;
  PyObject *__pyx_v_normalize = 0;
  PyObject *__pyx_v_sample_weight = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_compute_balanced_accuracy_binary (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_epsilon,&amp;__pyx_n_s_zero_division,&amp;__pyx_n_s_normalize,&amp;__pyx_n_s_sample_weight,0};
  PyObject* values[6] = {0,0,0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_15)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_0)));
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_4_compute_balanced_accuracy_binary(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_epsilon, PyObject *__pyx_v_zero_division, PyObject *__pyx_v_normalize, PyObject *__pyx_v_sample_weight) {
  PyObject *__pyx_v_cm = NULL;
  PyObject *__pyx_v_sensitivity = NULL;
  PyObject *__pyx_v_specificity = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__8)
  <span class='trace'>__Pyx_TraceCall</span>("_compute_balanced_accuracy_binary", __pyx_f[0], 344, 0, <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._compute_balanced_accuracy_binary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cm);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sensitivity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_specificity);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__154 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_epsilon, __pyx_n_s_zero_division, __pyx_n_s_normalize, __pyx_n_s_sample_weight, __pyx_n_s_cm, __pyx_n_s_sensitivity, __pyx_n_s_specificity);<span class='error_goto'> if (unlikely(!__pyx_tuple__154)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__154);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__154);
  __pyx_codeobj__8 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__154, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_balanced_accuracy_binar, 344, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__8)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(344,0,<span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_5_compute_balanced_accuracy_binary, 0, __pyx_n_s_compute_balanced_accuracy_binar, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__8));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__155);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_balanced_accuracy_binar, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__155 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject*)__pyx_float_1eneg_15), ((PyObject *)__pyx_int_0), ((PyObject *)Py_False), Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__155)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__155);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__155);
</pre><pre class="cython line score-0">&#xA0;<span class="">0345</span>:     y_true, y_pred, epsilon=1e-15,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0346</span>:     zero_division=0, normalize =False,</pre>
<pre class='cython code score-2 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-92" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0347</span>:     sample_weight=None</pre>
<pre class='cython code score-92 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_balanced_accuracy_binary", 0, 2, 6, 1); <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_epsilon);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zero_division);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_normalize);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sample_weight);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_compute_balanced_accuracy_binary") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_epsilon = values[2];
    __pyx_v_zero_division = values[3];
    __pyx_v_normalize = values[4];
    __pyx_v_sample_weight = values[5];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_balanced_accuracy_binary", 0, 2, 6, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._compute_balanced_accuracy_binary", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_4_compute_balanced_accuracy_binary(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_epsilon, __pyx_v_zero_division, __pyx_v_normalize, __pyx_v_sample_weight);
</pre><pre class="cython line score-0">&#xA0;<span class="">0348</span>:     ):</pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0349</span>:     cm = confusion_matrix(y_true, y_pred, sample_weight=sample_weight )</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(349,0,<span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_confusion_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 349, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_cm = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0350</span>:     if normalize:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(350,0,<span class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_normalize); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0351</span>:         cm = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]</pre>
<pre class='cython code score-58 '>    <span class='trace'>__Pyx_TraceLine</span>(351,0,<span class='error_goto'>__PYX_ERR(0, 351, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_cm, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 351, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_n_u_float};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 351, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_cm, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 351, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 351, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 351, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 351, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 351, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_newaxis);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 351, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 351, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 351, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 351, __pyx_L1_error)</span>;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 351, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 351, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_cm, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
  __pyx_slice__9 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__9)) __PYX_ERR(0, 351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0352</span>:     sensitivity = cm[1, 1] / (cm[1, 1] + cm[1, 0] + epsilon)</pre>
<pre class='cython code score-33 '>  <span class='trace'>__Pyx_TraceLine</span>(352,0,<span class='error_goto'>__PYX_ERR(0, 352, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_tuple__10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_tuple__10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_tuple__11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_sensitivity = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_1, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0353</span>:     specificity = cm[0, 0] / (cm[0, 0] + cm[0, 1] + epsilon)</pre>
<pre class='cython code score-33 '>  <span class='trace'>__Pyx_TraceLine</span>(353,0,<span class='error_goto'>__PYX_ERR(0, 353, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_tuple__12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_tuple__12);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_0);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_tuple__13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_specificity = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0354</span>:     return (sensitivity + specificity) / 2  if not np.isnan(</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(354,0,<span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(354,0,<span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_8 = (!__pyx_t_5);
  if (__pyx_t_8) {
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_sensitivity, __pyx_v_specificity);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_TrueDivideObjC</span>(__pyx_t_2, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_3 = __pyx_t_4;
    __pyx_t_4 = 0;
  } else {
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0355</span>:         sensitivity + specificity) else zero_division</pre>
<pre class='cython code score-21 '>  <span class='trace'>__Pyx_TraceLine</span>(355,0,<span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_sensitivity, __pyx_v_specificity);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_1};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(355,0,<span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_zero_division);
    __pyx_t_3 = __pyx_v_zero_division;
  }
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0356</span>: </pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0357</span>: def _balanced_accuracy_ovr(</pre>
<pre class='cython code score-43 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_7_balanced_accuracy_ovr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_7_balanced_accuracy_ovr = {"_balanced_accuracy_ovr", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_7_balanced_accuracy_ovr, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_7_balanced_accuracy_ovr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_labels = 0;
  PyObject *__pyx_v_epsilon = 0;
  PyObject *__pyx_v_zero_division = 0;
  PyObject *__pyx_v_normalize = 0;
  PyObject *__pyx_v_sample_weight = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_balanced_accuracy_ovr (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_labels,&amp;__pyx_n_s_epsilon,&amp;__pyx_n_s_zero_division,&amp;__pyx_n_s_normalize,&amp;__pyx_n_s_sample_weight,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_15)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_0)));
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_6_balanced_accuracy_ovr(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_labels, PyObject *__pyx_v_epsilon, PyObject *__pyx_v_zero_division, PyObject *__pyx_v_normalize, PyObject *__pyx_v_sample_weight) {
  PyObject *__pyx_v_bal_acc_scores = NULL;
  PyObject *__pyx_v_label = NULL;
  PyObject *__pyx_v_binary_y_true = NULL;
  PyObject *__pyx_v_binary_y_pred = NULL;
  PyObject *__pyx_v_score = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__14)
  <span class='trace'>__Pyx_TraceCall</span>("_balanced_accuracy_ovr", __pyx_f[0], 357, 0, <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._balanced_accuracy_ovr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bal_acc_scores);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_label);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_binary_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_binary_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_score);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__156 = <span class='py_c_api'>PyTuple_Pack</span>(12, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_labels, __pyx_n_s_epsilon, __pyx_n_s_zero_division, __pyx_n_s_normalize, __pyx_n_s_sample_weight, __pyx_n_s_bal_acc_scores, __pyx_n_s_label, __pyx_n_s_binary_y_true, __pyx_n_s_binary_y_pred, __pyx_n_s_score);<span class='error_goto'> if (unlikely(!__pyx_tuple__156)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__156);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__156);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(357,0,<span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_7_balanced_accuracy_ovr, 0, __pyx_n_s_balanced_accuracy_ovr, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__14));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__155);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_balanced_accuracy_ovr, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__14 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__156, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_balanced_accuracy_ovr, 357, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0358</span>:     y_true, y_pred, labels, epsilon=1e-15,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0359</span>:     zero_division=0, normalize=False,</pre>
<pre class='cython code score-2 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-107" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0360</span>:     sample_weight =None</pre>
<pre class='cython code score-107 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_balanced_accuracy_ovr", 0, 3, 7, 1); <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_labels)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_balanced_accuracy_ovr", 0, 3, 7, 2); <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_epsilon);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_zero_division);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_normalize);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sample_weight);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_balanced_accuracy_ovr") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_labels = values[2];
    __pyx_v_epsilon = values[3];
    __pyx_v_zero_division = values[4];
    __pyx_v_normalize = values[5];
    __pyx_v_sample_weight = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_balanced_accuracy_ovr", 0, 3, 7, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._balanced_accuracy_ovr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_6_balanced_accuracy_ovr(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_labels, __pyx_v_epsilon, __pyx_v_zero_division, __pyx_v_normalize, __pyx_v_sample_weight);
</pre><pre class="cython line score-0">&#xA0;<span class="">0361</span>:   ):</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0362</span>:     bal_acc_scores = []</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(362,0,<span class='error_goto'>__PYX_ERR(0, 362, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_bal_acc_scores = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0363</span>:     for label in labels:</pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(363,0,<span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>)
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_labels)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_labels)) {
    __pyx_t_1 = __pyx_v_labels; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_labels);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_label, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(363,0,<span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0364</span>:         binary_y_true = (y_true == label).astype(int)</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(364,0,<span class='error_goto'>__PYX_ERR(0, 364, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_true, __pyx_v_label, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 364, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 364, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, ((PyObject *)(&amp;PyInt_Type))};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_binary_y_true, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0365</span>:         binary_y_pred = (y_pred == label).astype(int)</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(365,0,<span class='error_goto'>__PYX_ERR(0, 365, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_pred, __pyx_v_label, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 365, __pyx_L1_error)</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, ((PyObject *)(&amp;PyInt_Type))};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_binary_y_pred, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0366</span>:         score = _compute_balanced_accuracy_binary(</pre>
<pre class='cython code score-25 '>    <span class='trace'>__Pyx_TraceLine</span>(366,0,<span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_compute_balanced_accuracy_binar);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(367,0,<span class='error_goto'>__PYX_ERR(0, 367, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 366, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_binary_y_true);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_binary_y_true);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_binary_y_true)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_binary_y_pred);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_binary_y_pred);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_binary_y_pred)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_epsilon);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_epsilon);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_v_epsilon)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_zero_division);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_zero_division);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 3, __pyx_v_zero_division)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(366,0,<span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 366, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_score, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0367</span>:             binary_y_true, binary_y_pred, epsilon, zero_division,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0368</span>:             normalize=normalize, sample_weight= sample_weight )</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(368,0,<span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_normalize, __pyx_v_normalize) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0369</span>:         bal_acc_scores.append(score)</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(369,0,<span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>)
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_bal_acc_scores, __pyx_v_score);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 369, __pyx_L1_error)</span>
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0370</span>:     return np.array(bal_acc_scores)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(370,0,<span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_bal_acc_scores};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0371</span>: </pre>
<pre class="cython line score-121" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0372</span>: def _balanced_accuracy_ovo(y_true, y_pred, labels, sample_weight=None):</pre>
<pre class='cython code score-121 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_9_balanced_accuracy_ovo(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_9_balanced_accuracy_ovo = {"_balanced_accuracy_ovo", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_9_balanced_accuracy_ovo, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_9_balanced_accuracy_ovo(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  CYTHON_UNUSED PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_labels = 0;
  PyObject *__pyx_v_sample_weight = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_balanced_accuracy_ovo (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_labels,&amp;__pyx_n_s_sample_weight,0};
  PyObject* values[4] = {0,0,0,0};
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_balanced_accuracy_ovo", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_labels)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_balanced_accuracy_ovo", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sample_weight);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_balanced_accuracy_ovo") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_labels = values[2];
    __pyx_v_sample_weight = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_balanced_accuracy_ovo", 0, 3, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._balanced_accuracy_ovo", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_8_balanced_accuracy_ovo(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_labels, __pyx_v_sample_weight);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_8_balanced_accuracy_ovo(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, CYTHON_UNUSED PyObject *__pyx_v_y_pred, PyObject *__pyx_v_labels, PyObject *__pyx_v_sample_weight) {
  PyObject *__pyx_v_le = NULL;
  PyObject *__pyx_v_y_true_encoded = NULL;
  PyObject *__pyx_v_y_bin = NULL;
  PyObject *__pyx_v_bal_acc_scores = NULL;
  PyObject *__pyx_v_i = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_label_i = NULL;
  PyObject *__pyx_v_j = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_label_j = NULL;
  PyObject *__pyx_v_specific_y_true = NULL;
  PyObject *__pyx_v_specific_y_pred = NULL;
  PyObject *__pyx_v_auc_score = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__15)
  <span class='trace'>__Pyx_TraceCall</span>("_balanced_accuracy_ovo", __pyx_f[0], 372, 0, <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._balanced_accuracy_ovo", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_le);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true_encoded);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_bin);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bal_acc_scores);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_label_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_label_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_specific_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_specific_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_auc_score);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__157 = <span class='py_c_api'>PyTuple_Pack</span>(15, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_labels, __pyx_n_s_sample_weight, __pyx_n_s_le, __pyx_n_s_y_true_encoded, __pyx_n_s_y_bin, __pyx_n_s_bal_acc_scores, __pyx_n_s_i, __pyx_n_s_label_i, __pyx_n_s_j, __pyx_n_s_label_j, __pyx_n_s_specific_y_true, __pyx_n_s_specific_y_pred, __pyx_n_s_auc_score);<span class='error_goto'> if (unlikely(!__pyx_tuple__157)) __PYX_ERR(0, 372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__157);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__157);
  __pyx_codeobj__15 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__157, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_balanced_accuracy_ovo, 372, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 372, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(372,0,<span class='error_goto'>__PYX_ERR(0, 372, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_9_balanced_accuracy_ovo, 0, __pyx_n_s_balanced_accuracy_ovo, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__15));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__158);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_balanced_accuracy_ovo, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__158 = <span class='py_c_api'>PyTuple_Pack</span>(1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__158)) __PYX_ERR(0, 372, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__158);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__158);
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0373</span>:     le = LabelEncoder()</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(373,0,<span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_LabelEncoder);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 373, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 373, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_le = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0374</span>:     y_true_encoded = le.fit_transform(y_true)</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(374,0,<span class='error_goto'>__PYX_ERR(0, 374, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_le, __pyx_n_s_fit_transform);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 374, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_true};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 374, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_y_true_encoded = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0375</span>:     y_bin = label_binarize(y_true_encoded, classes=range(len(labels)))</pre>
<pre class='cython code score-36 '>  <span class='trace'>__Pyx_TraceLine</span>(375,0,<span class='error_goto'>__PYX_ERR(0, 375, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_label_binarize);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true_encoded);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true_encoded);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true_encoded)) <span class='error_goto'>__PYX_ERR(0, 375, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_labels);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 375, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_classes, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 375, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_y_bin = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0376</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0377</span>:     bal_acc_scores = []</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(377,0,<span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>)
  __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 377, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_v_bal_acc_scores = ((PyObject*)__pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0378</span>:     for i, label_i in enumerate(labels[:-1]):</pre>
<pre class='cython code score-64 '>  <span class='trace'>__Pyx_TraceLine</span>(378,0,<span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_7 = __pyx_int_0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_labels, 0, -1L, NULL, NULL, &amp;__pyx_slice__16, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_2 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_t_5 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_5 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_5 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_8(__pyx_t_2);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_label_i, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_7);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_7, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7);
    __pyx_t_7 = __pyx_t_3;
    __pyx_t_3 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(378,0,<span class='error_goto'>__PYX_ERR(0, 378, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/* … */
  __pyx_slice__16 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_neg_1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__16)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__16);
</pre><pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0379</span>:         for j, label_j in enumerate(labels[i+1:]):</pre>
<pre class='cython code score-62 '>    <span class='trace'>__Pyx_TraceLine</span>(379,0,<span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_t_3 = __pyx_int_0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 379, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_labels, 0, 0, &amp;__pyx_t_1, NULL, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 379, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_6)) {
      __pyx_t_1 = __pyx_t_6; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 379, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 379, __pyx_L1_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_9 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_9++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
          #else
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 379, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_9 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_9++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
          #else
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 379, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          #endif
        }
      } else {
        __pyx_t_6 = __pyx_t_10(__pyx_t_1);
        if (unlikely(!__pyx_t_6)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_label_j, __pyx_t_6);
      __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_3);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 379, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3);
      __pyx_t_3 = __pyx_t_6;
      __pyx_t_6 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(379,0,<span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0380</span>:             specific_y_true = y_bin[:, i]</pre>
<pre class='cython code score-15 '>      <span class='trace'>__Pyx_TraceLine</span>(380,0,<span class='error_goto'>__PYX_ERR(0, 380, __pyx_L1_error)</span>)
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 380, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 380, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_i)) <span class='error_goto'>__PYX_ERR(0, 380, __pyx_L1_error)</span>;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_bin, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 380, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_specific_y_true, __pyx_t_11);
      __pyx_t_11 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0381</span>:             specific_y_pred = y_bin[:, j]</pre>
<pre class='cython code score-15 '>      <span class='trace'>__Pyx_TraceLine</span>(381,0,<span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>)
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_v_j)) <span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_bin, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_specific_y_pred, __pyx_t_6);
      __pyx_t_6 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0382</span>:             auc_score = roc_auc_score(</pre>
<pre class='cython code score-19 '>      <span class='trace'>__Pyx_TraceLine</span>(382,0,<span class='error_goto'>__PYX_ERR(0, 382, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_roc_auc_score);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(383,0,<span class='error_goto'>__PYX_ERR(0, 383, __pyx_L1_error)</span>)
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_specific_y_true);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_specific_y_true);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_specific_y_true)) <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_specific_y_pred);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_specific_y_pred);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_v_specific_y_pred)) <span class='error_goto'>__PYX_ERR(0, 382, __pyx_L1_error)</span>;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(382,0,<span class='error_goto'>__PYX_ERR(0, 382, __pyx_L1_error)</span>)
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_auc_score, __pyx_t_13);
      __pyx_t_13 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0383</span>:                 specific_y_true, specific_y_pred, sample_weight=sample_weight)</pre>
<pre class='cython code score-7 '>      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 383, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_12, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 383, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0384</span>:             bal_acc_scores.append(auc_score)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(384,0,<span class='error_goto'>__PYX_ERR(0, 384, __pyx_L1_error)</span>)
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_bal_acc_scores, __pyx_v_auc_score);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 384, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0385</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0386</span>:     return np.array(bal_acc_scores)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(386,0,<span class='error_goto'>__PYX_ERR(0, 386, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 386, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 386, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_bal_acc_scores};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 386, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0387</span>: </pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0388</span>: def compute_cost_based_threshold(</pre>
<pre class='cython code score-55 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_11compute_cost_based_threshold(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_10compute_cost_based_threshold, "\n    Compute threshold using a cost-based approach.\n\n    This method computes the total cost for each potential threshold and \n    selects the one that minimizes this cost.\n    \n    Parameters:\n    -----------\n    y_true : array-like of shape (n_samples,)\n        True binary labels.\n    y_scores : array-like of shape (n_samples,)\n        Target scores, can either be probability estimates of the positive class,\n        confidence values, or non-thresholded measure of decisions (as returned\n        by decision_function on some classifiers).\n    costs : tuple (C_FP, C_FN)\n        Costs associated with false positives (C_FP) and false negatives (C_FN).\n    sample_weight : array-like of shape (n_samples,), optional (default=None)\n        Sample weights.\n\n    Returns\n    --------\n    optimal_threshold : float\n        The threshold that minimizes the total cost.\n    total_cost : float\n        The total cost at the optimal threshold.\n\n    Examples\n    ---------\n    &gt;&gt;&gt; from gofast.tools.mathex import compute_cost_based_threshold\n    &gt;&gt;&gt; y_true = [0, 1, 1, 0, 1]\n    &gt;&gt;&gt; y_scores = [0.1, 0.8, 0.3, 0.6, 0.9]\n    &gt;&gt;&gt; costs = (1, 2)  # Cost of FP = 1, Cost of FN = 2\n    &gt;&gt;&gt; optimal_threshold, total_cost = compute_cost_based_threshold(y_true, y_scores, costs)\n    &gt;&gt;&gt; print(\"Optimal Threshold:\", optimal_threshold)\n    Optimal Threshold: 0.8\n    &gt;&gt;&gt; print(\"Total Cost:\", total_cost)\n    Total Cost: 4.0\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_11compute_cost_based_threshold = {"compute_cost_based_threshold", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_11compute_cost_based_threshold, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_10compute_cost_based_threshold};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_11compute_cost_based_threshold(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_scores = 0;
  PyObject *__pyx_v_costs = 0;
  PyObject *__pyx_v_sample_weight = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_cost_based_threshold (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_scores,&amp;__pyx_n_s_costs,&amp;__pyx_n_s_sample_weight,0};
  PyObject* values[4] = {0,0,0,0};
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_10compute_cost_based_threshold(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_scores, PyObject *__pyx_v_costs, PyObject *__pyx_v_sample_weight) {
  PyObject *__pyx_v_thresholds = NULL;
  PyObject *__pyx_v_best_threshold = NULL;
  PyObject *__pyx_v_C_FP = NULL;
  PyObject *__pyx_v_C_FN = NULL;
  PyObject *__pyx_v_min_cost = NULL;
  PyObject *__pyx_v_threshold = NULL;
  PyObject *__pyx_v_predicted_labels = NULL;
  PyObject *__pyx_v_FP = NULL;
  PyObject *__pyx_v_FN = NULL;
  PyObject *__pyx_v_total_cost = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__17)
  <span class='trace'>__Pyx_TraceCall</span>("compute_cost_based_threshold", __pyx_f[0], 388, 0, <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_scores);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sample_weight);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_cost_based_threshold", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_thresholds);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_best_threshold);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_C_FP);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_C_FN);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_min_cost);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_threshold);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_predicted_labels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_FP);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_FN);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_cost);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_scores);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sample_weight);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__159 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_y_true, __pyx_n_s_y_scores, __pyx_n_s_costs, __pyx_n_s_sample_weight, __pyx_n_s_thresholds, __pyx_n_s_best_threshold, __pyx_n_s_C_FP, __pyx_n_s_C_FN, __pyx_n_s_min_cost, __pyx_n_s_threshold, __pyx_n_s_predicted_labels, __pyx_n_s_FP, __pyx_n_s_FN, __pyx_n_s_total_cost);<span class='error_goto'> if (unlikely(!__pyx_tuple__159)) __PYX_ERR(0, 388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__159);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__159);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(388,0,<span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(388,0,<span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_11compute_cost_based_threshold, 0, __pyx_n_s_compute_cost_based_threshold, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__17));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 388, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_cost_based_threshold, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__17 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 1, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__159, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_cost_based_threshold, 388, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__17)) __PYX_ERR(0, 388, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0389</span>:     y_true, y_scores, costs, *,</pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0390</span>:     sample_weight=None</pre>
<pre class='cython code score-69 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_scores)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_cost_based_threshold", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_costs)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_cost_based_threshold", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
        }
      }
      if (kw_args == 1) {
        const Py_ssize_t index = 3;
        PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
        if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_cost_based_threshold") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_scores = values[1];
    __pyx_v_costs = values[2];
    __pyx_v_sample_weight = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_cost_based_threshold", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_cost_based_threshold", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_10compute_cost_based_threshold(__pyx_self, __pyx_v_y_true, __pyx_v_y_scores, __pyx_v_costs, __pyx_v_sample_weight);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(390,0,<span class='error_goto'>__PYX_ERR(0, 390, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_sample_weight, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0391</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0392</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0393</span>:     Compute threshold using a cost-based approach.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0394</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0395</span>:     This method computes the total cost for each potential threshold and</pre>
<pre class="cython line score-0">&#xA0;<span class="">0396</span>:     selects the one that minimizes this cost.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0397</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0398</span>:     Parameters:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0399</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0400</span>:     y_true : array-like of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0401</span>:         True binary labels.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0402</span>:     y_scores : array-like of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0403</span>:         Target scores, can either be probability estimates of the positive class,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0404</span>:         confidence values, or non-thresholded measure of decisions (as returned</pre>
<pre class="cython line score-0">&#xA0;<span class="">0405</span>:         by decision_function on some classifiers).</pre>
<pre class="cython line score-0">&#xA0;<span class="">0406</span>:     costs : tuple (C_FP, C_FN)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0407</span>:         Costs associated with false positives (C_FP) and false negatives (C_FN).</pre>
<pre class="cython line score-0">&#xA0;<span class="">0408</span>:     sample_weight : array-like of shape (n_samples,), optional (default=None)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0409</span>:         Sample weights.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0410</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0411</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0412</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0413</span>:     optimal_threshold : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">0414</span>:         The threshold that minimizes the total cost.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0415</span>:     total_cost : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">0416</span>:         The total cost at the optimal threshold.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0417</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0418</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0419</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0420</span>:     &gt;&gt;&gt; from gofast.tools.mathex import compute_cost_based_threshold</pre>
<pre class="cython line score-0">&#xA0;<span class="">0421</span>:     &gt;&gt;&gt; y_true = [0, 1, 1, 0, 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0422</span>:     &gt;&gt;&gt; y_scores = [0.1, 0.8, 0.3, 0.6, 0.9]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0423</span>:     &gt;&gt;&gt; costs = (1, 2)  # Cost of FP = 1, Cost of FN = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">0424</span>:     &gt;&gt;&gt; optimal_threshold, total_cost = compute_cost_based_threshold(y_true, y_scores, costs)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0425</span>:     &gt;&gt;&gt; print("Optimal Threshold:", optimal_threshold)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0426</span>:     Optimal Threshold: 0.8</pre>
<pre class="cython line score-0">&#xA0;<span class="">0427</span>:     &gt;&gt;&gt; print("Total Cost:", total_cost)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0428</span>:     Total Cost: 4.0</pre>
<pre class="cython line score-0">&#xA0;<span class="">0429</span>:     """</pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0430</span>:     y_true, y_scores = _ensure_y_is_valid(y_true, y_scores, y_numeric=True)</pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(430,0,<span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_ensure_y_is_valid);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_scores);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_scores);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_scores)) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_numeric, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
    index = 0; __pyx_t_3 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_scores, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0431</span>:     # Get unique thresholds from the scores</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0432</span>:     thresholds = np.unique(y_scores)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(432,0,<span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 432, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_unique);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 432, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_y_scores};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_thresholds = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0433</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0434</span>:     # Initialize variables to store the best threshold and minimum cost</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0435</span>:     best_threshold = None</pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(435,0,<span class='error_goto'>__PYX_ERR(0, 435, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_best_threshold = Py_None;
</pre><pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0436</span>:     C_FP, C_FN = validate_length_range(costs, param_name="costs")</pre>
<pre class='cython code score-68 '>  <span class='trace'>__Pyx_TraceLine</span>(436,0,<span class='error_goto'>__PYX_ERR(0, 436, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_validate_length_range);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 436, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 436, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_costs);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_costs);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_costs)) <span class='error_goto'>__PYX_ERR(0, 436, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 436, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_param_name, __pyx_n_u_costs) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 436, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 436, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 436, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 436, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 436, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 436, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_4);
    index = 0; __pyx_t_2 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_4), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 436, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 436, __pyx_L1_error)</span>
    __pyx_L6_unpacking_done:;
  }
  __pyx_v_C_FP = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_C_FN = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0437</span>:     min_cost = float('inf')</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(437,0,<span class='error_goto'>__PYX_ERR(0, 437, __pyx_L1_error)</span>)
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyUnicode_AsDouble</span>(__pyx_n_u_inf); if (unlikely(__pyx_t_7 == ((double)((double)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 437, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 437, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_min_cost = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0438</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0439</span>:     # If sample weights are not provided, set them to ones</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0440</span>:     if sample_weight is None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(440,0,<span class='error_goto'>__PYX_ERR(0, 440, __pyx_L1_error)</span>)
  __pyx_t_8 = (__pyx_v_sample_weight == Py_None);
  if (__pyx_t_8) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0441</span>:         sample_weight = np.ones_like(y_true)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(441,0,<span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 441, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ones_like);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 441, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_true};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sample_weight, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0442</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0443</span>:     # Validate sample weights</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0444</span>:     sample_weight = validate_sample_weights(</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(444,0,<span class='error_goto'>__PYX_ERR(0, 444, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_validate_sample_weights);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(445,0,<span class='error_goto'>__PYX_ERR(0, 445, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 444, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sample_weight);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sample_weight);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_sample_weight)) <span class='error_goto'>__PYX_ERR(0, 444, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 444, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(444,0,<span class='error_goto'>__PYX_ERR(0, 444, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 444, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sample_weight, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0445</span>:         sample_weight, y_true, normalize=True)</pre>
<pre class='cython code score-7 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 445, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_normalize, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 445, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0446</span>:     # Iterate over each unique threshold</pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0447</span>:     for threshold in thresholds:</pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(447,0,<span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span>)
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_thresholds)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_thresholds)) {
    __pyx_t_4 = __pyx_v_thresholds; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    __pyx_t_9 = 0;
    __pyx_t_10 = NULL;
  } else {
    __pyx_t_9 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_thresholds);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 447, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 447, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_10)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_4);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_9 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_4, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_9++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_4, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 447, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_4);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_9 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_9++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_4, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 447, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_10(__pyx_t_4);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_threshold, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(447,0,<span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0448</span>:         # Predict labels based on the current threshold</pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0449</span>:         predicted_labels = (y_scores &gt;= threshold).astype(int)</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(449,0,<span class='error_goto'>__PYX_ERR(0, 449, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_scores, __pyx_v_threshold, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 449, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, ((PyObject *)(&amp;PyInt_Type))};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 449, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_predicted_labels, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0450</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0451</span>:         # Calculate false positives (FP) and false negatives (FN) using sample weights</pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0452</span>:         FP = np.sum((predicted_labels == 1) &amp; (y_true == 0) &amp; (sample_weight &gt; 0))</pre>
<pre class='cython code score-44 '>    <span class='trace'>__Pyx_TraceLine</span>(452,0,<span class='error_goto'>__PYX_ERR(0, 452, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_predicted_labels, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_y_true, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_12 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_1, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_sample_weight, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_12, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 452, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_1};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 452, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_FP, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0453</span>:         FN = np.sum((predicted_labels == 0) &amp; (y_true == 1) &amp; (sample_weight &gt; 0))</pre>
<pre class='cython code score-44 '>    <span class='trace'>__Pyx_TraceLine</span>(453,0,<span class='error_goto'>__PYX_ERR(0, 453, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_predicted_labels, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_y_true, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_12 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_2, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_sample_weight, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_12, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_2};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_FN, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0454</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0455</span>:         # Calculate total cost using the provided costs and weighted FP/FN counts</pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0456</span>:         total_cost = C_FP * FP + C_FN * FN</pre>
<pre class='cython code score-18 '>    <span class='trace'>__Pyx_TraceLine</span>(456,0,<span class='error_goto'>__PYX_ERR(0, 456, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_C_FP, __pyx_v_FP);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_C_FN, __pyx_v_FN);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_total_cost, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0457</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0458</span>:         # Update the minimum cost and best threshold if the current cost is lower</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0459</span>:         if total_cost &lt; min_cost:</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(459,0,<span class='error_goto'>__PYX_ERR(0, 459, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_total_cost, __pyx_v_min_cost, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 459, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_8) {
/* … */
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0460</span>:             min_cost = total_cost</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(460,0,<span class='error_goto'>__PYX_ERR(0, 460, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_total_cost);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_min_cost, __pyx_v_total_cost);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0461</span>:             best_threshold = threshold</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(461,0,<span class='error_goto'>__PYX_ERR(0, 461, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_threshold);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_best_threshold, __pyx_v_threshold);
</pre><pre class="cython line score-0">&#xA0;<span class="">0462</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0463</span>:     # Return the best threshold and its corresponding minimum cost</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0464</span>:     return best_threshold, min_cost</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(464,0,<span class='error_goto'>__PYX_ERR(0, 464, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 464, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_best_threshold);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_best_threshold);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_best_threshold)) <span class='error_goto'>__PYX_ERR(0, 464, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_min_cost);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_min_cost);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_min_cost)) <span class='error_goto'>__PYX_ERR(0, 464, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0465</span>: </pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0466</span>: def compute_youdens_index(</pre>
<pre class='cython code score-49 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_13compute_youdens_index(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_12compute_youdens_index, "\n    Compute Youden's Index and optimal threshold.\n\n    Youden's Index is a single statistic that captures the performance of a\n    binary classification test. \n    It's defined as the maximum vertical distance between the ROC curve and \n    the diagonal line.\n    Mathematically, it is calculated as:\n    \n    .. math::\n        J = \text{True Positive Rate} - \text{False Positive Rate}\n\n    Parameters:\n    -----------\n    y_true : array-like of shape (n_samples,)\n        True binary labels.\n    y_scores : array-like of shape (n_samples,)\n        Target scores, can either be probability estimates of the positive class,\n        confidence values, or non-thresholded measure of decisions (as returned\n        by decision_function on some classifiers).\n    sample_weight : array-like of shape (n_samples,), optional (default=None)\n        Sample weights.\n    pos_label : int or str, optional (default=None)\n        The label of the positive class.\n    drop_intermediate : bool, optional (default=True)\n        Whether to drop some suboptimal thresholds that do not appear\n        on a ROC curve with vertical drops.\n\n    Returns:\n    --------\n    optimal_threshold : float\n        The optimal threshold that maximizes Youden's Index.\n    optimal_youden : float\n        The value of Youden's Index at the optimal threshold.\n    \n    Examples:\n    ---------\n    &gt;&gt;&gt; from gofast.tools.mathex import compute_youdens_index\n    &gt;&gt;&gt; y_true = [0, 1, 1, 0, 1]\n    &gt;&gt;&gt; y_scores = [0.1, 0.8, 0.3, 0.6, 0.9]\n    &gt;&gt;&gt; optimal_threshold, optimal_youden = compute_youdens_index(y_true, y_scores)\n    &gt;&gt;&gt; print(\"Optimal Threshold:\", optimal_threshold)\n    Optimal Threshold: 0.8\n    &gt;&gt;&gt; print(\"Youden's Index:\", optimal_youden)\n    Youden's Index: 0.6\n    \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_13compute_youdens_index = {"compute_youdens_index", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_13compute_youdens_index, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_12compute_youdens_index};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_13compute_youdens_index(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_scores = 0;
  PyObject *__pyx_v_sample_weight = 0;
  PyObject *__pyx_v_pos_label = 0;
  PyObject *__pyx_v_drop_intermediate = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_youdens_index (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_scores,&amp;__pyx_n_s_sample_weight,&amp;__pyx_n_s_pos_label,&amp;__pyx_n_s_drop_intermediate,0};
  PyObject* values[5] = {0,0,0,0,0};
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_12compute_youdens_index(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_scores, PyObject *__pyx_v_sample_weight, PyObject *__pyx_v_pos_label, PyObject *__pyx_v_drop_intermediate) {
  PyObject *__pyx_v_fpr = NULL;
  PyObject *__pyx_v_tpr = NULL;
  PyObject *__pyx_v_thresholds = NULL;
  PyObject *__pyx_v_youdens_index = NULL;
  PyObject *__pyx_v_optimal_idx = NULL;
  PyObject *__pyx_v_optimal_threshold = NULL;
  PyObject *__pyx_v_optimal_youden = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__18)
  <span class='trace'>__Pyx_TraceCall</span>("compute_youdens_index", __pyx_f[0], 466, 0, <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_scores);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_youdens_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fpr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tpr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_thresholds);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_youdens_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_optimal_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_optimal_threshold);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_optimal_youden);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_scores);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__160 = <span class='py_c_api'>PyTuple_Pack</span>(12, __pyx_n_s_y_true, __pyx_n_s_y_scores, __pyx_n_s_sample_weight, __pyx_n_s_pos_label, __pyx_n_s_drop_intermediate, __pyx_n_s_fpr, __pyx_n_s_tpr, __pyx_n_s_thresholds, __pyx_n_s_youdens_index, __pyx_n_s_optimal_idx, __pyx_n_s_optimal_threshold, __pyx_n_s_optimal_youden);<span class='error_goto'> if (unlikely(!__pyx_tuple__160)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__160);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__160);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(466,0,<span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(466,0,<span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_13compute_youdens_index, 0, __pyx_n_s_compute_youdens_index, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__18));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_youdens_index, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__18 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 3, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__160, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_youdens_index, 466, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(0, 466, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0467</span>:     y_true, y_scores, *,</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0468</span>:     sample_weight=None,</pre>
<pre class='cython code score-7 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(468,0,<span class='error_goto'>__PYX_ERR(0, 468, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_sample_weight, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0469</span>:     pos_label=None,</pre>
<pre class='cython code score-12 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(469,0,<span class='error_goto'>__PYX_ERR(0, 469, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_pos_label, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_drop_intermediate, ((PyObject *)Py_True)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L1_error)</span>
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0470</span>:     drop_intermediate=True</pre>
<pre class='cython code score-49 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_scores)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_youdens_index", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 3)) {
        Py_ssize_t index;
        for (index = 2; index &lt; 5 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_youdens_index") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_scores = values[1];
    __pyx_v_sample_weight = values[2];
    __pyx_v_pos_label = values[3];
    __pyx_v_drop_intermediate = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_youdens_index", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 466, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_youdens_index", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_12compute_youdens_index(__pyx_self, __pyx_v_y_true, __pyx_v_y_scores, __pyx_v_sample_weight, __pyx_v_pos_label, __pyx_v_drop_intermediate);
</pre><pre class="cython line score-0">&#xA0;<span class="">0471</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0472</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0473</span>:     Compute Youden's Index and optimal threshold.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0474</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0475</span>:     Youden's Index is a single statistic that captures the performance of a</pre>
<pre class="cython line score-0">&#xA0;<span class="">0476</span>:     binary classification test.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0477</span>:     It's defined as the maximum vertical distance between the ROC curve and</pre>
<pre class="cython line score-0">&#xA0;<span class="">0478</span>:     the diagonal line.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0479</span>:     Mathematically, it is calculated as:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0480</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0481</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">0482</span>:         J = \text{True Positive Rate} - \text{False Positive Rate}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0483</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0484</span>:     Parameters:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0485</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0486</span>:     y_true : array-like of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0487</span>:         True binary labels.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0488</span>:     y_scores : array-like of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0489</span>:         Target scores, can either be probability estimates of the positive class,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0490</span>:         confidence values, or non-thresholded measure of decisions (as returned</pre>
<pre class="cython line score-0">&#xA0;<span class="">0491</span>:         by decision_function on some classifiers).</pre>
<pre class="cython line score-0">&#xA0;<span class="">0492</span>:     sample_weight : array-like of shape (n_samples,), optional (default=None)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0493</span>:         Sample weights.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0494</span>:     pos_label : int or str, optional (default=None)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0495</span>:         The label of the positive class.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0496</span>:     drop_intermediate : bool, optional (default=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0497</span>:         Whether to drop some suboptimal thresholds that do not appear</pre>
<pre class="cython line score-0">&#xA0;<span class="">0498</span>:         on a ROC curve with vertical drops.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0499</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0500</span>:     Returns:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0501</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0502</span>:     optimal_threshold : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">0503</span>:         The optimal threshold that maximizes Youden's Index.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0504</span>:     optimal_youden : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">0505</span>:         The value of Youden's Index at the optimal threshold.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0506</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0507</span>:     Examples:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0508</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0509</span>:     &gt;&gt;&gt; from gofast.tools.mathex import compute_youdens_index</pre>
<pre class="cython line score-0">&#xA0;<span class="">0510</span>:     &gt;&gt;&gt; y_true = [0, 1, 1, 0, 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0511</span>:     &gt;&gt;&gt; y_scores = [0.1, 0.8, 0.3, 0.6, 0.9]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0512</span>:     &gt;&gt;&gt; optimal_threshold, optimal_youden = compute_youdens_index(y_true, y_scores)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0513</span>:     &gt;&gt;&gt; print("Optimal Threshold:", optimal_threshold)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0514</span>:     Optimal Threshold: 0.8</pre>
<pre class="cython line score-0">&#xA0;<span class="">0515</span>:     &gt;&gt;&gt; print("Youden's Index:", optimal_youden)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0516</span>:     Youden's Index: 0.6</pre>
<pre class="cython line score-0">&#xA0;<span class="">0517</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0518</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0519</span>:     # Ensure input arrays y_true and y_scores are valid</pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0520</span>:     y_true, y_scores = _ensure_y_is_valid(y_true, y_scores, y_numeric=True)</pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(520,0,<span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_ensure_y_is_valid);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_scores);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_scores);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_scores)) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_numeric, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 520, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
    index = 0; __pyx_t_3 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 520, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_scores, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0521</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0522</span>:     # Check if the class labels are binary</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0523</span>:     if not is_binary_class(y_true):</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(523,0,<span class='error_goto'>__PYX_ERR(0, 523, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_is_binary_class);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_true};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 523, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_8 = (!__pyx_t_7);
  if (unlikely(__pyx_t_8)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0524</span>:         raise ValueError("Youden's index calculation requires binary class"</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(524,0,<span class='error_goto'>__PYX_ERR(0, 524, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__19, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 524, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__19 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Youden_s_index_calculation_requi);<span class='error_goto'> if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__19);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__19);
</pre><pre class="cython line score-0">&#xA0;<span class="">0525</span>:                          "labels. Provided labels are not binary.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0526</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0527</span>:     # Validate scores as proper probability distributions</pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0528</span>:     y_scores = validate_scores(y_scores, y_true, mode="passthrough")</pre>
<pre class='cython code score-26 '>  <span class='trace'>__Pyx_TraceLine</span>(528,0,<span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_validate_scores);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_scores);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_scores);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_scores)) <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_mode, __pyx_n_u_passthrough) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 528, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 528, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_scores, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0529</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0530</span>:     # Calculate the ROC curve and the corresponding AUC</pre>
<pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0531</span>:     fpr, tpr, thresholds = roc_curve(</pre>
<pre class='cython code score-68 '>  <span class='trace'>__Pyx_TraceLine</span>(531,0,<span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_roc_curve);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(532,0,<span class='error_goto'>__PYX_ERR(0, 532, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_scores);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_scores);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_y_scores)) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(531,0,<span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 3)) {
      if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
    } else {
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    #else
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 531, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_9);
    index = 0; __pyx_t_2 = __pyx_t_5(__pyx_t_9); if (unlikely(!__pyx_t_2)) goto __pyx_L6_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 1; __pyx_t_3 = __pyx_t_5(__pyx_t_9); if (unlikely(!__pyx_t_3)) goto __pyx_L6_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 2; __pyx_t_1 = __pyx_t_5(__pyx_t_9); if (unlikely(!__pyx_t_1)) goto __pyx_L6_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_9), 3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    goto __pyx_L7_unpacking_done;
    __pyx_L6_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
    __pyx_L7_unpacking_done:;
  }
  __pyx_v_fpr = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_v_tpr = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_thresholds = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0532</span>:         y_true, y_scores, pos_label=pos_label,</pre>
<pre class='cython code score-7 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 532, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_pos_label, __pyx_v_pos_label) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0533</span>:         sample_weight=sample_weight,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(533,0,<span class='error_goto'>__PYX_ERR(0, 533, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0534</span>:         drop_intermediate=drop_intermediate</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(534,0,<span class='error_goto'>__PYX_ERR(0, 534, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_drop_intermediate, __pyx_v_drop_intermediate) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0535</span>:     )</pre>
<pre class="cython line score-0">&#xA0;<span class="">0536</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0537</span>:     # Calculate Youden's Index for each threshold</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0538</span>:     youdens_index = tpr - fpr</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(538,0,<span class='error_goto'>__PYX_ERR(0, 538, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_tpr, __pyx_v_fpr);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 538, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_youdens_index = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0539</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0540</span>:     # Find the optimal threshold (maximizes Youden's Index)</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0541</span>:     optimal_idx = np.argmax(youdens_index)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(541,0,<span class='error_goto'>__PYX_ERR(0, 541, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 541, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_argmax);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 541, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_youdens_index};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 541, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_optimal_idx = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0542</span>:     optimal_threshold = thresholds[optimal_idx]</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(542,0,<span class='error_goto'>__PYX_ERR(0, 542, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_thresholds, __pyx_v_optimal_idx);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 542, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_optimal_threshold = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0543</span>:     optimal_youden = youdens_index[optimal_idx]</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(543,0,<span class='error_goto'>__PYX_ERR(0, 543, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_youdens_index, __pyx_v_optimal_idx);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 543, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_optimal_youden = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0544</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0545</span>:     return optimal_threshold, optimal_youden</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(545,0,<span class='error_goto'>__PYX_ERR(0, 545, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 545, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_optimal_threshold);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_optimal_threshold);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_optimal_threshold)) <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_optimal_youden);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_optimal_youden);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_optimal_youden)) <span class='error_goto'>__PYX_ERR(0, 545, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0546</span>: </pre>
<pre class="cython line score-80" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0547</span>: def calculate_multiclass_avg_lr(</pre>
<pre class='cython code score-80 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_15calculate_multiclass_avg_lr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_14calculate_multiclass_avg_lr, "\n    Calculate the average likelihood ratio for multiclass classification \n    based on the average sensitivity and specificity across all classes or \n    class pairs.\n\n    This function supports one-versus-rest (OvR) and one-versus-one (OvO) \n    strategies for multiclass data and computes the likelihood ratio either \n    positively or negatively based on the specified consensus.\n\n    Parameters\n    ----------\n    y_true : array-like\n        True class labels as integers.\n    y_pred : array-like\n        Predicted class labels as integers.\n    strategy : str, optional\n        Specifies the computation strategy: 'ovr' for one-versus-rest or 'ovo' \n        for one-versus-one.\n    consensus : str, optional\n        'positive' for positive likelihood ratio or 'negative' for negative \n        likelihood ratio.\n    sample_weight : array-like, optional\n        Weights applied to classes in averaging sensitivity and specificity. \n        If None, equal weighting is assumed.\n    epsilon : float, optional\n        A small value to prevent division by zero in calculations. \n        Default is 1e-10.\n\n    Returns\n    -------\n    float\n        The computed average likelihood ratio.\n    float\n        The average sensitivity computed across classes or class pairs.\n    float\n        The average specificity computed across classes or class pairs.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import calculate_multiclass_avg_lr\n    &gt;&gt;&gt; y_true = [0, 1, 2, 2, 1, 0]\n    &gt;&gt;&gt; y_pred = [0, 2, 1, 2, 1, 0]\n    &gt;&gt;&gt; lr, avg_sens, avg_spec = calculate_multiclass_avg_lr(\n    ...    y_true, y_pred, strategy='ovr', consensus='positive')\n    &gt;&gt;&gt; print(f\"Likelihood Ratio: {lr:.2f}, \n    ...          Average Sensitivity: {avg_sens:.2f},\n    ...          Average Specificity: {avg_spec:.2f}\")\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_15calculate_multiclass_avg_lr = {"calculate_multiclass_avg_lr", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_15calculate_multiclass_avg_lr, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_14calculate_multiclass_avg_lr};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_15calculate_multiclass_avg_lr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_strategy = 0;
  PyObject *__pyx_v_consensus = 0;
  PyObject *__pyx_v_sample_weight = 0;
  PyObject *__pyx_v_multi_output = 0;
  PyObject *__pyx_v_epsilon = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_multiclass_avg_lr (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_strategy,&amp;__pyx_n_s_consensus,&amp;__pyx_n_s_sample_weight,&amp;__pyx_n_s_multi_output,&amp;__pyx_n_s_epsilon,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_ovr)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_positive)));
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_14calculate_multiclass_avg_lr(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_strategy, PyObject *__pyx_v_consensus, PyObject *__pyx_v_sample_weight, PyObject *__pyx_v_multi_output, PyObject *__pyx_v_epsilon) {
  PyObject *__pyx_v_classes = NULL;
  PyObject *__pyx_v_sensitivities = NULL;
  PyObject *__pyx_v_specificities = NULL;
  PyObject *__pyx_v_y_true_binarized = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_cls = NULL;
  PyObject *__pyx_v_sensitivity = NULL;
  PyObject *__pyx_v_specificity = NULL;
  PyObject *__pyx_v_cls1 = NULL;
  PyObject *__pyx_v_cls2 = NULL;
  PyObject *__pyx_v_relevant_mask = NULL;
  PyObject *__pyx_v_y_true_binary = NULL;
  PyObject *__pyx_v_y_pred_binary = NULL;
  PyObject *__pyx_v_avg_sensitivity = NULL;
  PyObject *__pyx_v_avg_specificity = NULL;
  PyObject *__pyx_v_lr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__20)
  <span class='trace'>__Pyx_TraceCall</span>("calculate_multiclass_avg_lr", __pyx_f[0], 547, 0, <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_strategy);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_consensus);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sample_weight);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_epsilon);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_multiclass_avg_lr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_classes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sensitivities);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_specificities);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true_binarized);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cls);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sensitivity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_specificity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cls1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cls2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_relevant_mask);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true_binary);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred_binary);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_avg_sensitivity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_avg_specificity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_strategy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_consensus);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sample_weight);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_epsilon);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__161 = <span class='py_c_api'>PyTuple_Pack</span>(23, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_strategy, __pyx_n_s_consensus, __pyx_n_s_sample_weight, __pyx_n_s_multi_output, __pyx_n_s_epsilon, __pyx_n_s_classes, __pyx_n_s_sensitivities, __pyx_n_s_specificities, __pyx_n_s_y_true_binarized, __pyx_n_s_i, __pyx_n_s_cls, __pyx_n_s_sensitivity, __pyx_n_s_specificity, __pyx_n_s_cls1, __pyx_n_s_cls2, __pyx_n_s_relevant_mask, __pyx_n_s_y_true_binary, __pyx_n_s_y_pred_binary, __pyx_n_s_avg_sensitivity, __pyx_n_s_avg_specificity, __pyx_n_s_lr);<span class='error_goto'> if (unlikely(!__pyx_tuple__161)) __PYX_ERR(0, 547, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__161);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__161);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(547,0,<span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 547, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_strategy, ((PyObject*)__pyx_n_u_ovr)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_consensus, ((PyObject*)__pyx_n_u_positive)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(547,0,<span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_15calculate_multiclass_avg_lr, 0, __pyx_n_s_calculate_multiclass_avg_lr, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__20));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 547, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calculate_multiclass_avg_lr, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__20 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 5, 23, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__161, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_calculate_multiclass_avg_lr, 547, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__20)) __PYX_ERR(0, 547, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0548</span>:     y_true, y_pred, *,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0549</span>:     strategy='ovr',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0550</span>:     consensus="positive",</pre>
<pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0551</span>:     sample_weight=None,</pre>
<pre class='cython code score-68 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_uniform_average)));
    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_10)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_multiclass_avg_lr", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 5)) {
        Py_ssize_t index;
        for (index = 2; index &lt; 7 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate_multiclass_avg_lr") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_strategy = values[2];
    __pyx_v_consensus = values[3];
    __pyx_v_sample_weight = values[4];
    __pyx_v_multi_output = values[5];
    __pyx_v_epsilon = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_multiclass_avg_lr", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_multiclass_avg_lr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_14calculate_multiclass_avg_lr(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_strategy, __pyx_v_consensus, __pyx_v_sample_weight, __pyx_v_multi_output, __pyx_v_epsilon);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(551,0,<span class='error_goto'>__PYX_ERR(0, 551, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_sample_weight, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_multi_output, ((PyObject*)__pyx_n_u_uniform_average)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_epsilon, ((PyObject*)__pyx_float_1eneg_10)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0552</span>:     multi_output='uniform_average',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0553</span>:     epsilon=1e-10</pre>
<pre class="cython line score-0">&#xA0;<span class="">0554</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0555</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0556</span>:     Calculate the average likelihood ratio for multiclass classification</pre>
<pre class="cython line score-0">&#xA0;<span class="">0557</span>:     based on the average sensitivity and specificity across all classes or</pre>
<pre class="cython line score-0">&#xA0;<span class="">0558</span>:     class pairs.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0559</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0560</span>:     This function supports one-versus-rest (OvR) and one-versus-one (OvO)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0561</span>:     strategies for multiclass data and computes the likelihood ratio either</pre>
<pre class="cython line score-0">&#xA0;<span class="">0562</span>:     positively or negatively based on the specified consensus.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0563</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0564</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0565</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0566</span>:     y_true : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">0567</span>:         True class labels as integers.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0568</span>:     y_pred : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">0569</span>:         Predicted class labels as integers.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0570</span>:     strategy : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0571</span>:         Specifies the computation strategy: 'ovr' for one-versus-rest or 'ovo'</pre>
<pre class="cython line score-0">&#xA0;<span class="">0572</span>:         for one-versus-one.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0573</span>:     consensus : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0574</span>:         'positive' for positive likelihood ratio or 'negative' for negative</pre>
<pre class="cython line score-0">&#xA0;<span class="">0575</span>:         likelihood ratio.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0576</span>:     sample_weight : array-like, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0577</span>:         Weights applied to classes in averaging sensitivity and specificity.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0578</span>:         If None, equal weighting is assumed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0579</span>:     epsilon : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0580</span>:         A small value to prevent division by zero in calculations.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0581</span>:         Default is 1e-10.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0582</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0583</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0584</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0585</span>:     float</pre>
<pre class="cython line score-0">&#xA0;<span class="">0586</span>:         The computed average likelihood ratio.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0587</span>:     float</pre>
<pre class="cython line score-0">&#xA0;<span class="">0588</span>:         The average sensitivity computed across classes or class pairs.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0589</span>:     float</pre>
<pre class="cython line score-0">&#xA0;<span class="">0590</span>:         The average specificity computed across classes or class pairs.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0591</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0592</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0593</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0594</span>:     &gt;&gt;&gt; from gofast.tools.mathex import calculate_multiclass_avg_lr</pre>
<pre class="cython line score-0">&#xA0;<span class="">0595</span>:     &gt;&gt;&gt; y_true = [0, 1, 2, 2, 1, 0]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0596</span>:     &gt;&gt;&gt; y_pred = [0, 2, 1, 2, 1, 0]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0597</span>:     &gt;&gt;&gt; lr, avg_sens, avg_spec = calculate_multiclass_avg_lr(</pre>
<pre class="cython line score-0">&#xA0;<span class="">0598</span>:     ...    y_true, y_pred, strategy='ovr', consensus='positive')</pre>
<pre class="cython line score-0">&#xA0;<span class="">0599</span>:     &gt;&gt;&gt; print(f"Likelihood Ratio: {lr:.2f},</pre>
<pre class="cython line score-0">&#xA0;<span class="">0600</span>:     ...          Average Sensitivity: {avg_sens:.2f},</pre>
<pre class="cython line score-0">&#xA0;<span class="">0601</span>:     ...          Average Specificity: {avg_spec:.2f}")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0602</span>:     """</pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0603</span>:     _ensure_y_is_valid( y_true, y_pred, y_numeric =True)</pre>
<pre class='cython code score-26 '>  <span class='trace'>__Pyx_TraceLine</span>(603,0,<span class='error_goto'>__PYX_ERR(0, 603, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_ensure_y_is_valid);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 603, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 603, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 603, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_numeric, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 603, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0604</span>:     ensure_non_negative(</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(604,0,<span class='error_goto'>__PYX_ERR(0, 604, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_ensure_non_negative);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(605,0,<span class='error_goto'>__PYX_ERR(0, 605, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 604, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 604, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(604,0,<span class='error_goto'>__PYX_ERR(0, 604, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 604, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0605</span>:         y_true, y_pred,</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0606</span>:         err_msg="y_true and y_pred must contain non-negative values."</pre>
<pre class='cython code score-7 '>  <span class='trace'>__Pyx_TraceLine</span>(606,0,<span class='error_goto'>__PYX_ERR(0, 606, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 606, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_err_msg, __pyx_kp_u_y_true_and_y_pred_must_contain_n) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 606, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0607</span>:     )</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0608</span>:     epsilon = check_epsilon(epsilon, y_true, y_pred )</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(608,0,<span class='error_goto'>__PYX_ERR(0, 608, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_check_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 608, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_3, __pyx_v_epsilon, __pyx_v_y_true, __pyx_v_y_pred};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 3+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 608, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_epsilon, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0609</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0610</span>:     consensus = parameter_validator(</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(610,0,<span class='error_goto'>__PYX_ERR(0, 610, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_parameter_validator);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 610, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(610,0,<span class='error_goto'>__PYX_ERR(0, 610, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__21, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 610, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_tuple__21 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_consensus);<span class='error_goto'> if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 610, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__21);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__21);
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0611</span>:         "consensus", target_strs={'negative', 'positive'})(consensus)</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(611,0,<span class='error_goto'>__PYX_ERR(0, 611, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 611, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PySet_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 611, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_4, __pyx_n_u_negative) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_4, __pyx_n_u_positive) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_target_strs, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(611,0,<span class='error_goto'>__PYX_ERR(0, 611, __pyx_L1_error)</span>)
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_consensus};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 611, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_consensus, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0612</span>:     strategy = parameter_validator(</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(612,0,<span class='error_goto'>__PYX_ERR(0, 612, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_parameter_validator);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 612, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(612,0,<span class='error_goto'>__PYX_ERR(0, 612, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__7, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 612, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0613</span>:         "strategy", target_strs={'ovr', 'ovo'})( strategy)</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(613,0,<span class='error_goto'>__PYX_ERR(0, 613, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PySet_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 613, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_2, __pyx_n_u_ovr) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 613, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_2, __pyx_n_u_ovo) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 613, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_target_strs, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 613, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(613,0,<span class='error_goto'>__PYX_ERR(0, 613, __pyx_L1_error)</span>)
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_strategy};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 613, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_strategy, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0614</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0615</span>:     classes = np.unique(y_true)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(615,0,<span class='error_goto'>__PYX_ERR(0, 615, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 615, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_unique);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 615, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_y_true};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 615, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_classes = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0616</span>:     sensitivities, specificities = [], []</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(616,0,<span class='error_goto'>__PYX_ERR(0, 616, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 616, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_sensitivities = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_v_specificities = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0617</span>:     # validate multitarget and samples weigths if exists</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0618</span>:     y_true = validate_multiclass_target( y_true )</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(618,0,<span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_validate_multiclass_target);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_y_true};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 618, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0619</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0620</span>:     if sample_weight is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(620,0,<span class='error_goto'>__PYX_ERR(0, 620, __pyx_L1_error)</span>)
  __pyx_t_6 = (__pyx_v_sample_weight != Py_None);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0621</span>:         sample_weight =validate_sample_weights( sample_weight, y_true)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(621,0,<span class='error_goto'>__PYX_ERR(0, 621, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_validate_sample_weights);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 621, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_sample_weight, __pyx_v_y_true};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 621, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sample_weight, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0622</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0623</span>:     if strategy == 'ovr':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(623,0,<span class='error_goto'>__PYX_ERR(0, 623, __pyx_L1_error)</span>)
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_strategy, __pyx_n_u_ovr, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 623, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0624</span>:         y_true_binarized = label_binarize(y_true, classes=classes)</pre>
<pre class='cython code score-22 '>    <span class='trace'>__Pyx_TraceLine</span>(624,0,<span class='error_goto'>__PYX_ERR(0, 624, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_label_binarize);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 624, __pyx_L1_error)</span>;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_classes, __pyx_v_classes) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 624, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 624, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_y_true_binarized = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0625</span>:         for i, cls in enumerate(classes):</pre>
<pre class='cython code score-56 '>    <span class='trace'>__Pyx_TraceLine</span>(625,0,<span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_t_4 = __pyx_int_0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_classes)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_classes)) {
      __pyx_t_2 = __pyx_v_classes; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      __pyx_t_7 = 0;
      __pyx_t_8 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_classes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_8)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
          #else
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
          #else
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_8(__pyx_t_2);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cls, __pyx_t_1);
      __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_4);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 625, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4);
      __pyx_t_4 = __pyx_t_1;
      __pyx_t_1 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(625,0,<span class='error_goto'>__PYX_ERR(0, 625, __pyx_L1_error)</span>)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0626</span>:             sensitivity, specificity = _compute_sensitivity_specificity(</pre>
<pre class='cython code score-64 '>      <span class='trace'>__Pyx_TraceLine</span>(626,0,<span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_compute_sensitivity_specificity);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(626,0,<span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>)
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>;
      __pyx_t_9 = 0;
      __pyx_t_3 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(626,0,<span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>)
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_11, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_9))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
        PyObject* sequence = __pyx_t_9;
        Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
        index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L7_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        index = 1; __pyx_t_11 = __pyx_t_12(__pyx_t_1); if (unlikely(!__pyx_t_11)) goto __pyx_L7_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>
        __pyx_t_12 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L8_unpacking_done;
        __pyx_L7_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_12 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L1_error)</span>
        __pyx_L8_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sensitivity, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_specificity, __pyx_t_11);
      __pyx_t_11 = 0;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0627</span>:                 y_true_binarized[:, i], (y_pred == cls).astype(int),</pre>
<pre class='cython code score-36 '>      <span class='trace'>__Pyx_TraceLine</span>(627,0,<span class='error_goto'>__PYX_ERR(0, 627, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 627, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_i)) <span class='error_goto'>__PYX_ERR(0, 627, __pyx_L1_error)</span>;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_true_binarized, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_pred, __pyx_v_cls, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = NULL;
      __pyx_t_5 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
          __pyx_t_5 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, ((PyObject *)(&amp;PyInt_Type))};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 627, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0628</span>:                 sample_weight=sample_weight,</pre>
<pre class='cython code score-7 '>      <span class='trace'>__Pyx_TraceLine</span>(628,0,<span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0629</span>:                 epsilon=epsilon</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(629,0,<span class='error_goto'>__PYX_ERR(0, 629, __pyx_L1_error)</span>)
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_epsilon, __pyx_v_epsilon) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0630</span>:             )</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0631</span>:             sensitivities.append(sensitivity)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(631,0,<span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>)
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_sensitivities, __pyx_v_sensitivity);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 631, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0632</span>:             specificities.append(specificity)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(632,0,<span class='error_goto'>__PYX_ERR(0, 632, __pyx_L1_error)</span>)
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_specificities, __pyx_v_specificity);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 632, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0633</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0634</span>:     elif strategy == 'ovo':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(634,0,<span class='error_goto'>__PYX_ERR(0, 634, __pyx_L1_error)</span>)
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_strategy, __pyx_n_u_ovo, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 634, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/* … */
  }
  __pyx_L4:;
</pre><pre class="cython line score-116" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0635</span>:         for cls1, cls2 in itertools.combinations(classes, 2):</pre>
<pre class='cython code score-116 '>    <span class='trace'>__Pyx_TraceLine</span>(635,0,<span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_itertools);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_combinations);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_classes, __pyx_int_2};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      __pyx_t_9 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      __pyx_t_7 = 0;
      __pyx_t_8 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    for (;;) {
      if (likely(!__pyx_t_8)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_9);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
          #else
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_9, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_9);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
          #else
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_9, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          #endif
        }
      } else {
        __pyx_t_4 = __pyx_t_8(__pyx_t_9);
        if (unlikely(!__pyx_t_4)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        PyObject* sequence = __pyx_t_4;
        Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 635, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);
        index = 0; __pyx_t_2 = __pyx_t_12(__pyx_t_3); if (unlikely(!__pyx_t_2)) goto __pyx_L12_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        index = 1; __pyx_t_11 = __pyx_t_12(__pyx_t_3); if (unlikely(!__pyx_t_11)) goto __pyx_L12_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_3), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
        __pyx_t_12 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        goto __pyx_L13_unpacking_done;
        __pyx_L12_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_12 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>
        __pyx_L13_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cls1, __pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cls2, __pyx_t_11);
      __pyx_t_11 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(635,0,<span class='error_goto'>__PYX_ERR(0, 635, __pyx_L1_error)</span>)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0636</span>:             relevant_mask = (y_true == cls1) | (y_true == cls2)</pre>
<pre class='cython code score-18 '>      <span class='trace'>__Pyx_TraceLine</span>(636,0,<span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_true, __pyx_v_cls1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
      __pyx_t_11 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_true, __pyx_v_cls2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Or</span>(__pyx_t_4, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_relevant_mask, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0637</span>:             y_true_binary = (y_true[relevant_mask] == cls1).astype(int)</pre>
<pre class='cython code score-26 '>      <span class='trace'>__Pyx_TraceLine</span>(637,0,<span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>)
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_true, __pyx_v_relevant_mask);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_11, __pyx_v_cls1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_5 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
          __pyx_t_5 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, ((PyObject *)(&amp;PyInt_Type))};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y_true_binary, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0638</span>:             y_pred_binary = (y_pred[relevant_mask] == cls1).astype(int)</pre>
<pre class='cython code score-26 '>      <span class='trace'>__Pyx_TraceLine</span>(638,0,<span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>)
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_pred, __pyx_v_relevant_mask);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_11, __pyx_v_cls1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_5 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
          __pyx_t_5 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, ((PyObject *)(&amp;PyInt_Type))};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y_pred_binary, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0639</span>:             sensitivity, specificity = _compute_sensitivity_specificity(</pre>
<pre class='cython code score-66 '>      <span class='trace'>__Pyx_TraceLine</span>(639,0,<span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_compute_sensitivity_specificity);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(640,0,<span class='error_goto'>__PYX_ERR(0, 640, __pyx_L1_error)</span>)
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true_binary);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true_binary);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_y_true_binary)) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred_binary);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred_binary);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_v_y_pred_binary)) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(639,0,<span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_11, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        PyObject* sequence = __pyx_t_3;
        Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);
        index = 0; __pyx_t_4 = __pyx_t_12(__pyx_t_2); if (unlikely(!__pyx_t_4)) goto __pyx_L14_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        index = 1; __pyx_t_11 = __pyx_t_12(__pyx_t_2); if (unlikely(!__pyx_t_11)) goto __pyx_L14_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_2), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
        __pyx_t_12 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        goto __pyx_L15_unpacking_done;
        __pyx_L14_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_12 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
        __pyx_L15_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sensitivity, __pyx_t_4);
      __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_specificity, __pyx_t_11);
      __pyx_t_11 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0640</span>:                 y_true_binary, y_pred_binary,</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0641</span>:                 sample_weight=sample_weight,</pre>
<pre class='cython code score-7 '>      <span class='trace'>__Pyx_TraceLine</span>(641,0,<span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 641, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0642</span>:                 epsilon=epsilon</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(642,0,<span class='error_goto'>__PYX_ERR(0, 642, __pyx_L1_error)</span>)
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_epsilon, __pyx_v_epsilon) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 641, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0643</span>:                 )</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0644</span>:             sensitivities.append(sensitivity)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(644,0,<span class='error_goto'>__PYX_ERR(0, 644, __pyx_L1_error)</span>)
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_sensitivities, __pyx_v_sensitivity);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 644, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0645</span>:             specificities.append(specificity)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(645,0,<span class='error_goto'>__PYX_ERR(0, 645, __pyx_L1_error)</span>)
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_specificities, __pyx_v_specificity);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 645, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0646</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0647</span>:     # Weighted averages if sample_weight is provided</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0648</span>:     if  multi_output=='uniform_average':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(648,0,<span class='error_goto'>__PYX_ERR(0, 648, __pyx_L1_error)</span>)
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_multi_output, __pyx_n_u_uniform_average, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/* … */
    goto __pyx_L17;
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0649</span>:         avg_sensitivity = np.average(sensitivities)</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(649,0,<span class='error_goto'>__PYX_ERR(0, 649, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 649, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_average);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 649, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_sensitivities};
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 649, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    __pyx_v_avg_sensitivity = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0650</span>:         avg_specificity = np.average(specificities)</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(650,0,<span class='error_goto'>__PYX_ERR(0, 650, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_average);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 650, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_v_specificities};
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 650, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_v_avg_specificity = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0651</span>:     else:</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0652</span>:         avg_sensitivity = np.asarray(sensitivities)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(652,0,<span class='error_goto'>__PYX_ERR(0, 652, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 652, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_sensitivities};
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 652, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    __pyx_v_avg_sensitivity = __pyx_t_9;
    __pyx_t_9 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0653</span>:         avg_specificity = np.asarray(specificities)</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(653,0,<span class='error_goto'>__PYX_ERR(0, 653, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 653, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 653, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_v_specificities};
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 653, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_v_avg_specificity = __pyx_t_9;
    __pyx_t_9 = 0;
  }
  __pyx_L17:;
</pre><pre class="cython line score-0">&#xA0;<span class="">0654</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0655</span>:     # Compute LR based on average values</pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0656</span>:     lr = calculate_adjusted_lr(</pre>
<pre class='cython code score-18 '>  <span class='trace'>__Pyx_TraceLine</span>(656,0,<span class='error_goto'>__PYX_ERR(0, 656, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_calculate_adjusted_lr);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 656, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(657,0,<span class='error_goto'>__PYX_ERR(0, 657, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 656, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_avg_sensitivity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_avg_sensitivity);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_avg_sensitivity)) <span class='error_goto'>__PYX_ERR(0, 656, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_avg_specificity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_avg_specificity);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_avg_specificity)) <span class='error_goto'>__PYX_ERR(0, 656, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(656,0,<span class='error_goto'>__PYX_ERR(0, 656, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_3, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 656, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_v_lr = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0657</span>:         avg_sensitivity, avg_specificity,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0658</span>:         consensus = consensus,max_lr = 100.</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(658,0,<span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>)
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_consensus, __pyx_v_consensus) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_11, __pyx_n_s_max_lr, __pyx_float_100_) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0659</span>:         )</pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0660</span>:     return lr, avg_sensitivity, avg_specificity</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(660,0,<span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 660, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_lr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_lr);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_lr)) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_avg_sensitivity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_avg_sensitivity);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_avg_sensitivity)) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_avg_specificity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_avg_specificity);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_v_avg_specificity)) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0661</span>: </pre>
<pre class="cython line score-72" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0662</span>: def calculate_multiclass_lr(</pre>
<pre class='cython code score-72 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_17calculate_multiclass_lr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_16calculate_multiclass_lr, "\n    Calculate the multiclass likelihood ratio for classification using either \n    one-versus-rest (OvR) or one-versus-one (OvO) strategies. Optionally applies \n    logarithmic scaling to the likelihood ratios and can return sensitivity and \n    specificity values.\n\n    Parameters\n    ----------\n    y_true : array-like\n        True class labels as integers.\n    y_pred : array-like\n        Predicted class labels as integers.\n    consensus : str, optional\n        Specifies the type of likelihood ratio to compute: 'positive' \n        (default) or 'negative'.\n    strategy : str, optional\n        Specifies the computation strategy: 'ovr' (one-versus-rest, default) \n        or 'ovo' (one-versus-one).\n    epsilon : float, optional\n        A small value to prevent division by zero in calculations. \n        Default is 1e-10. \n    multi_output : str, optional\n        If 'uniform_average', returns the average of the computed likelihood \n        ratios. If 'raw_values', returns the likelihood ratios for each class \n        comparison.\n    apply_log_scale : bool, optional\n        If True, applies the natural logarithm to the likelihood ratios, \n        returning the log-likelihood ratios.\n    include_metrics : bool, optional\n        If True, returns a tuple containing the likelihood ratios and arrays \n        of sensitivities and specificities.\n\n    Returns\n    -------\n    float or tuple\n        Depending on 'multi_output' and 'include_metrics', returns either the \n        average likelihood ratio, an array of likelihood ratios, or a tuple \n        containing the likelihood ratios and metrics arrays.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import calculate_multiclass_lr\n    &gt;&gt;&gt; y_true = [0, 1, 2, 2, 1, 0]\n    &gt;&gt;&gt; y_pred = [0, 2, 1, 2, 1, 0]\n    &gt;&gt;&gt; calculate_multiclass_lr(y_true, y_pred, consensus='positive', strategy='ovr')\n    1.6765\n    \n    &gt;&gt;&gt; from gofast.tools.mathex import calculate_multiclass_lr\n    &gt;&gt;&gt;"" y_true = [0, 1, 2, 2, 1, 0]\n    &gt;&gt;&gt; y_pred = [0, 2, 1, 2, 1, 0]\n    &gt;&gt;&gt; calculate_multiclass_lr(y_true, y_pred, consensus='positive', strategy='ovr')\n    1.6765\n    \n    &gt;&gt;&gt; calculate_multiclass_lr(y_true, y_pred, consensus='negative', strategy='ovo')\n    0.9890\n    \n    Notes\n    -----\n    The likelihood ratio (LR) for a given class or class pair is calculated as:\n    \n    .. math::\n        LR_+ = \\frac{\\text{sensitivity}}{1 - \\text{specificity}}\n    \n    or\n    \n    .. math::\n        LR_- = \\frac{1 - \\text{sensitivity}}{\\text{specificity}}\n    \n    If `apply_log_scale` is True, the log-likelihood ratio (LLR) is computed, \n    which transforms the LR using the natural logarithm:\n    \n    .. math::\n        LLR = \\log(LR)\n    \n    This transformation helps manage extreme values and improves the interpretability\n    of the results, especially when dealing with very high or very low likelihood ratios.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_17calculate_multiclass_lr = {"calculate_multiclass_lr", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_17calculate_multiclass_lr, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_16calculate_multiclass_lr};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_17calculate_multiclass_lr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_consensus = 0;
  PyObject *__pyx_v_sample_weight = 0;
  PyObject *__pyx_v_strategy = 0;
  PyObject *__pyx_v_epsilon = 0;
  PyObject *__pyx_v_multi_output = 0;
  PyObject *__pyx_v_apply_log_scale = 0;
  PyObject *__pyx_v_include_metrics = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_multiclass_lr (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_consensus,&amp;__pyx_n_s_sample_weight,&amp;__pyx_n_s_strategy,&amp;__pyx_n_s_epsilon,&amp;__pyx_n_s_multi_output,&amp;__pyx_n_s_apply_log_scale,&amp;__pyx_n_s_include_metrics,0};
  PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_positive)));
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_16calculate_multiclass_lr(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_consensus, PyObject *__pyx_v_sample_weight, PyObject *__pyx_v_strategy, PyObject *__pyx_v_epsilon, PyObject *__pyx_v_multi_output, PyObject *__pyx_v_apply_log_scale, PyObject *__pyx_v_include_metrics) {
  PyObject *__pyx_v_classes = NULL;
  PyObject *__pyx_v_results = NULL;
  PyObject *__pyx_v_sensitivities = NULL;
  PyObject *__pyx_v_specificities = NULL;
  PyObject *__pyx_v_y_true_binarized = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_label = NULL;
  PyObject *__pyx_v_sensitivity = NULL;
  PyObject *__pyx_v_specificity = NULL;
  PyObject *__pyx_v_lr = NULL;
  PyObject *__pyx_v_cls1 = NULL;
  PyObject *__pyx_v_cls2 = NULL;
  PyObject *__pyx_v_relevant_mask = NULL;
  PyObject *__pyx_v_y_true_binary = NULL;
  PyObject *__pyx_v_y_pred_binary = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__22)
  <span class='trace'>__Pyx_TraceCall</span>("calculate_multiclass_lr", __pyx_f[0], 662, 0, <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_consensus);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_strategy);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_epsilon);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_multiclass_lr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_classes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_results);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sensitivities);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_specificities);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true_binarized);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_label);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sensitivity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_specificity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cls1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cls2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_relevant_mask);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true_binary);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred_binary);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_consensus);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_strategy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_epsilon);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__162 = <span class='py_c_api'>PyTuple_Pack</span>(24, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_consensus, __pyx_n_s_sample_weight, __pyx_n_s_strategy, __pyx_n_s_epsilon, __pyx_n_s_multi_output, __pyx_n_s_apply_log_scale, __pyx_n_s_include_metrics, __pyx_n_s_classes, __pyx_n_s_results, __pyx_n_s_sensitivities, __pyx_n_s_specificities, __pyx_n_s_y_true_binarized, __pyx_n_s_i, __pyx_n_s_label, __pyx_n_s_sensitivity, __pyx_n_s_specificity, __pyx_n_s_lr, __pyx_n_s_cls1, __pyx_n_s_cls2, __pyx_n_s_relevant_mask, __pyx_n_s_y_true_binary, __pyx_n_s_y_pred_binary);<span class='error_goto'> if (unlikely(!__pyx_tuple__162)) __PYX_ERR(0, 662, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__162);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__162);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(662,0,<span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_consensus, ((PyObject*)__pyx_n_u_positive)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(662,0,<span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_17calculate_multiclass_lr, 0, __pyx_n_s_calculate_multiclass_lr, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__22));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 662, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calculate_multiclass_lr, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__22 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 7, 24, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__162, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_calculate_multiclass_lr, 662, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(0, 662, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0663</span>:     y_true, y_pred, *,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0664</span>:     consensus='positive',</pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0665</span>:     sample_weight=None,</pre>
<pre class='cython code score-38 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_ovr)));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_10)));
    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_uniform_average)));
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(665,0,<span class='error_goto'>__PYX_ERR(0, 665, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_sample_weight, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_strategy, ((PyObject*)__pyx_n_u_ovr)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_epsilon, ((PyObject*)__pyx_float_1eneg_10)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_multi_output, ((PyObject*)__pyx_n_u_uniform_average)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_apply_log_scale, ((PyObject *)Py_False)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_include_metrics, ((PyObject *)Py_False)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0666</span>:     strategy='ovr',</pre>
<pre class="cython line score-0">&#xA0;<span class="">0667</span>:     epsilon=1e-10,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0668</span>:     multi_output='uniform_average',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0669</span>:     apply_log_scale=False,</pre>
<pre class='cython code score-2 '>    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0670</span>:     include_metrics=False</pre>
<pre class='cython code score-49 '>    values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_multiclass_lr", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 7)) {
        Py_ssize_t index;
        for (index = 2; index &lt; 9 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate_multiclass_lr") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_consensus = values[2];
    __pyx_v_sample_weight = values[3];
    __pyx_v_strategy = values[4];
    __pyx_v_epsilon = values[5];
    __pyx_v_multi_output = values[6];
    __pyx_v_apply_log_scale = values[7];
    __pyx_v_include_metrics = values[8];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_multiclass_lr", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 662, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_multiclass_lr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_16calculate_multiclass_lr(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_consensus, __pyx_v_sample_weight, __pyx_v_strategy, __pyx_v_epsilon, __pyx_v_multi_output, __pyx_v_apply_log_scale, __pyx_v_include_metrics);
</pre><pre class="cython line score-0">&#xA0;<span class="">0671</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0672</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0673</span>:     Calculate the multiclass likelihood ratio for classification using either</pre>
<pre class="cython line score-0">&#xA0;<span class="">0674</span>:     one-versus-rest (OvR) or one-versus-one (OvO) strategies. Optionally applies</pre>
<pre class="cython line score-0">&#xA0;<span class="">0675</span>:     logarithmic scaling to the likelihood ratios and can return sensitivity and</pre>
<pre class="cython line score-0">&#xA0;<span class="">0676</span>:     specificity values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0677</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0678</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0679</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0680</span>:     y_true : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">0681</span>:         True class labels as integers.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0682</span>:     y_pred : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">0683</span>:         Predicted class labels as integers.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0684</span>:     consensus : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0685</span>:         Specifies the type of likelihood ratio to compute: 'positive'</pre>
<pre class="cython line score-0">&#xA0;<span class="">0686</span>:         (default) or 'negative'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0687</span>:     strategy : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0688</span>:         Specifies the computation strategy: 'ovr' (one-versus-rest, default)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0689</span>:         or 'ovo' (one-versus-one).</pre>
<pre class="cython line score-0">&#xA0;<span class="">0690</span>:     epsilon : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0691</span>:         A small value to prevent division by zero in calculations.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0692</span>:         Default is 1e-10.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0693</span>:     multi_output : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0694</span>:         If 'uniform_average', returns the average of the computed likelihood</pre>
<pre class="cython line score-0">&#xA0;<span class="">0695</span>:         ratios. If 'raw_values', returns the likelihood ratios for each class</pre>
<pre class="cython line score-0">&#xA0;<span class="">0696</span>:         comparison.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0697</span>:     apply_log_scale : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0698</span>:         If True, applies the natural logarithm to the likelihood ratios,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0699</span>:         returning the log-likelihood ratios.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0700</span>:     include_metrics : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0701</span>:         If True, returns a tuple containing the likelihood ratios and arrays</pre>
<pre class="cython line score-0">&#xA0;<span class="">0702</span>:         of sensitivities and specificities.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0703</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0704</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0705</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0706</span>:     float or tuple</pre>
<pre class="cython line score-0">&#xA0;<span class="">0707</span>:         Depending on 'multi_output' and 'include_metrics', returns either the</pre>
<pre class="cython line score-0">&#xA0;<span class="">0708</span>:         average likelihood ratio, an array of likelihood ratios, or a tuple</pre>
<pre class="cython line score-0">&#xA0;<span class="">0709</span>:         containing the likelihood ratios and metrics arrays.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0710</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0711</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0712</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0713</span>:     &gt;&gt;&gt; from gofast.tools.mathex import calculate_multiclass_lr</pre>
<pre class="cython line score-0">&#xA0;<span class="">0714</span>:     &gt;&gt;&gt; y_true = [0, 1, 2, 2, 1, 0]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0715</span>:     &gt;&gt;&gt; y_pred = [0, 2, 1, 2, 1, 0]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0716</span>:     &gt;&gt;&gt; calculate_multiclass_lr(y_true, y_pred, consensus='positive', strategy='ovr')</pre>
<pre class="cython line score-0">&#xA0;<span class="">0717</span>:     1.6765</pre>
<pre class="cython line score-0">&#xA0;<span class="">0718</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0719</span>:     &gt;&gt;&gt; from gofast.tools.mathex import calculate_multiclass_lr</pre>
<pre class="cython line score-0">&#xA0;<span class="">0720</span>:     &gt;&gt;&gt; y_true = [0, 1, 2, 2, 1, 0]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0721</span>:     &gt;&gt;&gt; y_pred = [0, 2, 1, 2, 1, 0]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0722</span>:     &gt;&gt;&gt; calculate_multiclass_lr(y_true, y_pred, consensus='positive', strategy='ovr')</pre>
<pre class="cython line score-0">&#xA0;<span class="">0723</span>:     1.6765</pre>
<pre class="cython line score-0">&#xA0;<span class="">0724</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0725</span>:     &gt;&gt;&gt; calculate_multiclass_lr(y_true, y_pred, consensus='negative', strategy='ovo')</pre>
<pre class="cython line score-0">&#xA0;<span class="">0726</span>:     0.9890</pre>
<pre class="cython line score-0">&#xA0;<span class="">0727</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0728</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">0729</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">0730</span>:     The likelihood ratio (LR) for a given class or class pair is calculated as:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0731</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0732</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">0733</span>:         LR_+ = \\frac{\\text{sensitivity}}{1 - \\text{specificity}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0734</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0735</span>:     or</pre>
<pre class="cython line score-0">&#xA0;<span class="">0736</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0737</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">0738</span>:         LR_- = \\frac{1 - \\text{sensitivity}}{\\text{specificity}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0739</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0740</span>:     If `apply_log_scale` is True, the log-likelihood ratio (LLR) is computed,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0741</span>:     which transforms the LR using the natural logarithm:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0742</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0743</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">0744</span>:         LLR = \\log(LR)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0745</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0746</span>:     This transformation helps manage extreme values and improves the interpretability</pre>
<pre class="cython line score-0">&#xA0;<span class="">0747</span>:     of the results, especially when dealing with very high or very low likelihood ratios.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0748</span>:     """</pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0749</span>:     y_true, y_pred = _ensure_y_is_valid(y_true, y_pred, y_numeric=True)</pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(749,0,<span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_ensure_y_is_valid);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_numeric, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
    index = 0; __pyx_t_3 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0750</span>:     ensure_non_negative(</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(750,0,<span class='error_goto'>__PYX_ERR(0, 750, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_ensure_non_negative);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(751,0,<span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 750, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 750, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(750,0,<span class='error_goto'>__PYX_ERR(0, 750, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0751</span>:         y_true, y_pred,</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0752</span>:         err_msg="y_true and y_pred must contain non-negative values."</pre>
<pre class='cython code score-7 '>  <span class='trace'>__Pyx_TraceLine</span>(752,0,<span class='error_goto'>__PYX_ERR(0, 752, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_err_msg, __pyx_kp_u_y_true_and_y_pred_must_contain_n) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 752, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0753</span>:     )</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0754</span>:     epsilon = check_epsilon(epsilon, y_true, y_pred)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(754,0,<span class='error_goto'>__PYX_ERR(0, 754, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_check_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 754, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_2, __pyx_v_epsilon, __pyx_v_y_true, __pyx_v_y_pred};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 3+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 754, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_epsilon, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0755</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0756</span>:     consensus = parameter_validator(</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(756,0,<span class='error_goto'>__PYX_ERR(0, 756, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_parameter_validator);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(756,0,<span class='error_goto'>__PYX_ERR(0, 756, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__21, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0757</span>:         "consensus", target_strs={'negative', 'positive'})(consensus)</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(757,0,<span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PySet_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_4, __pyx_n_u_negative) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_4, __pyx_n_u_positive) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_target_strs, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(757,0,<span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>)
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_consensus};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_consensus, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0758</span>:     strategy = parameter_validator(</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(758,0,<span class='error_goto'>__PYX_ERR(0, 758, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_parameter_validator);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 758, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(758,0,<span class='error_goto'>__PYX_ERR(0, 758, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__7, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 758, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0759</span>:         "strategy", target_strs={'ovr', 'ovo'})(strategy)</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(759,0,<span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PySet_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 759, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_3, __pyx_n_u_ovr) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_3, __pyx_n_u_ovo) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_target_strs, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(759,0,<span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>)
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_strategy};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 759, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_strategy, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0760</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0761</span>:     classes = np.unique(y_true)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(761,0,<span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_unique);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_true};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 761, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_classes = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0762</span>:     results = []</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(762,0,<span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_results = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0763</span>:     sensitivities = []</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(763,0,<span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 763, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_sensitivities = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0764</span>:     specificities = []</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(764,0,<span class='error_goto'>__PYX_ERR(0, 764, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_specificities = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0765</span>:     y_true = validate_multiclass_target( y_true )</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(765,0,<span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_validate_multiclass_target);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_true};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0766</span>:     if strategy == 'ovr':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(766,0,<span class='error_goto'>__PYX_ERR(0, 766, __pyx_L1_error)</span>)
  __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_strategy, __pyx_n_u_ovr, Py_EQ)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 766, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0767</span>:         y_true_binarized = label_binarize(y_true, classes=classes)</pre>
<pre class='cython code score-22 '>    <span class='trace'>__Pyx_TraceLine</span>(767,0,<span class='error_goto'>__PYX_ERR(0, 767, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_label_binarize);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 767, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 767, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 767, __pyx_L1_error)</span>;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 767, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_classes, __pyx_v_classes) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 767, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 767, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_y_true_binarized = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0768</span>:         for i, label in enumerate(classes):</pre>
<pre class='cython code score-56 '>    <span class='trace'>__Pyx_TraceLine</span>(768,0,<span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_t_4 = __pyx_int_0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_classes)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_classes)) {
      __pyx_t_3 = __pyx_v_classes; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_classes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 768, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 768, __pyx_L1_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_8 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_8++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>
          #else
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_8 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_8++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>
          #else
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        }
      } else {
        __pyx_t_2 = __pyx_t_9(__pyx_t_3);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_label, __pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_4);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 768, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4);
      __pyx_t_4 = __pyx_t_2;
      __pyx_t_2 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(768,0,<span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0769</span>:             # Isolate the class against all others</pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0770</span>:             sensitivity, specificity = _compute_sensitivity_specificity(</pre>
<pre class='cython code score-64 '>      <span class='trace'>__Pyx_TraceLine</span>(770,0,<span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_compute_sensitivity_specificity);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(770,0,<span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>)
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>;
      __pyx_t_10 = 0;
      __pyx_t_1 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(770,0,<span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>)
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_12, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_10))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_10))) {
        PyObject* sequence = __pyx_t_10;
        Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_12 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 770, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);
        index = 0; __pyx_t_1 = __pyx_t_5(__pyx_t_2); if (unlikely(!__pyx_t_1)) goto __pyx_L8_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        index = 1; __pyx_t_12 = __pyx_t_5(__pyx_t_2); if (unlikely(!__pyx_t_12)) goto __pyx_L8_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_2), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>
        __pyx_t_5 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        goto __pyx_L9_unpacking_done;
        __pyx_L8_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_5 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>__PYX_ERR(0, 770, __pyx_L1_error)</span>
        __pyx_L9_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sensitivity, __pyx_t_1);
      __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_specificity, __pyx_t_12);
      __pyx_t_12 = 0;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0771</span>:                 y_true_binarized[:, i], (y_pred == label).astype(int),</pre>
<pre class='cython code score-36 '>      <span class='trace'>__Pyx_TraceLine</span>(771,0,<span class='error_goto'>__PYX_ERR(0, 771, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 771, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_i)) <span class='error_goto'>__PYX_ERR(0, 771, __pyx_L1_error)</span>;
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_true_binarized, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_11 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_pred, __pyx_v_label, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 771, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_11, ((PyObject *)(&amp;PyInt_Type))};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_12, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 771, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0772</span>:                 sample_weight=sample_weight,</pre>
<pre class='cython code score-7 '>      <span class='trace'>__Pyx_TraceLine</span>(772,0,<span class='error_goto'>__PYX_ERR(0, 772, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 772, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0773</span>:                 epsilon=epsilon</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(773,0,<span class='error_goto'>__PYX_ERR(0, 773, __pyx_L1_error)</span>)
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_epsilon, __pyx_v_epsilon) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 772, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0774</span>:             )</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0775</span>:             lr = calculate_adjusted_lr (</pre>
<pre class='cython code score-19 '>      <span class='trace'>__Pyx_TraceLine</span>(775,0,<span class='error_goto'>__PYX_ERR(0, 775, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_calculate_adjusted_lr);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(776,0,<span class='error_goto'>__PYX_ERR(0, 776, __pyx_L1_error)</span>)
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sensitivity);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sensitivity);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_v_sensitivity)) <span class='error_goto'>__PYX_ERR(0, 775, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_specificity);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_specificity);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_v_specificity)) <span class='error_goto'>__PYX_ERR(0, 775, __pyx_L1_error)</span>;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(775,0,<span class='error_goto'>__PYX_ERR(0, 775, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_12, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_lr, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0776</span>:                 sensitivity, specificity,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0777</span>:                 consensus = consensus,</pre>
<pre class='cython code score-12 '>      <span class='trace'>__Pyx_TraceLine</span>(777,0,<span class='error_goto'>__PYX_ERR(0, 777, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_consensus, __pyx_v_consensus) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L1_error)</span>
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_max_lr, __pyx_float_1e1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0778</span>:                 max_lr=1e1</pre>
<pre class="cython line score-0">&#xA0;<span class="">0779</span>:             )</pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0780</span>:             results.append(np.log(lr) if apply_log_scale else lr)</pre>
<pre class='cython code score-25 '>      <span class='trace'>__Pyx_TraceLine</span>(780,0,<span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_apply_log_scale); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>
      if (__pyx_t_7) {
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_12, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 780, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_12 = NULL;
        __pyx_t_6 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
          __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
          if (likely(__pyx_t_12)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
            __pyx_t_6 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_v_lr};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        }
        __pyx_t_2 = __pyx_t_1;
        __pyx_t_1 = 0;
      } else {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_lr);
        __pyx_t_2 = __pyx_v_lr;
      }
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_results, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 780, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0781</span>:             sensitivities.append(sensitivity)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(781,0,<span class='error_goto'>__PYX_ERR(0, 781, __pyx_L1_error)</span>)
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_sensitivities, __pyx_v_sensitivity);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 781, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0782</span>:             specificities.append(specificity)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(782,0,<span class='error_goto'>__PYX_ERR(0, 782, __pyx_L1_error)</span>)
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_specificities, __pyx_v_specificity);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 782, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0783</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0784</span>:     elif strategy == 'ovo':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(784,0,<span class='error_goto'>__PYX_ERR(0, 784, __pyx_L1_error)</span>)
  __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_strategy, __pyx_n_u_ovo, Py_EQ)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 784, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
  }
  __pyx_L5:;
</pre><pre class="cython line score-116" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0785</span>:         for cls1, cls2 in itertools.combinations(classes, 2):</pre>
<pre class='cython code score-116 '>    <span class='trace'>__Pyx_TraceLine</span>(785,0,<span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_itertools);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_combinations);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_classes, __pyx_int_2};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      __pyx_t_2 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
    } else {
      __pyx_t_8 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    for (;;) {
      if (likely(!__pyx_t_9)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_8 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_8++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
          #else
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_8 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_8++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
          #else
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          #endif
        }
      } else {
        __pyx_t_4 = __pyx_t_9(__pyx_t_2);
        if (unlikely(!__pyx_t_4)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        PyObject* sequence = __pyx_t_4;
        Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 785, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_10);
        index = 0; __pyx_t_3 = __pyx_t_5(__pyx_t_10); if (unlikely(!__pyx_t_3)) goto __pyx_L13_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        index = 1; __pyx_t_1 = __pyx_t_5(__pyx_t_10); if (unlikely(!__pyx_t_1)) goto __pyx_L13_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_10), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
        __pyx_t_5 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        goto __pyx_L14_unpacking_done;
        __pyx_L13_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_5 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>
        __pyx_L14_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cls1, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cls2, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(785,0,<span class='error_goto'>__PYX_ERR(0, 785, __pyx_L1_error)</span>)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0786</span>:             relevant_mask = (y_true == cls1) | (y_true == cls2)</pre>
<pre class='cython code score-18 '>      <span class='trace'>__Pyx_TraceLine</span>(786,0,<span class='error_goto'>__PYX_ERR(0, 786, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_true, __pyx_v_cls1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_true, __pyx_v_cls2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Or</span>(__pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 786, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_relevant_mask, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0787</span>:             y_true_binary = (y_true[relevant_mask] == cls1).astype(int)</pre>
<pre class='cython code score-26 '>      <span class='trace'>__Pyx_TraceLine</span>(787,0,<span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_true, __pyx_v_relevant_mask);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_v_cls1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 787, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, ((PyObject *)(&amp;PyInt_Type))};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 787, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y_true_binary, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0788</span>:             y_pred_binary = (y_pred[relevant_mask] == cls1).astype(int)</pre>
<pre class='cython code score-26 '>      <span class='trace'>__Pyx_TraceLine</span>(788,0,<span class='error_goto'>__PYX_ERR(0, 788, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_pred, __pyx_v_relevant_mask);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_v_cls1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, ((PyObject *)(&amp;PyInt_Type))};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 788, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y_pred_binary, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0789</span>:             sensitivity, specificity = _compute_sensitivity_specificity(</pre>
<pre class='cython code score-66 '>      <span class='trace'>__Pyx_TraceLine</span>(789,0,<span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_compute_sensitivity_specificity);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(790,0,<span class='error_goto'>__PYX_ERR(0, 790, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true_binary);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true_binary);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_y_true_binary)) <span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred_binary);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred_binary);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_y_pred_binary)) <span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(789,0,<span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>)
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_10))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_10))) {
        PyObject* sequence = __pyx_t_10;
        Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        #else
        __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 789, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);
        index = 0; __pyx_t_4 = __pyx_t_5(__pyx_t_3); if (unlikely(!__pyx_t_4)) goto __pyx_L15_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        index = 1; __pyx_t_1 = __pyx_t_5(__pyx_t_3); if (unlikely(!__pyx_t_1)) goto __pyx_L15_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_3), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>
        __pyx_t_5 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        goto __pyx_L16_unpacking_done;
        __pyx_L15_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_5 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>__PYX_ERR(0, 789, __pyx_L1_error)</span>
        __pyx_L16_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_sensitivity, __pyx_t_4);
      __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_specificity, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0790</span>:                 y_true_binary, y_pred_binary,</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0791</span>:                 sample_weight=sample_weight,</pre>
<pre class='cython code score-7 '>      <span class='trace'>__Pyx_TraceLine</span>(791,0,<span class='error_goto'>__PYX_ERR(0, 791, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 791, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 791, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0792</span>:                 epsilon= epsilon,</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(792,0,<span class='error_goto'>__PYX_ERR(0, 792, __pyx_L1_error)</span>)
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_epsilon, __pyx_v_epsilon) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 791, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0793</span>:                 )</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0794</span>:             lr = calculate_adjusted_lr (</pre>
<pre class='cython code score-19 '>      <span class='trace'>__Pyx_TraceLine</span>(794,0,<span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_calculate_adjusted_lr);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(795,0,<span class='error_goto'>__PYX_ERR(0, 795, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sensitivity);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sensitivity);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_sensitivity)) <span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_specificity);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_specificity);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_specificity)) <span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(794,0,<span class='error_goto'>__PYX_ERR(0, 794, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_lr, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0795</span>:                 sensitivity, specificity,</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0796</span>:                 consensus = consensus, max_lr=1e1 )</pre>
<pre class='cython code score-12 '>      <span class='trace'>__Pyx_TraceLine</span>(796,0,<span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 796, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_consensus, __pyx_v_consensus) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_max_lr, __pyx_float_1e1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 796, __pyx_L1_error)</span>
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0797</span>:             results.append(np.log(lr) if apply_log_scale else lr)</pre>
<pre class='cython code score-25 '>      <span class='trace'>__Pyx_TraceLine</span>(797,0,<span class='error_goto'>__PYX_ERR(0, 797, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_apply_log_scale); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 797, __pyx_L1_error)</span>
      if (__pyx_t_7) {
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 797, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 797, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = NULL;
        __pyx_t_6 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
          __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
          if (likely(__pyx_t_1)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
            __pyx_t_6 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_lr};
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 797, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        }
        __pyx_t_3 = __pyx_t_4;
        __pyx_t_4 = 0;
      } else {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_lr);
        __pyx_t_3 = __pyx_v_lr;
      }
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_results, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 797, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0798</span>:             sensitivities.append(sensitivity)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(798,0,<span class='error_goto'>__PYX_ERR(0, 798, __pyx_L1_error)</span>)
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_sensitivities, __pyx_v_sensitivity);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 798, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0799</span>:             specificities.append(specificity)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(799,0,<span class='error_goto'>__PYX_ERR(0, 799, __pyx_L1_error)</span>)
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_specificities, __pyx_v_specificity);<span class='error_goto'> if (unlikely(__pyx_t_13 == ((int)-1))) __PYX_ERR(0, 799, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0800</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0801</span>:     if multi_output == 'uniform_average':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(801,0,<span class='error_goto'>__PYX_ERR(0, 801, __pyx_L1_error)</span>)
  __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_multi_output, __pyx_n_u_uniform_average, Py_EQ)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 801, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0802</span>:         # Return raw values for each class comparison</pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0803</span>:         return (np.mean(results), np.asarray(sensitivities),</pre>
<pre class='cython code score-50 '>    <span class='trace'>__Pyx_TraceLine</span>(803,0,<span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(803,0,<span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 803, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 803, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_results};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 803, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 803, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_sensitivities};
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(803,0,<span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>)
      __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 803, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_12, 2, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 803, __pyx_L1_error)</span>;
      __pyx_t_3 = 0;
      __pyx_t_10 = 0;
      __pyx_t_1 = 0;
      __pyx_t_2 = __pyx_t_12;
      __pyx_t_12 = 0;
    } else {
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0804</span>:                 np.asarray(specificities)) if include_metrics else np.mean(results)</pre>
<pre class='cython code score-40 '>    <span class='trace'>__Pyx_TraceLine</span>(804,0,<span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_include_metrics); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>
    if (__pyx_t_7) {
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(804,0,<span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_specificities};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_12, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      }
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(804,0,<span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 804, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_results};
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_2 = __pyx_t_12;
      __pyx_t_12 = 0;
    }
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0805</span>:     else:</pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0806</span>:         return (np.array(results), np.asarray(sensitivities),</pre>
<pre class='cython code score-50 '>  <span class='trace'>__Pyx_TraceLine</span>(806,0,<span class='error_goto'>__PYX_ERR(0, 806, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(806,0,<span class='error_goto'>__PYX_ERR(0, 806, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_v_results};
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 806, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_v_sensitivities};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 806, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(806,0,<span class='error_goto'>__PYX_ERR(0, 806, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 806, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_12);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 806, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 806, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 806, __pyx_L1_error)</span>;
      __pyx_t_12 = 0;
      __pyx_t_1 = 0;
      __pyx_t_3 = 0;
      __pyx_t_2 = __pyx_t_4;
      __pyx_t_4 = 0;
    } else {
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0807</span>:                 np.asarray(specificities)) if include_metrics else np.array(results)</pre>
<pre class='cython code score-40 '>    <span class='trace'>__Pyx_TraceLine</span>(807,0,<span class='error_goto'>__PYX_ERR(0, 807, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_include_metrics); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 807, __pyx_L1_error)</span>
    if (__pyx_t_7) {
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(807,0,<span class='error_goto'>__PYX_ERR(0, 807, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 807, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 807, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_v_specificities};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 807, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(807,0,<span class='error_goto'>__PYX_ERR(0, 807, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 807, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 807, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_results};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 807, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_2 = __pyx_t_4;
      __pyx_t_4 = 0;
    }
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0808</span>: </pre>
<pre class="cython line score-127" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0809</span>: def calculate_adjusted_lr(</pre>
<pre class='cython code score-127 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_19calculate_adjusted_lr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_18calculate_adjusted_lr, "\n    Calculate the likelihood ratio with modifications to avoid extremely high \n    values, particularly when specificity is close to 1.\n\n    Parameters\n    ----------\n    sensitivity : float or numpy.ndarray\n        The probability of correctly identifying a true positive, expressed as a \n        scalar for single measurement or an array for multiple measurements. Each\n        value represents the sensitivity for a given test or condition.\n    \n    specificity : float or numpy.ndarray\n        The probability of correctly identifying a true negative, similarly\n        expressed as either a scalar for a single measurement or an array for\n        multiple measurements. Each value corresponds to the specificity of \n        a test or condition and must match the dimensions of `sensitivity` if\n        provided as an array.\n\n    consensus : str, optional\n        Specifies the type of likelihood ratio to compute:\n        - 'positive': Computes the positive likelihood ratio (LR+), which\n          is sensitivity divided by (1 - specificity). This ratio indicates\n          how much the odds of the disease increase when a test is positive.\n        - 'negative': Computes the negative likelihood ratio (LR-), which\n          is (1 - sensitivity) divided by specificity. This ratio indicates\n          how much the odds of the disease decrease when a test is negative.\n          Default is 'positive'.\n    \n    max_lr : float, optional\n        The maximum allowed value for the likelihood ratio to prevent\n        extreme values that could be misleading or difficult to interpret.\n        Default is 100, which means likelihood ratios are capped at this value \n        to avoid disproportionately high results that could result from very\n        small denominators.\n\n    buffer : float, optional\n        A small value added to the denominator in the likelihood ratio\n        calculation to prevent division by near-zero, which can lead to\n        extremely ""high values. This buffer ensures stability in the calculations\n        by avoiding infinite or very large ratios. Default is 1e-2.\n\n    Returns\n    -------\n    float or numpy.ndarray\n        The adjusted likelihood ratio, either as a single value or an array of\n        values, depending on the input format. Each ratio is capped at `max_lr`\n        and adjusted for low denominators using `buffer`.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import calculate_adjusted_lr\n    &gt;&gt;&gt; calculate_adjusted_lr(0.95, 0.89)\n    8.636363636363637\n\n    &gt;&gt;&gt; calculate_adjusted_lr(np.array([0.95, 0.80]), np.array([0.89, 0.90]), \n                              consensus='negative', max_lr=10)\n    array([1.04545455, 2.        ])\n  \n    &gt;&gt;&gt; calculate_adjusted_lr(0.99, 0.999, consensus='positive')\n    99.0\n    &gt;&gt;&gt; calculate_adjusted_lr(0.80, 0.95, consensus='negative', max_lr=100,\n    ... buffer=0.005)\n    0.21052631578947364\n\n    Notes\n    -----\n    The likelihood ratio (LR) is calculated based on the specified `consensus`:\n    \n    For a 'positive' likelihood ratio:\n        \n    .. math::\n        LR_+ = \\frac{\\text{sensitivity}}{\\max(1 - \\text{specificity}, \n        \\text{buffer})}\n\n    For a 'negative' likelihood ratio:\n        \n    .. math::\n        LR_- = \\frac{1 - \\text{sensitivity}}{\\max(\\text{specificity}, \n        \\text{buffer})}\n\n    This approach helps to manage situations where specificity is very close to 1,\n    which would normally result in a very high LR due to a small denominator.\n    The `max_lr` parameter caps the LR to a maximum value, preventing extremely\n    high ratios that might be misleading or difficult to interpret in practical\n    scenarios.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_19calculate_adjusted_lr = {"calculate_adjusted_lr", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_19calculate_adjusted_lr, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_18calculate_adjusted_lr};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_19calculate_adjusted_lr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_sensitivity = 0;
  PyObject *__pyx_v_specificity = 0;
  PyObject *__pyx_v_consensus = 0;
  PyObject *__pyx_v_max_lr = 0;
  PyObject *__pyx_v_buffer = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_adjusted_lr (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_sensitivity,&amp;__pyx_n_s_specificity,&amp;__pyx_n_s_consensus,&amp;__pyx_n_s_max_lr,&amp;__pyx_n_s_buffer,0};
  PyObject* values[5] = {0,0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_positive)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_100)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_2)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sensitivity)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 809, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_specificity)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 809, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_adjusted_lr", 0, 2, 5, 1); <span class='error_goto'>__PYX_ERR(0, 809, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_consensus);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 809, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_lr);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 809, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_buffer);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 809, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate_adjusted_lr") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 809, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_sensitivity = values[0];
    __pyx_v_specificity = values[1];
    __pyx_v_consensus = values[2];
    __pyx_v_max_lr = values[3];
    __pyx_v_buffer = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_adjusted_lr", 0, 2, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 809, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_adjusted_lr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_18calculate_adjusted_lr(__pyx_self, __pyx_v_sensitivity, __pyx_v_specificity, __pyx_v_consensus, __pyx_v_max_lr, __pyx_v_buffer);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_18calculate_adjusted_lr(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_sensitivity, PyObject *__pyx_v_specificity, PyObject *__pyx_v_consensus, PyObject *__pyx_v_max_lr, PyObject *__pyx_v_buffer) {
  PyObject *__pyx_v_lr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__23)
  <span class='trace'>__Pyx_TraceCall</span>("calculate_adjusted_lr", __pyx_f[0], 809, 0, <span class='error_goto'>__PYX_ERR(0, 809, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sensitivity);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_specificity);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_adjusted_lr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sensitivity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_specificity);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__163 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_sensitivity, __pyx_n_s_specificity, __pyx_n_s_consensus, __pyx_n_s_max_lr, __pyx_n_s_buffer, __pyx_n_s_lr);<span class='error_goto'> if (unlikely(!__pyx_tuple__163)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__163);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__163);
  __pyx_codeobj__23 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__163, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_calculate_adjusted_lr, 809, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(809,0,<span class='error_goto'>__PYX_ERR(0, 809, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_19calculate_adjusted_lr, 0, __pyx_n_s_calculate_adjusted_lr, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__23));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__164);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calculate_adjusted_lr, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 809, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__164 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject*)__pyx_n_u_positive), ((PyObject *)__pyx_int_100), ((PyObject*)__pyx_float_1eneg_2));<span class='error_goto'> if (unlikely(!__pyx_tuple__164)) __PYX_ERR(0, 809, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__164);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__164);
</pre><pre class="cython line score-0">&#xA0;<span class="">0810</span>:     sensitivity,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0811</span>:     specificity,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0812</span>:     consensus="positive",</pre>
<pre class="cython line score-0">&#xA0;<span class="">0813</span>:     max_lr=100,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0814</span>:     buffer=1e-2</pre>
<pre class="cython line score-0">&#xA0;<span class="">0815</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">0816</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0817</span>:     Calculate the likelihood ratio with modifications to avoid extremely high</pre>
<pre class="cython line score-0">&#xA0;<span class="">0818</span>:     values, particularly when specificity is close to 1.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0819</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0820</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0821</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0822</span>:     sensitivity : float or numpy.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">0823</span>:         The probability of correctly identifying a true positive, expressed as a</pre>
<pre class="cython line score-0">&#xA0;<span class="">0824</span>:         scalar for single measurement or an array for multiple measurements. Each</pre>
<pre class="cython line score-0">&#xA0;<span class="">0825</span>:         value represents the sensitivity for a given test or condition.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0826</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0827</span>:     specificity : float or numpy.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">0828</span>:         The probability of correctly identifying a true negative, similarly</pre>
<pre class="cython line score-0">&#xA0;<span class="">0829</span>:         expressed as either a scalar for a single measurement or an array for</pre>
<pre class="cython line score-0">&#xA0;<span class="">0830</span>:         multiple measurements. Each value corresponds to the specificity of</pre>
<pre class="cython line score-0">&#xA0;<span class="">0831</span>:         a test or condition and must match the dimensions of `sensitivity` if</pre>
<pre class="cython line score-0">&#xA0;<span class="">0832</span>:         provided as an array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0833</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0834</span>:     consensus : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0835</span>:         Specifies the type of likelihood ratio to compute:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0836</span>:         - 'positive': Computes the positive likelihood ratio (LR+), which</pre>
<pre class="cython line score-0">&#xA0;<span class="">0837</span>:           is sensitivity divided by (1 - specificity). This ratio indicates</pre>
<pre class="cython line score-0">&#xA0;<span class="">0838</span>:           how much the odds of the disease increase when a test is positive.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0839</span>:         - 'negative': Computes the negative likelihood ratio (LR-), which</pre>
<pre class="cython line score-0">&#xA0;<span class="">0840</span>:           is (1 - sensitivity) divided by specificity. This ratio indicates</pre>
<pre class="cython line score-0">&#xA0;<span class="">0841</span>:           how much the odds of the disease decrease when a test is negative.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0842</span>:           Default is 'positive'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0843</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0844</span>:     max_lr : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0845</span>:         The maximum allowed value for the likelihood ratio to prevent</pre>
<pre class="cython line score-0">&#xA0;<span class="">0846</span>:         extreme values that could be misleading or difficult to interpret.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0847</span>:         Default is 100, which means likelihood ratios are capped at this value</pre>
<pre class="cython line score-0">&#xA0;<span class="">0848</span>:         to avoid disproportionately high results that could result from very</pre>
<pre class="cython line score-0">&#xA0;<span class="">0849</span>:         small denominators.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0850</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0851</span>:     buffer : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0852</span>:         A small value added to the denominator in the likelihood ratio</pre>
<pre class="cython line score-0">&#xA0;<span class="">0853</span>:         calculation to prevent division by near-zero, which can lead to</pre>
<pre class="cython line score-0">&#xA0;<span class="">0854</span>:         extremely high values. This buffer ensures stability in the calculations</pre>
<pre class="cython line score-0">&#xA0;<span class="">0855</span>:         by avoiding infinite or very large ratios. Default is 1e-2.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0856</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0857</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0858</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0859</span>:     float or numpy.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">0860</span>:         The adjusted likelihood ratio, either as a single value or an array of</pre>
<pre class="cython line score-0">&#xA0;<span class="">0861</span>:         values, depending on the input format. Each ratio is capped at `max_lr`</pre>
<pre class="cython line score-0">&#xA0;<span class="">0862</span>:         and adjusted for low denominators using `buffer`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0863</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0864</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0865</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0866</span>:     &gt;&gt;&gt; from gofast.tools.mathex import calculate_adjusted_lr</pre>
<pre class="cython line score-0">&#xA0;<span class="">0867</span>:     &gt;&gt;&gt; calculate_adjusted_lr(0.95, 0.89)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0868</span>:     8.636363636363637</pre>
<pre class="cython line score-0">&#xA0;<span class="">0869</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0870</span>:     &gt;&gt;&gt; calculate_adjusted_lr(np.array([0.95, 0.80]), np.array([0.89, 0.90]),</pre>
<pre class="cython line score-0">&#xA0;<span class="">0871</span>:                               consensus='negative', max_lr=10)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0872</span>:     array([1.04545455, 2.        ])</pre>
<pre class="cython line score-0">&#xA0;<span class="">0873</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0874</span>:     &gt;&gt;&gt; calculate_adjusted_lr(0.99, 0.999, consensus='positive')</pre>
<pre class="cython line score-0">&#xA0;<span class="">0875</span>:     99.0</pre>
<pre class="cython line score-0">&#xA0;<span class="">0876</span>:     &gt;&gt;&gt; calculate_adjusted_lr(0.80, 0.95, consensus='negative', max_lr=100,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0877</span>:     ... buffer=0.005)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0878</span>:     0.21052631578947364</pre>
<pre class="cython line score-0">&#xA0;<span class="">0879</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0880</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">0881</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">0882</span>:     The likelihood ratio (LR) is calculated based on the specified `consensus`:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0883</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0884</span>:     For a 'positive' likelihood ratio:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0885</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0886</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">0887</span>:         LR_+ = \\frac{\\text{sensitivity}}{\\max(1 - \\text{specificity},</pre>
<pre class="cython line score-0">&#xA0;<span class="">0888</span>:         \\text{buffer})}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0889</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0890</span>:     For a 'negative' likelihood ratio:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0891</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0892</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">0893</span>:         LR_- = \\frac{1 - \\text{sensitivity}}{\\max(\\text{specificity},</pre>
<pre class="cython line score-0">&#xA0;<span class="">0894</span>:         \\text{buffer})}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0895</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0896</span>:     This approach helps to manage situations where specificity is very close to 1,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0897</span>:     which would normally result in a very high LR due to a small denominator.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0898</span>:     The `max_lr` parameter caps the LR to a maximum value, preventing extremely</pre>
<pre class="cython line score-0">&#xA0;<span class="">0899</span>:     high ratios that might be misleading or difficult to interpret in practical</pre>
<pre class="cython line score-0">&#xA0;<span class="">0900</span>:     scenarios.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0901</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0902</span>:     # Ensure input compatibility if sensitivity and specificity are</pre>
<pre class="cython line score-0">&#xA0;<span class="">0903</span>:     # provided as lists or tuples</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0904</span>:     sensitivity = np.array(sensitivity)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(904,0,<span class='error_goto'>__PYX_ERR(0, 904, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 904, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_sensitivity};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 904, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sensitivity, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0905</span>:     specificity = np.array(specificity)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(905,0,<span class='error_goto'>__PYX_ERR(0, 905, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 905, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 905, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_specificity};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 905, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_specificity, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0906</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0907</span>:     # Compute the likelihood ratio based on the given consensus</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0908</span>:     if consensus == "positive":</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(908,0,<span class='error_goto'>__PYX_ERR(0, 908, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_consensus, __pyx_n_u_positive, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 908, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0909</span>:         lr = sensitivity / np.maximum(1 - specificity, buffer)</pre>
<pre class='cython code score-25 '>    <span class='trace'>__Pyx_TraceLine</span>(909,0,<span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_maximum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_specificity, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_6, __pyx_t_2, __pyx_v_buffer};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 909, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_sensitivity, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_lr = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0910</span>:     elif consensus == "negative":</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(910,0,<span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_consensus, __pyx_n_u_negative, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
  if (likely(__pyx_t_5)) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0911</span>:         lr = (1 - sensitivity) / np.maximum(specificity, buffer)</pre>
<pre class='cython code score-25 '>    <span class='trace'>__Pyx_TraceLine</span>(911,0,<span class='error_goto'>__PYX_ERR(0, 911, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_sensitivity, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 911, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 911, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_maximum);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 911, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_specificity, __pyx_v_buffer};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 911, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 911, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_lr = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0912</span>:     else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0913</span>:         raise ValueError("Consensus must be either 'positive' or 'negative'")</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(913,0,<span class='error_goto'>__PYX_ERR(0, 913, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__24, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 913, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_6, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='error_goto'>__PYX_ERR(0, 913, __pyx_L1_error)</span>
  }
  __pyx_L3:;
/* … */
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Consensus_must_be_either_positiv);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 913, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
</pre><pre class="cython line score-0">&#xA0;<span class="">0914</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0915</span>:     # Cap the likelihood ratios at the maximum allowed value</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0916</span>:     lr = np.minimum(lr, max_lr)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(916,0,<span class='error_goto'>__PYX_ERR(0, 916, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 916, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_minimum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 916, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_v_lr, __pyx_v_max_lr};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 916, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_lr, __pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0917</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0918</span>:     return lr</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(918,0,<span class='error_goto'>__PYX_ERR(0, 918, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_lr);
  __pyx_r = __pyx_v_lr;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0919</span>: </pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0920</span>: def _compute_sensitivity_specificity(</pre>
<pre class='cython code score-54 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_21_compute_sensitivity_specificity(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_20_compute_sensitivity_specificity, "\n    Calculate sensitivity and specificity for binary classification results,\n    optionally using sample weights to adjust the importance of each sample.\n\n    Parameters\n    ----------\n    y_true : array-like\n        Binary ground truth labels (1 for positive class, 0 for negative class).\n    y_pred : array-like\n        Binary predicted labels (1 for positive class, 0 for negative class).\n    sample_weight : array-like, optional\n        Weights applied to each sample when calculating sensitivity and specificity.\n        If None, all samples are assumed to have equal weight. Sample weights are\n        typically used in datasets where some samples are more important than\n        others or in the presence of class imbalance.\n    epsilon : float, optional\n        Small value added to denominators to avoid division by zero. \n        Default is 1e-10.\n\n    Returns\n    -------\n    tuple\n        A tuple containing the sensitivity and specificity values.\n\n    Notes\n    -----\n    Sensitivity and specificity are calculated using the following formulas:\n    \n    .. math::\n        \text{sensitivity} = \014rac{\\sum (w_i \\cdot [y_{true}^i = 1 \\cap y_{pred}^i = 1])}\n        {\\sum (w_i \\cdot [y_{true}^i = 1]) + \\epsilon}\n\n    .. math::\n        \text{specificity} = \014rac{\\sum (w_i \\cdot [y_{true}^i = 0 \\cap y_{pred}^i = 0])}\n        {\\sum (w_i \\cdot [y_{true}^i = 0]) + \\epsilon}\n\n    Where \\( w_i \\) are the sample weights. If `sample_weight` is None,\n    all weights are considered equal to 1.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import calculate_binary_metrics\n    &gt;&gt;&gt; y_true = [1, 0, 1, 1, 0, 1, 0, 0]\n    &gt;&gt;&gt; y_pred = [1, 0, 0, 1, 0, 1, 1, 0]\n    &gt;&gt;&gt; sensitivity, specificity = calculate_binary_metrics(y_true, y_pred)\n    &gt;&gt;&gt; print(f\"Sensitivity: {sensitivity:.2f}, Specificity: {specificity:.2f}\")\n    Sensitivity: 0.75, Specificity: 0.75\n\n    &gt;&gt;&gt; weights = [1, 1, 2, 2, 1, 2, 1, 1]\n    &gt;&gt;&gt; sensit""ivity, specificity = calculate_binary_metrics(y_true, y_pred, sample_weight=weights)\n    &gt;&gt;&gt; print(f\"Sensitivity: {sensitivity:.2f}, Specificity: {specificity:.2f}\")\n    Sensitivity: 0.80, Specificity: 0.83\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_21_compute_sensitivity_specificity = {"_compute_sensitivity_specificity", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_21_compute_sensitivity_specificity, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_20_compute_sensitivity_specificity};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_21_compute_sensitivity_specificity(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_sample_weight = 0;
  PyObject *__pyx_v_epsilon = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_compute_sensitivity_specificity (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_sample_weight,&amp;__pyx_n_s_epsilon,0};
  PyObject* values[4] = {0,0,0,0};
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_20_compute_sensitivity_specificity(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_sample_weight, PyObject *__pyx_v_epsilon) {
  PyObject *__pyx_v_true_positives = NULL;
  PyObject *__pyx_v_false_positives = NULL;
  PyObject *__pyx_v_false_negatives = NULL;
  PyObject *__pyx_v_true_negatives = NULL;
  PyObject *__pyx_v_sensitivity = NULL;
  PyObject *__pyx_v_specificity = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__25)
  <span class='trace'>__Pyx_TraceCall</span>("_compute_sensitivity_specificity", __pyx_f[0], 920, 0, <span class='error_goto'>__PYX_ERR(0, 920, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sample_weight);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_epsilon);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._compute_sensitivity_specificity", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_true_positives);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_false_positives);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_false_negatives);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_true_negatives);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sensitivity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_specificity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sample_weight);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_epsilon);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__165 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_sample_weight, __pyx_n_s_epsilon, __pyx_n_s_true_positives, __pyx_n_s_false_positives, __pyx_n_s_false_negatives, __pyx_n_s_true_negatives, __pyx_n_s_sensitivity, __pyx_n_s_specificity);<span class='error_goto'> if (unlikely(!__pyx_tuple__165)) __PYX_ERR(0, 920, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__165);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__165);
  __pyx_codeobj__25 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__165, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_sensitivity_specificity, 920, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 920, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(920,0,<span class='error_goto'>__PYX_ERR(0, 920, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_21_compute_sensitivity_specificity, 0, __pyx_n_s_compute_sensitivity_specificity, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__25));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 920, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__166);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_sensitivity_specificity, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 920, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__166 = <span class='py_c_api'>PyTuple_Pack</span>(2, Py_None, ((PyObject*)__pyx_float_1eneg_10));<span class='error_goto'> if (unlikely(!__pyx_tuple__166)) __PYX_ERR(0, 920, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__166);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__166);
</pre><pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0921</span>:         y_true, y_pred, sample_weight=None, epsilon=1e-10):</pre>
<pre class='cython code score-68 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_10)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 920, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 920, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_sensitivity_specificity", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 920, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sample_weight);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 920, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_epsilon);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 920, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_compute_sensitivity_specificity") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 920, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_sample_weight = values[2];
    __pyx_v_epsilon = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_sensitivity_specificity", 0, 2, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 920, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._compute_sensitivity_specificity", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_20_compute_sensitivity_specificity(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_sample_weight, __pyx_v_epsilon);
</pre><pre class="cython line score-0">&#xA0;<span class="">0922</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">0923</span>:     Calculate sensitivity and specificity for binary classification results,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0924</span>:     optionally using sample weights to adjust the importance of each sample.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0925</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0926</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">0927</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0928</span>:     y_true : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">0929</span>:         Binary ground truth labels (1 for positive class, 0 for negative class).</pre>
<pre class="cython line score-0">&#xA0;<span class="">0930</span>:     y_pred : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">0931</span>:         Binary predicted labels (1 for positive class, 0 for negative class).</pre>
<pre class="cython line score-0">&#xA0;<span class="">0932</span>:     sample_weight : array-like, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0933</span>:         Weights applied to each sample when calculating sensitivity and specificity.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0934</span>:         If None, all samples are assumed to have equal weight. Sample weights are</pre>
<pre class="cython line score-0">&#xA0;<span class="">0935</span>:         typically used in datasets where some samples are more important than</pre>
<pre class="cython line score-0">&#xA0;<span class="">0936</span>:         others or in the presence of class imbalance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0937</span>:     epsilon : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">0938</span>:         Small value added to denominators to avoid division by zero.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0939</span>:         Default is 1e-10.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0940</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0941</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">0942</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0943</span>:     tuple</pre>
<pre class="cython line score-0">&#xA0;<span class="">0944</span>:         A tuple containing the sensitivity and specificity values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0945</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0946</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">0947</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">0948</span>:     Sensitivity and specificity are calculated using the following formulas:</pre>
<pre class="cython line score-0">&#xA0;<span class="">0949</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0950</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">0951</span>:         \text{sensitivity} = \frac{\sum (w_i \cdot [y_{true}^i = 1 \cap y_{pred}^i = 1])}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0952</span>:         {\sum (w_i \cdot [y_{true}^i = 1]) + \epsilon}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0953</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0954</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">0955</span>:         \text{specificity} = \frac{\sum (w_i \cdot [y_{true}^i = 0 \cap y_{pred}^i = 0])}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0956</span>:         {\sum (w_i \cdot [y_{true}^i = 0]) + \epsilon}</pre>
<pre class="cython line score-0">&#xA0;<span class="">0957</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0958</span>:     Where \( w_i \) are the sample weights. If `sample_weight` is None,</pre>
<pre class="cython line score-0">&#xA0;<span class="">0959</span>:     all weights are considered equal to 1.</pre>
<pre class="cython line score-0">&#xA0;<span class="">0960</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0961</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">0962</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">0963</span>:     &gt;&gt;&gt; from gofast.tools.mathex import calculate_binary_metrics</pre>
<pre class="cython line score-0">&#xA0;<span class="">0964</span>:     &gt;&gt;&gt; y_true = [1, 0, 1, 1, 0, 1, 0, 0]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0965</span>:     &gt;&gt;&gt; y_pred = [1, 0, 0, 1, 0, 1, 1, 0]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0966</span>:     &gt;&gt;&gt; sensitivity, specificity = calculate_binary_metrics(y_true, y_pred)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0967</span>:     &gt;&gt;&gt; print(f"Sensitivity: {sensitivity:.2f}, Specificity: {specificity:.2f}")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0968</span>:     Sensitivity: 0.75, Specificity: 0.75</pre>
<pre class="cython line score-0">&#xA0;<span class="">0969</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0970</span>:     &gt;&gt;&gt; weights = [1, 1, 2, 2, 1, 2, 1, 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">0971</span>:     &gt;&gt;&gt; sensitivity, specificity = calculate_binary_metrics(y_true, y_pred, sample_weight=weights)</pre>
<pre class="cython line score-0">&#xA0;<span class="">0972</span>:     &gt;&gt;&gt; print(f"Sensitivity: {sensitivity:.2f}, Specificity: {specificity:.2f}")</pre>
<pre class="cython line score-0">&#xA0;<span class="">0973</span>:     Sensitivity: 0.80, Specificity: 0.83</pre>
<pre class="cython line score-0">&#xA0;<span class="">0974</span>:     """</pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0975</span>:     y_true, y_pred = _ensure_y_is_valid( y_true, y_pred, y_numeric =True)</pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(975,0,<span class='error_goto'>__PYX_ERR(0, 975, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_ensure_y_is_valid);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 975, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 975, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_numeric, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 975, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 975, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 975, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
    index = 0; __pyx_t_3 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 975, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 975, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0976</span>:     ensure_non_negative(</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(976,0,<span class='error_goto'>__PYX_ERR(0, 976, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_ensure_non_negative);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 976, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(977,0,<span class='error_goto'>__PYX_ERR(0, 977, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 976, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 976, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 976, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(976,0,<span class='error_goto'>__PYX_ERR(0, 976, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 976, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0977</span>:         y_true, y_pred,</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0978</span>:         err_msg="y_true and y_pred must contain non-negative values."</pre>
<pre class='cython code score-7 '>  <span class='trace'>__Pyx_TraceLine</span>(978,0,<span class='error_goto'>__PYX_ERR(0, 978, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 978, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_err_msg, __pyx_kp_u_y_true_and_y_pred_must_contain_n) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 978, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">0979</span>:     )</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0980</span>:     epsilon = check_epsilon(epsilon, y_true, y_pred )</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(980,0,<span class='error_goto'>__PYX_ERR(0, 980, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_check_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 980, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_2, __pyx_v_epsilon, __pyx_v_y_true, __pyx_v_y_pred};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 3+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 980, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_epsilon, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0981</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0982</span>:     if sample_weight is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(982,0,<span class='error_goto'>__PYX_ERR(0, 982, __pyx_L1_error)</span>)
  __pyx_t_7 = (__pyx_v_sample_weight != Py_None);
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0983</span>:         sample_weight = validate_sample_weights(sample_weight, y_true)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(983,0,<span class='error_goto'>__PYX_ERR(0, 983, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_validate_sample_weights);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 983, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_sample_weight, __pyx_v_y_true};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 983, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sample_weight, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0984</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0985</span>:     # Calculate true positives, false positives, false negatives, and true negatives</pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0986</span>:     true_positives = np.sum(((y_true == 1) &amp; (y_pred == 1)) * (</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(986,0,<span class='error_goto'>__PYX_ERR(0, 986, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 986, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 986, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_y_true, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 986, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_y_pred, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 986, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 986, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(986,0,<span class='error_goto'>__PYX_ERR(0, 986, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 986, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 986, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_true_positives = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0987</span>:         sample_weight if sample_weight is not None else 1))</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(987,0,<span class='error_goto'>__PYX_ERR(0, 987, __pyx_L1_error)</span>)
  __pyx_t_7 = (__pyx_v_sample_weight != Py_None);
  if (__pyx_t_7) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sample_weight);
    __pyx_t_4 = __pyx_v_sample_weight;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    __pyx_t_4 = __pyx_int_1;
  }
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0988</span>:     false_positives = np.sum(((y_true == 0) &amp; (y_pred == 1)) * (</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(988,0,<span class='error_goto'>__PYX_ERR(0, 988, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 988, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_y_true, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_y_pred, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 988, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 988, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(988,0,<span class='error_goto'>__PYX_ERR(0, 988, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 988, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 988, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_false_positives = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0989</span>:         sample_weight if sample_weight is not None else 1))</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(989,0,<span class='error_goto'>__PYX_ERR(0, 989, __pyx_L1_error)</span>)
  __pyx_t_7 = (__pyx_v_sample_weight != Py_None);
  if (__pyx_t_7) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sample_weight);
    __pyx_t_4 = __pyx_v_sample_weight;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    __pyx_t_4 = __pyx_int_1;
  }
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0990</span>:     false_negatives = np.sum(((y_true == 1) &amp; (y_pred == 0)) * (</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(990,0,<span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_y_true, __pyx_int_1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_y_pred, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(990,0,<span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 990, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_false_negatives = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0991</span>:         sample_weight if sample_weight is not None else 1))</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(991,0,<span class='error_goto'>__PYX_ERR(0, 991, __pyx_L1_error)</span>)
  __pyx_t_7 = (__pyx_v_sample_weight != Py_None);
  if (__pyx_t_7) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sample_weight);
    __pyx_t_4 = __pyx_v_sample_weight;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    __pyx_t_4 = __pyx_int_1;
  }
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0992</span>:     true_negatives = np.sum(((y_true == 0) &amp; (y_pred == 0)) * (</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(992,0,<span class='error_goto'>__PYX_ERR(0, 992, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 992, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 992, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_y_true, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 992, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_EqObjC</span>(__pyx_v_y_pred, __pyx_int_0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 992, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 992, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(992,0,<span class='error_goto'>__PYX_ERR(0, 992, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_8, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 992, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 992, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_true_negatives = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0993</span>:         sample_weight if sample_weight is not None else 1))</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(993,0,<span class='error_goto'>__PYX_ERR(0, 993, __pyx_L1_error)</span>)
  __pyx_t_7 = (__pyx_v_sample_weight != Py_None);
  if (__pyx_t_7) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sample_weight);
    __pyx_t_4 = __pyx_v_sample_weight;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    __pyx_t_4 = __pyx_int_1;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">0994</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">0995</span>:     # Calculate sensitivity and specificity with weighted counts</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0996</span>:     sensitivity = true_positives / (true_positives + false_negatives + epsilon)</pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(996,0,<span class='error_goto'>__PYX_ERR(0, 996, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_true_positives, __pyx_v_false_negatives);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 996, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 996, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_true_positives, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 996, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_sensitivity = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0997</span>:     specificity = true_negatives / (true_negatives + false_positives + epsilon)</pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(997,0,<span class='error_goto'>__PYX_ERR(0, 997, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_true_negatives, __pyx_v_false_positives);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 997, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 997, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_true_negatives, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 997, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_specificity = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">0998</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">0999</span>:     return sensitivity, specificity</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(999,0,<span class='error_goto'>__PYX_ERR(0, 999, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 999, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sensitivity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sensitivity);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_sensitivity)) <span class='error_goto'>__PYX_ERR(0, 999, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_specificity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_specificity);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_specificity)) <span class='error_goto'>__PYX_ERR(0, 999, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1000</span>: </pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1001</span>: def compute_sensitivity_specificity(</pre>
<pre class='cython code score-69 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_23compute_sensitivity_specificity(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_22compute_sensitivity_specificity, "\n    Calculate sensitivity and specificity for binary or multiclass classification\n    results, with support for different strategies and averaging methods. \n\n    Parameters\n    ----------\n    y_true : array-like of shape (n_samples,)\n        True class labels. Each element in this array should be an integer\n        representing the actual class of the corresponding sample.\n    y_pred : array-like of shape (n_samples,)\n        Predicted class labels. Each element should correspond to the predicted\n        class label for the sample.\n    sample_weight : array-like of shape (n_samples,), optional\n        Weights applied to each sample when calculating metrics. If not provided,\n        all samples are assumed to have equal weight. Useful in cases of class\n        imbalance or when some samples are more critical than others.\n    strategy : {'ovr', 'ovo'}, default 'ovr'\n        The strategy to calculate metrics:\n        - 'ovr' (One-vs-Rest): Metrics are calculated by treating each class as\n          the positive class against all other classes combined.\n        - 'ovo' (One-vs-One): Metrics are calculated for each pair of classes.\n          This can be more computationally intensive.\n    average : {'macro', 'micro', 'weighted'}, default 'macro'\n        Specifies the method to average sensitivity and specificity:\n        - 'macro': Calculate metrics for each label, and find their unweighted mean.\n        - 'micro': Calculate metrics globally across all classes.\n        - 'weighted': Calculate metrics for each label, and find their average,\n          weighted by the number of true instances for each label.\n    epsilon : float or \"auto\", optional\n        A small constant added to the denominator to prevent division by zero. If\n        'auto', the machine epsilon for float64 is used. Defaults to \"auto\".\n\n    Returns\n    -------\n    tuple\n        A tuple containing the averaged or non-averaged sensitivity and specificity.\n\n    Example""s\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import compute_sensitivity_specificity\n    &gt;&gt;&gt; y_true = [0, 1, 1, 0]\n    &gt;&gt;&gt; y_pred = [0, 1, 0, 1]\n    &gt;&gt;&gt; compute_sensitivity_specificity(y_true, y_pred)\n    (0.5, 0.5)\n\n    Notes\n    -----\n    Sensitivity (also known as recall or true positive rate) and specificity\n    (true negative rate) are calculated from the confusion matrix as:\n\n    .. math::\n        \text{sensitivity} = \014rac{TP}{TP + FN}\n\n    .. math::\n        \text{specificity} = \014rac{TN}{TN + FP}\n\n    Here, TP, TN, FN, and FP denote the counts of true positives, true negatives,\n    false negatives, and false positives, respectively.\n\n    - Micro averaging will sum the counts of true positives, false negatives, and\n      false positives across all classes and then compute the metrics.\n    - Macro averaging will compute the metrics independently for each class but\n      then take the unweighted mean. This does not take label imbalance into\n      account.\n    - Weighted averaging will compute the metrics for each class, and find their\n      average weighted by the number of true instances for each label, which\n      helps in addressing label imbalance.\n\n    The choice of averaging method depends on the balance of classes and the\n    importance of each class in the dataset.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_23compute_sensitivity_specificity = {"compute_sensitivity_specificity", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_23compute_sensitivity_specificity, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_22compute_sensitivity_specificity};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_23compute_sensitivity_specificity(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_sample_weight = 0;
  PyObject *__pyx_v_strategy = 0;
  PyObject *__pyx_v_average = 0;
  PyObject *__pyx_v_epsilon = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_sensitivity_specificity (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_sample_weight,&amp;__pyx_n_s_strategy,&amp;__pyx_n_s_average,&amp;__pyx_n_s_epsilon,0};
  PyObject* values[6] = {0,0,0,0,0,0};
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_22compute_sensitivity_specificity(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_sample_weight, PyObject *__pyx_v_strategy, PyObject *__pyx_v_average, PyObject *__pyx_v_epsilon) {
  PyObject *__pyx_v_labels = NULL;
  PyObject *__pyx_v_label_to_index = NULL;
  PyObject *__pyx_v_y_true_indices = NULL;
  PyObject *__pyx_v_y_pred_indices = NULL;
  PyObject *__pyx_v_cm = NULL;
  PyObject *__pyx_v_sensitivity = NULL;
  PyObject *__pyx_v_specificity = NULL;
  Py_ssize_t __pyx_v_i;
  PyObject *__pyx_v_TP = NULL;
  PyObject *__pyx_v_FN = NULL;
  PyObject *__pyx_v_FP = NULL;
  PyObject *__pyx_v_TN = NULL;
  PyObject *__pyx_v_support = NULL;
  PyObject *__pyx_v_total_TP = NULL;
  PyObject *__pyx_v_total_FN = NULL;
  PyObject *__pyx_v_total_FP = NULL;
  PyObject *__pyx_v_total_TN = NULL;
  PyObject *__pyx_v_micro_sensitivity = NULL;
  PyObject *__pyx_v_micro_specificity = NULL;
  PyObject *__pyx_8genexpr1__pyx_v_index = NULL;
  PyObject *__pyx_8genexpr1__pyx_v_label = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__26)
  <span class='trace'>__Pyx_TraceCall</span>("compute_sensitivity_specificity", __pyx_f[0], 1001, 0, <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_strategy);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_average);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_epsilon);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_sensitivity_specificity", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_labels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_label_to_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true_indices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred_indices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cm);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sensitivity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_specificity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_TP);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_FN);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_FP);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_TN);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_support);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_TP);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_FN);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_FP);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_TN);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_micro_sensitivity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_micro_specificity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_label);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_strategy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_average);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_epsilon);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__167 = <span class='py_c_api'>PyTuple_Pack</span>(27, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_sample_weight, __pyx_n_s_strategy, __pyx_n_s_average, __pyx_n_s_epsilon, __pyx_n_s_labels, __pyx_n_s_label_to_index, __pyx_n_s_y_true_indices, __pyx_n_s_y_pred_indices, __pyx_n_s_cm, __pyx_n_s_sensitivity, __pyx_n_s_specificity, __pyx_n_s_i, __pyx_n_s_TP, __pyx_n_s_FN, __pyx_n_s_FP, __pyx_n_s_TN, __pyx_n_s_support, __pyx_n_s_total_TP, __pyx_n_s_total_FN, __pyx_n_s_total_FP, __pyx_n_s_total_TN, __pyx_n_s_micro_sensitivity, __pyx_n_s_micro_specificity, __pyx_n_s_index, __pyx_n_s_label);<span class='error_goto'> if (unlikely(!__pyx_tuple__167)) __PYX_ERR(0, 1001, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__167);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__167);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1001,0,<span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1001, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1001,0,<span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_23compute_sensitivity_specificity, 0, __pyx_n_s_compute_sensitivity_specificity_2, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__26));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1001, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_sensitivity_specificity_2, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__26 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 4, 27, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__167, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_sensitivity_specificity_2, 1001, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__26)) __PYX_ERR(0, 1001, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1002</span>:     y_true, y_pred, *,</pre>
<pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1003</span>:     sample_weight=None,</pre>
<pre class='cython code score-75 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_ovr)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_macro)));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_auto)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_sensitivity_specificity", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 4)) {
        Py_ssize_t index;
        for (index = 2; index &lt; 6 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_sensitivity_specificity") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_sample_weight = values[2];
    __pyx_v_strategy = values[3];
    __pyx_v_average = values[4];
    __pyx_v_epsilon = values[5];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_sensitivity_specificity", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_sensitivity_specificity", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_22compute_sensitivity_specificity(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_sample_weight, __pyx_v_strategy, __pyx_v_average, __pyx_v_epsilon);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1003,0,<span class='error_goto'>__PYX_ERR(0, 1003, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_sample_weight, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_strategy, ((PyObject*)__pyx_n_u_ovr)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_average, ((PyObject*)__pyx_n_u_macro)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_epsilon, ((PyObject*)__pyx_n_u_auto)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1001, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1004</span>:     strategy='ovr',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1005</span>:     average='macro',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1006</span>:     epsilon="auto"</pre>
<pre class="cython line score-0">&#xA0;<span class="">1007</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1008</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1009</span>:     Calculate sensitivity and specificity for binary or multiclass classification</pre>
<pre class="cython line score-0">&#xA0;<span class="">1010</span>:     results, with support for different strategies and averaging methods.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1011</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1012</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1013</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1014</span>:     y_true : array-like of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1015</span>:         True class labels. Each element in this array should be an integer</pre>
<pre class="cython line score-0">&#xA0;<span class="">1016</span>:         representing the actual class of the corresponding sample.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1017</span>:     y_pred : array-like of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1018</span>:         Predicted class labels. Each element should correspond to the predicted</pre>
<pre class="cython line score-0">&#xA0;<span class="">1019</span>:         class label for the sample.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1020</span>:     sample_weight : array-like of shape (n_samples,), optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1021</span>:         Weights applied to each sample when calculating metrics. If not provided,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1022</span>:         all samples are assumed to have equal weight. Useful in cases of class</pre>
<pre class="cython line score-0">&#xA0;<span class="">1023</span>:         imbalance or when some samples are more critical than others.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1024</span>:     strategy : {'ovr', 'ovo'}, default 'ovr'</pre>
<pre class="cython line score-0">&#xA0;<span class="">1025</span>:         The strategy to calculate metrics:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1026</span>:         - 'ovr' (One-vs-Rest): Metrics are calculated by treating each class as</pre>
<pre class="cython line score-0">&#xA0;<span class="">1027</span>:           the positive class against all other classes combined.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1028</span>:         - 'ovo' (One-vs-One): Metrics are calculated for each pair of classes.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1029</span>:           This can be more computationally intensive.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1030</span>:     average : {'macro', 'micro', 'weighted'}, default 'macro'</pre>
<pre class="cython line score-0">&#xA0;<span class="">1031</span>:         Specifies the method to average sensitivity and specificity:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1032</span>:         - 'macro': Calculate metrics for each label, and find their unweighted mean.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1033</span>:         - 'micro': Calculate metrics globally across all classes.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1034</span>:         - 'weighted': Calculate metrics for each label, and find their average,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1035</span>:           weighted by the number of true instances for each label.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1036</span>:     epsilon : float or "auto", optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1037</span>:         A small constant added to the denominator to prevent division by zero. If</pre>
<pre class="cython line score-0">&#xA0;<span class="">1038</span>:         'auto', the machine epsilon for float64 is used. Defaults to "auto".</pre>
<pre class="cython line score-0">&#xA0;<span class="">1039</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1040</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1041</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1042</span>:     tuple</pre>
<pre class="cython line score-0">&#xA0;<span class="">1043</span>:         A tuple containing the averaged or non-averaged sensitivity and specificity.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1044</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1045</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1046</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1047</span>:     &gt;&gt;&gt; from gofast.tools.mathex import compute_sensitivity_specificity</pre>
<pre class="cython line score-0">&#xA0;<span class="">1048</span>:     &gt;&gt;&gt; y_true = [0, 1, 1, 0]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1049</span>:     &gt;&gt;&gt; y_pred = [0, 1, 0, 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1050</span>:     &gt;&gt;&gt; compute_sensitivity_specificity(y_true, y_pred)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1051</span>:     (0.5, 0.5)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1053</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">1054</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">1055</span>:     Sensitivity (also known as recall or true positive rate) and specificity</pre>
<pre class="cython line score-0">&#xA0;<span class="">1056</span>:     (true negative rate) are calculated from the confusion matrix as:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1057</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1058</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">1059</span>:         \text{sensitivity} = \frac{TP}{TP + FN}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1060</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1061</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">1062</span>:         \text{specificity} = \frac{TN}{TN + FP}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1063</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1064</span>:     Here, TP, TN, FN, and FP denote the counts of true positives, true negatives,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1065</span>:     false negatives, and false positives, respectively.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1067</span>:     - Micro averaging will sum the counts of true positives, false negatives, and</pre>
<pre class="cython line score-0">&#xA0;<span class="">1068</span>:       false positives across all classes and then compute the metrics.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1069</span>:     - Macro averaging will compute the metrics independently for each class but</pre>
<pre class="cython line score-0">&#xA0;<span class="">1070</span>:       then take the unweighted mean. This does not take label imbalance into</pre>
<pre class="cython line score-0">&#xA0;<span class="">1071</span>:       account.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1072</span>:     - Weighted averaging will compute the metrics for each class, and find their</pre>
<pre class="cython line score-0">&#xA0;<span class="">1073</span>:       average weighted by the number of true instances for each label, which</pre>
<pre class="cython line score-0">&#xA0;<span class="">1074</span>:       helps in addressing label imbalance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1075</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1076</span>:     The choice of averaging method depends on the balance of classes and the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1077</span>:     importance of each class in the dataset.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1078</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1079</span>: </pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1080</span>:     if is_binary_class(y_true, accept_multioutput= False) :</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(1080,0,<span class='error_goto'>__PYX_ERR(0, 1080, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_is_binary_class);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1080, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 1080, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1080, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_accept_multioutput, Py_False) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1080, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1080, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1080, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1081</span>:         return _compute_sensitivity_specificity (</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(1081,0,<span class='error_goto'>__PYX_ERR(0, 1081, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_compute_sensitivity_specificity);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1081, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1082,0,<span class='error_goto'>__PYX_ERR(0, 1082, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1081, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 1081, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1081, __pyx_L1_error)</span>;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1081,0,<span class='error_goto'>__PYX_ERR(0, 1081, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1081, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1082</span>:             y_true, y_pred, sample_weight=sample_weight,</pre>
<pre class='cython code score-7 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1082, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_sample_weight, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1082, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1083</span>:             epsilon=epsilon # already defined.</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(1083,0,<span class='error_goto'>__PYX_ERR(0, 1083, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_epsilon, __pyx_v_epsilon) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1082, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1084</span>:             )</pre>
<pre class="cython line score-0">&#xA0;<span class="">1085</span>: </pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1086</span>:     y_true, y_pred = _ensure_y_is_valid( y_true, y_pred, y_numeric =True)</pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(1086,0,<span class='error_goto'>__PYX_ERR(0, 1086, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_ensure_y_is_valid);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 1086, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1086, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_numeric, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1086, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 1086, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
    index = 0; __pyx_t_3 = __pyx_t_6(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L4_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_6(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L4_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1086, __pyx_L1_error)</span>
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L5_unpacking_done;
    __pyx_L4_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 1086, __pyx_L1_error)</span>
    __pyx_L5_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1087</span>:     strategy = parameter_validator(</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(1087,0,<span class='error_goto'>__PYX_ERR(0, 1087, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_parameter_validator);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1087,0,<span class='error_goto'>__PYX_ERR(0, 1087, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__7, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1087, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1088</span>:         "strategy", target_strs={'ovr', 'ovo'})(strategy)</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(1088,0,<span class='error_goto'>__PYX_ERR(0, 1088, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='py_c_api'>PySet_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1088, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_1, __pyx_n_u_ovr) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1088, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_1, __pyx_n_u_ovo) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1088, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_target_strs, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1088, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1088,0,<span class='error_goto'>__PYX_ERR(0, 1088, __pyx_L1_error)</span>)
  __pyx_t_3 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_strategy};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1088, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_strategy, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1089</span>:     average = parameter_validator(</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1089,0,<span class='error_goto'>__PYX_ERR(0, 1089, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_parameter_validator);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1089,0,<span class='error_goto'>__PYX_ERR(0, 1089, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__27, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_average);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 1089, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1090</span>:         "average", target_strs={'macro', 'micro', 'weighted'})(average)</pre>
<pre class='cython code score-43 '>  <span class='trace'>__Pyx_TraceLine</span>(1090,0,<span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PySet_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1090, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_2, __pyx_n_u_macro) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_2, __pyx_n_u_micro) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_2, __pyx_n_u_weighted) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_target_strs, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1090,0,<span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>)
  __pyx_t_3 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_average};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1090, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_average, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1091</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1092</span>:     epsilon = check_epsilon(epsilon, y_true, y_pred , scale_factor =1e-10)</pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(1092,0,<span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_check_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_epsilon);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_epsilon);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_epsilon)) <span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_scale_factor, __pyx_float_1eneg_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1092, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_epsilon, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1093</span>:     # Encode labels to integer indices</pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1094</span>:     labels = np.unique(np.concatenate([y_true, y_pred]))</pre>
<pre class='cython code score-51 '>  <span class='trace'>__Pyx_TraceLine</span>(1094,0,<span class='error_goto'>__PYX_ERR(0, 1094, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_unique);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 1094, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1094, __pyx_L1_error)</span>;
  __pyx_t_9 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_4};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1094, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  __pyx_t_8 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1094, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_labels = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1095</span>:     label_to_index = {label: index for index, label in enumerate(labels)}</pre>
<pre class='cython code score-70 '>  <span class='trace'>__Pyx_TraceLine</span>(1095,0,<span class='error_goto'>__PYX_ERR(0, 1095, __pyx_L1_error)</span>)
  { /* enter inner scope */
    __pyx_t_1 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L8_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_t_2 = __pyx_int_0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_labels)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_labels)) {
      __pyx_t_3 = __pyx_v_labels; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_10 = 0;
      __pyx_t_11 = NULL;
    } else {
      __pyx_t_10 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_labels);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1095, __pyx_L8_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1095, __pyx_L8_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_11)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1095, __pyx_L8_error)</span>
            #endif
            if (__pyx_t_10 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1095, __pyx_L8_error)</span>
          #else
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1095, __pyx_L8_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1095, __pyx_L8_error)</span>
            #endif
            if (__pyx_t_10 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1095, __pyx_L8_error)</span>
          #else
          __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1095, __pyx_L8_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
          #endif
        }
      } else {
        __pyx_t_8 = __pyx_t_11(__pyx_t_3);
        if (unlikely(!__pyx_t_8)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 1095, __pyx_L8_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr1__pyx_v_label, __pyx_t_8);
      __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr1__pyx_v_index, __pyx_t_2);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_2, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1095, __pyx_L8_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2);
      __pyx_t_2 = __pyx_t_8;
      __pyx_t_8 = 0;
      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, (PyObject*)__pyx_8genexpr1__pyx_v_label, (PyObject*)__pyx_8genexpr1__pyx_v_index))) <span class='error_goto'>__PYX_ERR(0, 1095, __pyx_L8_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_index); __pyx_8genexpr1__pyx_v_index = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_label); __pyx_8genexpr1__pyx_v_label = 0;
    goto __pyx_L12_exit_scope;
    __pyx_L8_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_index); __pyx_8genexpr1__pyx_v_index = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr1__pyx_v_label); __pyx_8genexpr1__pyx_v_label = 0;
    goto __pyx_L1_error;
    __pyx_L12_exit_scope:;
  } /* exit inner scope */
  __pyx_v_label_to_index = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1096</span>:     y_true_indices = np.vectorize(label_to_index.get)(y_true)</pre>
<pre class='cython code score-36 '>  <span class='trace'>__Pyx_TraceLine</span>(1096,0,<span class='error_goto'>__PYX_ERR(0, 1096, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_vectorize);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_label_to_index, __pyx_n_s_get);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1096, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_3};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1096, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  __pyx_t_8 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_y_true};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1096, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_y_true_indices = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1097</span>:     y_pred_indices = np.vectorize(label_to_index.get)(y_pred)</pre>
<pre class='cython code score-36 '>  <span class='trace'>__Pyx_TraceLine</span>(1097,0,<span class='error_goto'>__PYX_ERR(0, 1097, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1097, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_vectorize);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1097, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_label_to_index, __pyx_n_s_get);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1097, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_8};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1097, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_pred};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1097, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_y_pred_indices = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1098</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1099</span>:     # Compute confusion matrix</pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1100</span>:     cm = confusion_matrix(y_true_indices, y_pred_indices, labels=range(len(labels)))</pre>
<pre class='cython code score-39 '>  <span class='trace'>__Pyx_TraceLine</span>(1100,0,<span class='error_goto'>__PYX_ERR(0, 1100, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_confusion_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true_indices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true_indices);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true_indices)) <span class='error_goto'>__PYX_ERR(0, 1100, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred_indices);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred_indices);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred_indices)) <span class='error_goto'>__PYX_ERR(0, 1100, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_labels);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_labels, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_cm = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1101</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1102</span>:     # Sensitivity and specificity calculation</pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1103</span>:     sensitivity = np.zeros(len(labels))</pre>
<pre class='cython code score-30 '>  <span class='trace'>__Pyx_TraceLine</span>(1103,0,<span class='error_goto'>__PYX_ERR(0, 1103, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_labels);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1103, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_3};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1103, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_sensitivity = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1104</span>:     specificity = np.zeros(len(labels))</pre>
<pre class='cython code score-30 '>  <span class='trace'>__Pyx_TraceLine</span>(1104,0,<span class='error_goto'>__PYX_ERR(0, 1104, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_labels);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_2};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1104, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_specificity = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1105</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1106</span>:     if strategy == 'ovr':  # One-vs-Rest</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1106,0,<span class='error_goto'>__PYX_ERR(0, 1106, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_strategy, __pyx_n_u_ovr, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1106, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
    goto __pyx_L13;
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1107</span>:         for i in range(len(labels)):</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(1107,0,<span class='error_goto'>__PYX_ERR(0, 1107, __pyx_L1_error)</span>)
    __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_labels);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1107, __pyx_L1_error)</span>
    __pyx_t_12 = __pyx_t_10;
    for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
      __pyx_v_i = __pyx_t_13;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1108</span>:             TP = cm[i, i]</pre>
<pre class='cython code score-23 '>      <span class='trace'>__Pyx_TraceLine</span>(1108,0,<span class='error_goto'>__PYX_ERR(0, 1108, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1108, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1108, __pyx_L1_error)</span>;
      __pyx_t_4 = 0;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_TP, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1109</span>:             FN = np.sum(cm[i, :]) - TP</pre>
<pre class='cython code score-45 '>      <span class='trace'>__Pyx_TraceLine</span>(1109,0,<span class='error_goto'>__PYX_ERR(0, 1109, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1109, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 1109, __pyx_L1_error)</span>;
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_7 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_7 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_2};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1109, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_v_TP);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_FN, __pyx_t_4);
      __pyx_t_4 = 0;
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1110</span>:             FP = np.sum(cm[:, i]) - TP</pre>
<pre class='cython code score-45 '>      <span class='trace'>__Pyx_TraceLine</span>(1110,0,<span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L1_error)</span>;
      __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_7 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_7 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_3};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1110, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_v_TP);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_FP, __pyx_t_2);
      __pyx_t_2 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1111</span>:             TN = np.sum(cm) - (TP + FP + FN)</pre>
<pre class='cython code score-38 '>      <span class='trace'>__Pyx_TraceLine</span>(1111,0,<span class='error_goto'>__PYX_ERR(0, 1111, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_7 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_7 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_cm};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1111, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_TP, __pyx_v_FP);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_FN);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_TN, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1112</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1113</span>:             sensitivity[i] = TP / (TP + FN + epsilon)</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(1113,0,<span class='error_goto'>__PYX_ERR(0, 1113, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_TP, __pyx_v_FN);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1113, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1113, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_TP, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1113, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_sensitivity, __pyx_v_i, __pyx_t_3, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1113, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1114</span>:             specificity[i] = TN / (TN + FP + epsilon)</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(1114,0,<span class='error_goto'>__PYX_ERR(0, 1114, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_TN, __pyx_v_FP);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_TN, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1114, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_specificity, __pyx_v_i, __pyx_t_3, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1114, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1115</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1116</span>:     elif strategy == 'ovo':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1116,0,<span class='error_goto'>__PYX_ERR(0, 1116, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_strategy, __pyx_n_u_ovo, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1116, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
  }
  __pyx_L13:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1117</span>:         # Retrieve unique class labels</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1118</span>:         labels = np.unique(y_true)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(1118,0,<span class='error_goto'>__PYX_ERR(0, 1118, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1118, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_unique);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1118, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_y_true};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1118, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_labels, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1119</span>:         return _compute_ovo_sens_spec(y_true, y_pred, labels,</pre>
<pre class='cython code score-22 '>    <span class='trace'>__Pyx_TraceLine</span>(1119,0,<span class='error_goto'>__PYX_ERR(0, 1119, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_compute_ovo_sens_spec);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1119, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1119, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 1119, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1119, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_labels);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_labels);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_labels)) <span class='error_goto'>__PYX_ERR(0, 1119, __pyx_L1_error)</span>;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1119,0,<span class='error_goto'>__PYX_ERR(0, 1119, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1119, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1120</span>:                                       return_array=True</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(1120,0,<span class='error_goto'>__PYX_ERR(0, 1120, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1120, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_return_array, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1120, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1121</span>:                  )</pre>
<pre class="cython line score-0">&#xA0;<span class="">1122</span>:     # Handle averaging of results</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1123</span>:     if average == 'macro':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1123,0,<span class='error_goto'>__PYX_ERR(0, 1123, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_average, __pyx_n_u_macro, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1123, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1124</span>:         return np.mean(sensitivity), np.mean(specificity)</pre>
<pre class='cython code score-48 '>    <span class='trace'>__Pyx_TraceLine</span>(1124,0,<span class='error_goto'>__PYX_ERR(0, 1124, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_sensitivity};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1124, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_specificity};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1124, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1124, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1124, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1124, __pyx_L1_error)</span>;
    __pyx_t_1 = 0;
    __pyx_t_2 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1125</span>:     elif average == 'weighted':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1125,0,<span class='error_goto'>__PYX_ERR(0, 1125, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_average, __pyx_n_u_weighted, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1125, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1126</span>:         support = np.sum(cm, axis=1)</pre>
<pre class='cython code score-25 '>    <span class='trace'>__Pyx_TraceLine</span>(1126,0,<span class='error_goto'>__PYX_ERR(0, 1126, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1126, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1126, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1126, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cm);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cm);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_cm)) <span class='error_goto'>__PYX_ERR(0, 1126, __pyx_L1_error)</span>;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1126, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1126, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1126, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_support = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1127</span>:         return (np.average(sensitivity, weights=support),</pre>
<pre class='cython code score-35 '>    <span class='trace'>__Pyx_TraceLine</span>(1127,0,<span class='error_goto'>__PYX_ERR(0, 1127, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1127, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_average);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1127, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1127, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sensitivity);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sensitivity);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_sensitivity)) <span class='error_goto'>__PYX_ERR(0, 1127, __pyx_L1_error)</span>;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1127, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_weights, __pyx_v_support) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1127, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1127, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1127,0,<span class='error_goto'>__PYX_ERR(0, 1127, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1127, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1127, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 1127, __pyx_L1_error)</span>;
    __pyx_t_2 = 0;
    __pyx_t_8 = 0;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1128</span>:                 np.average(specificity, weights=support))</pre>
<pre class='cython code score-25 '>    <span class='trace'>__Pyx_TraceLine</span>(1128,0,<span class='error_goto'>__PYX_ERR(0, 1128, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_average);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_specificity);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_specificity);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_specificity)) <span class='error_goto'>__PYX_ERR(0, 1128, __pyx_L1_error)</span>;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_weights, __pyx_v_support) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1128, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1129</span>:     elif average == 'micro':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1129,0,<span class='error_goto'>__PYX_ERR(0, 1129, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_average, __pyx_n_u_micro, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1129, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1130</span>:         total_TP = np.sum(np.diag(cm))</pre>
<pre class='cython code score-39 '>    <span class='trace'>__Pyx_TraceLine</span>(1130,0,<span class='error_goto'>__PYX_ERR(0, 1130, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1130, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1130, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1130, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_diag);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1130, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_cm};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 1130, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_t_4 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_8};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1130, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_v_total_TP = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1131</span>:         total_FN = np.sum(np.sum(cm, axis=1) - np.diag(cm))</pre>
<pre class='cython code score-71 '>    <span class='trace'>__Pyx_TraceLine</span>(1131,0,<span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cm);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cm);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_cm)) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_diag);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_cm};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_9, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1131, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    __pyx_v_total_FN = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1132</span>:         total_FP = np.sum(np.sum(cm, axis=0) - np.diag(cm))</pre>
<pre class='cython code score-71 '>    <span class='trace'>__Pyx_TraceLine</span>(1132,0,<span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cm);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cm);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_cm)) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_diag);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_cm};
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_3};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1132, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_v_total_FP = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1133</span>:         total_TN = np.sum(cm) - (total_TP + total_FP + total_FN)</pre>
<pre class='cython code score-37 '>    <span class='trace'>__Pyx_TraceLine</span>(1133,0,<span class='error_goto'>__PYX_ERR(0, 1133, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_cm};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1133, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_total_TP, __pyx_v_total_FP);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_total_FN);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_total_TN = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1134</span>:         micro_sensitivity = total_TP / (total_TP + total_FN + epsilon)</pre>
<pre class='cython code score-14 '>    <span class='trace'>__Pyx_TraceLine</span>(1134,0,<span class='error_goto'>__PYX_ERR(0, 1134, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_total_TP, __pyx_v_total_FN);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1134, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1134, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_total_TP, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1134, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_micro_sensitivity = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1135</span>:         micro_specificity = total_TN / (total_TN + total_FP + epsilon)</pre>
<pre class='cython code score-14 '>    <span class='trace'>__Pyx_TraceLine</span>(1135,0,<span class='error_goto'>__PYX_ERR(0, 1135, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_total_TN, __pyx_v_total_FP);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_total_TN, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1135, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_micro_specificity = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1136</span>:         return micro_sensitivity, micro_specificity</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(1136,0,<span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1136, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_micro_sensitivity);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_micro_sensitivity);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_micro_sensitivity)) <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_micro_specificity);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_micro_specificity);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_micro_specificity)) <span class='error_goto'>__PYX_ERR(0, 1136, __pyx_L1_error)</span>;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1137</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1138</span>:     return sensitivity, specificity</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(1138,0,<span class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sensitivity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sensitivity);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_sensitivity)) <span class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_specificity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_specificity);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_specificity)) <span class='error_goto'>__PYX_ERR(0, 1138, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1139</span>: </pre>
<pre class="cython line score-132" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1140</span>: def _compute_ovo_sens_spec(y_true, y_pred, labels, return_array=True):</pre>
<pre class='cython code score-132 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_25_compute_ovo_sens_spec(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_24_compute_ovo_sens_spec, "\n    Compute sensitivity and specificity for each pair of classes \n    (One-vs-One strategy).\n    Optionally returns sensitivity and specificity as arrays, averaging results \n    over all relevant pairs for each class.\n\n    Parameters:\n    y_true : array-like\n        Ground truth binary labels.\n    y_pred : array-like\n        Predicted binary labels.\n    labels : array-like\n        Array of unique class labels.\n    return_array : bool, default True\n        If True, returns sensitivity and specificity as numpy arrays averaged \n        over all pairs involving each class. If False, returns dictionaries\n        with pairs as keys.\n\n    Returns:\n    --------\n    tuple of (numpy.ndarray, numpy.ndarray) or (dict, dict)\n        Sensitivity and specificity either as arrays or dictionaries depending \n        on `return_array`.\n    Examples \n    ---------\n    &gt;&gt;&gt; import numpy as np \n    &gt;&gt;&gt; from gofast.tools.mathex import _compute_ovo_sens_spec\n    &gt;&gt;&gt; labels = np.array([0, 1, 2])\n    &gt;&gt;&gt; y_true = np.array([0, 1, 1, 2, 2, 0, 1, 2, 0])\n    &gt;&gt;&gt; y_pred = np.array([0, 1, 2, 2, 0, 0, 1, 0, 2])\n    &gt;&gt;&gt; sensitivity, specificity = _compute_ovo_sens_spec(y_true, y_pred, labels, return_array=True)\n    &gt;&gt;&gt; print(\"Sensitivity:\", sensitivity)\n    &gt;&gt;&gt; print(\"Specificity:\", specificity)\n    Sensitivity: [0.66666667 0.66666667 0.66666667]\n    Specificity: [0.66666667 1.         0.66666667]\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_25_compute_ovo_sens_spec = {"_compute_ovo_sens_spec", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_25_compute_ovo_sens_spec, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_24_compute_ovo_sens_spec};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_25_compute_ovo_sens_spec(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_labels = 0;
  PyObject *__pyx_v_return_array = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_compute_ovo_sens_spec (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_labels,&amp;__pyx_n_s_return_array,0};
  PyObject* values[4] = {0,0,0,0};
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_ovo_sens_spec", 0, 3, 4, 1); <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_labels)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_ovo_sens_spec", 0, 3, 4, 2); <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_array);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_compute_ovo_sens_spec") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_labels = values[2];
    __pyx_v_return_array = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_ovo_sens_spec", 0, 3, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._compute_ovo_sens_spec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_24_compute_ovo_sens_spec(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_labels, __pyx_v_return_array);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_24_compute_ovo_sens_spec(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_labels, PyObject *__pyx_v_return_array) {
  PyObject *__pyx_v_sensitivity = NULL;
  PyObject *__pyx_v_specificity = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_pair_indices = NULL;
  PyObject *__pyx_v_y_true_pair = NULL;
  PyObject *__pyx_v_y_pred_pair = NULL;
  PyObject *__pyx_v_y_true_binary = NULL;
  PyObject *__pyx_v_y_pred_binary = NULL;
  PyObject *__pyx_v_cm = NULL;
  PyObject *__pyx_v_TP = NULL;
  PyObject *__pyx_v_FN = NULL;
  PyObject *__pyx_v_FP = NULL;
  PyObject *__pyx_v_TN = NULL;
  PyObject *__pyx_v_sens_array = NULL;
  PyObject *__pyx_v_spec_array = NULL;
  PyObject *__pyx_v_idx = NULL;
  PyObject *__pyx_v_label = NULL;
  PyObject *__pyx_v_involved_pairs = NULL;
  PyObject *__pyx_8genexpr2__pyx_v_key = NULL;
  PyObject *__pyx_8genexpr3__pyx_v_pair = NULL;
  PyObject *__pyx_8genexpr4__pyx_v_pair = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__28)
  <span class='trace'>__Pyx_TraceCall</span>("_compute_ovo_sens_spec", __pyx_f[0], 1140, 0, <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._compute_ovo_sens_spec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sensitivity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_specificity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pair_indices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true_pair);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred_pair);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true_binary);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred_binary);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cm);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_TP);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_FN);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_FP);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_TN);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sens_array);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_spec_array);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_idx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_label);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_involved_pairs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_key);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr3__pyx_v_pair);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr4__pyx_v_pair);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__168 = <span class='py_c_api'>PyTuple_Pack</span>(26, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_labels, __pyx_n_s_return_array, __pyx_n_s_sensitivity, __pyx_n_s_specificity, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_pair_indices, __pyx_n_s_y_true_pair, __pyx_n_s_y_pred_pair, __pyx_n_s_y_true_binary, __pyx_n_s_y_pred_binary, __pyx_n_s_cm, __pyx_n_s_TP, __pyx_n_s_FN, __pyx_n_s_FP, __pyx_n_s_TN, __pyx_n_s_sens_array, __pyx_n_s_spec_array, __pyx_n_s_idx, __pyx_n_s_label, __pyx_n_s_involved_pairs, __pyx_n_s_key, __pyx_n_s_pair, __pyx_n_s_pair);<span class='error_goto'> if (unlikely(!__pyx_tuple__168)) __PYX_ERR(0, 1140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__168);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__168);
  __pyx_codeobj__28 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 26, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__168, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_ovo_sens_spec, 1140, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 1140, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1140,0,<span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_25_compute_ovo_sens_spec, 0, __pyx_n_s_compute_ovo_sens_spec, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__28));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__169);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_ovo_sens_spec, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1140, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__169 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)Py_True));<span class='error_goto'> if (unlikely(!__pyx_tuple__169)) __PYX_ERR(0, 1140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__169);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__169);
</pre><pre class="cython line score-0">&#xA0;<span class="">1141</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1142</span>:     Compute sensitivity and specificity for each pair of classes</pre>
<pre class="cython line score-0">&#xA0;<span class="">1143</span>:     (One-vs-One strategy).</pre>
<pre class="cython line score-0">&#xA0;<span class="">1144</span>:     Optionally returns sensitivity and specificity as arrays, averaging results</pre>
<pre class="cython line score-0">&#xA0;<span class="">1145</span>:     over all relevant pairs for each class.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1146</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1147</span>:     Parameters:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1148</span>:     y_true : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1149</span>:         Ground truth binary labels.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1150</span>:     y_pred : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1151</span>:         Predicted binary labels.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1152</span>:     labels : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1153</span>:         Array of unique class labels.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1154</span>:     return_array : bool, default True</pre>
<pre class="cython line score-0">&#xA0;<span class="">1155</span>:         If True, returns sensitivity and specificity as numpy arrays averaged</pre>
<pre class="cython line score-0">&#xA0;<span class="">1156</span>:         over all pairs involving each class. If False, returns dictionaries</pre>
<pre class="cython line score-0">&#xA0;<span class="">1157</span>:         with pairs as keys.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1158</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1159</span>:     Returns:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1160</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1161</span>:     tuple of (numpy.ndarray, numpy.ndarray) or (dict, dict)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1162</span>:         Sensitivity and specificity either as arrays or dictionaries depending</pre>
<pre class="cython line score-0">&#xA0;<span class="">1163</span>:         on `return_array`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1164</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1165</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1166</span>:     &gt;&gt;&gt; import numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">1167</span>:     &gt;&gt;&gt; from gofast.tools.mathex import _compute_ovo_sens_spec</pre>
<pre class="cython line score-0">&#xA0;<span class="">1168</span>:     &gt;&gt;&gt; labels = np.array([0, 1, 2])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1169</span>:     &gt;&gt;&gt; y_true = np.array([0, 1, 1, 2, 2, 0, 1, 2, 0])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1170</span>:     &gt;&gt;&gt; y_pred = np.array([0, 1, 2, 2, 0, 0, 1, 0, 2])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1171</span>:     &gt;&gt;&gt; sensitivity, specificity = _compute_ovo_sens_spec(y_true, y_pred, labels, return_array=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1172</span>:     &gt;&gt;&gt; print("Sensitivity:", sensitivity)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1173</span>:     &gt;&gt;&gt; print("Specificity:", specificity)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1174</span>:     Sensitivity: [0.66666667 0.66666667 0.66666667]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1175</span>:     Specificity: [0.66666667 1.         0.66666667]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1176</span>:     """</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1177</span>:     sensitivity = {}</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1177,0,<span class='error_goto'>__PYX_ERR(0, 1177, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_sensitivity = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1178</span>:     specificity = {}</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1178,0,<span class='error_goto'>__PYX_ERR(0, 1178, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_specificity = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1179</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1180</span>:     # Iterate over all pairs of labels</pre>
<pre class="cython line score-116" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1181</span>:     for i, j in itertools.combinations(labels, 2):</pre>
<pre class='cython code score-116 '>  <span class='trace'>__Pyx_TraceLine</span>(1181,0,<span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_itertools);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_combinations);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_labels, __pyx_int_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_5 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_5 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
      PyObject* sequence = __pyx_t_1;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1181, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_8);
      index = 0; __pyx_t_2 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_2)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      index = 1; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_8), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_7);
    __pyx_t_7 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1181,0,<span class='error_goto'>__PYX_ERR(0, 1181, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1182</span>:         # Filter data for the pair (i, j)</pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1183</span>:         pair_indices = (y_true == i) | (y_true == j)</pre>
<pre class='cython code score-18 '>    <span class='trace'>__Pyx_TraceLine</span>(1183,0,<span class='error_goto'>__PYX_ERR(0, 1183, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_true, __pyx_v_i, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1183, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_true, __pyx_v_j, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1183, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Or</span>(__pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1183, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_pair_indices, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1184</span>:         y_true_pair = y_true[pair_indices]</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(1184,0,<span class='error_goto'>__PYX_ERR(0, 1184, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_true, __pyx_v_pair_indices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1184, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y_true_pair, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1185</span>:         y_pred_pair = y_pred[pair_indices]</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(1185,0,<span class='error_goto'>__PYX_ERR(0, 1185, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_pred, __pyx_v_pair_indices);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1185, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y_pred_pair, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1186</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1187</span>:         # Map labels i and j to 0 and 1 for binary classification in this pair</pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1188</span>:         y_true_binary = np.where(y_true_pair == i, 1, 0)</pre>
<pre class='cython code score-26 '>    <span class='trace'>__Pyx_TraceLine</span>(1188,0,<span class='error_goto'>__PYX_ERR(0, 1188, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1188, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_where);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1188, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_true_pair, __pyx_v_i, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1188, __pyx_L1_error)</span>
    __pyx_t_8 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_8, __pyx_t_7, __pyx_int_1, __pyx_int_0};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 3+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1188, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y_true_binary, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1189</span>:         y_pred_binary = np.where(y_pred_pair == i, 1, 0)</pre>
<pre class='cython code score-26 '>    <span class='trace'>__Pyx_TraceLine</span>(1189,0,<span class='error_goto'>__PYX_ERR(0, 1189, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1189, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_where);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1189, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_pred_pair, __pyx_v_i, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1189, __pyx_L1_error)</span>
    __pyx_t_8 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_8, __pyx_t_1, __pyx_int_1, __pyx_int_0};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_4, 3+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1189, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_y_pred_binary, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1190</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1191</span>:         # Calculate confusion matrix for the binary case</pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1192</span>:         cm = confusion_matrix(y_true_binary, y_pred_binary, labels=[1, 0])</pre>
<pre class='cython code score-38 '>    <span class='trace'>__Pyx_TraceLine</span>(1192,0,<span class='error_goto'>__PYX_ERR(0, 1192, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_confusion_matrix);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1192, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1192, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true_binary);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true_binary);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_y_true_binary)) <span class='error_goto'>__PYX_ERR(0, 1192, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred_binary);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred_binary);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_y_pred_binary)) <span class='error_goto'>__PYX_ERR(0, 1192, __pyx_L1_error)</span>;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1192, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 1192, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_int_0)) <span class='error_goto'>__PYX_ERR(0, 1192, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_labels, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1192, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_7, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1192, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cm, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1193</span>:         TP = cm[0, 0]</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(1193,0,<span class='error_goto'>__PYX_ERR(0, 1193, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_tuple__12);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1193, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_TP, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1194</span>:         FN = cm[0, 1]</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(1194,0,<span class='error_goto'>__PYX_ERR(0, 1194, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_tuple__13);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1194, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_FN, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1195</span>:         FP = cm[1, 0]</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(1195,0,<span class='error_goto'>__PYX_ERR(0, 1195, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_tuple__11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1195, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_FP, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1196</span>:         TN = cm[1, 1]</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(1196,0,<span class='error_goto'>__PYX_ERR(0, 1196, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_cm, __pyx_tuple__10);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1196, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_TN, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1198</span>:         # Store sensitivity and specificity for this pair</pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1199</span>:         sensitivity[(i, j)] = TP / (TP + FN) if (TP + FN) &gt; 0 else 0</pre>
<pre class='cython code score-41 '>    <span class='trace'>__Pyx_TraceLine</span>(1199,0,<span class='error_goto'>__PYX_ERR(0, 1199, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_TP, __pyx_v_FN);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1199, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1199, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (__pyx_t_10) {
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_TP, __pyx_v_FN);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1199, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_TP, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_8 = __pyx_t_1;
      __pyx_t_1 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      __pyx_t_8 = __pyx_int_0;
    }
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1199, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_i)) <span class='error_goto'>__PYX_ERR(0, 1199, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_j)) <span class='error_goto'>__PYX_ERR(0, 1199, __pyx_L1_error)</span>;
    if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_sensitivity, __pyx_t_1, __pyx_t_8) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1199, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1200</span>:         specificity[(i, j)] = TN / (TN + FP) if (TN + FP) &gt; 0 else 0</pre>
<pre class='cython code score-41 '>    <span class='trace'>__Pyx_TraceLine</span>(1200,0,<span class='error_goto'>__PYX_ERR(0, 1200, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_TN, __pyx_v_FP);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1200, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (__pyx_t_10) {
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_TN, __pyx_v_FP);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_TN, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_8 = __pyx_t_1;
      __pyx_t_1 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
      __pyx_t_8 = __pyx_int_0;
    }
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1200, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_i)) <span class='error_goto'>__PYX_ERR(0, 1200, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_j)) <span class='error_goto'>__PYX_ERR(0, 1200, __pyx_L1_error)</span>;
    if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_specificity, __pyx_t_1, __pyx_t_8) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1200, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1201</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1202</span>:     if return_array:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1202,0,<span class='error_goto'>__PYX_ERR(0, 1202, __pyx_L1_error)</span>)
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_array); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1202, __pyx_L1_error)</span>
  if (__pyx_t_10) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1203</span>:         # Convert to arrays, averaging results for each class across all pairs involving it</pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1204</span>:         sens_array = np.zeros(len(labels))</pre>
<pre class='cython code score-30 '>    <span class='trace'>__Pyx_TraceLine</span>(1204,0,<span class='error_goto'>__PYX_ERR(0, 1204, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1204, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_labels);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1204, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1204, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_7 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_8};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1204, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_v_sens_array = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1205</span>:         spec_array = np.zeros(len(labels))</pre>
<pre class='cython code score-30 '>    <span class='trace'>__Pyx_TraceLine</span>(1205,0,<span class='error_goto'>__PYX_ERR(0, 1205, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1205, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_labels);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1205, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_1};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1205, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    __pyx_v_spec_array = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1206</span>: </pre>
<pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1207</span>:         for idx, label in enumerate(labels):</pre>
<pre class='cython code score-56 '>    <span class='trace'>__Pyx_TraceLine</span>(1207,0,<span class='error_goto'>__PYX_ERR(0, 1207, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_t_3 = __pyx_int_0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_labels)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_labels)) {
      __pyx_t_8 = __pyx_v_labels; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_labels);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1207, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1207, __pyx_L1_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_8);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1207, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_5 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1207, __pyx_L1_error)</span>
          #else
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_8, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_8);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1207, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_5 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1207, __pyx_L1_error)</span>
          #else
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_8, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_6(__pyx_t_8);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 1207, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_label, __pyx_t_1);
      __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_idx, __pyx_t_3);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3);
      __pyx_t_3 = __pyx_t_1;
      __pyx_t_1 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(1207,0,<span class='error_goto'>__PYX_ERR(0, 1207, __pyx_L1_error)</span>)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1208</span>:             # Averaging sensitivity and specificity for each label</pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1209</span>:             involved_pairs = [key for key in sensitivity if label in key]</pre>
<pre class='cython code score-15 '>      <span class='trace'>__Pyx_TraceLine</span>(1209,0,<span class='error_goto'>__PYX_ERR(0, 1209, __pyx_L1_error)</span>)
      { /* enter inner scope */
        __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_11 = 0;
        __pyx_t_2 = __Pyx_dict_iterator(__pyx_v_sensitivity, 1, ((PyObject *)NULL), (&amp;__pyx_t_12), (&amp;__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
        __pyx_t_7 = __pyx_t_2;
        __pyx_t_2 = 0;
        while (1) {
          __pyx_t_13 = __Pyx_dict_iter_next(__pyx_t_7, __pyx_t_12, &amp;__pyx_t_11, &amp;__pyx_t_2, NULL, NULL, __pyx_t_4);
          if (unlikely(__pyx_t_13 == 0)) break;
          if (unlikely(__pyx_t_13 == -1)) <span class='error_goto'>__PYX_ERR(0, 1209, __pyx_L13_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr2__pyx_v_key, __pyx_t_2);
          __pyx_t_2 = 0;
          __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_label, __pyx_8genexpr2__pyx_v_key, Py_EQ)); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1209, __pyx_L13_error)</span>
          if (__pyx_t_10) {
            if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_8genexpr2__pyx_v_key))) <span class='error_goto'>__PYX_ERR(0, 1209, __pyx_L13_error)</span>
          }
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_key); __pyx_8genexpr2__pyx_v_key = 0;
        goto __pyx_L17_exit_scope;
        __pyx_L13_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr2__pyx_v_key); __pyx_8genexpr2__pyx_v_key = 0;
        goto __pyx_L1_error;
        __pyx_L17_exit_scope:;
      } /* exit inner scope */
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_involved_pairs, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1210</span>:             sens_array[idx] = np.mean([sensitivity[pair] for pair in involved_pairs])</pre>
<pre class='cython code score-47 '>      <span class='trace'>__Pyx_TraceLine</span>(1210,0,<span class='error_goto'>__PYX_ERR(0, 1210, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1210, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1210, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      { /* enter inner scope */
        __pyx_t_7 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1210, __pyx_L20_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_14 = __pyx_v_involved_pairs; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        __pyx_t_12 = 0;
        for (;;) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_14);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1210, __pyx_L20_error)</span>
            #endif
            if (__pyx_t_12 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_15 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_14, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1210, __pyx_L20_error)</span>
          #else
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_14, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1210, __pyx_L20_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          #endif
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr3__pyx_v_pair, __pyx_t_15);
          __pyx_t_15 = 0;
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_sensitivity, __pyx_8genexpr3__pyx_v_pair);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1210, __pyx_L20_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_7, (PyObject*)__pyx_t_15))) <span class='error_goto'>__PYX_ERR(0, 1210, __pyx_L20_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr3__pyx_v_pair); __pyx_8genexpr3__pyx_v_pair = 0;
        goto __pyx_L24_exit_scope;
        __pyx_L20_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr3__pyx_v_pair); __pyx_8genexpr3__pyx_v_pair = 0;
        goto __pyx_L1_error;
        __pyx_L24_exit_scope:;
      } /* exit inner scope */
      __pyx_t_14 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_14, __pyx_t_7};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1210, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_sens_array, __pyx_v_idx, __pyx_t_1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1210, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1211</span>:             spec_array[idx] = np.mean([specificity[pair] for pair in involved_pairs])</pre>
<pre class='cython code score-47 '>      <span class='trace'>__Pyx_TraceLine</span>(1211,0,<span class='error_goto'>__PYX_ERR(0, 1211, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1211, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1211, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      { /* enter inner scope */
        __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1211, __pyx_L27_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_14 = __pyx_v_involved_pairs; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        __pyx_t_12 = 0;
        for (;;) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_14);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1211, __pyx_L27_error)</span>
            #endif
            if (__pyx_t_12 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_15 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_14, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1211, __pyx_L27_error)</span>
          #else
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_14, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1211, __pyx_L27_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          #endif
          <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr4__pyx_v_pair, __pyx_t_15);
          __pyx_t_15 = 0;
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_specificity, __pyx_8genexpr4__pyx_v_pair);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 1211, __pyx_L27_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_2, (PyObject*)__pyx_t_15))) <span class='error_goto'>__PYX_ERR(0, 1211, __pyx_L27_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr4__pyx_v_pair); __pyx_8genexpr4__pyx_v_pair = 0;
        goto __pyx_L31_exit_scope;
        __pyx_L27_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr4__pyx_v_pair); __pyx_8genexpr4__pyx_v_pair = 0;
        goto __pyx_L1_error;
        __pyx_L31_exit_scope:;
      } /* exit inner scope */
      __pyx_t_14 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_14, __pyx_t_2};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1211, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_spec_array, __pyx_v_idx, __pyx_t_1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1211, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1212</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1213</span>:         return sens_array, spec_array</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(1213,0,<span class='error_goto'>__PYX_ERR(0, 1213, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1213, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sens_array);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sens_array);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_sens_array)) <span class='error_goto'>__PYX_ERR(0, 1213, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_spec_array);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_spec_array);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_spec_array)) <span class='error_goto'>__PYX_ERR(0, 1213, __pyx_L1_error)</span>;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1214</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1215</span>:     return sensitivity, specificity</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(1215,0,<span class='error_goto'>__PYX_ERR(0, 1215, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1215, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sensitivity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sensitivity);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_sensitivity)) <span class='error_goto'>__PYX_ERR(0, 1215, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_specificity);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_specificity);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_specificity)) <span class='error_goto'>__PYX_ERR(0, 1215, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1216</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1217</span>: def calculate_histogram_bins(</pre>
<pre class='cython code score-70 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_27calculate_histogram_bins(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_26calculate_histogram_bins, "\n    Calculates histogram bin edges from data with optional normalization.\n\n    Parameters\n    ----------\n    data : array_like\n        The input data to calculate histogram bins for.\n    bins : int, sequence of scalars, or str, optional\n        The criteria to bin the data. If an integer, it defines the number \n        of equal-width bins in the given range. If a sequence, it defines the \n        bin edges directly. If a string, it defines the method used to calculate \n        the optimal bin width, as defined by numpy.histogram_bin_edges().\n    range : (float, float), optional\n        The lower and upper range of the bins. If not provided, range is \n        simply (data.min(), data.max()).\n        Values outside the range are ignored.\n    normalize : bool, default False\n        If True, scales the data to range [0, 1] before calculating bins.\n\n    Returns\n    -------\n    bin_edges : ndarray\n        The computed or specified bin edges.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import calculate_histogram_bins\n    &gt;&gt;&gt; data = np.random.randn(1000)\n    &gt;&gt;&gt; bins = calculate_histogram_bins(data, bins=30)\n    &gt;&gt;&gt; print(bins)\n\n    Notes\n    -----\n    This function is particularly useful in data preprocessing for histogram plotting.\n    Normalization before binning can be useful when dealing with data with outliers\n    or very skewed distributions.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_27calculate_histogram_bins = {"calculate_histogram_bins", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_27calculate_histogram_bins, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_26calculate_histogram_bins};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_27calculate_histogram_bins(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_bins = 0;
  PyObject *__pyx_v_range = 0;
  PyObject *__pyx_v_normalize = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_histogram_bins (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_bins,&amp;__pyx_n_s_range,&amp;__pyx_n_s_normalize,0};
  PyObject* values[4] = {0,0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_auto)));
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_26calculate_histogram_bins(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_bins, PyObject *__pyx_v_range, PyObject *__pyx_v_normalize) {
  PyObject *__pyx_v_bin_edges = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__29)
  <span class='trace'>__Pyx_TraceCall</span>("calculate_histogram_bins", __pyx_f[0], 1217, 0, <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_histogram_bins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bin_edges);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__170 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_data, __pyx_n_s_bins, __pyx_n_s_range, __pyx_n_s_normalize, __pyx_n_s_bin_edges);<span class='error_goto'> if (unlikely(!__pyx_tuple__170)) __PYX_ERR(0, 1217, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__170);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__170);
  __pyx_codeobj__29 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__170, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_calculate_histogram_bins, 1217, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__29)) __PYX_ERR(0, 1217, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1217,0,<span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1217, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_data, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_bins, __pyx_kp_s_Union_int_str_list) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_range, __pyx_kp_s_Tuple_float_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_normalize, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_27calculate_histogram_bins, 0, __pyx_n_s_calculate_histogram_bins, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__29));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1217, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__171);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calculate_histogram_bins, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__171 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject*)__pyx_n_u_auto), Py_None, ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__171)) __PYX_ERR(0, 1217, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__171);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__171);
</pre><pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1218</span>:         data:ArrayLike,  bins:Union [int, str, list]='auto', range:Tuple[float, float]=None, normalize: bool=False):</pre>
<pre class='cython code score-66 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bins);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_range);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_normalize);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate_histogram_bins") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_data = values[0];
    __pyx_v_bins = values[1];
    __pyx_v_range = values[2];
    __pyx_v_normalize = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_histogram_bins", 0, 1, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1217, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_histogram_bins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_26calculate_histogram_bins(__pyx_self, __pyx_v_data, __pyx_v_bins, __pyx_v_range, __pyx_v_normalize);
</pre><pre class="cython line score-0">&#xA0;<span class="">1219</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1220</span>:     Calculates histogram bin edges from data with optional normalization.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1221</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1222</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1223</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1224</span>:     data : array_like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1225</span>:         The input data to calculate histogram bins for.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1226</span>:     bins : int, sequence of scalars, or str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1227</span>:         The criteria to bin the data. If an integer, it defines the number</pre>
<pre class="cython line score-0">&#xA0;<span class="">1228</span>:         of equal-width bins in the given range. If a sequence, it defines the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1229</span>:         bin edges directly. If a string, it defines the method used to calculate</pre>
<pre class="cython line score-0">&#xA0;<span class="">1230</span>:         the optimal bin width, as defined by numpy.histogram_bin_edges().</pre>
<pre class="cython line score-0">&#xA0;<span class="">1231</span>:     range : (float, float), optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1232</span>:         The lower and upper range of the bins. If not provided, range is</pre>
<pre class="cython line score-0">&#xA0;<span class="">1233</span>:         simply (data.min(), data.max()).</pre>
<pre class="cython line score-0">&#xA0;<span class="">1234</span>:         Values outside the range are ignored.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1235</span>:     normalize : bool, default False</pre>
<pre class="cython line score-0">&#xA0;<span class="">1236</span>:         If True, scales the data to range [0, 1] before calculating bins.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1237</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1238</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1239</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1240</span>:     bin_edges : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">1241</span>:         The computed or specified bin edges.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1242</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1243</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1244</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1245</span>:     &gt;&gt;&gt; from gofast.tools.mathex import calculate_histogram_bins</pre>
<pre class="cython line score-0">&#xA0;<span class="">1246</span>:     &gt;&gt;&gt; data = np.random.randn(1000)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1247</span>:     &gt;&gt;&gt; bins = calculate_histogram_bins(data, bins=30)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1248</span>:     &gt;&gt;&gt; print(bins)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1249</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1250</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">1251</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">1252</span>:     This function is particularly useful in data preprocessing for histogram plotting.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1253</span>:     Normalization before binning can be useful when dealing with data with outliers</pre>
<pre class="cython line score-0">&#xA0;<span class="">1254</span>:     or very skewed distributions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1255</span>:     """</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1256</span>:     data = np.asarray (data)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(1256,0,<span class='error_goto'>__PYX_ERR(0, 1256, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1256, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1256, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_data};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1256, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1257</span>:     if normalize:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1257,0,<span class='error_goto'>__PYX_ERR(0, 1257, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_normalize); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1257, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1258</span>:         data = (data - np.min(data)) / (np.max(data) - np.min(data))</pre>
<pre class='cython code score-75 '>    <span class='trace'>__Pyx_TraceLine</span>(1258,0,<span class='error_goto'>__PYX_ERR(0, 1258, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1258, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1258, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_data};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_data, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1258, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1258, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1258, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_data};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1258, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1258, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_data};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1258, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1258, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1259</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1260</span>:     bin_edges = np.histogram_bin_edges(data, bins=bins, range=range)</pre>
<pre class='cython code score-30 '>  <span class='trace'>__Pyx_TraceLine</span>(1260,0,<span class='error_goto'>__PYX_ERR(0, 1260, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_histogram_bin_edges);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_data)) <span class='error_goto'>__PYX_ERR(0, 1260, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_bins, __pyx_v_bins) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1260, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_range, __pyx_v_range) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1260, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_6, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1260, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_bin_edges = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1261</span>:     return bin_edges</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1261,0,<span class='error_goto'>__PYX_ERR(0, 1261, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bin_edges);
  __pyx_r = __pyx_v_bin_edges;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1262</span>: </pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1263</span>: def rank_data(data, method='average'):</pre>
<pre class='cython code score-84 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_29rank_data(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_28rank_data, "\n    Assigns ranks to data, handling ties according to the specified method.\n    This function supports several strategies for tie-breaking, making it\n    versatile for ranking tasks in statistical analyses and machine learning.\n\n    Parameters\n    ----------\n    data : array-like\n        The input data to rank. This can be any sequence that can be converted\n        to a numpy array.\n    method : {'average', 'min', 'max', 'dense', 'ordinal'}, optional\n        The method used to assign ranks to tied elements. The options are:\n        - 'average': Assign the average of the ranks to the tied elements.\n        - 'min': Assign the minimum of the ranks to the tied elements.\n        - 'max': Assign the maximum of the ranks to the tied elements.\n        - 'dense': Like 'min', but the next rank is always one greater than\n          the previous rank (i.e., no gaps in rank values).\n        - 'ordinal': Assign a unique rank to each element, with ties broken\n          by their order in the data.\n\n    Returns\n    -------\n    ranks : ndarray\n        The ranks of the input data.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import rank_data\n    &gt;&gt;&gt; data = [40, 20, 30, 20]\n    &gt;&gt;&gt; rank_data(data, method='average')\n    array([4. , 1.5, 3. , 1.5])\n\n    &gt;&gt;&gt; rank_data(data, method='min')\n    array([4, 1, 3, 1])\n\n    Notes\n    -----\n    The ranking methods provided offer flexibility for different ranking\n    scenarios. 'average', 'min', and 'max' are particularly useful in\n    statistical contexts where ties need to be accounted for explicitly,\n    while 'dense' and 'ordinal' provide strategies for more ordinal or\n    categorical data ranking tasks.\n\n    References\n    ----------\n    - Freund, J.E., &amp; Wilson, W.J. (1993). Statistical Methods, 2nd ed.\n    - Gibbons, J.D., &amp; Chakraborti, S. (2011). Nonparametric Statistical Inference.\n    \n    See Also\n    --------\n    scipy.stats.rankdata : Rank the data in an array.\n    num""py.argsort : Returns the indices that would sort an array.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_29rank_data = {"rank_data", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_29rank_data, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_28rank_data};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_29rank_data(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_method = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rank_data (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_method,0};
  PyObject* values[2] = {0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_average)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_method);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "rank_data") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_data = values[0];
    __pyx_v_method = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("rank_data", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.rank_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_28rank_data(__pyx_self, __pyx_v_data, __pyx_v_method);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_28rank_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_method) {
  PyObject *__pyx_v_sorter = NULL;
  PyObject *__pyx_v_inv = NULL;
  PyObject *__pyx_v_ranks = NULL;
  PyObject *__pyx_v_valid_methods = NULL;
  PyObject *__pyx_v_dense_rank = NULL;
  PyObject *__pyx_v_prev_val = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__30)
  <span class='trace'>__Pyx_TraceCall</span>("rank_data", __pyx_f[0], 1263, 0, <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.rank_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sorter);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_inv);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ranks);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_valid_methods);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dense_rank);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_prev_val);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_method);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__172 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_data, __pyx_n_s_method, __pyx_n_s_sorter, __pyx_n_s_inv, __pyx_n_s_ranks, __pyx_n_s_valid_methods, __pyx_n_s_dense_rank, __pyx_n_s_prev_val, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__172)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__172);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__172);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1263,0,<span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_29rank_data, 0, __pyx_n_s_rank_data, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__30));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__27);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_rank_data, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1263, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__30 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__172, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_rank_data, 1263, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 1263, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1264</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1265</span>:     Assigns ranks to data, handling ties according to the specified method.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1266</span>:     This function supports several strategies for tie-breaking, making it</pre>
<pre class="cython line score-0">&#xA0;<span class="">1267</span>:     versatile for ranking tasks in statistical analyses and machine learning.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1268</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1269</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1270</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1271</span>:     data : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1272</span>:         The input data to rank. This can be any sequence that can be converted</pre>
<pre class="cython line score-0">&#xA0;<span class="">1273</span>:         to a numpy array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1274</span>:     method : {'average', 'min', 'max', 'dense', 'ordinal'}, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1275</span>:         The method used to assign ranks to tied elements. The options are:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1276</span>:         - 'average': Assign the average of the ranks to the tied elements.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1277</span>:         - 'min': Assign the minimum of the ranks to the tied elements.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1278</span>:         - 'max': Assign the maximum of the ranks to the tied elements.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1279</span>:         - 'dense': Like 'min', but the next rank is always one greater than</pre>
<pre class="cython line score-0">&#xA0;<span class="">1280</span>:           the previous rank (i.e., no gaps in rank values).</pre>
<pre class="cython line score-0">&#xA0;<span class="">1281</span>:         - 'ordinal': Assign a unique rank to each element, with ties broken</pre>
<pre class="cython line score-0">&#xA0;<span class="">1282</span>:           by their order in the data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1283</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1284</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1285</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1286</span>:     ranks : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">1287</span>:         The ranks of the input data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1288</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1289</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1290</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1291</span>:     &gt;&gt;&gt; from gofast.tools.mathex import rank_data</pre>
<pre class="cython line score-0">&#xA0;<span class="">1292</span>:     &gt;&gt;&gt; data = [40, 20, 30, 20]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1293</span>:     &gt;&gt;&gt; rank_data(data, method='average')</pre>
<pre class="cython line score-0">&#xA0;<span class="">1294</span>:     array([4. , 1.5, 3. , 1.5])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1295</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1296</span>:     &gt;&gt;&gt; rank_data(data, method='min')</pre>
<pre class="cython line score-0">&#xA0;<span class="">1297</span>:     array([4, 1, 3, 1])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1299</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">1300</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">1301</span>:     The ranking methods provided offer flexibility for different ranking</pre>
<pre class="cython line score-0">&#xA0;<span class="">1302</span>:     scenarios. 'average', 'min', and 'max' are particularly useful in</pre>
<pre class="cython line score-0">&#xA0;<span class="">1303</span>:     statistical contexts where ties need to be accounted for explicitly,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1304</span>:     while 'dense' and 'ordinal' provide strategies for more ordinal or</pre>
<pre class="cython line score-0">&#xA0;<span class="">1305</span>:     categorical data ranking tasks.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1306</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1307</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">1308</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1309</span>:     - Freund, J.E., &amp; Wilson, W.J. (1993). Statistical Methods, 2nd ed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1310</span>:     - Gibbons, J.D., &amp; Chakraborti, S. (2011). Nonparametric Statistical Inference.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1311</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1312</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">1313</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1314</span>:     scipy.stats.rankdata : Rank the data in an array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1315</span>:     numpy.argsort : Returns the indices that would sort an array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1316</span>:     """</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1317</span>:     sorter = np.argsort(data)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(1317,0,<span class='error_goto'>__PYX_ERR(0, 1317, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_argsort);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_data};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_sorter = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1318</span>:     inv = np.empty_like(sorter)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(1318,0,<span class='error_goto'>__PYX_ERR(0, 1318, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1318, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_empty_like);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1318, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_sorter};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_inv = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1319</span>:     inv[sorter] = np.arange(len(data))</pre>
<pre class='cython code score-36 '>  <span class='trace'>__Pyx_TraceLine</span>(1319,0,<span class='error_goto'>__PYX_ERR(0, 1319, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1319, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_inv, __pyx_v_sorter, __pyx_t_1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1319, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1320</span>:     ranks = np.empty_like(data, dtype=float)</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(1320,0,<span class='error_goto'>__PYX_ERR(0, 1320, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty_like);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_data)) <span class='error_goto'>__PYX_ERR(0, 1320, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1320, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ranks = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1321</span>:     valid_methods = ['average', 'min', 'max', 'dense', 'ordinal']</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(1321,0,<span class='error_goto'>__PYX_ERR(0, 1321, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_average);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_average);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_n_u_average)) <span class='error_goto'>__PYX_ERR(0, 1321, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_min);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_min);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 1, __pyx_n_u_min)) <span class='error_goto'>__PYX_ERR(0, 1321, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_max);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_max);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 2, __pyx_n_u_max)) <span class='error_goto'>__PYX_ERR(0, 1321, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_dense);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_dense);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 3, __pyx_n_u_dense)) <span class='error_goto'>__PYX_ERR(0, 1321, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_ordinal);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_ordinal);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 4, __pyx_n_u_ordinal)) <span class='error_goto'>__PYX_ERR(0, 1321, __pyx_L1_error)</span>;
  __pyx_v_valid_methods = ((PyObject*)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1322</span>:     method = normalize_string(</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(1322,0,<span class='error_goto'>__PYX_ERR(0, 1322, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_normalize_string);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1323,0,<span class='error_goto'>__PYX_ERR(0, 1323, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_method);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_method)) <span class='error_goto'>__PYX_ERR(0, 1322, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1322,0,<span class='error_goto'>__PYX_ERR(0, 1322, __pyx_L1_error)</span>)
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_method, __pyx_t_9);
  __pyx_t_9 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1323</span>:         method, target_strs=valid_methods, raise_exception=True,</pre>
<pre class='cython code score-12 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_target_strs, __pyx_v_valid_methods) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1323, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_raise_exception, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1323, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1324</span>:         return_target_only=True, error_msg= (</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1324,0,<span class='error_goto'>__PYX_ERR(0, 1324, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return_target_only, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1323, __pyx_L1_error)</span>
</pre><pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1325</span>:             f"Invalid method '{method}'. Expect {smart_format(valid_methods, 'or')} ")</pre>
<pre class='cython code score-55 '>  <span class='trace'>__Pyx_TraceLine</span>(1325,0,<span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = 0;
  __pyx_t_7 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Invalid_method);
  __pyx_t_5 += 16;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Invalid_method);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_kp_u_Invalid_method);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_method, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_8) &gt; __pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_8) : __pyx_t_7;
  __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_8);
  __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Expect);
  __pyx_t_5 += 10;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Expect);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_kp_u_Expect);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_smart_format);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_10, __pyx_v_valid_methods, __pyx_n_u_or};
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 1325, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_8, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_9) &gt; __pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_9) : __pyx_t_7;
  __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_t_9);
  __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__31);
  __pyx_t_5 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__31);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 4, __pyx_kp_u__31);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 5, __pyx_t_5, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_error_msg, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1323, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1326</span>:         )</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1327</span>:     if method == 'average':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1327,0,<span class='error_goto'>__PYX_ERR(0, 1327, __pyx_L1_error)</span>)
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_average, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1327, __pyx_L1_error)</span>
  if (__pyx_t_11) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1328</span>:         # Average ranks of tied groups</pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1329</span>:         ranks[sorter] = np.mean([np.arange(len(data))], axis=0)</pre>
<pre class='cython code score-67 '>    <span class='trace'>__Pyx_TraceLine</span>(1329,0,<span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_2};
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>;
    __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>;
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_ranks, __pyx_v_sorter, __pyx_t_2) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1329, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1330</span>:     elif method == 'min':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1330,0,<span class='error_goto'>__PYX_ERR(0, 1330, __pyx_L1_error)</span>)
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_min, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1330, __pyx_L1_error)</span>
  if (__pyx_t_11) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1331</span>:         # Minimum rank for all tied entries</pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1332</span>:         ranks[sorter] = np.min([np.arange(len(data))], axis=0)</pre>
<pre class='cython code score-67 '>    <span class='trace'>__Pyx_TraceLine</span>(1332,0,<span class='error_goto'>__PYX_ERR(0, 1332, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_9};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1332, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1332, __pyx_L1_error)</span>;
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1332, __pyx_L1_error)</span>;
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1332, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1332, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_ranks, __pyx_v_sorter, __pyx_t_9) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1332, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1333</span>:     elif method == 'max':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1333,0,<span class='error_goto'>__PYX_ERR(0, 1333, __pyx_L1_error)</span>)
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_max, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1333, __pyx_L1_error)</span>
  if (__pyx_t_11) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1334</span>:         # Maximum rank for all tied entries</pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1335</span>:         ranks[sorter] = np.max([np.arange(len(data))], axis=0)</pre>
<pre class='cython code score-67 '>    <span class='trace'>__Pyx_TraceLine</span>(1335,0,<span class='error_goto'>__PYX_ERR(0, 1335, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_2};
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 1335, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 1335, __pyx_L1_error)</span>;
    __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1335, __pyx_L1_error)</span>;
    __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1335, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_ranks, __pyx_v_sorter, __pyx_t_2) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1335, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1336</span>:     elif method == 'dense':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1336,0,<span class='error_goto'>__PYX_ERR(0, 1336, __pyx_L1_error)</span>)
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_dense, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1336, __pyx_L1_error)</span>
  if (__pyx_t_11) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1337</span>:         # Like 'min', but rank always increases by 1 between groups</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1338</span>:         dense_rank = 0</pre>
<pre class='cython code score-1 '>    <span class='trace'>__Pyx_TraceLine</span>(1338,0,<span class='error_goto'>__PYX_ERR(0, 1338, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_v_dense_rank = __pyx_int_0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1339</span>:         prev_val = np.nan</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(1339,0,<span class='error_goto'>__PYX_ERR(0, 1339, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1339, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_nan);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1339, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_prev_val = __pyx_t_6;
    __pyx_t_6 = 0;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1340</span>:         for i in sorter:</pre>
<pre class='cython code score-49 '>    <span class='trace'>__Pyx_TraceLine</span>(1340,0,<span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>)
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_sorter)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_sorter)) {
      __pyx_t_6 = __pyx_v_sorter; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      __pyx_t_5 = 0;
      __pyx_t_12 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_sorter);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1340, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1340, __pyx_L1_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_12)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_6);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_5 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_6, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
          #else
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_6, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1340, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_6);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_5 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_6, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
          #else
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_6, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1340, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          #endif
        }
      } else {
        __pyx_t_2 = __pyx_t_12(__pyx_t_6);
        if (unlikely(!__pyx_t_2)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
      __pyx_t_2 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(1340,0,<span class='error_goto'>__PYX_ERR(0, 1340, __pyx_L1_error)</span>)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1341</span>:             if data[i] != prev_val:</pre>
<pre class='cython code score-11 '>      <span class='trace'>__Pyx_TraceLine</span>(1341,0,<span class='error_goto'>__PYX_ERR(0, 1341, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_data, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1341, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_9 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_v_prev_val, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1341, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_9); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1341, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1342</span>:                 dense_rank += 1</pre>
<pre class='cython code score-3 '>        <span class='trace'>__Pyx_TraceLine</span>(1342,0,<span class='error_goto'>__PYX_ERR(0, 1342, __pyx_L1_error)</span>)
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_dense_rank, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1342, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_dense_rank, __pyx_t_9);
        __pyx_t_9 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1343</span>:                 prev_val = data[i]</pre>
<pre class='cython code score-3 '>        <span class='trace'>__Pyx_TraceLine</span>(1343,0,<span class='error_goto'>__PYX_ERR(0, 1343, __pyx_L1_error)</span>)
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_data, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1343, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_prev_val, __pyx_t_9);
        __pyx_t_9 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1344</span>:             ranks[i] = dense_rank</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(1344,0,<span class='error_goto'>__PYX_ERR(0, 1344, __pyx_L1_error)</span>)
      if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_ranks, __pyx_v_i, __pyx_v_dense_rank) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1344, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1345</span>:     elif method == 'ordinal':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1345,0,<span class='error_goto'>__PYX_ERR(0, 1345, __pyx_L1_error)</span>)
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_ordinal, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1345, __pyx_L1_error)</span>
  if (__pyx_t_11) {
/* … */
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1346</span>:         # Distinct rank for every entry, resolving ties arbitrarily</pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1347</span>:         ranks[sorter] = np.arange(len(data))</pre>
<pre class='cython code score-36 '>    <span class='trace'>__Pyx_TraceLine</span>(1347,0,<span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1347, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1347, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1347, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1347, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_9};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_ranks, __pyx_v_sorter, __pyx_t_6) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1347, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1348</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1349</span>:     return ranks</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1349,0,<span class='error_goto'>__PYX_ERR(0, 1349, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ranks);
  __pyx_r = __pyx_v_ranks;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1350</span>: </pre>
<pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1351</span>: def optimized_spearmanr(</pre>
<pre class='cython code score-78 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_31optimized_spearmanr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_30optimized_spearmanr, "\n    Compute Spearman's rank correlation coefficient with support for \n    sample weights, custom tie handling, and NaN policies. This function \n    extends the standard Spearman's rank correlation to offer more \n    flexibility and utility in statistical and machine learning applications.\n\n    Parameters\n    ----------\n    y_true : array-like\n        True values for calculating the correlation. Must be 1D.\n    y_pred : array-like\n        Predicted values, corresponding to y_true.\n    sample_weight : array-like, optional\n        Weights for each pair of values. Default is None, which gives\n        equal weight to all values.\n    tie_method : {'average', 'min', 'max', 'dense', 'ordinal'}, optional\n        Method to handle ranking ties. Default is 'average'.\n    nan_policy : {'propagate', 'raise', 'omit'}, optional\n        Defines how to handle when input contains NaN. 'propagate' returns NaN,\n        'raise' throws an error, 'omit' ignores pairs with NaN.\n    control_vars : array-like, optional\n        Control variables for partial correlation. Default is None.\n    multioutput : {'raw_values', 'uniform_average'}, optional\n        Strategy for aggregating errors across multiple output dimensions:\n        - 'raw_values' : Returns an array of RMSLE values for each output.\n        - 'uniform_average' : Averages errors across all outputs.\n    Returns\n    -------\n    float\n        Spearman's rank correlation coefficient.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import optimized_spearmanr\n    &gt;&gt;&gt; y_true = [1, 2, 3, 4, 5]\n    &gt;&gt;&gt; y_pred = [5, 6, 7, 8, 7]\n    &gt;&gt;&gt; optimized_spearmanr(y_true, y_pred)\n    0.8208\n\n    Notes\n    -----\n    Spearman's rank correlation assesses monotonic relationships by using the \n    ranked values for each variable. It is a non-parametric measure of \n    statistical dependence between two variables [1]_.\n\n    .. math::\n        \\rho = 1 - \\frac{6 \\sum d_i^2}{n(n^2 - 1)}\n\n    where"" \\(d_i\\) is the difference between the two ranks of each observation, \n    and \\(n\\) is the number of observations [2]_.\n\n    This extended implementation allows for weighted correlation calculation, \n    handling of NaN values according to a specified policy, and consideration \n    of control variables for partial correlation analysis.\n\n    References\n    ----------\n    .. [1] Spearman, C. (1904). \"The proof and measurement of association \n           between two things\".\n    .. [2] Myer, K., &amp; Waller, N. (2009). Applied Spearman's rank correlation. \n           Statistics in Medicine.\n\n    See Also\n    --------\n    scipy.stats.spearmanr : Spearman correlation calculation in SciPy.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_31optimized_spearmanr = {"optimized_spearmanr", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_31optimized_spearmanr, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_30optimized_spearmanr};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_31optimized_spearmanr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_sample_weight = 0;
  PyObject *__pyx_v_tie_method = 0;
  PyObject *__pyx_v_nan_policy = 0;
  PyObject *__pyx_v_control_vars = 0;
  PyObject *__pyx_v_multioutput = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("optimized_spearmanr (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_sample_weight,&amp;__pyx_n_s_tie_method,&amp;__pyx_n_s_nan_policy,&amp;__pyx_n_s_control_vars,&amp;__pyx_n_s_multioutput,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_30optimized_spearmanr(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_sample_weight, PyObject *__pyx_v_tie_method, PyObject *__pyx_v_nan_policy, PyObject *__pyx_v_control_vars, PyObject *__pyx_v_multioutput) {
  PyObject *__pyx_v_results = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_corr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__32)
  <span class='trace'>__Pyx_TraceCall</span>("optimized_spearmanr", __pyx_f[0], 1351, 0, <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_multioutput);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.optimized_spearmanr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_results);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_corr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_multioutput);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__173 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_sample_weight, __pyx_n_s_tie_method, __pyx_n_s_nan_policy, __pyx_n_s_control_vars, __pyx_n_s_multioutput, __pyx_n_s_results, __pyx_n_s_i, __pyx_n_s_corr);<span class='error_goto'> if (unlikely(!__pyx_tuple__173)) __PYX_ERR(0, 1351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__173);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__173);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1351,0,<span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1351,0,<span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_sample_weight, __pyx_kp_s_Optional_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_tie_method, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_nan_policy, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_control_vars, __pyx_kp_s_Optional_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_multioutput, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_31optimized_spearmanr, 0, __pyx_n_s_optimized_spearmanr, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__32));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_4, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_optimized_spearmanr, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__32 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 5, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__173, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_optimized_spearmanr, 1351, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 1351, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1352</span>:     y_true, y_pred, *,</pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1353</span>:     sample_weight:Optional[ArrayLike]=None,</pre>
<pre class='cython code score-21 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_average)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_propagate)));
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1353,0,<span class='error_goto'>__PYX_ERR(0, 1353, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_sample_weight, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_tie_method, ((PyObject*)__pyx_n_u_average)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_nan_policy, ((PyObject*)__pyx_n_u_propagate)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1354</span>:     tie_method:str='average',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1355</span>:     nan_policy:str='propagate',</pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1356</span>:     control_vars:Optional[ArrayLike]=None,</pre>
<pre class='cython code score-67 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_uniform_average)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("optimized_spearmanr", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 5)) {
        Py_ssize_t index;
        for (index = 2; index &lt; 7 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "optimized_spearmanr") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_sample_weight = values[2];
    __pyx_v_tie_method = ((PyObject*)values[3]);
    __pyx_v_nan_policy = ((PyObject*)values[4]);
    __pyx_v_control_vars = values[5];
    __pyx_v_multioutput = ((PyObject*)values[6]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("optimized_spearmanr", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.optimized_spearmanr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_tie_method), (&amp;PyUnicode_Type), 0, "tie_method", 1))) <span class='error_goto'>__PYX_ERR(0, 1354, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_nan_policy), (&amp;PyUnicode_Type), 0, "nan_policy", 1))) <span class='error_goto'>__PYX_ERR(0, 1355, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_multioutput), (&amp;PyUnicode_Type), 0, "multioutput", 1))) <span class='error_goto'>__PYX_ERR(0, 1357, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_30optimized_spearmanr(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_sample_weight, __pyx_v_tie_method, __pyx_v_nan_policy, __pyx_v_control_vars, __pyx_v_multioutput);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1356,0,<span class='error_goto'>__PYX_ERR(0, 1356, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_control_vars, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_multioutput, ((PyObject*)__pyx_n_u_uniform_average)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1351, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1357</span>:     multioutput:str='uniform_average'</pre>
<pre class="cython line score-0">&#xA0;<span class="">1358</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1359</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1360</span>:     Compute Spearman's rank correlation coefficient with support for</pre>
<pre class="cython line score-0">&#xA0;<span class="">1361</span>:     sample weights, custom tie handling, and NaN policies. This function</pre>
<pre class="cython line score-0">&#xA0;<span class="">1362</span>:     extends the standard Spearman's rank correlation to offer more</pre>
<pre class="cython line score-0">&#xA0;<span class="">1363</span>:     flexibility and utility in statistical and machine learning applications.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1364</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1365</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1366</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1367</span>:     y_true : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1368</span>:         True values for calculating the correlation. Must be 1D.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1369</span>:     y_pred : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1370</span>:         Predicted values, corresponding to y_true.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1371</span>:     sample_weight : array-like, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1372</span>:         Weights for each pair of values. Default is None, which gives</pre>
<pre class="cython line score-0">&#xA0;<span class="">1373</span>:         equal weight to all values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1374</span>:     tie_method : {'average', 'min', 'max', 'dense', 'ordinal'}, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1375</span>:         Method to handle ranking ties. Default is 'average'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1376</span>:     nan_policy : {'propagate', 'raise', 'omit'}, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1377</span>:         Defines how to handle when input contains NaN. 'propagate' returns NaN,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1378</span>:         'raise' throws an error, 'omit' ignores pairs with NaN.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1379</span>:     control_vars : array-like, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1380</span>:         Control variables for partial correlation. Default is None.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1381</span>:     multioutput : {'raw_values', 'uniform_average'}, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1382</span>:         Strategy for aggregating errors across multiple output dimensions:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1383</span>:         - 'raw_values' : Returns an array of RMSLE values for each output.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1384</span>:         - 'uniform_average' : Averages errors across all outputs.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1385</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1386</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1387</span>:     float</pre>
<pre class="cython line score-0">&#xA0;<span class="">1388</span>:         Spearman's rank correlation coefficient.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1389</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1390</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1391</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1392</span>:     &gt;&gt;&gt; from gofast.tools.mathex import optimized_spearmanr</pre>
<pre class="cython line score-0">&#xA0;<span class="">1393</span>:     &gt;&gt;&gt; y_true = [1, 2, 3, 4, 5]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1394</span>:     &gt;&gt;&gt; y_pred = [5, 6, 7, 8, 7]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1395</span>:     &gt;&gt;&gt; optimized_spearmanr(y_true, y_pred)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1396</span>:     0.8208</pre>
<pre class="cython line score-0">&#xA0;<span class="">1397</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1398</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">1399</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">1400</span>:     Spearman's rank correlation assesses monotonic relationships by using the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1401</span>:     ranked values for each variable. It is a non-parametric measure of</pre>
<pre class="cython line score-0">&#xA0;<span class="">1402</span>:     statistical dependence between two variables [1]_.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1403</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1404</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">1405</span>:         \\rho = 1 - \\frac{6 \\sum d_i^2}{n(n^2 - 1)}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1406</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1407</span>:     where \\(d_i\\) is the difference between the two ranks of each observation,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1408</span>:     and \\(n\\) is the number of observations [2]_.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1409</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1410</span>:     This extended implementation allows for weighted correlation calculation,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1411</span>:     handling of NaN values according to a specified policy, and consideration</pre>
<pre class="cython line score-0">&#xA0;<span class="">1412</span>:     of control variables for partial correlation analysis.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1413</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1414</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">1415</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1416</span>:     .. [1] Spearman, C. (1904). "The proof and measurement of association</pre>
<pre class="cython line score-0">&#xA0;<span class="">1417</span>:            between two things".</pre>
<pre class="cython line score-0">&#xA0;<span class="">1418</span>:     .. [2] Myer, K., &amp; Waller, N. (2009). Applied Spearman's rank correlation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1419</span>:            Statistics in Medicine.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1420</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1421</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">1422</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1423</span>:     scipy.stats.spearmanr : Spearman correlation calculation in SciPy.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1424</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1425</span>:     # Handle the multioutput scenario</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1426</span>:     if y_true.ndim == 1:</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1426,0,<span class='error_goto'>__PYX_ERR(0, 1426, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y_true, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1426, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1426, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1427</span>:         y_true = y_true[:, np.newaxis]</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(1427,0,<span class='error_goto'>__PYX_ERR(0, 1427, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1427, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_newaxis);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1427, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1427, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 1427, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1427, __pyx_L1_error)</span>;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_true, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1427, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1428</span>:     if y_pred.ndim == 1:</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1428,0,<span class='error_goto'>__PYX_ERR(0, 1428, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y_pred, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1428, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1428, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1429</span>:         y_pred = y_pred[:, np.newaxis]</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(1429,0,<span class='error_goto'>__PYX_ERR(0, 1429, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1429, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_newaxis);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1429, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1429, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 1429, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1429, __pyx_L1_error)</span>;
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_pred, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1429, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1430</span>:     check_consistent_length(y_true, y_pred)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(1430,0,<span class='error_goto'>__PYX_ERR(0, 1430, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_check_consistent_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_v_y_true, __pyx_v_y_pred};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1430, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1431</span>:     results = []</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1431,0,<span class='error_goto'>__PYX_ERR(0, 1431, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1431, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_results = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1432</span>:     for i in range(y_true.shape[1]):</pre>
<pre class='cython code score-58 '>  <span class='trace'>__Pyx_TraceLine</span>(1432,0,<span class='error_goto'>__PYX_ERR(0, 1432, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y_true, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1432, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1432, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1432, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1432, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1432, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1432, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_6 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1432, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1432, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1432, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_6 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1432, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1432, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_7(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1432, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1432,0,<span class='error_goto'>__PYX_ERR(0, 1432, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1433</span>:         corr = _compute_spearmanr(y_true[:, i], y_pred[:, i], sample_weight,</pre>
<pre class='cython code score-30 '>    <span class='trace'>__Pyx_TraceLine</span>(1433,0,<span class='error_goto'>__PYX_ERR(0, 1433, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_compute_spearmanr);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1433, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1433, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 1433, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_i)) <span class='error_goto'>__PYX_ERR(0, 1433, __pyx_L1_error)</span>;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_true, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1433, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1433, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 1433, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_i);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_i)) <span class='error_goto'>__PYX_ERR(0, 1433, __pyx_L1_error)</span>;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_pred, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1433, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1434</span>:                                   tie_method, nan_policy, control_vars)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(1434,0,<span class='error_goto'>__PYX_ERR(0, 1434, __pyx_L1_error)</span>)
    __pyx_t_8 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[7] = {__pyx_t_8, __pyx_t_9, __pyx_t_10, __pyx_v_sample_weight, __pyx_v_tie_method, __pyx_v_nan_policy, __pyx_v_control_vars};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 6+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1433, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_corr, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1435</span>:         results.append(corr)</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1435,0,<span class='error_goto'>__PYX_ERR(0, 1435, __pyx_L1_error)</span>)
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_results, __pyx_v_corr);<span class='error_goto'> if (unlikely(__pyx_t_11 == ((int)-1))) __PYX_ERR(0, 1435, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1436</span>: </pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1437</span>:     multioutput = validate_multioutput(multioutput )</pre>
<pre class='cython code score-24 '>  <span class='trace'>__Pyx_TraceLine</span>(1437,0,<span class='error_goto'>__PYX_ERR(0, 1437, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_validate_multioutput);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1437, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_multioutput};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1437, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  if (!(likely(<span class='py_c_api'>PyUnicode_CheckExact</span>(__pyx_t_3))||((__pyx_t_3) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("unicode", __pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 1437, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_multioutput, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1438</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1439</span>:     return np.array(results) if multioutput == 'raw_values' else np.mean(results)</pre>
<pre class='cython code score-41 '>  <span class='trace'>__Pyx_TraceLine</span>(1439,0,<span class='error_goto'>__PYX_ERR(0, 1439, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_multioutput, __pyx_n_u_raw_values, Py_EQ)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1439, __pyx_L1_error)</span>
  if (__pyx_t_2) {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1439, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1439, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_results};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1439, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    __pyx_t_3 = __pyx_t_1;
    __pyx_t_1 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1439, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1439, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_v_results};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1439, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_t_3 = __pyx_t_1;
    __pyx_t_1 = 0;
  }
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1440</span>: </pre>
<pre class="cython line score-149" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1441</span>: def _compute_spearmanr(</pre>
<pre class='cython code score-149 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_33_compute_spearmanr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_33_compute_spearmanr = {"_compute_spearmanr", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_33_compute_spearmanr, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_33_compute_spearmanr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_sample_weight = 0;
  PyObject *__pyx_v_tie_method = 0;
  PyObject *__pyx_v_nan_policy = 0;
  PyObject *__pyx_v_control_vars = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_compute_spearmanr (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_sample_weight,&amp;__pyx_n_s_tie_method,&amp;__pyx_n_s_nan_policy,&amp;__pyx_n_s_control_vars,0};
  PyObject* values[6] = {0,0,0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_spearmanr", 1, 6, 6, 1); <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sample_weight)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_spearmanr", 1, 6, 6, 2); <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_tie_method)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_spearmanr", 1, 6, 6, 3); <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_nan_policy)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_spearmanr", 1, 6, 6, 4); <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_control_vars)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_spearmanr", 1, 6, 6, 5); <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_compute_spearmanr") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 6)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
      values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
      values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
      values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_sample_weight = values[2];
    __pyx_v_tie_method = values[3];
    __pyx_v_nan_policy = values[4];
    __pyx_v_control_vars = values[5];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_compute_spearmanr", 1, 6, 6, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._compute_spearmanr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_32_compute_spearmanr(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_sample_weight, __pyx_v_tie_method, __pyx_v_nan_policy, __pyx_v_control_vars);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_6gofast_5tools_6mathex_32_compute_spearmanr(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_sample_weight, PyObject *__pyx_v_tie_method, PyObject *__pyx_v_nan_policy, PyObject *__pyx_v_control_vars) {
  PyObject *__pyx_v__weighted_spearman_corr = 0;
  PyObject *__pyx_v_valid_policies = NULL;
  PyObject *__pyx_v_valid_mask = NULL;
  PyObject *__pyx_v_valid_methods = NULL;
  PyObject *__pyx_v_ranks_true = NULL;
  PyObject *__pyx_v_ranks_pred = NULL;
  PyObject *__pyx_v_corr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__33)
  <span class='trace'>__Pyx_TraceCall</span>("_compute_spearmanr", __pyx_f[0], 1441, 0, <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sample_weight);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tie_method);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nan_policy);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._compute_spearmanr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__weighted_spearman_corr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_valid_policies);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_valid_mask);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_valid_methods);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ranks_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ranks_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_corr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sample_weight);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tie_method);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nan_policy);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__174 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_sample_weight, __pyx_n_s_tie_method, __pyx_n_s_nan_policy, __pyx_n_s_control_vars, __pyx_n_s_weighted_spearman_corr, __pyx_n_s_weighted_spearman_corr, __pyx_n_s_valid_policies, __pyx_n_s_valid_mask, __pyx_n_s_valid_methods, __pyx_n_s_ranks_true, __pyx_n_s_ranks_pred, __pyx_n_s_corr);<span class='error_goto'> if (unlikely(!__pyx_tuple__174)) __PYX_ERR(0, 1441, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__174);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__174);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1441,0,<span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_33_compute_spearmanr, 0, __pyx_n_s_compute_spearmanr, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__33));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1441, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_spearmanr, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1441, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__33 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__174, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_spearmanr, 1441, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__33)) __PYX_ERR(0, 1441, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1442</span>:         y_true, y_pred, sample_weight, tie_method, nan_policy, control_vars):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1443</span>:     # The key addition is the handling of multioutput by reshaping inputs if</pre>
<pre class="cython line score-0">&#xA0;<span class="">1444</span>:     # necessary and iterating over columns (or outputs) to compute Spearman's</pre>
<pre class="cython line score-0">&#xA0;<span class="">1445</span>:     # correlation for each, aggregating the results according to the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1446</span>:     # multioutput strategy.</pre>
<pre class="cython line score-85" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1447</span>:     def _weighted_spearman_corr(ranks_true, ranks_pred, weights):</pre>
<pre class='cython code score-85 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_18_compute_spearmanr_1_weighted_spearman_corr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_18_compute_spearmanr__weighted_spearman_corr, "\n        Computes Spearman's rank correlation with support for sample weights.\n        ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_18_compute_spearmanr_1_weighted_spearman_corr = {"_weighted_spearman_corr", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_18_compute_spearmanr_1_weighted_spearman_corr, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_18_compute_spearmanr__weighted_spearman_corr};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_18_compute_spearmanr_1_weighted_spearman_corr(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_ranks_true = 0;
  PyObject *__pyx_v_ranks_pred = 0;
  PyObject *__pyx_v_weights = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_weighted_spearman_corr (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_ranks_true,&amp;__pyx_n_s_ranks_pred,&amp;__pyx_n_s_weights,0};
  PyObject* values[3] = {0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ranks_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ranks_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_weighted_spearman_corr", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_weights)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_weighted_spearman_corr", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_weighted_spearman_corr") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
    }
    __pyx_v_ranks_true = values[0];
    __pyx_v_ranks_pred = values[1];
    __pyx_v_weights = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_weighted_spearman_corr", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._compute_spearmanr._weighted_spearman_corr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_18_compute_spearmanr__weighted_spearman_corr(__pyx_self, __pyx_v_ranks_true, __pyx_v_ranks_pred, __pyx_v_weights);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_18_compute_spearmanr__weighted_spearman_corr(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ranks_true, PyObject *__pyx_v_ranks_pred, PyObject *__pyx_v_weights) {
  PyObject *__pyx_v_mean_rank_true = NULL;
  PyObject *__pyx_v_mean_rank_pred = NULL;
  PyObject *__pyx_v_cov = NULL;
  PyObject *__pyx_v_var_true = NULL;
  PyObject *__pyx_v_var_pred = NULL;
  PyObject *__pyx_v_spearman_corr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("_weighted_spearman_corr", __pyx_f[0], 1447, 0, <span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._compute_spearmanr._weighted_spearman_corr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mean_rank_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mean_rank_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cov);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_var_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_var_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_spearman_corr);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__34 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_ranks_true, __pyx_n_s_ranks_pred, __pyx_n_s_weights, __pyx_n_s_mean_rank_true, __pyx_n_s_mean_rank_pred, __pyx_n_s_cov, __pyx_n_s_var_true, __pyx_n_s_var_pred, __pyx_n_s_spearman_corr);<span class='error_goto'> if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 1447, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__34);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__34);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1447,0,<span class='error_goto'>__PYX_ERR(0, 1447, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_18_compute_spearmanr_1_weighted_spearman_corr, 0, __pyx_n_s_compute_spearmanr_locals__weigh, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__35));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1447, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v__weighted_spearman_corr = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__35 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_weighted_spearman_corr, 1447, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__35)) __PYX_ERR(0, 1447, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1448</span>:         """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1449</span>:         Computes Spearman's rank correlation with support for sample weights.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1450</span>:         """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1451</span>:         # Weighted mean rank</pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1452</span>:         mean_rank_true = np.average(ranks_true, weights=weights)</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(1452,0,<span class='error_goto'>__PYX_ERR(0, 1452, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_average);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ranks_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ranks_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_ranks_true)) <span class='error_goto'>__PYX_ERR(0, 1452, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_weights, __pyx_v_weights) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1452, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1452, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_mean_rank_true = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1453</span>:         mean_rank_pred = np.average(ranks_pred, weights=weights)</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(1453,0,<span class='error_goto'>__PYX_ERR(0, 1453, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1453, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_average);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1453, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1453, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ranks_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ranks_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_ranks_pred)) <span class='error_goto'>__PYX_ERR(0, 1453, __pyx_L1_error)</span>;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1453, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_weights, __pyx_v_weights) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1453, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1453, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_mean_rank_pred = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1454</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1455</span>:         # Weighted covariance and variances</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1456</span>:         cov = np.average((ranks_true - mean_rank_true) * (</pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(1456,0,<span class='error_goto'>__PYX_ERR(0, 1456, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_average);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_ranks_true, __pyx_v_mean_rank_true);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1456,0,<span class='error_goto'>__PYX_ERR(0, 1456, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1456, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1456,0,<span class='error_goto'>__PYX_ERR(0, 1456, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_cov = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1457</span>:             ranks_pred - mean_rank_pred), weights=weights)</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(1457,0,<span class='error_goto'>__PYX_ERR(0, 1457, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_ranks_pred, __pyx_v_mean_rank_pred);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1457, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1457,0,<span class='error_goto'>__PYX_ERR(0, 1457, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1457, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_weights, __pyx_v_weights) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1457, __pyx_L1_error)</span>
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1458</span>:         var_true = np.average((ranks_true - mean_rank_true)**2, weights=weights)</pre>
<pre class='cython code score-35 '>  <span class='trace'>__Pyx_TraceLine</span>(1458,0,<span class='error_goto'>__PYX_ERR(0, 1458, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_average);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_ranks_true, __pyx_v_mean_rank_true);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_2, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1458, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_weights, __pyx_v_weights) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1458, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_var_true = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1459</span>:         var_pred = np.average((ranks_pred - mean_rank_pred)**2, weights=weights)</pre>
<pre class='cython code score-35 '>  <span class='trace'>__Pyx_TraceLine</span>(1459,0,<span class='error_goto'>__PYX_ERR(0, 1459, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_average);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_ranks_pred, __pyx_v_mean_rank_pred);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_1, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1459, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_weights, __pyx_v_weights) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1459, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_var_pred = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1460</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1461</span>:         # Weighted Spearman's rank correlation</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1462</span>:         spearman_corr = cov / np.sqrt(var_true * var_pred)</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(1462,0,<span class='error_goto'>__PYX_ERR(0, 1462, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_var_true, __pyx_v_var_pred);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1462, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_cov, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_spearman_corr = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1463</span>:         return spearman_corr</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1463,0,<span class='error_goto'>__PYX_ERR(0, 1463, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_spearman_corr);
  __pyx_r = __pyx_v_spearman_corr;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1464</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1465</span>:     # Validate and clean data based on `nan_policy`</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1466</span>:     valid_policies = ['propagate', 'raise', 'omit']</pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(1466,0,<span class='error_goto'>__PYX_ERR(0, 1466, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1466, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_propagate);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_propagate);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_u_propagate)) <span class='error_goto'>__PYX_ERR(0, 1466, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_raise);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_raise);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_u_raise)) <span class='error_goto'>__PYX_ERR(0, 1466, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_omit);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_omit);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_u_omit)) <span class='error_goto'>__PYX_ERR(0, 1466, __pyx_L1_error)</span>;
  __pyx_v_valid_policies = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1467</span>:     nan_policy= normalize_string(</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(1467,0,<span class='error_goto'>__PYX_ERR(0, 1467, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_normalize_string);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1467, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1468,0,<span class='error_goto'>__PYX_ERR(0, 1468, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1467, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_nan_policy);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_nan_policy);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_nan_policy)) <span class='error_goto'>__PYX_ERR(0, 1467, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1467,0,<span class='error_goto'>__PYX_ERR(0, 1467, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1467, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_nan_policy, __pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1468</span>:         nan_policy, target_strs= valid_policies,</pre>
<pre class='cython code score-7 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1468, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_target_strs, __pyx_v_valid_policies) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1468, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1469</span>:         raise_exception=True, deep=True,</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(1469,0,<span class='error_goto'>__PYX_ERR(0, 1469, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_raise_exception, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1468, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_deep, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1468, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1470</span>:         return_target_only=True,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1470,0,<span class='error_goto'>__PYX_ERR(0, 1470, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return_target_only, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1468, __pyx_L1_error)</span>
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1471</span>:         error_msg=(f"Invalid nan_policy: {nan_policy}")</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(1471,0,<span class='error_goto'>__PYX_ERR(0, 1471, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_nan_policy, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1471, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_Invalid_nan_policy, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1471, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_error_msg, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1468, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1472</span>:     )</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1473</span>:     if nan_policy == 'omit':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1473,0,<span class='error_goto'>__PYX_ERR(0, 1473, __pyx_L1_error)</span>)
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_nan_policy, __pyx_n_u_omit, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1473, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1474</span>:         valid_mask = ~np.isnan(y_true) &amp; ~np.isnan(y_pred)</pre>
<pre class='cython code score-57 '>    <span class='trace'>__Pyx_TraceLine</span>(1474,0,<span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_true};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Invert</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_pred};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1474, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Invert</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_valid_mask = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1475</span>:         y_true, y_pred = y_true[valid_mask], y_pred[valid_mask]</pre>
<pre class='cython code score-6 '>    <span class='trace'>__Pyx_TraceLine</span>(1475,0,<span class='error_goto'>__PYX_ERR(0, 1475, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_true, __pyx_v_valid_mask);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1475, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_pred, __pyx_v_valid_mask);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1475, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_5);
    __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1476</span>:         if sample_weight is not None:</pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(1476,0,<span class='error_goto'>__PYX_ERR(0, 1476, __pyx_L1_error)</span>)
    __pyx_t_6 = (__pyx_v_sample_weight != Py_None);
    if (__pyx_t_6) {
/* … */
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1477</span>:             sample_weight = sample_weight[valid_mask]</pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(1477,0,<span class='error_goto'>__PYX_ERR(0, 1477, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_sample_weight, __pyx_v_valid_mask);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1477, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sample_weight, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1478</span>:     elif nan_policy == 'raise':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1478,0,<span class='error_goto'>__PYX_ERR(0, 1478, __pyx_L1_error)</span>)
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_nan_policy, __pyx_n_u_raise, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1478, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/* … */
  }
  __pyx_L3:;
</pre><pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1479</span>:         if np.isnan(y_true).any() or np.isnan(y_pred).any():</pre>
<pre class='cython code score-78 '>    <span class='trace'>__Pyx_TraceLine</span>(1479,0,<span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_y_true};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (!__pyx_t_8) {
    } else {
      __pyx_t_6 = __pyx_t_8;
      goto __pyx_L6_bool_binop_done;
    }
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_y_pred};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1479, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = __pyx_t_8;
    __pyx_L6_bool_binop_done:;
    if (unlikely(__pyx_t_6)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1480</span>:             raise ValueError("Input values contain NaNs.")</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(1480,0,<span class='error_goto'>__PYX_ERR(0, 1480, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__36, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1480, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 1480, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__36 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Input_values_contain_NaNs);<span class='error_goto'> if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 1480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__36);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__36);
</pre><pre class="cython line score-0">&#xA0;<span class="">1481</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1482</span>:     # Implement tie handling</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1483</span>:     valid_methods = ['average', 'min', 'max', 'dense', 'ordinal']</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(1483,0,<span class='error_goto'>__PYX_ERR(0, 1483, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1483, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_average);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_average);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_u_average)) <span class='error_goto'>__PYX_ERR(0, 1483, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_min);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_min);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_u_min)) <span class='error_goto'>__PYX_ERR(0, 1483, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_max);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_max);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_u_max)) <span class='error_goto'>__PYX_ERR(0, 1483, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_dense);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_dense);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_n_u_dense)) <span class='error_goto'>__PYX_ERR(0, 1483, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_ordinal);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_ordinal);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 4, __pyx_n_u_ordinal)) <span class='error_goto'>__PYX_ERR(0, 1483, __pyx_L1_error)</span>;
  __pyx_v_valid_methods = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1484</span>:     tie_method = normalize_string(</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(1484,0,<span class='error_goto'>__PYX_ERR(0, 1484, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_normalize_string);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1484, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1485,0,<span class='error_goto'>__PYX_ERR(0, 1485, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1484, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_tie_method);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_tie_method);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_tie_method)) <span class='error_goto'>__PYX_ERR(0, 1484, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1484,0,<span class='error_goto'>__PYX_ERR(0, 1484, __pyx_L1_error)</span>)
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1484, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tie_method, __pyx_t_11);
  __pyx_t_11 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1485</span>:         tie_method, target_strs=valid_methods, raise_exception=True,</pre>
<pre class='cython code score-12 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1485, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_target_strs, __pyx_v_valid_methods) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1485, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_raise_exception, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1485, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1486</span>:         return_target_only=True, error_msg= (</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1486,0,<span class='error_goto'>__PYX_ERR(0, 1486, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return_target_only, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1485, __pyx_L1_error)</span>
</pre><pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1487</span>:             f"Invalid method '{tie_method}'. Expect {smart_format(valid_methods, 'or')} ")</pre>
<pre class='cython code score-55 '>  <span class='trace'>__Pyx_TraceLine</span>(1487,0,<span class='error_goto'>__PYX_ERR(0, 1487, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_9 = 0;
  __pyx_t_10 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Invalid_method);
  __pyx_t_9 += 16;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Invalid_method);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_kp_u_Invalid_method);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_tie_method, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_10) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_10;
  __pyx_t_9 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Expect);
  __pyx_t_9 += 10;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Expect);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_kp_u_Expect);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_smart_format);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_12, __pyx_v_valid_methods, __pyx_n_u_or};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1487, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  }
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_4, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_11) &gt; __pyx_t_10) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_11) : __pyx_t_10;
  __pyx_t_9 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 3, __pyx_t_11);
  __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__31);
  __pyx_t_9 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__31);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 4, __pyx_kp_u__31);
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_5, 5, __pyx_t_9, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_error_msg, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1485, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1488</span>:         )</pre>
<pre class="cython line score-0">&#xA0;<span class="">1489</span>:     # Rank data with specified tie handling method</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1490</span>:     ranks_true = rankdata(y_true, method=tie_method)</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(1490,0,<span class='error_goto'>__PYX_ERR(0, 1490, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_rankdata);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 1490, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_method, __pyx_v_tie_method) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1490, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ranks_true = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1491</span>:     ranks_pred = rankdata(y_pred, method=tie_method)</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(1491,0,<span class='error_goto'>__PYX_ERR(0, 1491, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_rankdata);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1491, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_method, __pyx_v_tie_method) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1491, __pyx_L1_error)</span>
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_ranks_pred = __pyx_t_11;
  __pyx_t_11 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1492</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1493</span>:     if control_vars is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1493,0,<span class='error_goto'>__PYX_ERR(0, 1493, __pyx_L1_error)</span>)
  __pyx_t_6 = (__pyx_v_control_vars != Py_None);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1494</span>:         ranks_true, ranks_pred = adjust_for_control_vars (</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(1494,0,<span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_adjust_for_control_vars);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1494,0,<span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ranks_true, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ranks_pred, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1495</span>:             ranks_true, ranks_pred, control_vars )</pre>
<pre class='cython code score-60 '>    <span class='trace'>__Pyx_TraceLine</span>(1495,0,<span class='error_goto'>__PYX_ERR(0, 1495, __pyx_L1_error)</span>)
    __pyx_t_2 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_2, __pyx_v_ranks_true, __pyx_v_ranks_pred, __pyx_v_control_vars};
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 3+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_11))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11))) {
      PyObject* sequence = __pyx_t_11;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1494, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
      index = 0; __pyx_t_3 = __pyx_t_13(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L9_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      index = 1; __pyx_t_2 = __pyx_t_13(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L9_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_13(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>
      __pyx_t_13 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L10_unpacking_done;
      __pyx_L9_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_13 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 1494, __pyx_L1_error)</span>
      __pyx_L10_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1496</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1497</span>:     # Compute weighted Spearman's rank correlation</pre>
<pre class="cython line score-0">&#xA0;<span class="">1498</span>:     # if sample_weight is provided</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1499</span>:     if sample_weight is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1499,0,<span class='error_goto'>__PYX_ERR(0, 1499, __pyx_L1_error)</span>)
  __pyx_t_6 = (__pyx_v_sample_weight != Py_None);
  if (__pyx_t_6) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1500</span>:         corr = _weighted_spearman_corr(ranks_true, ranks_pred, sample_weight)</pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(1500,0,<span class='error_goto'>__PYX_ERR(0, 1500, __pyx_L1_error)</span>)
    __pyx_t_11 = __pyx_pf_6gofast_5tools_6mathex_18_compute_spearmanr__weighted_spearman_corr(__pyx_v__weighted_spearman_corr, __pyx_v_ranks_true, __pyx_v_ranks_pred, __pyx_v_sample_weight);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1500, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_v_corr = __pyx_t_11;
    __pyx_t_11 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1501</span>:     else:</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1502</span>:         corr = np.corrcoef(ranks_true, ranks_pred)[0, 1]</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(1502,0,<span class='error_goto'>__PYX_ERR(0, 1502, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1502, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_corrcoef);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1502, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_ranks_true, __pyx_v_ranks_pred};
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_11)) <span class='error_goto'>__PYX_ERR(0, 1502, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_11, __pyx_tuple__13);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1502, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_v_corr = __pyx_t_3;
    __pyx_t_3 = 0;
  }
  __pyx_L11:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1503</span>:     return corr</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1503,0,<span class='error_goto'>__PYX_ERR(0, 1503, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_corr);
  __pyx_r = __pyx_v_corr;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1504</span>: </pre>
<pre class="cython line score-110" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1505</span>: def adjust_for_control_vars(y_true:ArrayLike, y_pred:ArrayLike, control_vars:Optional[Union[ArrayLike, List[ArrayLike]]]=None):</pre>
<pre class='cython code score-110 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_35adjust_for_control_vars(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_34adjust_for_control_vars, "\n    Adjusts y_true and y_pred for either regression or classification tasks by \n    removing the influence of control variables. \n    \n    The function serves as a wrapper that decides the adjustment strategy \n    based on the type of task (regression or classification) inferred from y_true.\n\n    Parameters\n    ----------\n    y_true : array-like\n        True target values. The nature of these values (continuous for regression or \n        categorical for classification) determines the adjustment strategy.\n    y_pred : array-like\n        Predicted target values. Must have the same shape as `y_true`.\n    control_vars : array-like or list of array-likes, optional\n        Control variables to adjust for. Can be a single array or a list of arrays. \n        If None, no adjustment is performed.\n\n    Returns\n    -------\n    adjusted_y_true : ndarray\n        Adjusted true target values, with the influence of control variables \n        removed.\n    adjusted_y_pred : ndarray\n        Adjusted predicted target values, with the influence of control \n        variables removed.\n\n    Notes\n    -----\n    The function dynamically determines whether the targets suggest a \n    regression or classification task and applies the appropriate adjustment\n    method. For regression, the adjustment involves residualizing the targets \n    against the control variables. \n    For classification, the approach might involve stratification or other \n    methods to control for the variables' influence.\n\n    In practice, this adjustment is crucial when control variables might \n    confound or otherwise influence the relationship between the predictors \n    and the target variable, potentially biasing the correlation measure.\n\n    Examples\n    --------\n    &gt;&gt;&gt; y_true = np.array([1, 2, 3, 4])\n    &gt;&gt;&gt; y_pred = np.array([1.1, 1.9, 3.2, 3.8])\n    &gt;&gt;&gt; control_vars = np.array([1, 1, 2, 2])\n    &gt;&gt;&gt; adjusted_y_true, adjusted_y_pred = adjust_for_control_vars(\n    ..."" y_true, y_pred, control_vars)\n    # Adjusted values depend on the specific implementation for regression\n    or classification.\n\n    See Also\n    --------\n    adjust_for_control_vars_regression : \n        Function to adjust targets in a regression task.\n    adjust_for_control_vars_classification : \n        Function to adjust targets in a classification task.\n\n    References\n    ----------\n    .. [1] K. Pearson, \"On the theory of contingency and its relation to \n           association and normal correlation,\" Drapers' Company Research \n           Memoirs (Biometric Series I), London, 1904.\n    .. [2] D. C. Montgomery, E. A. Peck, and G. G. Vining, \"Introduction to\n           Linear Regression Analysis,\" 5th ed., Wiley, 2012.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_35adjust_for_control_vars = {"adjust_for_control_vars", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_35adjust_for_control_vars, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_34adjust_for_control_vars};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_35adjust_for_control_vars(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_control_vars = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("adjust_for_control_vars (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_control_vars,0};
  PyObject* values[3] = {0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("adjust_for_control_vars", 0, 2, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_control_vars);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "adjust_for_control_vars") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_control_vars = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("adjust_for_control_vars", 0, 2, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.adjust_for_control_vars", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_34adjust_for_control_vars(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_control_vars);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_34adjust_for_control_vars(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_control_vars) {
  PyObject *__pyx_v_adjusted_y_true = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__37)
  <span class='trace'>__Pyx_TraceCall</span>("adjust_for_control_vars", __pyx_f[0], 1505, 0, <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_control_vars);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.adjust_for_control_vars", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_adjusted_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_control_vars);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__175 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_control_vars, __pyx_n_s_adjusted_y_true);<span class='error_goto'> if (unlikely(!__pyx_tuple__175)) __PYX_ERR(0, 1505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__175);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__175);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1505,0,<span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_y_true, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_y_pred, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_control_vars, __pyx_kp_s_Optional_Union_ArrayLike_List_Ar) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_35adjust_for_control_vars, 0, __pyx_n_s_adjust_for_control_vars, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__37));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1505, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__158);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_adjust_for_control_vars, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1505, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__37 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__175, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_adjust_for_control_vars, 1505, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__37)) __PYX_ERR(0, 1505, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1506</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1507</span>:     Adjusts y_true and y_pred for either regression or classification tasks by</pre>
<pre class="cython line score-0">&#xA0;<span class="">1508</span>:     removing the influence of control variables.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1509</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1510</span>:     The function serves as a wrapper that decides the adjustment strategy</pre>
<pre class="cython line score-0">&#xA0;<span class="">1511</span>:     based on the type of task (regression or classification) inferred from y_true.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1512</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1513</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1514</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1515</span>:     y_true : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1516</span>:         True target values. The nature of these values (continuous for regression or</pre>
<pre class="cython line score-0">&#xA0;<span class="">1517</span>:         categorical for classification) determines the adjustment strategy.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1518</span>:     y_pred : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1519</span>:         Predicted target values. Must have the same shape as `y_true`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1520</span>:     control_vars : array-like or list of array-likes, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1521</span>:         Control variables to adjust for. Can be a single array or a list of arrays.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1522</span>:         If None, no adjustment is performed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1523</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1524</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1525</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1526</span>:     adjusted_y_true : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">1527</span>:         Adjusted true target values, with the influence of control variables</pre>
<pre class="cython line score-0">&#xA0;<span class="">1528</span>:         removed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1529</span>:     adjusted_y_pred : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">1530</span>:         Adjusted predicted target values, with the influence of control</pre>
<pre class="cython line score-0">&#xA0;<span class="">1531</span>:         variables removed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1532</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1533</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">1534</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">1535</span>:     The function dynamically determines whether the targets suggest a</pre>
<pre class="cython line score-0">&#xA0;<span class="">1536</span>:     regression or classification task and applies the appropriate adjustment</pre>
<pre class="cython line score-0">&#xA0;<span class="">1537</span>:     method. For regression, the adjustment involves residualizing the targets</pre>
<pre class="cython line score-0">&#xA0;<span class="">1538</span>:     against the control variables.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1539</span>:     For classification, the approach might involve stratification or other</pre>
<pre class="cython line score-0">&#xA0;<span class="">1540</span>:     methods to control for the variables' influence.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1541</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1542</span>:     In practice, this adjustment is crucial when control variables might</pre>
<pre class="cython line score-0">&#xA0;<span class="">1543</span>:     confound or otherwise influence the relationship between the predictors</pre>
<pre class="cython line score-0">&#xA0;<span class="">1544</span>:     and the target variable, potentially biasing the correlation measure.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1545</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1546</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1547</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1548</span>:     &gt;&gt;&gt; y_true = np.array([1, 2, 3, 4])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1549</span>:     &gt;&gt;&gt; y_pred = np.array([1.1, 1.9, 3.2, 3.8])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1550</span>:     &gt;&gt;&gt; control_vars = np.array([1, 1, 2, 2])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1551</span>:     &gt;&gt;&gt; adjusted_y_true, adjusted_y_pred = adjust_for_control_vars(</pre>
<pre class="cython line score-0">&#xA0;<span class="">1552</span>:     ... y_true, y_pred, control_vars)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1553</span>:     # Adjusted values depend on the specific implementation for regression</pre>
<pre class="cython line score-0">&#xA0;<span class="">1554</span>:     or classification.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1555</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1556</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">1557</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1558</span>:     adjust_for_control_vars_regression :</pre>
<pre class="cython line score-0">&#xA0;<span class="">1559</span>:         Function to adjust targets in a regression task.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1560</span>:     adjust_for_control_vars_classification :</pre>
<pre class="cython line score-0">&#xA0;<span class="">1561</span>:         Function to adjust targets in a classification task.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1562</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1563</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">1564</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1565</span>:     .. [1] K. Pearson, "On the theory of contingency and its relation to</pre>
<pre class="cython line score-0">&#xA0;<span class="">1566</span>:            association and normal correlation," Drapers' Company Research</pre>
<pre class="cython line score-0">&#xA0;<span class="">1567</span>:            Memoirs (Biometric Series I), London, 1904.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1568</span>:     .. [2] D. C. Montgomery, E. A. Peck, and G. G. Vining, "Introduction to</pre>
<pre class="cython line score-0">&#xA0;<span class="">1569</span>:            Linear Regression Analysis," 5th ed., Wiley, 2012.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1570</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1571</span>:     if control_vars is None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1571,0,<span class='error_goto'>__PYX_ERR(0, 1571, __pyx_L1_error)</span>)
  __pyx_t_1 = (__pyx_v_control_vars == Py_None);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1572</span>:         return y_true, y_pred</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(1572,0,<span class='error_goto'>__PYX_ERR(0, 1572, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1572, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 1572, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1572, __pyx_L1_error)</span>;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1573</span>:     # Convert control_vars to numpy array if not already</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1574</span>:     control_vars = np.asarray(control_vars)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(1574,0,<span class='error_goto'>__PYX_ERR(0, 1574, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1574, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_control_vars};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1574, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_control_vars, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1575</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1576</span>:     # statistical method suitable for the specific use case.</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1577</span>:     if type_of_target(y_true) =='continuous':</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(1577,0,<span class='error_goto'>__PYX_ERR(0, 1577, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_type_of_target);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1577, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_true};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1577, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_2, __pyx_n_u_continuous, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1577, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_1) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1578</span>:         adjusted_y_true, adjusted_y_true = adjust_for_control_vars_regression(</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(1578,0,<span class='error_goto'>__PYX_ERR(0, 1578, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_adjust_for_control_vars_regressi);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1578,0,<span class='error_goto'>__PYX_ERR(0, 1578, __pyx_L1_error)</span>)
    __pyx_v_adjusted_y_true = __pyx_t_4;
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_adjusted_y_true, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1579</span>:             y_true, y_pred, control_vars)</pre>
<pre class='cython code score-60 '>    <span class='trace'>__Pyx_TraceLine</span>(1579,0,<span class='error_goto'>__PYX_ERR(0, 1579, __pyx_L1_error)</span>)
    __pyx_t_3 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_3, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_control_vars};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 3+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1578, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 1578, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      #else
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1578, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_6);
      index = 0; __pyx_t_4 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_4)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      index = 1; __pyx_t_3 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_6), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1578, __pyx_L1_error)</span>
      __pyx_t_7 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 1578, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1580</span>:     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1581</span>:         # is classification</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1582</span>:         adjusted_y_true, adjusted_y_true = adjust_for_control_vars_classification(</pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(1582,0,<span class='error_goto'>__PYX_ERR(0, 1582, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_adjust_for_control_vars_classifi);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1582, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1582,0,<span class='error_goto'>__PYX_ERR(0, 1582, __pyx_L1_error)</span>)
    __pyx_v_adjusted_y_true = __pyx_t_3;
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_adjusted_y_true, __pyx_t_4);
    __pyx_t_4 = 0;
  }
  __pyx_L4:;
</pre><pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1583</span>:             y_true, y_pred, control_vars)</pre>
<pre class='cython code score-60 '>    <span class='trace'>__Pyx_TraceLine</span>(1583,0,<span class='error_goto'>__PYX_ERR(0, 1583, __pyx_L1_error)</span>)
    __pyx_t_4 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_4, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_control_vars};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 3+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1582, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 1582, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1582, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1582, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1582, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_6);
      index = 0; __pyx_t_3 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_3)) goto __pyx_L7_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      index = 1; __pyx_t_4 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_4)) goto __pyx_L7_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_7(__pyx_t_6), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1582, __pyx_L1_error)</span>
      __pyx_t_7 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L8_unpacking_done;
      __pyx_L7_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_7 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 1582, __pyx_L1_error)</span>
      __pyx_L8_unpacking_done:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1584</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1585</span>:     return adjusted_y_true, adjusted_y_true</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(1585,0,<span class='error_goto'>__PYX_ERR(0, 1585, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1585, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_adjusted_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_adjusted_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_adjusted_y_true)) <span class='error_goto'>__PYX_ERR(0, 1585, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_adjusted_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_adjusted_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_adjusted_y_true)) <span class='error_goto'>__PYX_ERR(0, 1585, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1586</span>: </pre>
<pre class="cython line score-116" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1587</span>: def adjust_for_control_vars_regression(y_true:ArrayLike, y_pred: ArrayLike, control_vars: Union[ArrayLike, List[ArrayLike]]):</pre>
<pre class='cython code score-116 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_37adjust_for_control_vars_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_36adjust_for_control_vars_regression, "\n    Adjust y_true and y_pred for regression tasks by accounting for the influence\n    of specified control variables through residualization.\n\n    This approach fits a linear model to predict y_true and y_pred solely based on\n    control variables, and then computes the residuals. These residuals represent\n    the portion of y_true and y_pred that cannot be explained by the control\n    variables, effectively isolating the effect of the predictors of interest.\n\n    Parameters\n    ----------\n    y_true : array-like of shape (n_samples,)\n        True target values for regression.\n    y_pred : array-like of shape (n_samples,)\n        Predicted target values for regression.\n    control_vars : array-like or list of array-likes\n        Control variables to adjust for. Can be a single array or a list of arrays.\n\n    Returns\n    -------\n    adjusted_y_true : ndarray of shape (n_samples,)\n        Adjusted true target values, with the influence of control variables removed.\n    adjusted_y_pred : ndarray of shape (n_samples,)\n        Adjusted predicted target values, with the influence of control variables removed.\n\n    Raises\n    ------\n    ValueError\n        If y_true or y_pred are not 1-dimensional arrays.\n\n    Notes\n    -----\n    This function uses LinearRegression from sklearn.linear_model to fit models\n    predicting y_true and y_pred from the control variables. The residuals from\n    these models (the differences between the observed and predicted values) are\n    the adjusted targets.\n\n    The mathematical concept behind this adjustment is as follows:\n    \n    .. math::\n        \text{adjusted\\_y} = y - \\hat{y}_{\text{control}}\n        \n    where :math:`\\hat{y}_{\text{control}}` is the prediction from a linear model\n    trained only on the control variables.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import adjust_for_control_vars_regression\n    &gt;&gt;&gt; y_true = np.array([3, 5, 7, 9])\n    &gt;&gt;&gt; y_pred = np.ar""ray([4, 6, 8, 10])\n    &gt;&gt;&gt; control_vars = np.array([1, 2, 3, 4])\n    &gt;&gt;&gt; adjusted_y_true, adjusted_y_pred = adjust_for_control_vars_regression(\n    ... y_true, y_pred, control_vars)\n    &gt;&gt;&gt; print(adjusted_y_true)\n    &gt;&gt;&gt; print(adjusted_y_pred)\n\n    References\n    ----------\n    .. [1] Freedman, D. A. (2009). Statistical Models: Theory and Practice. \n          Cambridge University Press.\n    \n    See Also\n    --------\n    sklearn.linear_model.LinearRegression\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_37adjust_for_control_vars_regression = {"adjust_for_control_vars_regression", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_37adjust_for_control_vars_regression, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_36adjust_for_control_vars_regression};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_37adjust_for_control_vars_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_control_vars = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("adjust_for_control_vars_regression (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_control_vars,0};
  PyObject* values[3] = {0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("adjust_for_control_vars_regression", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_control_vars)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("adjust_for_control_vars_regression", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "adjust_for_control_vars_regression") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_control_vars = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("adjust_for_control_vars_regression", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.adjust_for_control_vars_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_36adjust_for_control_vars_regression(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_control_vars);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_36adjust_for_control_vars_regression(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_control_vars) {
  PyObject *__pyx_v_LinearRegression = NULL;
  PyObject *__pyx_v_model_true = NULL;
  PyObject *__pyx_v_residuals_true = NULL;
  PyObject *__pyx_v_model_pred = NULL;
  PyObject *__pyx_v_residuals_pred = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__38)
  <span class='trace'>__Pyx_TraceCall</span>("adjust_for_control_vars_regression", __pyx_f[0], 1587, 0, <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_control_vars);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.adjust_for_control_vars_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_LinearRegression);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_model_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_residuals_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_model_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_residuals_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_control_vars);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__176 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_control_vars, __pyx_n_s_LinearRegression, __pyx_n_s_model_true, __pyx_n_s_residuals_true, __pyx_n_s_model_pred, __pyx_n_s_residuals_pred);<span class='error_goto'> if (unlikely(!__pyx_tuple__176)) __PYX_ERR(0, 1587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__176);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__176);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1587,0,<span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_true, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_pred, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_control_vars, __pyx_kp_s_Union_ArrayLike_List_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_37adjust_for_control_vars_regression, 0, __pyx_n_s_adjust_for_control_vars_regressi, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__38));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1587, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_4, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_adjust_for_control_vars_regressi, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1587, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__38 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__176, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_adjust_for_control_vars_regressi, 1587, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 1587, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1588</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1589</span>:     Adjust y_true and y_pred for regression tasks by accounting for the influence</pre>
<pre class="cython line score-0">&#xA0;<span class="">1590</span>:     of specified control variables through residualization.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1591</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1592</span>:     This approach fits a linear model to predict y_true and y_pred solely based on</pre>
<pre class="cython line score-0">&#xA0;<span class="">1593</span>:     control variables, and then computes the residuals. These residuals represent</pre>
<pre class="cython line score-0">&#xA0;<span class="">1594</span>:     the portion of y_true and y_pred that cannot be explained by the control</pre>
<pre class="cython line score-0">&#xA0;<span class="">1595</span>:     variables, effectively isolating the effect of the predictors of interest.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1596</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1597</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1598</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1599</span>:     y_true : array-like of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1600</span>:         True target values for regression.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1601</span>:     y_pred : array-like of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1602</span>:         Predicted target values for regression.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1603</span>:     control_vars : array-like or list of array-likes</pre>
<pre class="cython line score-0">&#xA0;<span class="">1604</span>:         Control variables to adjust for. Can be a single array or a list of arrays.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1605</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1606</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1607</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1608</span>:     adjusted_y_true : ndarray of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1609</span>:         Adjusted true target values, with the influence of control variables removed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1610</span>:     adjusted_y_pred : ndarray of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1611</span>:         Adjusted predicted target values, with the influence of control variables removed.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1612</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1613</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">1614</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1615</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">1616</span>:         If y_true or y_pred are not 1-dimensional arrays.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1617</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1618</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">1619</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">1620</span>:     This function uses LinearRegression from sklearn.linear_model to fit models</pre>
<pre class="cython line score-0">&#xA0;<span class="">1621</span>:     predicting y_true and y_pred from the control variables. The residuals from</pre>
<pre class="cython line score-0">&#xA0;<span class="">1622</span>:     these models (the differences between the observed and predicted values) are</pre>
<pre class="cython line score-0">&#xA0;<span class="">1623</span>:     the adjusted targets.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1624</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1625</span>:     The mathematical concept behind this adjustment is as follows:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1626</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1627</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">1628</span>:         \text{adjusted\_y} = y - \hat{y}_{\text{control}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1629</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1630</span>:     where :math:`\hat{y}_{\text{control}}` is the prediction from a linear model</pre>
<pre class="cython line score-0">&#xA0;<span class="">1631</span>:     trained only on the control variables.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1632</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1633</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1634</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1635</span>:     &gt;&gt;&gt; from gofast.tools.mathex import adjust_for_control_vars_regression</pre>
<pre class="cython line score-0">&#xA0;<span class="">1636</span>:     &gt;&gt;&gt; y_true = np.array([3, 5, 7, 9])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1637</span>:     &gt;&gt;&gt; y_pred = np.array([4, 6, 8, 10])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1638</span>:     &gt;&gt;&gt; control_vars = np.array([1, 2, 3, 4])</pre>
<pre class="cython line score-0">&#xA0;<span class="">1639</span>:     &gt;&gt;&gt; adjusted_y_true, adjusted_y_pred = adjust_for_control_vars_regression(</pre>
<pre class="cython line score-0">&#xA0;<span class="">1640</span>:     ... y_true, y_pred, control_vars)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1641</span>:     &gt;&gt;&gt; print(adjusted_y_true)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1642</span>:     &gt;&gt;&gt; print(adjusted_y_pred)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1643</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1644</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">1645</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1646</span>:     .. [1] Freedman, D. A. (2009). Statistical Models: Theory and Practice.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1647</span>:           Cambridge University Press.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1648</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1649</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">1650</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1651</span>:     sklearn.linear_model.LinearRegression</pre>
<pre class="cython line score-0">&#xA0;<span class="">1652</span>:     """</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1653</span>:     from sklearn.linear_model import LinearRegression</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(1653,0,<span class='error_goto'>__PYX_ERR(0, 1653, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1653, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_LinearRegression);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_LinearRegression);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_LinearRegression)) <span class='error_goto'>__PYX_ERR(0, 1653, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_linear_model, __pyx_t_1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1653, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_LinearRegression);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1653, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_LinearRegression = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1654</span>:     # Convert inputs to numpy arrays for consistency</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1655</span>:     y_true = np.asarray(y_true)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(1655,0,<span class='error_goto'>__PYX_ERR(0, 1655, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_y_true};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1656</span>:     y_pred = np.asarray(y_pred)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(1656,0,<span class='error_goto'>__PYX_ERR(0, 1656, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1656, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1656, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_pred};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1656, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1657</span>:     control_vars = np.asarray(control_vars)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(1657,0,<span class='error_goto'>__PYX_ERR(0, 1657, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1657, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_control_vars};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1657, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_control_vars, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1658</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1659</span>:     # Ensure the task is appropriate for the data</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1660</span>:     if y_true.ndim &gt; 1 or y_pred.ndim &gt; 1:</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(1660,0,<span class='error_goto'>__PYX_ERR(0, 1660, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y_true, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1660, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_int_1, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1660, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1660, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y_pred, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1660, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_int_1, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1660, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1660, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __pyx_t_6;
  __pyx_L4_bool_binop_done:;
  if (unlikely(__pyx_t_5)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1661</span>:         raise ValueError(</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(1661,0,<span class='error_goto'>__PYX_ERR(0, 1661, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__40, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1661, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 1661, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__40 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_y_true_and_y_pred_should_be_1_di);<span class='error_goto'> if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 1661, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__40);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__40);
</pre><pre class="cython line score-0">&#xA0;<span class="">1662</span>:             "y_true and y_pred should be 1-dimensional arrays for regression tasks.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">1663</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1664</span>:     if control_vars is None or len(control_vars) == 0:</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1664,0,<span class='error_goto'>__PYX_ERR(0, 1664, __pyx_L1_error)</span>)
  __pyx_t_6 = (__pyx_v_control_vars == Py_None);
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L7_bool_binop_done;
  }
  __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_control_vars);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1664, __pyx_L1_error)</span>
  __pyx_t_6 = (__pyx_t_7 == 0);
  __pyx_t_5 = __pyx_t_6;
  __pyx_L7_bool_binop_done:;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">1665</span>:         # No adjustment needed if there are no control variables</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1666</span>:         return y_true, y_pred</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(1666,0,<span class='error_goto'>__PYX_ERR(0, 1666, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1666, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 1666, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1666, __pyx_L1_error)</span>;
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1667</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1668</span>:     # Check if control_vars is a single array; if so,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1669</span>:     # reshape for sklearn compatibility</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1670</span>:     if control_vars.ndim == 1:</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1670,0,<span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_control_vars, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_2, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1670, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1671</span>:         control_vars = control_vars.reshape(-1, 1)</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(1671,0,<span class='error_goto'>__PYX_ERR(0, 1671, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_control_vars, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1671, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__41, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1671, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_control_vars, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  __pyx_tuple__41 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_neg_1, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 1671, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__41);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__41);
</pre><pre class="cython line score-0">&#xA0;<span class="">1672</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1673</span>:     # Adjust y_true based on control variables</pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1674</span>:     model_true = LinearRegression().fit(control_vars, y_true)</pre>
<pre class='cython code score-32 '>  <span class='trace'>__Pyx_TraceLine</span>(1674,0,<span class='error_goto'>__PYX_ERR(0, 1674, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_LinearRegression);
  __pyx_t_1 = __pyx_v_LinearRegression; __pyx_t_8 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1674, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_fit);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_control_vars, __pyx_v_y_true};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1674, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_v_model_true = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1675</span>:     residuals_true = y_true - model_true.predict(control_vars)</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(1675,0,<span class='error_goto'>__PYX_ERR(0, 1675, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model_true, __pyx_n_s_predict);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1675, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_control_vars};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1675, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_y_true, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1675, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_residuals_true = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1676</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1677</span>:     # Adjust y_pred based on control variables</pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1678</span>:     model_pred = LinearRegression().fit(control_vars, y_pred)</pre>
<pre class='cython code score-32 '>  <span class='trace'>__Pyx_TraceLine</span>(1678,0,<span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_LinearRegression);
  __pyx_t_2 = __pyx_v_LinearRegression; __pyx_t_8 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, NULL};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_fit);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1678, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_control_vars, __pyx_v_y_pred};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_model_pred = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1679</span>:     residuals_pred = y_pred - model_pred.predict(control_vars)</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(1679,0,<span class='error_goto'>__PYX_ERR(0, 1679, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model_pred, __pyx_n_s_predict);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1679, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_control_vars};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_y_pred, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1679, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_residuals_pred = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1680</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1681</span>:     return residuals_true, residuals_pred</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(1681,0,<span class='error_goto'>__PYX_ERR(0, 1681, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_residuals_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_residuals_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_residuals_true)) <span class='error_goto'>__PYX_ERR(0, 1681, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_residuals_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_residuals_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_residuals_pred)) <span class='error_goto'>__PYX_ERR(0, 1681, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1682</span>: </pre>
<pre class="cython line score-123" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1683</span>: def adjust_for_control_vars_classification(y_true:ArrayLike, y_pred:ArrayLike, control_vars:DataFrame):</pre>
<pre class='cython code score-123 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_39adjust_for_control_vars_classification(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_38adjust_for_control_vars_classification, "\n    Adjusts `y_true` and `y_pred` in a classification task by stratifying the\n    data based on control variables. It optionally applies logistic regression\n    within each stratum  for adjustment, aiming to refine predictions based \n    on the influence of control variables.\n\n    Parameters\n    ----------\n    y_true : array-like\n        True class labels. Must be a 1D array of classification targets.\n    y_pred : array-like\n        Predicted class labels, corresponding to `y_true`. Must be of the \n        same shape as `y_true`.\n    control_vars : pandas.DataFrame\n        DataFrame containing one or more columns that represent control \n        variables. These variables are used to stratify the data before \n        applying any adjustment logic.\n\n    Returns\n    -------\n    adjusted_y_true : numpy.ndarray\n        Adjusted array of true class labels, same as input `y_true` \n        (adjustment process does not alter true labels).\n    adjusted_y_pred : numpy.ndarray\n        Adjusted array of predicted class labels after considering the \n        stratification by control variables.\n\n    Notes\n    -----\n    This function aims to account for potential confounders or additional\n    information represented by control variables.\n    Logistic regression is utilized within each stratum defined by unique \n    combinations of control variables to adjust predictions.\n    The essence is to mitigate the influence of control variables on the \n    prediction outcomes, thereby potentially enhancing the prediction accuracy\n    or fairness across different groups.\n\n    The adjustment is particularly useful in scenarios where control variables\n    significantly influence the target variable, and their effects need to be\n    isolated from the primary predictive modeling process.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import adjust_for_control_vars_classification\n    &gt;&gt;&gt; y_true = [0, 1, 0, 1]\n    &gt;&gt;&gt; y_pred = [0, 0, 1, 1]""\n    &gt;&gt;&gt; control_vars = pd.DataFrame({'age': [25, 30, 35, 40], 'gender': [0, 1, 0, 1]})\n    &gt;&gt;&gt; adjusted_y_true, adjusted_y_pred = adjust_for_control_vars_classification(\n    ... y_true, y_pred, control_vars)\n    &gt;&gt;&gt; print(adjusted_y_pred)\n    [0 0 1 1]\n\n    The function does not modify `y_true` but adjusts `y_pred` based on \n    logistic regression adjustments within each stratum defined by \n    `control_vars`.\n\n    See Also\n    --------\n    sklearn.metrics.classification_report : Compute precision, recall,\n        F-measure and support for each class.\n    sklearn.preprocessing.LabelEncoder : \n        Encode target labels with value between 0 and n_classes-1.\n    sklearn.linear_model.LogisticRegression : \n        Logistic Regression (aka logit, MaxEnt) classifier.\n\n    References\n    ----------\n    .. [2] J. D. Hunter. \"Matplotlib: A 2D graphics environment\", \n           Computing in Science &amp; Engineering, vol. 9, no. 3, pp. 90-95, 2007.\n    .. [1] F. Pedregosa et al., \"Scikit-learn: Machine Learning in Python\",\n           Journal of Machine Learning Research, vol. 12, pp. 2825-2830, 2011.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_39adjust_for_control_vars_classification = {"adjust_for_control_vars_classification", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_39adjust_for_control_vars_classification, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_38adjust_for_control_vars_classification};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_39adjust_for_control_vars_classification(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_control_vars = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("adjust_for_control_vars_classification (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_control_vars,0};
  PyObject* values[3] = {0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("adjust_for_control_vars_classification", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_control_vars)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("adjust_for_control_vars_classification", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "adjust_for_control_vars_classification") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_control_vars = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("adjust_for_control_vars_classification", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.adjust_for_control_vars_classification", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_38adjust_for_control_vars_classification(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_control_vars);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_38adjust_for_control_vars_classification(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_control_vars) {
  PyObject *__pyx_v_LogisticRegression = NULL;
  PyObject *__pyx_v_LabelEncoder = NULL;
  PyObject *__pyx_v_data = NULL;
  PyObject *__pyx_v_col = NULL;
  PyObject *__pyx_v_le_true = NULL;
  PyObject *__pyx_v_le_pred = NULL;
  PyObject *__pyx_v_adjusted_preds = NULL;
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  PyObject *__pyx_v_group = NULL;
  PyObject *__pyx_v_lr = NULL;
  PyObject *__pyx_v_adjusted_pred = NULL;
  PyObject *__pyx_v_adjusted_y_pred = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__42)
  <span class='trace'>__Pyx_TraceCall</span>("adjust_for_control_vars_classification", __pyx_f[0], 1683, 0, <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.adjust_for_control_vars_classification", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_LogisticRegression);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_LabelEncoder);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_col);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_le_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_le_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_adjusted_preds);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_group);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_adjusted_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_adjusted_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__178 = <span class='py_c_api'>PyTuple_Pack</span>(15, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_control_vars, __pyx_n_s_LogisticRegression, __pyx_n_s_LabelEncoder, __pyx_n_s_data, __pyx_n_s_col, __pyx_n_s_le_true, __pyx_n_s_le_pred, __pyx_n_s_adjusted_preds, __pyx_n_s__177, __pyx_n_s_group, __pyx_n_s_lr, __pyx_n_s_adjusted_pred, __pyx_n_s_adjusted_y_pred);<span class='error_goto'> if (unlikely(!__pyx_tuple__178)) __PYX_ERR(0, 1683, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__178);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__178);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1683,0,<span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1683, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_y_true, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_y_pred, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_control_vars, __pyx_n_s_DataFrame) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_39adjust_for_control_vars_classification, 0, __pyx_n_s_adjust_for_control_vars_classifi, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__42));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1683, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_adjust_for_control_vars_classifi, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1683, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__42 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__178, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_adjust_for_control_vars_classifi, 1683, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 1683, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1684</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1685</span>:     Adjusts `y_true` and `y_pred` in a classification task by stratifying the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1686</span>:     data based on control variables. It optionally applies logistic regression</pre>
<pre class="cython line score-0">&#xA0;<span class="">1687</span>:     within each stratum  for adjustment, aiming to refine predictions based</pre>
<pre class="cython line score-0">&#xA0;<span class="">1688</span>:     on the influence of control variables.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1689</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1690</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1691</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1692</span>:     y_true : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1693</span>:         True class labels. Must be a 1D array of classification targets.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1694</span>:     y_pred : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1695</span>:         Predicted class labels, corresponding to `y_true`. Must be of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1696</span>:         same shape as `y_true`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1697</span>:     control_vars : pandas.DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">1698</span>:         DataFrame containing one or more columns that represent control</pre>
<pre class="cython line score-0">&#xA0;<span class="">1699</span>:         variables. These variables are used to stratify the data before</pre>
<pre class="cython line score-0">&#xA0;<span class="">1700</span>:         applying any adjustment logic.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1701</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1702</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1703</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1704</span>:     adjusted_y_true : numpy.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">1705</span>:         Adjusted array of true class labels, same as input `y_true`</pre>
<pre class="cython line score-0">&#xA0;<span class="">1706</span>:         (adjustment process does not alter true labels).</pre>
<pre class="cython line score-0">&#xA0;<span class="">1707</span>:     adjusted_y_pred : numpy.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">1708</span>:         Adjusted array of predicted class labels after considering the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1709</span>:         stratification by control variables.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1710</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1711</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">1712</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">1713</span>:     This function aims to account for potential confounders or additional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1714</span>:     information represented by control variables.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1715</span>:     Logistic regression is utilized within each stratum defined by unique</pre>
<pre class="cython line score-0">&#xA0;<span class="">1716</span>:     combinations of control variables to adjust predictions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1717</span>:     The essence is to mitigate the influence of control variables on the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1718</span>:     prediction outcomes, thereby potentially enhancing the prediction accuracy</pre>
<pre class="cython line score-0">&#xA0;<span class="">1719</span>:     or fairness across different groups.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1720</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1721</span>:     The adjustment is particularly useful in scenarios where control variables</pre>
<pre class="cython line score-0">&#xA0;<span class="">1722</span>:     significantly influence the target variable, and their effects need to be</pre>
<pre class="cython line score-0">&#xA0;<span class="">1723</span>:     isolated from the primary predictive modeling process.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1724</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1725</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1726</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1727</span>:     &gt;&gt;&gt; from gofast.tools.mathex import adjust_for_control_vars_classification</pre>
<pre class="cython line score-0">&#xA0;<span class="">1728</span>:     &gt;&gt;&gt; y_true = [0, 1, 0, 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1729</span>:     &gt;&gt;&gt; y_pred = [0, 0, 1, 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1730</span>:     &gt;&gt;&gt; control_vars = pd.DataFrame({'age': [25, 30, 35, 40], 'gender': [0, 1, 0, 1]})</pre>
<pre class="cython line score-0">&#xA0;<span class="">1731</span>:     &gt;&gt;&gt; adjusted_y_true, adjusted_y_pred = adjust_for_control_vars_classification(</pre>
<pre class="cython line score-0">&#xA0;<span class="">1732</span>:     ... y_true, y_pred, control_vars)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1733</span>:     &gt;&gt;&gt; print(adjusted_y_pred)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1734</span>:     [0 0 1 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1735</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1736</span>:     The function does not modify `y_true` but adjusts `y_pred` based on</pre>
<pre class="cython line score-0">&#xA0;<span class="">1737</span>:     logistic regression adjustments within each stratum defined by</pre>
<pre class="cython line score-0">&#xA0;<span class="">1738</span>:     `control_vars`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1739</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1740</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">1741</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1742</span>:     sklearn.metrics.classification_report : Compute precision, recall,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1743</span>:         F-measure and support for each class.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1744</span>:     sklearn.preprocessing.LabelEncoder :</pre>
<pre class="cython line score-0">&#xA0;<span class="">1745</span>:         Encode target labels with value between 0 and n_classes-1.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1746</span>:     sklearn.linear_model.LogisticRegression :</pre>
<pre class="cython line score-0">&#xA0;<span class="">1747</span>:         Logistic Regression (aka logit, MaxEnt) classifier.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1748</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1749</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">1750</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1751</span>:     .. [2] J. D. Hunter. "Matplotlib: A 2D graphics environment",</pre>
<pre class="cython line score-0">&#xA0;<span class="">1752</span>:            Computing in Science &amp; Engineering, vol. 9, no. 3, pp. 90-95, 2007.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1753</span>:     .. [1] F. Pedregosa et al., "Scikit-learn: Machine Learning in Python",</pre>
<pre class="cython line score-0">&#xA0;<span class="">1754</span>:            Journal of Machine Learning Research, vol. 12, pp. 2825-2830, 2011.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1755</span>:     """</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1756</span>:     from sklearn.linear_model import LogisticRegression</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(1756,0,<span class='error_goto'>__PYX_ERR(0, 1756, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_LogisticRegression);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_LogisticRegression);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_LogisticRegression)) <span class='error_goto'>__PYX_ERR(0, 1756, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_linear_model, __pyx_t_1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_LogisticRegression);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_LogisticRegression = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1757</span>:     from sklearn.preprocessing import LabelEncoder</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(1757,0,<span class='error_goto'>__PYX_ERR(0, 1757, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_LabelEncoder);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_LabelEncoder);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_LabelEncoder)) <span class='error_goto'>__PYX_ERR(0, 1757, __pyx_L1_error)</span>;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_preprocessing, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_LabelEncoder);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_v_LabelEncoder = __pyx_t_2;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1758</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1759</span>:     # first check whether y_true and y_pred are classification data</pre>
<pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1760</span>:     y_true, y_pred = check_classification_targets(</pre>
<pre class='cython code score-66 '>  <span class='trace'>__Pyx_TraceLine</span>(1760,0,<span class='error_goto'>__PYX_ERR(0, 1760, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_check_classification_targets);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1761,0,<span class='error_goto'>__PYX_ERR(0, 1761, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 1760, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1760, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1760,0,<span class='error_goto'>__PYX_ERR(0, 1760, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 1760, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1760, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1760, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1760, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
    index = 0; __pyx_t_3 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1760, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 1760, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1761</span>:         y_true, y_pred, strategy='custom logic')</pre>
<pre class='cython code score-7 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_strategy, __pyx_kp_u_custom_logic) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1761, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1762</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1763</span>:     # Ensure input is a DataFrame for easier manipulation</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1764</span>:     data = pd.DataFrame({</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1764,0,<span class='error_goto'>__PYX_ERR(0, 1764, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1764, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1764, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1765</span>:         'y_true': y_true,</pre>
<pre class='cython code score-7 '>  <span class='trace'>__Pyx_TraceLine</span>(1765,0,<span class='error_goto'>__PYX_ERR(0, 1765, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1765, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_y_true, __pyx_v_y_true) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1765, __pyx_L1_error)</span>
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1766</span>:         'y_pred': y_pred</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(1766,0,<span class='error_goto'>__PYX_ERR(0, 1766, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_y_pred, __pyx_v_y_pred) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1765, __pyx_L1_error)</span>
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_2};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1764, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_data = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1767</span>:     })</pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1768</span>:     for col in control_vars.columns:</pre>
<pre class='cython code score-52 '>  <span class='trace'>__Pyx_TraceLine</span>(1768,0,<span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_control_vars, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1768, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
    __pyx_t_3 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1768, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1768, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_7 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1768, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_7 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1768, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_8(__pyx_t_3);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1768,0,<span class='error_goto'>__PYX_ERR(0, 1768, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1769</span>:         data[col] = control_vars[col]</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(1769,0,<span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_control_vars, __pyx_v_col);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1769, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_data, __pyx_v_col, __pyx_t_4) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1769, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1770</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1771</span>:     # Encode y_true and y_pred if they are not numerical</pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1772</span>:     le_true = LabelEncoder().fit(y_true)</pre>
<pre class='cython code score-32 '>  <span class='trace'>__Pyx_TraceLine</span>(1772,0,<span class='error_goto'>__PYX_ERR(0, 1772, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_LabelEncoder);
  __pyx_t_2 = __pyx_v_LabelEncoder; __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1772, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_fit);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1772, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_y_true};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1772, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_le_true = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1773</span>:     data['y_true'] = le_true.transform(data['y_true'])</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(1773,0,<span class='error_goto'>__PYX_ERR(0, 1773, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_le_true, __pyx_n_s_transform);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_data, __pyx_n_u_y_true);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1773, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_4};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1773, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_data, __pyx_n_u_y_true, __pyx_t_3) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1773, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1774</span>: </pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1775</span>:     if not np.issubdtype(data['y_pred'].dtype, np.number):</pre>
<pre class='cython code score-34 '>  <span class='trace'>__Pyx_TraceLine</span>(1775,0,<span class='error_goto'>__PYX_ERR(0, 1775, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1775, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_issubdtype);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1775, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_data, __pyx_n_u_y_pred);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1775, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1775, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1775, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_number);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1775, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_t_1, __pyx_t_9};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1775, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1775, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_11 = (!__pyx_t_10);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1776</span>:         le_pred = LabelEncoder().fit(y_pred)</pre>
<pre class='cython code score-32 '>    <span class='trace'>__Pyx_TraceLine</span>(1776,0,<span class='error_goto'>__PYX_ERR(0, 1776, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_LabelEncoder);
    __pyx_t_9 = __pyx_v_LabelEncoder; __pyx_t_1 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1776, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_fit);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1776, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_y_pred};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1776, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    __pyx_v_le_pred = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1777</span>:         data['y_pred'] = le_pred.transform(data['y_pred'])</pre>
<pre class='cython code score-25 '>    <span class='trace'>__Pyx_TraceLine</span>(1777,0,<span class='error_goto'>__PYX_ERR(0, 1777, __pyx_L1_error)</span>)
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_le_pred, __pyx_n_s_transform);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1777, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_data, __pyx_n_u_y_pred);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1777, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_4};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1777, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_data, __pyx_n_u_y_pred, __pyx_t_3) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1777, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1778</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1779</span>:     # Iterate over each unique combination of control variables (each stratum)</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1780</span>:     adjusted_preds = []</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(1780,0,<span class='error_goto'>__PYX_ERR(0, 1780, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_adjusted_preds = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-119" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1781</span>:     for _, group in data.groupby(list(control_vars.columns)):</pre>
<pre class='cython code score-119 '>  <span class='trace'>__Pyx_TraceLine</span>(1781,0,<span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>)
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_groupby);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_control_vars, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_1};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_9 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_9);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_7 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_9, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_9);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_7 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_9, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_8(__pyx_t_9);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
      PyObject* sequence = __pyx_t_3;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1781, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);
      index = 0; __pyx_t_1 = __pyx_t_5(__pyx_t_2); if (unlikely(!__pyx_t_1)) goto __pyx_L11_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      index = 1; __pyx_t_4 = __pyx_t_5(__pyx_t_2); if (unlikely(!__pyx_t_4)) goto __pyx_L11_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_2), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
      __pyx_t_5 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L12_unpacking_done;
      __pyx_L11_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_5 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>
      __pyx_L12_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v__, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_group, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1781,0,<span class='error_goto'>__PYX_ERR(0, 1781, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1782</span>:         if len(group) &gt; 1:  # Enough data for logistic regression</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(1782,0,<span class='error_goto'>__PYX_ERR(0, 1782, __pyx_L1_error)</span>)
    __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_group);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1782, __pyx_L1_error)</span>
    __pyx_t_11 = (__pyx_t_12 &gt; 1);
    if (__pyx_t_11) {
/* … */
      goto __pyx_L13;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">1783</span>:             # Apply logistic regression within each stratum</pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1784</span>:             lr = LogisticRegression().fit(group[control_vars.columns], group['y_true'])</pre>
<pre class='cython code score-42 '>      <span class='trace'>__Pyx_TraceLine</span>(1784,0,<span class='error_goto'>__PYX_ERR(0, 1784, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_LogisticRegression);
      __pyx_t_1 = __pyx_v_LogisticRegression; __pyx_t_2 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1784, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_fit);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_control_vars, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_group, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_group, __pyx_n_u_y_true);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1784, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_13 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_13)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_13, __pyx_t_2, __pyx_t_4};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1784, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_lr, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1785</span>:             adjusted_pred = lr.predict(group[control_vars.columns])</pre>
<pre class='cython code score-23 '>      <span class='trace'>__Pyx_TraceLine</span>(1785,0,<span class='error_goto'>__PYX_ERR(0, 1785, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_lr, __pyx_n_s_predict);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1785, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_control_vars, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1785, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_group, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1785, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1785, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_adjusted_pred, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1786</span>:             adjusted_preds.extend(adjusted_pred)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(1786,0,<span class='error_goto'>__PYX_ERR(0, 1786, __pyx_L1_error)</span>)
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyList_Extend</span>(__pyx_v_adjusted_preds, __pyx_v_adjusted_pred);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 1786, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1787</span>:         else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1788</span>:             # Not enough data for logistic regression, use original predictions</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1789</span>:             adjusted_preds.extend(group['y_pred'])</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(1789,0,<span class='error_goto'>__PYX_ERR(0, 1789, __pyx_L1_error)</span>)
    /*else*/ {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_group, __pyx_n_u_y_pred);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1789, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyList_Extend</span>(__pyx_v_adjusted_preds, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((int)-1))) __PYX_ERR(0, 1789, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_L13:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1790</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1791</span>:     # Convert adjusted predictions back to original class labels</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1792</span>:     adjusted_y_pred = le_true.inverse_transform(adjusted_preds)</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(1792,0,<span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_le_true, __pyx_n_s_inverse_transform);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_adjusted_preds};
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 1792, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_adjusted_y_pred = __pyx_t_9;
  __pyx_t_9 = 0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1793</span>:     return np.array(y_true), adjusted_y_pred</pre>
<pre class='cython code score-30 '>  <span class='trace'>__Pyx_TraceLine</span>(1793,0,<span class='error_goto'>__PYX_ERR(0, 1793, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_true};
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 1793, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 1793, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_adjusted_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_adjusted_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_adjusted_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1793, __pyx_L1_error)</span>;
  __pyx_t_9 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1794</span>: </pre>
<pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1795</span>: def weighted_spearman_rank(</pre>
<pre class='cython code score-56 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_41weighted_spearman_rank(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_40weighted_spearman_rank, "\n    Compute Spearman's rank correlation coefficient with sample weights,\n    offering an extension to the standard Spearman's correlation by incorporating\n    sample weights into the rank calculation. This method is particularly useful\n    for datasets where some observations are more important than others.\n\n    Parameters\n    ----------\n    y_true : array-like\n        True target values.\n    y_pred : array-like\n        Predicted target values. Both `y_true` and `y_pred` must have the same length.\n    sample_weight : array-like\n        Weights for each sample, indicating the importance of each observation\n        in `y_true` and `y_pred`. Must be the same length as `y_true` and `y_pred`.\n    return_weighted_rank : bool, optional\n        If True, returns the weighted ranks of `y_true` and `y_pred` instead of\n        Spearman's rho. Default is False.\n    epsilon : float, optional\n        A small value added to the denominator to avoid division by zero in the\n        computation of Spearman's rho. Default is 1e-10.\n\n    Returns\n    -------\n    float or tuple of ndarray\n        If `return_weighted_rank` is False (default), returns Spearman's rho,\n        considering sample weights. If `return_weighted_rank` is True, returns\n        a tuple containing the weighted ranks of `y_true` and `y_pred`.\n\n    Notes\n    -----\n    The weighted Spearman's rank correlation coefficient is computed as:\n\n    .. math::\n        \\rho = 1 - \\frac{6 \\sum d_i^2 w_i}{\\sum w_i(n^3 - n)}\n\n    where :math:`d_i` is the difference between the weighted ranks of each observation,\n    :math:`w_i` is the weight of each observation, and :math:`n` is the number of observations.\n\n    This function calculates weighted ranks based on the sample weights, adjusting\n    the influence of each data point in the final correlation measure. It is useful\n    in scenarios where certain observations are deemed more critical than others.\n\n    Examples\n    --------\n    &gt;""&gt;&gt; from gofast.tools.mathex import weighted_spearman_corr\n    &gt;&gt;&gt; y_true = [1, 2, 3, 4, 5]\n    &gt;&gt;&gt; y_pred = [5, 6, 7, 8, 7]\n    &gt;&gt;&gt; sample_weight = [1, 1, 1, 1, 2]\n    &gt;&gt;&gt; weighted_spearman_corr(y_true, y_pred, sample_weight)\n    0.8208\n\n    References\n    ----------\n    .. [1] Myatt, G.J. (2007). Making Sense of Data, A Practical Guide to \n           Exploratory Data Analysis and Data Mining. John Wiley &amp; Sons.\n\n    See Also\n    --------\n    scipy.stats.spearmanr : Spearman rank-order correlation coefficient.\n    numpy.cov : Covariance matrix.\n    numpy.var : Variance.\n\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_41weighted_spearman_rank = {"weighted_spearman_rank", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_41weighted_spearman_rank, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_40weighted_spearman_rank};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_41weighted_spearman_rank(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_sample_weight = 0;
  PyObject *__pyx_v_return_weighted_rank = 0;
  PyObject *__pyx_v_epsilon = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("weighted_spearman_rank (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_sample_weight,&amp;__pyx_n_s_return_weighted_rank,&amp;__pyx_n_s_epsilon,0};
  PyObject* values[5] = {0,0,0,0,0};
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_6gofast_5tools_6mathex_40weighted_spearman_rank(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_sample_weight, PyObject *__pyx_v_return_weighted_rank, PyObject *__pyx_v_epsilon) {
  PyObject *__pyx_v_weighted_rank = 0;
  PyObject *__pyx_v_ranks_true = NULL;
  PyObject *__pyx_v_ranks_pred = NULL;
  PyObject *__pyx_v_cov = NULL;
  PyObject *__pyx_v_std_true = NULL;
  PyObject *__pyx_v_std_pred = NULL;
  PyObject *__pyx_v_rho = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__43)
  <span class='trace'>__Pyx_TraceCall</span>("weighted_spearman_rank", __pyx_f[0], 1795, 0, <span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sample_weight);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_epsilon);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.weighted_spearman_rank", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_weighted_rank);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ranks_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ranks_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cov);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_std_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_std_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rho);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sample_weight);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_epsilon);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__179 = <span class='py_c_api'>PyTuple_Pack</span>(13, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_sample_weight, __pyx_n_s_return_weighted_rank, __pyx_n_s_epsilon, __pyx_n_s_weighted_rank, __pyx_n_s_weighted_rank, __pyx_n_s_ranks_true, __pyx_n_s_ranks_pred, __pyx_n_s_cov, __pyx_n_s_std_true, __pyx_n_s_std_pred, __pyx_n_s_rho);<span class='error_goto'> if (unlikely(!__pyx_tuple__179)) __PYX_ERR(0, 1795, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__179);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__179);
  __pyx_codeobj__43 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__179, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_weighted_spearman_rank, 1795, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__43)) __PYX_ERR(0, 1795, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1795,0,<span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_41weighted_spearman_rank, 0, __pyx_n_s_weighted_spearman_rank, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__43));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1795, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__180);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_weighted_spearman_rank, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__180 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject *)Py_False), ((PyObject*)__pyx_float_1eneg_10));<span class='error_goto'> if (unlikely(!__pyx_tuple__180)) __PYX_ERR(0, 1795, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__180);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__180);
</pre><pre class="cython line score-0">&#xA0;<span class="">1796</span>:     y_true, y_pred, sample_weight,</pre>
<pre class="cython line score-83" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1797</span>:     return_weighted_rank=False,</pre>
<pre class='cython code score-83 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_10)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("weighted_spearman_rank", 0, 3, 5, 1); <span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_sample_weight)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("weighted_spearman_rank", 0, 3, 5, 2); <span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_weighted_rank);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_epsilon);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "weighted_spearman_rank") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_sample_weight = values[2];
    __pyx_v_return_weighted_rank = values[3];
    __pyx_v_epsilon = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("weighted_spearman_rank", 0, 3, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1795, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.weighted_spearman_rank", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_40weighted_spearman_rank(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_sample_weight, __pyx_v_return_weighted_rank, __pyx_v_epsilon);
</pre><pre class="cython line score-0">&#xA0;<span class="">1798</span>:     epsilon=1e-10</pre>
<pre class="cython line score-0">&#xA0;<span class="">1799</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">1800</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1801</span>:     Compute Spearman's rank correlation coefficient with sample weights,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1802</span>:     offering an extension to the standard Spearman's correlation by incorporating</pre>
<pre class="cython line score-0">&#xA0;<span class="">1803</span>:     sample weights into the rank calculation. This method is particularly useful</pre>
<pre class="cython line score-0">&#xA0;<span class="">1804</span>:     for datasets where some observations are more important than others.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1805</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1806</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1807</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1808</span>:     y_true : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1809</span>:         True target values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1810</span>:     y_pred : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1811</span>:         Predicted target values. Both `y_true` and `y_pred` must have the same length.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1812</span>:     sample_weight : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1813</span>:         Weights for each sample, indicating the importance of each observation</pre>
<pre class="cython line score-0">&#xA0;<span class="">1814</span>:         in `y_true` and `y_pred`. Must be the same length as `y_true` and `y_pred`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1815</span>:     return_weighted_rank : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1816</span>:         If True, returns the weighted ranks of `y_true` and `y_pred` instead of</pre>
<pre class="cython line score-0">&#xA0;<span class="">1817</span>:         Spearman's rho. Default is False.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1818</span>:     epsilon : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1819</span>:         A small value added to the denominator to avoid division by zero in the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1820</span>:         computation of Spearman's rho. Default is 1e-10.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1821</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1822</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1823</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1824</span>:     float or tuple of ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">1825</span>:         If `return_weighted_rank` is False (default), returns Spearman's rho,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1826</span>:         considering sample weights. If `return_weighted_rank` is True, returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1827</span>:         a tuple containing the weighted ranks of `y_true` and `y_pred`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1828</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1829</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">1830</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">1831</span>:     The weighted Spearman's rank correlation coefficient is computed as:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1832</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1833</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">1834</span>:         \\rho = 1 - \\frac{6 \\sum d_i^2 w_i}{\\sum w_i(n^3 - n)}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1835</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1836</span>:     where :math:`d_i` is the difference between the weighted ranks of each observation,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1837</span>:     :math:`w_i` is the weight of each observation, and :math:`n` is the number of observations.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1838</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1839</span>:     This function calculates weighted ranks based on the sample weights, adjusting</pre>
<pre class="cython line score-0">&#xA0;<span class="">1840</span>:     the influence of each data point in the final correlation measure. It is useful</pre>
<pre class="cython line score-0">&#xA0;<span class="">1841</span>:     in scenarios where certain observations are deemed more critical than others.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1842</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1843</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1844</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1845</span>:     &gt;&gt;&gt; from gofast.tools.mathex import weighted_spearman_corr</pre>
<pre class="cython line score-0">&#xA0;<span class="">1846</span>:     &gt;&gt;&gt; y_true = [1, 2, 3, 4, 5]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1847</span>:     &gt;&gt;&gt; y_pred = [5, 6, 7, 8, 7]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1848</span>:     &gt;&gt;&gt; sample_weight = [1, 1, 1, 1, 2]</pre>
<pre class="cython line score-0">&#xA0;<span class="">1849</span>:     &gt;&gt;&gt; weighted_spearman_corr(y_true, y_pred, sample_weight)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1850</span>:     0.8208</pre>
<pre class="cython line score-0">&#xA0;<span class="">1851</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1852</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">1853</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1854</span>:     .. [1] Myatt, G.J. (2007). Making Sense of Data, A Practical Guide to</pre>
<pre class="cython line score-0">&#xA0;<span class="">1855</span>:            Exploratory Data Analysis and Data Mining. John Wiley &amp; Sons.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1856</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1857</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">1858</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1859</span>:     scipy.stats.spearmanr : Spearman rank-order correlation coefficient.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1860</span>:     numpy.cov : Covariance matrix.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1861</span>:     numpy.var : Variance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1862</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1863</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1864</span>:     # Check and convert inputs to numpy arrays</pre>
<pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1865</span>:     y_true, y_pred, sample_weight = map(np.asarray, [y_true, y_pred, sample_weight])</pre>
<pre class='cython code score-84 '>  <span class='trace'>__Pyx_TraceLine</span>(1865,0,<span class='error_goto'>__PYX_ERR(0, 1865, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_true);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_y_true)) <span class='error_goto'>__PYX_ERR(0, 1865, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1865, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sample_weight);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sample_weight);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_v_sample_weight)) <span class='error_goto'>__PYX_ERR(0, 1865, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1865, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1865, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_map, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 3)) {
      if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 1865, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1865, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);
    index = 0; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    index = 2; __pyx_t_4 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1865, __pyx_L1_error)</span>
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 1865, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_2);
  __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sample_weight, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1866</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1867</span>:     if str(epsilon).lower() =='auto':</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(1867,0,<span class='error_goto'>__PYX_ERR(0, 1867, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1867, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1867, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1867, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_1, __pyx_n_u_auto, Py_EQ)); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1867, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_8) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1868</span>:         epsilon = determine_epsilon(y_pred, scale_factor= 1e-10)</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(1868,0,<span class='error_goto'>__PYX_ERR(0, 1868, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_determine_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 1868, __pyx_L1_error)</span>;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_scale_factor, __pyx_float_1eneg_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1868, __pyx_L1_error)</span>
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1868, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_epsilon, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1869</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1870</span>:     # Compute weighted ranks</pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1871</span>:     def weighted_rank(data, weights):</pre>
<pre class='cython code score-67 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_22weighted_spearman_rank_1weighted_rank(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_22weighted_spearman_rank_1weighted_rank = {"weighted_rank", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_22weighted_spearman_rank_1weighted_rank, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_22weighted_spearman_rank_1weighted_rank(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_weights = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("weighted_rank (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_weights,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_weights)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("weighted_rank", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "weighted_rank") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_data = values[0];
    __pyx_v_weights = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("weighted_rank", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.weighted_spearman_rank.weighted_rank", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_22weighted_spearman_rank_weighted_rank(__pyx_self, __pyx_v_data, __pyx_v_weights);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_22weighted_spearman_rank_weighted_rank(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_weights) {
  PyObject *__pyx_v_order = NULL;
  PyObject *__pyx_v_ranks = NULL;
  PyObject *__pyx_v_cum_weights = NULL;
  PyObject *__pyx_v_total_weight = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("weighted_rank", __pyx_f[0], 1871, 0, <span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.weighted_spearman_rank.weighted_rank", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_order);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ranks);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cum_weights);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total_weight);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__44 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_data, __pyx_n_s_weights, __pyx_n_s_order, __pyx_n_s_ranks, __pyx_n_s_cum_weights, __pyx_n_s_total_weight);<span class='error_goto'> if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 1871, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__44);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__44);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1871,0,<span class='error_goto'>__PYX_ERR(0, 1871, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_22weighted_spearman_rank_1weighted_rank, 0, __pyx_n_s_weighted_spearman_rank_locals_we, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__45));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1871, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_weighted_rank = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_codeobj__45 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__44, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_weighted_rank, 1871, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__45)) __PYX_ERR(0, 1871, __pyx_L1_error)</span>
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1872</span>:         order = np.argsort(data)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(1872,0,<span class='error_goto'>__PYX_ERR(0, 1872, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1872, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_argsort);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1872, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_data};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1872, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_order = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1873</span>:         ranks = np.empty_like(order, dtype=float)</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(1873,0,<span class='error_goto'>__PYX_ERR(0, 1873, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty_like);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_order);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_order);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_order)) <span class='error_goto'>__PYX_ERR(0, 1873, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1873, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1873, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_ranks = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1874</span>:         cum_weights = np.cumsum(weights[order])</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(1874,0,<span class='error_goto'>__PYX_ERR(0, 1874, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1874, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1874, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_weights, __pyx_v_order);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1874, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_2};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 1874, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_v_cum_weights = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1875</span>:         total_weight = cum_weights[-1]</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1875,0,<span class='error_goto'>__PYX_ERR(0, 1875, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_cum_weights, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1875, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_v_total_weight = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1876</span>:         ranks[order] = cum_weights / total_weight * len(data)</pre>
<pre class='cython code score-25 '>  <span class='trace'>__Pyx_TraceLine</span>(1876,0,<span class='error_goto'>__PYX_ERR(0, 1876, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_cum_weights, __pyx_v_total_weight);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1876, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_ranks, __pyx_v_order, __pyx_t_2) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1876, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1877</span>:         return ranks</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1877,0,<span class='error_goto'>__PYX_ERR(0, 1877, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ranks);
  __pyx_r = __pyx_v_ranks;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1878</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1879</span>:     ranks_true = weighted_rank(y_true, sample_weight)</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1879,0,<span class='error_goto'>__PYX_ERR(0, 1879, __pyx_L1_error)</span>)
  __pyx_t_3 = __pyx_pf_6gofast_5tools_6mathex_22weighted_spearman_rank_weighted_rank(__pyx_v_weighted_rank, __pyx_v_y_true, __pyx_v_sample_weight);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1879, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_ranks_true = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1880</span>:     ranks_pred = weighted_rank(y_pred, sample_weight)</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1880,0,<span class='error_goto'>__PYX_ERR(0, 1880, __pyx_L1_error)</span>)
  __pyx_t_3 = __pyx_pf_6gofast_5tools_6mathex_22weighted_spearman_rank_weighted_rank(__pyx_v_weighted_rank, __pyx_v_y_pred, __pyx_v_sample_weight);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1880, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_ranks_pred = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1881</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1882</span>:     if return_weighted_rank:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1882,0,<span class='error_goto'>__PYX_ERR(0, 1882, __pyx_L1_error)</span>)
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_weighted_rank); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1882, __pyx_L1_error)</span>
  if (__pyx_t_8) {
/* … */
  }
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1883</span>:         return ranks_true, ranks_pred</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(1883,0,<span class='error_goto'>__PYX_ERR(0, 1883, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1883, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ranks_true);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ranks_true);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_ranks_true)) <span class='error_goto'>__PYX_ERR(0, 1883, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ranks_pred);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ranks_pred);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_ranks_pred)) <span class='error_goto'>__PYX_ERR(0, 1883, __pyx_L1_error)</span>;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1884</span>:     # Compute covariance between the weighted ranks</pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1885</span>:     cov = np.cov(ranks_true, ranks_pred, aweights=sample_weight)[0, 1]</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(1885,0,<span class='error_goto'>__PYX_ERR(0, 1885, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cov);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ranks_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ranks_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_ranks_true)) <span class='error_goto'>__PYX_ERR(0, 1885, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ranks_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ranks_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_ranks_pred)) <span class='error_goto'>__PYX_ERR(0, 1885, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_aweights, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1885, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_tuple__13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1885, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_cov = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1886</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1887</span>:     # Compute standard deviations of the weighted ranks</pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1888</span>:     std_true = np.sqrt(np.var(ranks_true, ddof=1, aweights=sample_weight))</pre>
<pre class='cython code score-50 '>  <span class='trace'>__Pyx_TraceLine</span>(1888,0,<span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_var);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ranks_true);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ranks_true);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_ranks_true)) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_ddof, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_aweights, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1888, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_9};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1888, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_std_true = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1889</span>:     std_pred = np.sqrt(np.var(ranks_pred, ddof=1, aweights=sample_weight))</pre>
<pre class='cython code score-50 '>  <span class='trace'>__Pyx_TraceLine</span>(1889,0,<span class='error_goto'>__PYX_ERR(0, 1889, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_var);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ranks_pred);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ranks_pred);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_ranks_pred)) <span class='error_goto'>__PYX_ERR(0, 1889, __pyx_L1_error)</span>;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_ddof, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1889, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_aweights, __pyx_v_sample_weight) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1889, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_4};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1889, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  __pyx_v_std_pred = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1890</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1891</span>:     # Compute Spearman's rho</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1892</span>:     rho = cov / ( (std_true * std_pred) + epsilon)</pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(1892,0,<span class='error_goto'>__PYX_ERR(0, 1892, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_std_true, __pyx_v_std_pred);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_cov, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_rho = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1893</span>:     return rho</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1893,0,<span class='error_goto'>__PYX_ERR(0, 1893, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_rho);
  __pyx_r = __pyx_v_rho;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1894</span>: </pre>
<pre class="cython line score-104" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1895</span>: def calculate_optimal_bins(y_pred, method='freedman_diaconis', data_range=None):</pre>
<pre class='cython code score-104 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_43calculate_optimal_bins(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_42calculate_optimal_bins, "\n    Calculate the optimal number of bins for histogramming a given set of \n    predictions, utilizing various heuristics. This function supports the \n    Freedman-Diaconis rule, Sturges' formula, and the Square-root choice, \n    allowing users to select the most appropriate method based on their data \n    distribution and size.\n\n    Parameters\n    ----------\n    y_pred : array-like\n        Predicted probabilities for the positive class. This array should be \n        one-dimensional.\n    method : str, optional\n        The binning method to use. Options include:\n        - 'freedman_diaconis': Uses the Freedman-Diaconis rule, which is \n          particularly useful for data with skewed distributions.\n          .. math:: \text{bin width} = 2 \\cdot \014rac{IQR}{\\sqrt[3]{n}}\n        - 'sturges': Uses Sturges' formula, ideal for normal distributions \n          but may be suboptimal for large datasets or non-normal distributions.\n          .. math:: \text{bins} = \\lceil \\log_2(n) + 1 \rceil\n        - 'sqrt': Employs the Square-root choice, a simple rule that works well \n          for small datasets.\n          .. math:: \text{bins} = \\lceil \\sqrt{n} \rceil\n        Default is 'freedman_diaconis'.\n    data_range : tuple, optional\n        A tuple specifying the range of the data as (min, max). If None, the \n        minimum and maximum values in `y_pred` are used. Default is None.\n\n    Returns\n    -------\n    int\n        The calculated optimal number of bins.\n\n    Raises\n    ------\n    ValueError\n        If an invalid `method` is specified.\n\n    Examples\n    --------\n    Calculate the optimal number of bins for a dataset of random predictions \n    using different methods:\n    \n    &gt;&gt;&gt; from gofast.tools.mathex import calculate_optimal_bins\n    &gt;&gt;&gt; y_pred = np.random.rand(100)\n    &gt;&gt;&gt; print(calculate_optimal_bins(y_pred, method='freedman_diaconis'))\n    9\n    &gt;&gt;&gt; print(calculate_optimal_bins(y_pred, method='sturges'))\n    7""\n    &gt;&gt;&gt; print(calculate_optimal_bins(y_pred, method='sqrt'))\n    10\n\n    References\n    ----------\n    - Freedman, D. and Diaconis, P. (1981). On the histogram as a density estimator:\n      L2 theory. Zeitschrift f\303\274r Wahrscheinlichkeitstheorie und verwandte Gebiete, \n      57(4), 453-476.\n    - Sturges, H. A. (1926). The choice of a class interval. Journal of the American \n      Statistical Association, 21(153), 65-66.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_43calculate_optimal_bins = {"calculate_optimal_bins", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_43calculate_optimal_bins, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_42calculate_optimal_bins};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_43calculate_optimal_bins(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_method = 0;
  PyObject *__pyx_v_data_range = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_optimal_bins (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_method,&amp;__pyx_n_s_data_range,0};
  PyObject* values[3] = {0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_freedman_diaconis)));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1895, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_method);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1895, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data_range);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1895, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate_optimal_bins") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1895, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y_pred = values[0];
    __pyx_v_method = values[1];
    __pyx_v_data_range = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_optimal_bins", 0, 1, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1895, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_optimal_bins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_42calculate_optimal_bins(__pyx_self, __pyx_v_y_pred, __pyx_v_method, __pyx_v_data_range);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
static PyObject *__pyx_gb_6gofast_5tools_6mathex_22calculate_optimal_bins_2generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value); /* proto */
/* … */
static PyObject *__pyx_pf_6gofast_5tools_6mathex_42calculate_optimal_bins(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_method, PyObject *__pyx_v_data_range) {
  PyObject *__pyx_v_data_min = NULL;
  PyObject *__pyx_v_data_max = NULL;
  PyObject *__pyx_v_n = NULL;
  PyObject *__pyx_v_iqr = NULL;
  PyObject *__pyx_v_bin_width = NULL;
  PyObject *__pyx_v_optimal_bins = NULL;
  PyObject *__pyx_gb_6gofast_5tools_6mathex_22calculate_optimal_bins_2generator = 0;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__46)
  <span class='trace'>__Pyx_TraceCall</span>("calculate_optimal_bins", __pyx_f[0], 1895, 0, <span class='error_goto'>__PYX_ERR(0, 1895, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_optimal_bins", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data_min);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data_max);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_iqr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bin_width);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_optimal_bins);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_gb_6gofast_5tools_6mathex_22calculate_optimal_bins_2generator);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_method);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__181 = <span class='py_c_api'>PyTuple_Pack</span>(11, __pyx_n_s_y_pred, __pyx_n_s_method, __pyx_n_s_data_range, __pyx_n_s_data_min, __pyx_n_s_data_max, __pyx_n_s_n, __pyx_n_s_iqr, __pyx_n_s_bin_width, __pyx_n_s_optimal_bins, __pyx_n_s_genexpr, __pyx_n_s_genexpr);<span class='error_goto'> if (unlikely(!__pyx_tuple__181)) __PYX_ERR(0, 1895, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__181);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__181);
  __pyx_codeobj__46 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__181, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_calculate_optimal_bins, 1895, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 1895, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1895,0,<span class='error_goto'>__PYX_ERR(0, 1895, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_43calculate_optimal_bins, 0, __pyx_n_s_calculate_optimal_bins, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__46));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1895, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__182);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calculate_optimal_bins, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1895, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__182 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject*)__pyx_n_u_freedman_diaconis), Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__182)) __PYX_ERR(0, 1895, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__182);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__182);
</pre><pre class="cython line score-0">&#xA0;<span class="">1896</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">1897</span>:     Calculate the optimal number of bins for histogramming a given set of</pre>
<pre class="cython line score-0">&#xA0;<span class="">1898</span>:     predictions, utilizing various heuristics. This function supports the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1899</span>:     Freedman-Diaconis rule, Sturges' formula, and the Square-root choice,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1900</span>:     allowing users to select the most appropriate method based on their data</pre>
<pre class="cython line score-0">&#xA0;<span class="">1901</span>:     distribution and size.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1902</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1903</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">1904</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1905</span>:     y_pred : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">1906</span>:         Predicted probabilities for the positive class. This array should be</pre>
<pre class="cython line score-0">&#xA0;<span class="">1907</span>:         one-dimensional.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1908</span>:     method : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1909</span>:         The binning method to use. Options include:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1910</span>:         - 'freedman_diaconis': Uses the Freedman-Diaconis rule, which is</pre>
<pre class="cython line score-0">&#xA0;<span class="">1911</span>:           particularly useful for data with skewed distributions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1912</span>:           .. math:: \text{bin width} = 2 \cdot \frac{IQR}{\sqrt[3]{n}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">1913</span>:         - 'sturges': Uses Sturges' formula, ideal for normal distributions</pre>
<pre class="cython line score-0">&#xA0;<span class="">1914</span>:           but may be suboptimal for large datasets or non-normal distributions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1915</span>:           .. math:: \text{bins} = \lceil \log_2(n) + 1 \rceil</pre>
<pre class="cython line score-0">&#xA0;<span class="">1916</span>:         - 'sqrt': Employs the Square-root choice, a simple rule that works well</pre>
<pre class="cython line score-0">&#xA0;<span class="">1917</span>:           for small datasets.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1918</span>:           .. math:: \text{bins} = \lceil \sqrt{n} \rceil</pre>
<pre class="cython line score-0">&#xA0;<span class="">1919</span>:         Default is 'freedman_diaconis'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1920</span>:     data_range : tuple, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">1921</span>:         A tuple specifying the range of the data as (min, max). If None, the</pre>
<pre class="cython line score-0">&#xA0;<span class="">1922</span>:         minimum and maximum values in `y_pred` are used. Default is None.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1923</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1924</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">1925</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1926</span>:     int</pre>
<pre class="cython line score-0">&#xA0;<span class="">1927</span>:         The calculated optimal number of bins.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1928</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1929</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">1930</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1931</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">1932</span>:         If an invalid `method` is specified.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1933</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1934</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">1935</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1936</span>:     Calculate the optimal number of bins for a dataset of random predictions</pre>
<pre class="cython line score-0">&#xA0;<span class="">1937</span>:     using different methods:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1938</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1939</span>:     &gt;&gt;&gt; from gofast.tools.mathex import calculate_optimal_bins</pre>
<pre class="cython line score-0">&#xA0;<span class="">1940</span>:     &gt;&gt;&gt; y_pred = np.random.rand(100)</pre>
<pre class="cython line score-0">&#xA0;<span class="">1941</span>:     &gt;&gt;&gt; print(calculate_optimal_bins(y_pred, method='freedman_diaconis'))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1942</span>:     9</pre>
<pre class="cython line score-0">&#xA0;<span class="">1943</span>:     &gt;&gt;&gt; print(calculate_optimal_bins(y_pred, method='sturges'))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1944</span>:     7</pre>
<pre class="cython line score-0">&#xA0;<span class="">1945</span>:     &gt;&gt;&gt; print(calculate_optimal_bins(y_pred, method='sqrt'))</pre>
<pre class="cython line score-0">&#xA0;<span class="">1946</span>:     10</pre>
<pre class="cython line score-0">&#xA0;<span class="">1947</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">1948</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">1949</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">1950</span>:     - Freedman, D. and Diaconis, P. (1981). On the histogram as a density estimator:</pre>
<pre class="cython line score-0">&#xA0;<span class="">1951</span>:       L2 theory. Zeitschrift für Wahrscheinlichkeitstheorie und verwandte Gebiete,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1952</span>:       57(4), 453-476.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1953</span>:     - Sturges, H. A. (1926). The choice of a class interval. Journal of the American</pre>
<pre class="cython line score-0">&#xA0;<span class="">1954</span>:       Statistical Association, 21(153), 65-66.</pre>
<pre class="cython line score-0">&#xA0;<span class="">1955</span>:     """</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1956</span>:     y_pred = np.asarray(y_pred)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(1956,0,<span class='error_goto'>__PYX_ERR(0, 1956, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1956, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1956, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_y_pred};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1956, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1957</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1958</span>:     if data_range is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(1958,0,<span class='error_goto'>__PYX_ERR(0, 1958, __pyx_L1_error)</span>)
  __pyx_t_5 = (__pyx_v_data_range != Py_None);
  if (__pyx_t_5) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1959</span>:         if not isinstance(data_range, tuple) or len(data_range) != 2:</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(1959,0,<span class='error_goto'>__PYX_ERR(0, 1959, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='py_c_api'>PyTuple_Check</span>(__pyx_v_data_range); 
    __pyx_t_7 = (!__pyx_t_6);
    if (!__pyx_t_7) {
    } else {
      __pyx_t_5 = __pyx_t_7;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_8 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data_range);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1959, __pyx_L1_error)</span>
    __pyx_t_7 = (__pyx_t_8 != 2);
    __pyx_t_5 = __pyx_t_7;
    __pyx_L5_bool_binop_done:;
    if (unlikely(__pyx_t_5)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1960</span>:             raise ValueError(</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(1960,0,<span class='error_goto'>__PYX_ERR(0, 1960, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__47, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1960, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 1960, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__47 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_data_range_must_be_a_tuple_of_tw);<span class='error_goto'> if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1960, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__47);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__47);
</pre><pre class="cython line score-0">&#xA0;<span class="">1961</span>:                 "data_range must be a tuple of two numeric values (min, max).")</pre>
<pre class="cython line score-126" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1962</span>:         if any(not np.isscalar(v) or not np.isreal(v) for v in data_range):</pre>
<pre class='cython code score-126 '>static PyObject *__pyx_pf_6gofast_5tools_6mathex_22calculate_optimal_bins_genexpr(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_genexpr_arg_0) {
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct__genexpr *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct__genexpr *)__pyx_tp_new_6gofast_5tools_6mathex___pyx_scope_struct__genexpr(__pyx_ptype_6gofast_5tools_6mathex___pyx_scope_struct__genexpr, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct__genexpr *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_genexpr_arg_0 = __pyx_genexpr_arg_0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0);
  {
    __pyx_CoroutineObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_coroutine_body_t) __pyx_gb_6gofast_5tools_6mathex_22calculate_optimal_bins_2generator, NULL, (PyObject *) __pyx_cur_scope, __pyx_n_s_genexpr, __pyx_n_s_calculate_optimal_bins_locals_ge, __pyx_n_s_gofast_tools_mathex);<span class='error_goto'> if (unlikely(!gen)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return (PyObject *) gen;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_optimal_bins.genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_gb_6gofast_5tools_6mathex_22calculate_optimal_bins_2generator(__pyx_CoroutineObject *__pyx_generator, CYTHON_UNUSED PyThreadState *__pyx_tstate, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("genexpr", 0);
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value)) <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_genexpr_arg_0)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>(".0"); <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span> }
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0)) {
    __pyx_t_1 = __pyx_cur_scope-&gt;__pyx_genexpr_arg_0; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_3 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_cur_scope-&gt;__pyx_genexpr_arg_0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_3)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_3(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_v);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_v, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_isscalar);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    __pyx_t_8 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        __pyx_t_8 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_cur_scope-&gt;__pyx_v_v};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_10 = (!__pyx_t_9);
    if (!__pyx_t_10) {
    } else {
      __pyx_t_5 = __pyx_t_10;
      goto __pyx_L7_bool_binop_done;
    }
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_isreal);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = NULL;
    __pyx_t_8 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_8 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_cur_scope-&gt;__pyx_v_v};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = (!__pyx_t_10);
    __pyx_t_5 = __pyx_t_9;
    __pyx_L7_bool_binop_done:;
    if (__pyx_t_5) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
      __pyx_r = Py_True;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
    __pyx_r = Py_False;
    goto __pyx_L0;
  }
  CYTHON_MAYBE_UNUSED_VAR(__pyx_cur_scope);

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_Generator_Replace_StopIteration</span>(0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("genexpr", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  #if !CYTHON_USE_EXC_INFO_STACK
  <span class='pyx_c_api'>__Pyx_Coroutine_ResetAndClearException</span>(__pyx_generator);
  #endif
  __pyx_generator-&gt;resume_label = -1;
  <span class='pyx_c_api'>__Pyx_Coroutine_clear</span>((PyObject*)__pyx_generator);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(1962,0,<span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>)
    __pyx_t_1 = __pyx_pf_6gofast_5tools_6mathex_22calculate_optimal_bins_genexpr(NULL, __pyx_v_data_range);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Generator_Next</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1962, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(__pyx_t_5)) {
/* … */
    }
/* … */
struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct__genexpr {
  PyObject_HEAD
  PyObject *__pyx_genexpr_arg_0;
  PyObject *__pyx_v_v;
};

</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1963</span>:             raise ValueError("data_range must contain numeric values.")</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(1963,0,<span class='error_goto'>__PYX_ERR(0, 1963, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__48, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1963, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 1963, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__48 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_data_range_must_contain_numeric);<span class='error_goto'> if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 1963, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__48);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__48);
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1964</span>:         data_min, data_max = data_range</pre>
<pre class='cython code score-44 '>    <span class='trace'>__Pyx_TraceLine</span>(1964,0,<span class='error_goto'>__PYX_ERR(0, 1964, __pyx_L1_error)</span>)
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_data_range))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_data_range))) {
      PyObject* sequence = __pyx_v_data_range;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 1964, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1964, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1964, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      #endif
    } else {
      Py_ssize_t index = -1;
      __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_data_range);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1964, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);
      index = 0; __pyx_t_3 = __pyx_t_9(__pyx_t_2); if (unlikely(!__pyx_t_3)) goto __pyx_L8_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      index = 1; __pyx_t_1 = __pyx_t_9(__pyx_t_2); if (unlikely(!__pyx_t_1)) goto __pyx_L8_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_2), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1964, __pyx_L1_error)</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L9_unpacking_done;
      __pyx_L8_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 1964, __pyx_L1_error)</span>
      __pyx_L9_unpacking_done:;
    }
    __pyx_v_data_min = __pyx_t_3;
    __pyx_t_3 = 0;
    __pyx_v_data_max = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1965</span>:     else:</pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1966</span>:         data_min, data_max = np.min(y_pred), np.max(y_pred)</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(1966,0,<span class='error_goto'>__PYX_ERR(0, 1966, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1966, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1966, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_pred};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 1966, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1966, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1966, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y_pred};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1966, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    __pyx_v_data_min = __pyx_t_1;
    __pyx_t_1 = 0;
    __pyx_v_data_max = __pyx_t_2;
    __pyx_t_2 = 0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">1967</span>:     # Handle case where data is uniform</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1968</span>:     if data_min == data_max:</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(1968,0,<span class='error_goto'>__PYX_ERR(0, 1968, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_data_min, __pyx_v_data_max, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1968, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1968, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1969</span>:         return 1</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1969,0,<span class='error_goto'>__PYX_ERR(0, 1969, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    __pyx_r = __pyx_int_1;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1970</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1971</span>:     n = len(y_pred)</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(1971,0,<span class='error_goto'>__PYX_ERR(0, 1971, __pyx_L1_error)</span>)
  __pyx_t_8 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_y_pred);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1971, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1971, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_v_n = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1972</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1973</span>:     method = normalize_string(</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(1973,0,<span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_normalize_string);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1973, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1974,0,<span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1973, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_method);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_method)) <span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1973,0,<span class='error_goto'>__PYX_ERR(0, 1973, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1973, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_method, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1974</span>:         method, target_strs=["freedman_diaconis","sturges","sqrt"],</pre>
<pre class='cython code score-22 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1974, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1974, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_freedman_diaconis);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_freedman_diaconis);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_u_freedman_diaconis)) <span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_sturges);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_sturges);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_u_sturges)) <span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_sqrt);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_sqrt);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_u_sqrt)) <span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_target_strs, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1975</span>:         return_target_only= True, match_method="contains", raise_exception=True,</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(1975,0,<span class='error_goto'>__PYX_ERR(0, 1975, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_return_target_only, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_match_method, __pyx_n_u_contains) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_raise_exception, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_error_msg, __pyx_kp_u_Invalid_method_specified_Choose) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1974, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">1976</span>:         error_msg=("Invalid method specified. Choose among"</pre>
<pre class="cython line score-0">&#xA0;<span class="">1977</span>:                    " 'freedman_diaconis', 'sturges', 'sqrt'.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">1978</span>:         )</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1979</span>:     if method == 'freedman_diaconis':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1979,0,<span class='error_goto'>__PYX_ERR(0, 1979, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_freedman_diaconis, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1979, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1980</span>:         iqr = np.subtract(*np.percentile(y_pred, [75, 25]))  # Interquartile range</pre>
<pre class='cython code score-43 '>    <span class='trace'>__Pyx_TraceLine</span>(1980,0,<span class='error_goto'>__PYX_ERR(0, 1980, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1980, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_subtract);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1980, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1980, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_percentile);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1980, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1980, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_75);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_75);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_75)) <span class='error_goto'>__PYX_ERR(0, 1980, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_25);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_25);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_25)) <span class='error_goto'>__PYX_ERR(0, 1980, __pyx_L1_error)</span>;
    __pyx_t_11 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_11, __pyx_v_y_pred, __pyx_t_1};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1980, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1980, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1980, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_iqr = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1981</span>:         if iqr == 0:  # Handle case where IQR is 0</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(1981,0,<span class='error_goto'>__PYX_ERR(0, 1981, __pyx_L1_error)</span>)
    __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_v_iqr, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1981, __pyx_L1_error)</span>
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1982</span>:             return max(1, n // 2)  # Fallback to avoid division by zero</pre>
<pre class='cython code score-20 '>      <span class='trace'>__Pyx_TraceLine</span>(1982,0,<span class='error_goto'>__PYX_ERR(0, 1982, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_FloorDivideObjC</span>(__pyx_v_n, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1982, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_12 = 1;
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1982, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_10, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1982, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1982, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (__pyx_t_5) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        __pyx_t_2 = __pyx_t_3;
      } else {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1982, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_2 = __pyx_t_1;
        __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      __pyx_r = __pyx_t_2;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1983</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1984</span>:         bin_width = 2 * iqr * (n ** (-1/3))</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(1984,0,<span class='error_goto'>__PYX_ERR(0, 1984, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyCObj</span>(__pyx_int_2, __pyx_v_iqr, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1984, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((-1.0 / 3.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1984, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_n, __pyx_t_3, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1984, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1984, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_bin_width = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1985</span>:         optimal_bins = int(np.ceil((data_max - data_min) / bin_width))</pre>
<pre class='cython code score-31 '>    <span class='trace'>__Pyx_TraceLine</span>(1985,0,<span class='error_goto'>__PYX_ERR(0, 1985, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1985, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ceil);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1985, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_data_max, __pyx_v_data_min);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1985, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_v_bin_width);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1985, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_10};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1985, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1985, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_optimal_bins = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1986</span>:     elif method == 'sturges':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1986,0,<span class='error_goto'>__PYX_ERR(0, 1986, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_sturges, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1986, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
    goto __pyx_L11;
  }
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1987</span>:         optimal_bins = int(np.ceil(np.log2(n) + 1))</pre>
<pre class='cython code score-45 '>    <span class='trace'>__Pyx_TraceLine</span>(1987,0,<span class='error_goto'>__PYX_ERR(0, 1987, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ceil);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_log2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_n};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 1987, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_11};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1987, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_optimal_bins = __pyx_t_10;
    __pyx_t_10 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1988</span>:     elif method == 'sqrt':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(1988,0,<span class='error_goto'>__PYX_ERR(0, 1988, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_sqrt, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1988, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
  }
  __pyx_L11:;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1989</span>:         optimal_bins = int(np.ceil(np.sqrt(n)))</pre>
<pre class='cython code score-42 '>    <span class='trace'>__Pyx_TraceLine</span>(1989,0,<span class='error_goto'>__PYX_ERR(0, 1989, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1989, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_ceil);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1989, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1989, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1989, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_n};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 1989, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_2};
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 1989, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 1989, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_v_optimal_bins = __pyx_t_11;
    __pyx_t_11 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1990</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1991</span>:     return max(1, optimal_bins)  # Ensure at least one bin</pre>
<pre class='cython code score-21 '>  <span class='trace'>__Pyx_TraceLine</span>(1991,0,<span class='error_goto'>__PYX_ERR(0, 1991, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_optimal_bins)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("optimal_bins"); <span class='error_goto'>__PYX_ERR(0, 1991, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_optimal_bins);
  __pyx_t_11 = __pyx_v_optimal_bins;
  __pyx_t_12 = 1;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1991, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_11, __pyx_t_2, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1991, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 1991, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
    __pyx_t_10 = __pyx_t_11;
  } else {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1991, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_10 = __pyx_t_1;
    __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
  __pyx_r = __pyx_t_10;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">1992</span>: </pre>
<pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">1993</span>: def calculate_binary_iv(</pre>
<pre class='cython code score-75 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_45calculate_binary_iv(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_44calculate_binary_iv, "\n    Calculate the Information Value (IV) for binary classification problems\n    using a base or binning approach. This function provides flexibility in\n    IV calculation by allowing for simple percentage-based calculations or\n    detailed binning techniques to understand the predictive power across\n    the distribution of predicted probabilities.\n\n    Parameters\n    ----------\n    y_true : array-like\n        True binary labels.\n    y_pred : array-like\n        Predicted probabilities for the positive class.\n    epsilon : float or 'auto', optional\n        A small epsilon value added to probabilities to prevent division\n        by zero in logarithmic calculations. If 'auto', dynamically determines\n        an appropriate epsilon based on `y_pred`. Default is 1e-15.\n    method : str, optional\n        The method for calculating IV. Options are 'base' for a direct approach\n        using the overall percentage of events, and 'binning' for a detailed\n        analysis using bins of predicted probabilities. Default is 'base'.\n    bins : int or 'auto', optional\n        The number of bins to use for the 'binning' method. If 'auto', the\n        optimal number of bins is calculated based on `bins_method`.\n        Default is 'auto'.\n    bins_method : str, optional\n        Method to use for calculating the optimal number of bins when\n        `bins` is 'auto'. Options include 'freedman_diaconis', 'sturges', \n        and 'sqrt'. Default is 'freedman_diaconis'.\n    data_range : tuple, optional\n        A tuple specifying the range of the data as (min, max) for bin\n        calculation. If None, the range is derived from `y_pred`. Default is None.\n\n    Returns\n    -------\n    float\n        The calculated Information Value (IV).\n\n    Raises\n    ------\n    ValueError\n        If an invalid method is specified.\n\n    Examples\n    --------\n    &gt;&gt;&gt; import numpy as np \n    &gt;&gt;&gt; from gofast.tools.mathex import calculate_binary_iv\n    &gt;&gt;&gt; y_true = np.""array([0, 1, 0, 1, 1])\n    &gt;&gt;&gt; y_pred = np.array([0.1, 0.8, 0.2, 0.7, 0.9])\n    &gt;&gt;&gt; print(calculate_binary_iv(y_true, y_pred, method='base'))\n    1.6094379124341003\n\n    &gt;&gt;&gt; print(calculate_binary_iv(y_true, y_pred, method='binning', bins=3,\n    ...                           bins_method='sturges'))\n    0.6931471805599453\n\n    Notes\n    -----\n    The Information Value (IV) quantifies the predictive power of a feature or\n    model in binary classification, illustrating its ability to distinguish\n    between classes.\n\n    - The 'base' method calculates IV using the overall percentage of events\n      and non-events:\n\n      .. math::\n        IV = \\sum ((\\% \text{{ of non-events}} - \\% \text{{ of events}}) \times\n        \\ln\\left(\014rac{\\% \text{{ of non-events}} + \\epsilon}\n        {\\% \text{{ of events}} + \\epsilon}\right))\n\n    - The 'binning' method divides `y_pred` into bins and calculates IV for\n      each bin, summing up the contributions from all bins.\n\n    References\n    ----------\n    - Freedman, D. and Diaconis, P. (1981). \"On the histogram as a density estimator:\n      L2 theory.\" Zeitschrift f\303\274r Wahrscheinlichkeitstheorie und verwandte Gebiete.\n    - Sturges, H. A. (1926). \"The choice of a class interval.\" Journal of the American\n      Statistical Association.\n      \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_45calculate_binary_iv = {"calculate_binary_iv", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_45calculate_binary_iv, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_44calculate_binary_iv};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_45calculate_binary_iv(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_true = 0;
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_epsilon = 0;
  PyObject *__pyx_v_method = 0;
  PyObject *__pyx_v_bins = 0;
  PyObject *__pyx_v_bins_method = 0;
  PyObject *__pyx_v_data_range = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_binary_iv (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_true,&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_epsilon,&amp;__pyx_n_s_method,&amp;__pyx_n_s_bins,&amp;__pyx_n_s_bins_method,&amp;__pyx_n_s_data_range,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_15)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_base)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_auto)));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_freedman_diaconis)));
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_44calculate_binary_iv(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_true, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_epsilon, PyObject *__pyx_v_method, PyObject *__pyx_v_bins, PyObject *__pyx_v_bins_method, PyObject *__pyx_v_data_range) {
  PyObject *__pyx_v_msg_meth = NULL;
  PyObject *__pyx_v_percent_events = NULL;
  PyObject *__pyx_v_percent_non_events = NULL;
  PyObject *__pyx_v_bins_array = NULL;
  PyObject *__pyx_v_digitized = NULL;
  PyObject *__pyx_v_iv = NULL;
  Py_ssize_t __pyx_v_bin_index;
  PyObject *__pyx_v_in_bin = NULL;
  PyObject *__pyx_v_bin_true = NULL;
  PyObject *__pyx_v_percent_events_bin = NULL;
  PyObject *__pyx_v_percent_non_events_bin = NULL;
  PyObject *__pyx_v_bin_contribution = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__49)
  <span class='trace'>__Pyx_TraceCall</span>("calculate_binary_iv", __pyx_f[0], 1993, 0, <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_epsilon);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bins);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bins_method);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_binary_iv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_msg_meth);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_percent_events);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_percent_non_events);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bins_array);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_digitized);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_iv);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_in_bin);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bin_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_percent_events_bin);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_percent_non_events_bin);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bin_contribution);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_true);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_epsilon);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_method);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bins);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bins_method);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__183 = <span class='py_c_api'>PyTuple_Pack</span>(19, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_epsilon, __pyx_n_s_method, __pyx_n_s_bins, __pyx_n_s_bins_method, __pyx_n_s_data_range, __pyx_n_s_msg_meth, __pyx_n_s_percent_events, __pyx_n_s_percent_non_events, __pyx_n_s_bins_array, __pyx_n_s_digitized, __pyx_n_s_iv, __pyx_n_s_bin_index, __pyx_n_s_in_bin, __pyx_n_s_bin_true, __pyx_n_s_percent_events_bin, __pyx_n_s_percent_non_events_bin, __pyx_n_s_bin_contribution);<span class='error_goto'> if (unlikely(!__pyx_tuple__183)) __PYX_ERR(0, 1993, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__183);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__183);
  __pyx_codeobj__49 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 0, 19, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__183, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_calculate_binary_iv, 1993, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__49)) __PYX_ERR(0, 1993, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(1993,0,<span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_45calculate_binary_iv, 0, __pyx_n_s_calculate_binary_iv, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__49));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1993, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__184);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calculate_binary_iv, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__184 = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject*)__pyx_float_1eneg_15), ((PyObject*)__pyx_n_u_base), ((PyObject*)__pyx_n_u_auto), ((PyObject*)__pyx_n_u_freedman_diaconis), Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__184)) __PYX_ERR(0, 1993, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__184);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__184);
</pre><pre class="cython line score-0">&#xA0;<span class="">1994</span>:     y_true,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1995</span>:     y_pred,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1996</span>:     epsilon=1e-15,</pre>
<pre class="cython line score-0">&#xA0;<span class="">1997</span>:     method='base',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1998</span>:     bins='auto',</pre>
<pre class="cython line score-0">&#xA0;<span class="">1999</span>:     bins_method='freedman_diaconis',</pre>
<pre class="cython line score-105" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2000</span>:     data_range=None):</pre>
<pre class='cython code score-105 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_true)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_binary_iv", 0, 2, 7, 1); <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_epsilon);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_method);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bins);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bins_method);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data_range);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate_binary_iv") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y_true = values[0];
    __pyx_v_y_pred = values[1];
    __pyx_v_epsilon = values[2];
    __pyx_v_method = values[3];
    __pyx_v_bins = values[4];
    __pyx_v_bins_method = values[5];
    __pyx_v_data_range = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_binary_iv", 0, 2, 7, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 1993, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_binary_iv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_44calculate_binary_iv(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_epsilon, __pyx_v_method, __pyx_v_bins, __pyx_v_bins_method, __pyx_v_data_range);
</pre><pre class="cython line score-0">&#xA0;<span class="">2001</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2002</span>:     Calculate the Information Value (IV) for binary classification problems</pre>
<pre class="cython line score-0">&#xA0;<span class="">2003</span>:     using a base or binning approach. This function provides flexibility in</pre>
<pre class="cython line score-0">&#xA0;<span class="">2004</span>:     IV calculation by allowing for simple percentage-based calculations or</pre>
<pre class="cython line score-0">&#xA0;<span class="">2005</span>:     detailed binning techniques to understand the predictive power across</pre>
<pre class="cython line score-0">&#xA0;<span class="">2006</span>:     the distribution of predicted probabilities.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2008</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2009</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2010</span>:     y_true : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">2011</span>:         True binary labels.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2012</span>:     y_pred : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">2013</span>:         Predicted probabilities for the positive class.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2014</span>:     epsilon : float or 'auto', optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2015</span>:         A small epsilon value added to probabilities to prevent division</pre>
<pre class="cython line score-0">&#xA0;<span class="">2016</span>:         by zero in logarithmic calculations. If 'auto', dynamically determines</pre>
<pre class="cython line score-0">&#xA0;<span class="">2017</span>:         an appropriate epsilon based on `y_pred`. Default is 1e-15.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2018</span>:     method : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2019</span>:         The method for calculating IV. Options are 'base' for a direct approach</pre>
<pre class="cython line score-0">&#xA0;<span class="">2020</span>:         using the overall percentage of events, and 'binning' for a detailed</pre>
<pre class="cython line score-0">&#xA0;<span class="">2021</span>:         analysis using bins of predicted probabilities. Default is 'base'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2022</span>:     bins : int or 'auto', optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2023</span>:         The number of bins to use for the 'binning' method. If 'auto', the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2024</span>:         optimal number of bins is calculated based on `bins_method`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2025</span>:         Default is 'auto'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2026</span>:     bins_method : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2027</span>:         Method to use for calculating the optimal number of bins when</pre>
<pre class="cython line score-0">&#xA0;<span class="">2028</span>:         `bins` is 'auto'. Options include 'freedman_diaconis', 'sturges',</pre>
<pre class="cython line score-0">&#xA0;<span class="">2029</span>:         and 'sqrt'. Default is 'freedman_diaconis'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2030</span>:     data_range : tuple, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2031</span>:         A tuple specifying the range of the data as (min, max) for bin</pre>
<pre class="cython line score-0">&#xA0;<span class="">2032</span>:         calculation. If None, the range is derived from `y_pred`. Default is None.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2033</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2034</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2035</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2036</span>:     float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2037</span>:         The calculated Information Value (IV).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2038</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2039</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">2040</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2041</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2042</span>:         If an invalid method is specified.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2043</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2044</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2045</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2046</span>:     &gt;&gt;&gt; import numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">2047</span>:     &gt;&gt;&gt; from gofast.tools.mathex import calculate_binary_iv</pre>
<pre class="cython line score-0">&#xA0;<span class="">2048</span>:     &gt;&gt;&gt; y_true = np.array([0, 1, 0, 1, 1])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2049</span>:     &gt;&gt;&gt; y_pred = np.array([0.1, 0.8, 0.2, 0.7, 0.9])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2050</span>:     &gt;&gt;&gt; print(calculate_binary_iv(y_true, y_pred, method='base'))</pre>
<pre class="cython line score-0">&#xA0;<span class="">2051</span>:     1.6094379124341003</pre>
<pre class="cython line score-0">&#xA0;<span class="">2052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2053</span>:     &gt;&gt;&gt; print(calculate_binary_iv(y_true, y_pred, method='binning', bins=3,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2054</span>:     ...                           bins_method='sturges'))</pre>
<pre class="cython line score-0">&#xA0;<span class="">2055</span>:     0.6931471805599453</pre>
<pre class="cython line score-0">&#xA0;<span class="">2056</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2057</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">2058</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">2059</span>:     The Information Value (IV) quantifies the predictive power of a feature or</pre>
<pre class="cython line score-0">&#xA0;<span class="">2060</span>:     model in binary classification, illustrating its ability to distinguish</pre>
<pre class="cython line score-0">&#xA0;<span class="">2061</span>:     between classes.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2062</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2063</span>:     - The 'base' method calculates IV using the overall percentage of events</pre>
<pre class="cython line score-0">&#xA0;<span class="">2064</span>:       and non-events:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2065</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2066</span>:       .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">2067</span>:         IV = \sum ((\% \text{{ of non-events}} - \% \text{{ of events}}) \times</pre>
<pre class="cython line score-0">&#xA0;<span class="">2068</span>:         \ln\left(\frac{\% \text{{ of non-events}} + \epsilon}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2069</span>:         {\% \text{{ of events}} + \epsilon}\right))</pre>
<pre class="cython line score-0">&#xA0;<span class="">2070</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2071</span>:     - The 'binning' method divides `y_pred` into bins and calculates IV for</pre>
<pre class="cython line score-0">&#xA0;<span class="">2072</span>:       each bin, summing up the contributions from all bins.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2073</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2074</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">2075</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2076</span>:     - Freedman, D. and Diaconis, P. (1981). "On the histogram as a density estimator:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2077</span>:       L2 theory." Zeitschrift für Wahrscheinlichkeitstheorie und verwandte Gebiete.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2078</span>:     - Sturges, H. A. (1926). "The choice of a class interval." Journal of the American</pre>
<pre class="cython line score-0">&#xA0;<span class="">2079</span>:       Statistical Association.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2080</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2081</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2082</span>:     # Ensure y_true and y_pred are numpy arrays for efficient computation</pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2083</span>:     y_true, y_pred = np.asarray(y_true), np.asarray(y_pred)</pre>
<pre class='cython code score-40 '>  <span class='trace'>__Pyx_TraceLine</span>(2083,0,<span class='error_goto'>__PYX_ERR(0, 2083, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2083, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2083, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_y_true};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2083, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2083, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2083, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_y_pred};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2083, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_true, __pyx_t_1);
  __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2084</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2085</span>:     # Validate and process epsilon</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2086</span>:     if isinstance(epsilon, str):</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2086,0,<span class='error_goto'>__PYX_ERR(0, 2086, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_epsilon); 
  if (__pyx_t_6) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2087</span>:         if epsilon == 'auto':</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2087,0,<span class='error_goto'>__PYX_ERR(0, 2087, __pyx_L1_error)</span>)
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_epsilon, __pyx_n_u_auto, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2087, __pyx_L1_error)</span>
    if (likely(__pyx_t_6)) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2088</span>:             epsilon = determine_epsilon(y_pred)</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(2088,0,<span class='error_goto'>__PYX_ERR(0, 2088, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_determine_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2088, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_5)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_y_pred};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2088, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_epsilon, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2089</span>:         else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2090</span>:             raise ValueError(</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2090,0,<span class='error_goto'>__PYX_ERR(0, 2090, __pyx_L1_error)</span>)
    /*else*/ {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__50, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 2090, __pyx_L1_error)</span>
    }
    __pyx_L4:;
/* … */
  __pyx_tuple__50 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Epsilon_value_auto_is_acceptable);<span class='error_goto'> if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 2090, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__50);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__50);
</pre><pre class="cython line score-0">&#xA0;<span class="">2091</span>:                 "Epsilon value 'auto' is acceptable or should be a numeric value.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2092</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2093</span>:     elif not isinstance(epsilon, (int, float)):</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(2093,0,<span class='error_goto'>__PYX_ERR(0, 2093, __pyx_L1_error)</span>)
  __pyx_t_7 = <span class='py_c_api'>PyInt_Check</span>(__pyx_v_epsilon); 
  if (!__pyx_t_7) {
  } else {
    __pyx_t_6 = __pyx_t_7;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_7 = <span class='py_c_api'>PyFloat_Check</span>(__pyx_v_epsilon); 
  __pyx_t_6 = __pyx_t_7;
  __pyx_L5_bool_binop_done:;
  __pyx_t_7 = (!__pyx_t_6);
  if (unlikely(__pyx_t_7)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2094</span>:         raise ValueError("Epsilon must be a numeric value or 'auto'.")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2094,0,<span class='error_goto'>__PYX_ERR(0, 2094, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__51, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2094, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2094, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__51 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Epsilon_must_be_a_numeric_value);<span class='error_goto'> if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 2094, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__51);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__51);
</pre><pre class="cython line score-0">&#xA0;<span class="">2095</span>:     else:</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2096</span>:         epsilon = float(epsilon)</pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(2096,0,<span class='error_goto'>__PYX_ERR(0, 2096, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Float</span>(__pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2096, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_epsilon, __pyx_t_3);
    __pyx_t_3 = 0;
  }
  __pyx_L3:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2097</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2098</span>:     # Validate method parameter</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2099</span>:     msg_meth=copy.deepcopy(method)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(2099,0,<span class='error_goto'>__PYX_ERR(0, 2099, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_deepcopy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2099, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_method};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2099, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_v_msg_meth = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2100</span>:     method = normalize_string(</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(2100,0,<span class='error_goto'>__PYX_ERR(0, 2100, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_normalize_string);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2101,0,<span class='error_goto'>__PYX_ERR(0, 2101, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_method);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_method)) <span class='error_goto'>__PYX_ERR(0, 2100, __pyx_L1_error)</span>;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2100,0,<span class='error_goto'>__PYX_ERR(0, 2100, __pyx_L1_error)</span>)
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_method, __pyx_t_10);
  __pyx_t_10 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2101</span>:         method, target_strs= ['base', 'binning'], match_method='contains',</pre>
<pre class='cython code score-24 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_base);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_base);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_base)) <span class='error_goto'>__PYX_ERR(0, 2101, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_binning);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_binning);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_u_binning)) <span class='error_goto'>__PYX_ERR(0, 2101, __pyx_L1_error)</span>;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_target_strs, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2101, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_match_method, __pyx_n_u_contains) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2101, __pyx_L1_error)</span>
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2102</span>:         return_target_only=True, raise_exception=True , error_msg= (</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(2102,0,<span class='error_goto'>__PYX_ERR(0, 2102, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return_target_only, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2101, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_raise_exception, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2101, __pyx_L1_error)</span>
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2103</span>:             f"Invalid method '{msg_meth}'. Use 'base' or 'binning'.")</pre>
<pre class='cython code score-27 '>  <span class='trace'>__Pyx_TraceLine</span>(2103,0,<span class='error_goto'>__PYX_ERR(0, 2103, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = 0;
  __pyx_t_9 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Invalid_method);
  __pyx_t_8 += 16;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Invalid_method);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_Invalid_method);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_msg_meth, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_10) &gt; __pyx_t_9) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_10) : __pyx_t_9;
  __pyx_t_8 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_10);
  __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Use_base_or_binning);
  __pyx_t_8 += 27;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Use_base_or_binning);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_Use_base_or_binning);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 3, __pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_error_msg, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2101, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2104</span>:         )</pre>
<pre class="cython line score-0">&#xA0;<span class="">2105</span>:     # Base method for IV calculation</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2106</span>:     if method == 'base':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2106,0,<span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L1_error)</span>)
  __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_base, Py_EQ)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2106, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2107</span>:         percent_events = y_true.mean()</pre>
<pre class='cython code score-16 '>    <span class='trace'>__Pyx_TraceLine</span>(2107,0,<span class='error_goto'>__PYX_ERR(0, 2107, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y_true, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2107, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 2107, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_v_percent_events = __pyx_t_10;
    __pyx_t_10 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2108</span>:         percent_non_events = 1 - percent_events</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2108,0,<span class='error_goto'>__PYX_ERR(0, 2108, __pyx_L1_error)</span>)
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_percent_events, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2108, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_v_percent_non_events = __pyx_t_10;
    __pyx_t_10 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2109</span>:         return np.sum((percent_non_events - percent_events) * np.log(</pre>
<pre class='cython code score-38 '>    <span class='trace'>__Pyx_TraceLine</span>(2109,0,<span class='error_goto'>__PYX_ERR(0, 2109, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2109, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2109, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_percent_non_events, __pyx_v_percent_events);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2109, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2109, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2109, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(2109,0,<span class='error_goto'>__PYX_ERR(0, 2109, __pyx_L1_error)</span>)
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2109, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_11};
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 2109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_r = __pyx_t_10;
    __pyx_t_10 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2110</span>:             (percent_non_events + epsilon) / (percent_events + epsilon)))</pre>
<pre class='cython code score-29 '>    <span class='trace'>__Pyx_TraceLine</span>(2110,0,<span class='error_goto'>__PYX_ERR(0, 2110, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_percent_non_events, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_12 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_percent_events, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 2110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    __pyx_t_12 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_12)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_t_13};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2109, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2111</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2112</span>:     # Binning method for IV calculation</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2113</span>:     elif method == 'binning':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2113,0,<span class='error_goto'>__PYX_ERR(0, 2113, __pyx_L1_error)</span>)
  __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_binning, Py_EQ)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2113, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2114</span>:         if isinstance (bins, str):</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2114,0,<span class='error_goto'>__PYX_ERR(0, 2114, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_bins); 
    if (__pyx_t_7) {
/* … */
      goto __pyx_L8;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2115</span>:             if bins=='auto' and bins_method is None:</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2115,0,<span class='error_goto'>__PYX_ERR(0, 2115, __pyx_L1_error)</span>)
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_bins, __pyx_n_u_auto, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2115, __pyx_L1_error)</span>
      if (__pyx_t_6) {
      } else {
        __pyx_t_7 = __pyx_t_6;
        goto __pyx_L10_bool_binop_done;
      }
      __pyx_t_6 = (__pyx_v_bins_method == Py_None);
      __pyx_t_7 = __pyx_t_6;
      __pyx_L10_bool_binop_done:;
      if (__pyx_t_7) {
/* … */
      }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2116</span>:                 warnings.warn(</pre>
<pre class='cython code score-20 '>        <span class='trace'>__Pyx_TraceLine</span>(2116,0,<span class='error_goto'>__PYX_ERR(0, 2116, __pyx_L1_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2116, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2116, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        __pyx_t_5 = NULL;
        __pyx_t_4 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
          __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
          if (likely(__pyx_t_5)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
            __pyx_t_4 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_kp_u_The_bins_parameter_is_set_to_aut};
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 2116, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2117</span>:                     "The 'bins' parameter is set to 'auto', but no 'bins_method'"</pre>
<pre class="cython line score-0">&#xA0;<span class="">2118</span>:                     " has been specified. Defaulting to the 'freedman_diaconis'"</pre>
<pre class="cython line score-0">&#xA0;<span class="">2119</span>:                     " method for determining the optimal number of bins.")</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2120</span>:                 bins_method="freedman_diaconis"</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(2120,0,<span class='error_goto'>__PYX_ERR(0, 2120, __pyx_L1_error)</span>)
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_freedman_diaconis);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_bins_method, __pyx_n_u_freedman_diaconis);
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2121</span>:             bins = calculate_optimal_bins(</pre>
<pre class='cython code score-16 '>      <span class='trace'>__Pyx_TraceLine</span>(2121,0,<span class='error_goto'>__PYX_ERR(0, 2121, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_calculate_optimal_bins);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2121, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(2122,0,<span class='error_goto'>__PYX_ERR(0, 2122, __pyx_L1_error)</span>)
      __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2121, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_pred);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_v_y_pred)) <span class='error_goto'>__PYX_ERR(0, 2121, __pyx_L1_error)</span>;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(2121,0,<span class='error_goto'>__PYX_ERR(0, 2121, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_11, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2121, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_bins, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2122</span>:                 y_pred, method=bins_method, data_range=data_range)</pre>
<pre class='cython code score-12 '>      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2122, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_method, __pyx_v_bins_method) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2122, __pyx_L1_error)</span>
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_data_range, __pyx_v_data_range) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2122, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2123</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2124</span>:         elif not isinstance(bins, (int, float)) or bins &lt; 1:</pre>
<pre class='cython code score-18 '>    <span class='trace'>__Pyx_TraceLine</span>(2124,0,<span class='error_goto'>__PYX_ERR(0, 2124, __pyx_L1_error)</span>)
    __pyx_t_14 = <span class='py_c_api'>PyInt_Check</span>(__pyx_v_bins); 
    if (!__pyx_t_14) {
    } else {
      __pyx_t_6 = __pyx_t_14;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_14 = <span class='py_c_api'>PyFloat_Check</span>(__pyx_v_bins); 
    __pyx_t_6 = __pyx_t_14;
    __pyx_L14_bool_binop_done:;
    __pyx_t_14 = (!__pyx_t_6);
    if (!__pyx_t_14) {
    } else {
      __pyx_t_7 = __pyx_t_14;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_bins, __pyx_int_1, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2124, __pyx_L1_error)</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2124, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_7 = __pyx_t_14;
    __pyx_L12_bool_binop_done:;
    if (unlikely(__pyx_t_7)) {
/* … */
    }
    __pyx_L8:;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2125</span>:             raise ValueError("Bins must be 'auto' or a positive integer.")</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(2125,0,<span class='error_goto'>__PYX_ERR(0, 2125, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__52, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2125, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 2125, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__52 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Bins_must_be_auto_or_a_positive);<span class='error_goto'> if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 2125, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__52);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__52);
</pre><pre class="cython line score-0">&#xA0;<span class="">2126</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2127</span>:         if isinstance ( bins, float):</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2127,0,<span class='error_goto'>__PYX_ERR(0, 2127, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='py_c_api'>PyFloat_Check</span>(__pyx_v_bins); 
    if (__pyx_t_7) {
/* … */
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2128</span>:             bins =int (bins )</pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(2128,0,<span class='error_goto'>__PYX_ERR(0, 2128, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_bins);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2128, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_bins, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2129</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2130</span>:         bins_array = np.linspace(0, 1, bins + 1)</pre>
<pre class='cython code score-22 '>    <span class='trace'>__Pyx_TraceLine</span>(2130,0,<span class='error_goto'>__PYX_ERR(0, 2130, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2130, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2130, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_bins, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2130, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_10 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_10, __pyx_int_0, __pyx_int_1, __pyx_t_5};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_4, 3+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2130, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    __pyx_v_bins_array = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2131</span>:         digitized = np.digitize(y_pred, bins_array) - 1</pre>
<pre class='cython code score-22 '>    <span class='trace'>__Pyx_TraceLine</span>(2131,0,<span class='error_goto'>__PYX_ERR(0, 2131, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_digitize);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_11, __pyx_v_y_pred, __pyx_v_bins_array};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2131, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_digitized = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2132</span>:         iv = 0</pre>
<pre class='cython code score-1 '>    <span class='trace'>__Pyx_TraceLine</span>(2132,0,<span class='error_goto'>__PYX_ERR(0, 2132, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_v_iv = __pyx_int_0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2133</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2134</span>:         for bin_index in range(len(bins_array) - 1):</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2134,0,<span class='error_goto'>__PYX_ERR(0, 2134, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_bins_array);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2134, __pyx_L1_error)</span>
    __pyx_t_15 = (__pyx_t_8 - 1);
    __pyx_t_8 = __pyx_t_15;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_8; __pyx_t_16+=1) {
      __pyx_v_bin_index = __pyx_t_16;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2135</span>:             in_bin = digitized == bin_index</pre>
<pre class='cython code score-12 '>      <span class='trace'>__Pyx_TraceLine</span>(2135,0,<span class='error_goto'>__PYX_ERR(0, 2135, __pyx_L1_error)</span>)
      __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_bin_index);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2135, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_digitized, __pyx_t_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2135, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_in_bin, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2136</span>:             if not in_bin.any(): # if np.sum(indices) == 0:</pre>
<pre class='cython code score-19 '>      <span class='trace'>__Pyx_TraceLine</span>(2136,0,<span class='error_goto'>__PYX_ERR(0, 2136, __pyx_L1_error)</span>)
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_in_bin, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2136, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_11 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_11, NULL};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2136, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2136, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_14 = (!__pyx_t_7);
      if (__pyx_t_14) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2137</span>:                 continue # # Skip empty bins</pre>
<pre class='cython code score-0 '>        <span class='trace'>__Pyx_TraceLine</span>(2137,0,<span class='error_goto'>__PYX_ERR(0, 2137, __pyx_L1_error)</span>)
        goto __pyx_L17_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">2138</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2139</span>:             bin_true = y_true[in_bin]</pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(2139,0,<span class='error_goto'>__PYX_ERR(0, 2139, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_true, __pyx_v_in_bin);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2139, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_bin_true, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2140</span>:             percent_events_bin = bin_true.mean()</pre>
<pre class='cython code score-17 '>      <span class='trace'>__Pyx_TraceLine</span>(2140,0,<span class='error_goto'>__PYX_ERR(0, 2140, __pyx_L1_error)</span>)
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_bin_true, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2140, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_11 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_11, NULL};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2140, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_percent_events_bin, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2141</span>:             percent_non_events_bin = 1 - percent_events_bin</pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(2141,0,<span class='error_goto'>__PYX_ERR(0, 2141, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_percent_events_bin, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2141, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_percent_non_events_bin, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2142</span>:             bin_contribution = (percent_non_events_bin - percent_events_bin) * np.log(</pre>
<pre class='cython code score-18 '>      <span class='trace'>__Pyx_TraceLine</span>(2142,0,<span class='error_goto'>__PYX_ERR(0, 2142, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_percent_non_events_bin, __pyx_v_percent_events_bin);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2142, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2142, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2142, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(2142,0,<span class='error_goto'>__PYX_ERR(0, 2142, __pyx_L1_error)</span>)
      __pyx_t_10 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2142, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_bin_contribution, __pyx_t_10);
      __pyx_t_10 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2143</span>:                 (percent_non_events_bin + epsilon) / (percent_events_bin + epsilon))</pre>
<pre class='cython code score-29 '>      <span class='trace'>__Pyx_TraceLine</span>(2143,0,<span class='error_goto'>__PYX_ERR(0, 2143, __pyx_L1_error)</span>)
      __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_percent_non_events_bin, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2143, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_percent_events_bin, __pyx_v_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2143, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_11, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 2143, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_13};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2142, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2144</span>:             iv += bin_contribution if not np.isnan(bin_contribution) else 0</pre>
<pre class='cython code score-31 '>      <span class='trace'>__Pyx_TraceLine</span>(2144,0,<span class='error_goto'>__PYX_ERR(0, 2144, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2144, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 2144, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_13))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_13);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_13, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_bin_contribution};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_13, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2144, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      }
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2144, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_7 = (!__pyx_t_14);
      if (__pyx_t_7) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_bin_contribution);
        __pyx_t_10 = __pyx_v_bin_contribution;
      } else {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
        __pyx_t_10 = __pyx_int_0;
      }
      __pyx_t_5 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_iv, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2144, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_iv, __pyx_t_5);
      __pyx_t_5 = 0;
      __pyx_L17_continue:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2145</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2146</span>:         return iv</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2146,0,<span class='error_goto'>__PYX_ERR(0, 2146, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_iv);
    __pyx_r = __pyx_v_iv;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2147</span>: </pre>
<pre class="cython line score-97" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2148</span>: def determine_epsilon(y_pred, base_epsilon=1e-15, scale_factor=1e-5):</pre>
<pre class='cython code score-97 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_47determine_epsilon(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_46determine_epsilon, "\n    Determine an appropriate epsilon value based on the predictions.\n\n    If any predicted value is greater than 0, epsilon is set as a fraction \n    of the smallest non-zero prediction to avoid division by zero in \n    logarithmic calculations. Otherwise, a default small epsilon value is used.\n\n    Parameters\n    ----------\n    y_pred : array-like\n        Predicted probabilities or values.\n    base_epsilon : float, optional\n        The minimum allowed epsilon value to ensure it's not too small, \n        by default 1e-15.\n    scale_factor : float, optional\n        The factor to scale the minimum non-zero prediction by to determine \n        epsilon, by default 1e-5.\n\n    Returns\n    -------\n    float\n        The determined epsilon value.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_47determine_epsilon = {"determine_epsilon", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_47determine_epsilon, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_46determine_epsilon};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_47determine_epsilon(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y_pred = 0;
  PyObject *__pyx_v_base_epsilon = 0;
  PyObject *__pyx_v_scale_factor = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("determine_epsilon (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y_pred,&amp;__pyx_n_s_base_epsilon,&amp;__pyx_n_s_scale_factor,0};
  PyObject* values[3] = {0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_15)));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1eneg_5)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y_pred)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2148, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_base_epsilon);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2148, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_scale_factor);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2148, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "determine_epsilon") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2148, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y_pred = values[0];
    __pyx_v_base_epsilon = values[1];
    __pyx_v_scale_factor = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("determine_epsilon", 0, 1, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2148, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.determine_epsilon", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_46determine_epsilon(__pyx_self, __pyx_v_y_pred, __pyx_v_base_epsilon, __pyx_v_scale_factor);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_46determine_epsilon(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y_pred, PyObject *__pyx_v_base_epsilon, PyObject *__pyx_v_scale_factor) {
  PyObject *__pyx_v_positive_preds = NULL;
  PyObject *__pyx_v_min_non_zero_pred = NULL;
  PyObject *__pyx_v_epsilon = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__53)
  <span class='trace'>__Pyx_TraceCall</span>("determine_epsilon", __pyx_f[0], 2148, 0, <span class='error_goto'>__PYX_ERR(0, 2148, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_pred);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.determine_epsilon", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_positive_preds);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_min_non_zero_pred);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_epsilon);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_pred);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__185 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_y_pred, __pyx_n_s_base_epsilon, __pyx_n_s_scale_factor, __pyx_n_s_positive_preds, __pyx_n_s_min_non_zero_pred, __pyx_n_s_epsilon);<span class='error_goto'> if (unlikely(!__pyx_tuple__185)) __PYX_ERR(0, 2148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__185);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__185);
  __pyx_codeobj__53 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__185, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_determine_epsilon, 2148, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__53)) __PYX_ERR(0, 2148, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2148,0,<span class='error_goto'>__PYX_ERR(0, 2148, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_47determine_epsilon, 0, __pyx_n_s_determine_epsilon, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__53));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__186);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_determine_epsilon, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2148, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__186 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject*)__pyx_float_1eneg_15), ((PyObject*)__pyx_float_1eneg_5));<span class='error_goto'> if (unlikely(!__pyx_tuple__186)) __PYX_ERR(0, 2148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__186);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__186);
</pre><pre class="cython line score-0">&#xA0;<span class="">2149</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2150</span>:     Determine an appropriate epsilon value based on the predictions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2151</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2152</span>:     If any predicted value is greater than 0, epsilon is set as a fraction</pre>
<pre class="cython line score-0">&#xA0;<span class="">2153</span>:     of the smallest non-zero prediction to avoid division by zero in</pre>
<pre class="cython line score-0">&#xA0;<span class="">2154</span>:     logarithmic calculations. Otherwise, a default small epsilon value is used.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2155</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2156</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2157</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2158</span>:     y_pred : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">2159</span>:         Predicted probabilities or values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2160</span>:     base_epsilon : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2161</span>:         The minimum allowed epsilon value to ensure it's not too small,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2162</span>:         by default 1e-15.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2163</span>:     scale_factor : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2164</span>:         The factor to scale the minimum non-zero prediction by to determine</pre>
<pre class="cython line score-0">&#xA0;<span class="">2165</span>:         epsilon, by default 1e-5.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2166</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2167</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2168</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2169</span>:     float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2170</span>:         The determined epsilon value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2171</span>:     """</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2172</span>:     if not isinstance (y_pred, np.ndarray):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(2172,0,<span class='error_goto'>__PYX_ERR(0, 2172, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2172, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2172, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_y_pred, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 2172, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = (!__pyx_t_3);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2173</span>:         y_pred = np.asarray(y_pred )</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(2173,0,<span class='error_goto'>__PYX_ERR(0, 2173, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_y_pred};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2173, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y_pred, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2174</span>:     # if np.any(y_pred &gt; 0):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2175</span>:     #     # Find the minimum non-zero predicted probability/value</pre>
<pre class="cython line score-0">&#xA0;<span class="">2176</span>:     #     min_non_zero_pred = np.min(y_pred[y_pred &gt; 0])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2177</span>:     #     # Use a fraction of the smallest non-zero prediction</pre>
<pre class="cython line score-0">&#xA0;<span class="">2178</span>:     #     epsilon = min_non_zero_pred * scale_factor</pre>
<pre class="cython line score-0">&#xA0;<span class="">2179</span>:     #     # Ensure epsilon is not too small, applying a lower bound</pre>
<pre class="cython line score-0">&#xA0;<span class="">2180</span>:     #     epsilon = max(epsilon, base_epsilon)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2181</span>:     # else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2182</span>:     #     # Use the base epsilon if no predictions are greater than 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">2183</span>:     #     epsilon = base_epsilon</pre>
<pre class="cython line score-0">&#xA0;<span class="">2184</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2185</span>:     # return epsilon</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2186</span>:     positive_preds = y_pred[y_pred &gt; 0]</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(2186,0,<span class='error_goto'>__PYX_ERR(0, 2186, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_y_pred, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2186, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y_pred, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_positive_preds = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2187</span>:     if positive_preds.size &gt; 0:</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(2187,0,<span class='error_goto'>__PYX_ERR(0, 2187, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_positive_preds, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2187, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2187, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2187, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_4) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2188</span>:         min_non_zero_pred = np.min(positive_preds)</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(2188,0,<span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2188, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2188, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_positive_preds};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2188, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_v_min_non_zero_pred = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2189</span>:         epsilon = max(min_non_zero_pred * scale_factor, base_epsilon)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(2189,0,<span class='error_goto'>__PYX_ERR(0, 2189, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_base_epsilon);
    __pyx_t_2 = __pyx_v_base_epsilon;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_min_non_zero_pred, __pyx_v_scale_factor);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2189, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_1, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2189, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2189, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (__pyx_t_4) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      __pyx_t_5 = __pyx_t_2;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_5 = __pyx_t_1;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __pyx_t_5;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_epsilon = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2190</span>:     else:</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2191</span>:         epsilon = base_epsilon</pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(2191,0,<span class='error_goto'>__PYX_ERR(0, 2191, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_base_epsilon);
    __pyx_v_epsilon = __pyx_v_base_epsilon;
  }
  __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2192</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2193</span>:     return epsilon</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2193,0,<span class='error_goto'>__PYX_ERR(0, 2193, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_epsilon);
  __pyx_r = __pyx_v_epsilon;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2194</span>: </pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2195</span>: def calculate_residuals(</pre>
<pre class='cython code score-74 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_49calculate_residuals(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_48calculate_residuals, "\n    Calculate the residuals for regression, binary, or multiclass \n    classification tasks.\n\n    Parameters\n    ----------\n    actual : np.ndarray\n        The actual observed values or class labels.\n    predicted : Union[np.ndarray, List[np.ndarray]]\n        The predicted values for regression or class labels for classification.\n        Can be a list of predicted probabilities for each class from predict_proba.\n    task_type : str, default='regression'\n        The type of task: 'regression', 'binary', or 'multiclass'.\n    predict_proba : np.ndarray, optional\n        Predicted probabilities for each class from predict_proba \n        (for classification tasks).\n\n    Returns\n    -------\n    residuals : np.ndarray\n        The residuals of the model.\n\n    Example\n    -------\n    &gt;&gt;&gt; import numpy as np \n    &gt;&gt;&gt; from gofast.tools.mathex import calculate_residuals\n    &gt;&gt;&gt; # For regression\n    &gt;&gt;&gt; actual = np.array([3, -0.5, 2, 7])\n    &gt;&gt;&gt; predicted = np.array([2.5, 0.0, 2, 8])\n    &gt;&gt;&gt; residuals = calculate_residuals(actual, predicted, task_type='regression')\n    &gt;&gt;&gt; print(residuals)\n\n    &gt;&gt;&gt; # For binary classification\n    &gt;&gt;&gt; actual = np.array([0, 1, 0, 1])\n    &gt;&gt;&gt; predicted = np.array([0, 1, 0, 1])  # predicted class labels\n    &gt;&gt;&gt; residuals = calculate_residuals(actual, predicted, task_type='binary')\n    &gt;&gt;&gt; print(residuals)\n\n    &gt;&gt;&gt; # For multiclass classification with predict_proba\n    &gt;&gt;&gt; actual = np.array([0, 1, 2, 1])\n    &gt;&gt;&gt; predict_proba = np.array([[0.7, 0.2, 0.1], [0.1, 0.7, 0.2], \n                                  [0.2, 0.2, 0.6], [0.1, 0.8, 0.1]])\n    &gt;&gt;&gt; residuals = calculate_residuals(actual, None, task_type='multiclass',\n                                        predict_proba=predict_proba)\n    &gt;&gt;&gt; print(residuals)\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_49calculate_residuals = {"calculate_residuals", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_49calculate_residuals, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_48calculate_residuals};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_49calculate_residuals(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_actual = 0;
  PyObject *__pyx_v_predicted = 0;
  PyObject *__pyx_v_task_type = 0;
  PyObject *__pyx_v_predict_proba = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("calculate_residuals (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_actual,&amp;__pyx_n_s_predicted,&amp;__pyx_n_s_task_type,&amp;__pyx_n_s_predict_proba,0};
  PyObject* values[4] = {0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_regression)));
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_48calculate_residuals(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_actual, PyObject *__pyx_v_predicted, PyObject *__pyx_v_task_type, PyObject *__pyx_v_predict_proba) {
  PyObject *__pyx_v_prob_true_class = NULL;
  PyObject *__pyx_v_residuals = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__54)
  <span class='trace'>__Pyx_TraceCall</span>("calculate_residuals", __pyx_f[0], 2195, 0, <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_residuals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_prob_true_class);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_residuals);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__187 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_actual, __pyx_n_s_predicted, __pyx_n_s_task_type, __pyx_n_s_predict_proba, __pyx_n_s_prob_true_class, __pyx_n_s_residuals);<span class='error_goto'> if (unlikely(!__pyx_tuple__187)) __PYX_ERR(0, 2195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__187);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__187);
  __pyx_codeobj__54 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__187, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_calculate_residuals, 2195, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__54)) __PYX_ERR(0, 2195, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2195,0,<span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_actual, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_predicted, __pyx_kp_s_Union_np_ndarray_List_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_task_type, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_predict_proba, __pyx_kp_s_Optional_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_49calculate_residuals, 0, __pyx_n_s_calculate_residuals, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__54));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_tuple__188);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_4, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calculate_residuals, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__188 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject*)__pyx_n_u_regression), Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__188)) __PYX_ERR(0, 2195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__188);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__188);
</pre><pre class="cython line score-0">&#xA0;<span class="">2196</span>:     actual: ArrayLike,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2197</span>:     predicted: Union[np.ndarray, List[ArrayLike]],</pre>
<pre class="cython line score-0">&#xA0;<span class="">2198</span>:     task_type: str = 'regression',</pre>
<pre class="cython line score-68" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2199</span>:     predict_proba: Optional[ArrayLike] = None</pre>
<pre class='cython code score-68 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_actual)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_predicted)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_residuals", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_task_type);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_predict_proba);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "calculate_residuals") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_actual = values[0];
    __pyx_v_predicted = values[1];
    __pyx_v_task_type = ((PyObject*)values[2]);
    __pyx_v_predict_proba = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("calculate_residuals", 0, 2, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2195, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.calculate_residuals", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_task_type), (&amp;PyUnicode_Type), 0, "task_type", 1))) <span class='error_goto'>__PYX_ERR(0, 2198, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_48calculate_residuals(__pyx_self, __pyx_v_actual, __pyx_v_predicted, __pyx_v_task_type, __pyx_v_predict_proba);
</pre><pre class="cython line score-0">&#xA0;<span class="">2200</span>: ) -&gt; ArrayLike:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2201</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2202</span>:     Calculate the residuals for regression, binary, or multiclass</pre>
<pre class="cython line score-0">&#xA0;<span class="">2203</span>:     classification tasks.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2204</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2205</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2206</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2207</span>:     actual : np.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2208</span>:         The actual observed values or class labels.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2209</span>:     predicted : Union[np.ndarray, List[np.ndarray]]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2210</span>:         The predicted values for regression or class labels for classification.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2211</span>:         Can be a list of predicted probabilities for each class from predict_proba.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2212</span>:     task_type : str, default='regression'</pre>
<pre class="cython line score-0">&#xA0;<span class="">2213</span>:         The type of task: 'regression', 'binary', or 'multiclass'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2214</span>:     predict_proba : np.ndarray, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2215</span>:         Predicted probabilities for each class from predict_proba</pre>
<pre class="cython line score-0">&#xA0;<span class="">2216</span>:         (for classification tasks).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2217</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2218</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2219</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2220</span>:     residuals : np.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2221</span>:         The residuals of the model.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2222</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2223</span>:     Example</pre>
<pre class="cython line score-0">&#xA0;<span class="">2224</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2225</span>:     &gt;&gt;&gt; import numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">2226</span>:     &gt;&gt;&gt; from gofast.tools.mathex import calculate_residuals</pre>
<pre class="cython line score-0">&#xA0;<span class="">2227</span>:     &gt;&gt;&gt; # For regression</pre>
<pre class="cython line score-0">&#xA0;<span class="">2228</span>:     &gt;&gt;&gt; actual = np.array([3, -0.5, 2, 7])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2229</span>:     &gt;&gt;&gt; predicted = np.array([2.5, 0.0, 2, 8])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2230</span>:     &gt;&gt;&gt; residuals = calculate_residuals(actual, predicted, task_type='regression')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2231</span>:     &gt;&gt;&gt; print(residuals)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2232</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2233</span>:     &gt;&gt;&gt; # For binary classification</pre>
<pre class="cython line score-0">&#xA0;<span class="">2234</span>:     &gt;&gt;&gt; actual = np.array([0, 1, 0, 1])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2235</span>:     &gt;&gt;&gt; predicted = np.array([0, 1, 0, 1])  # predicted class labels</pre>
<pre class="cython line score-0">&#xA0;<span class="">2236</span>:     &gt;&gt;&gt; residuals = calculate_residuals(actual, predicted, task_type='binary')</pre>
<pre class="cython line score-0">&#xA0;<span class="">2237</span>:     &gt;&gt;&gt; print(residuals)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2238</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2239</span>:     &gt;&gt;&gt; # For multiclass classification with predict_proba</pre>
<pre class="cython line score-0">&#xA0;<span class="">2240</span>:     &gt;&gt;&gt; actual = np.array([0, 1, 2, 1])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2241</span>:     &gt;&gt;&gt; predict_proba = np.array([[0.7, 0.2, 0.1], [0.1, 0.7, 0.2],</pre>
<pre class="cython line score-0">&#xA0;<span class="">2242</span>:                                   [0.2, 0.2, 0.6], [0.1, 0.8, 0.1]])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2243</span>:     &gt;&gt;&gt; residuals = calculate_residuals(actual, None, task_type='multiclass',</pre>
<pre class="cython line score-0">&#xA0;<span class="">2244</span>:                                         predict_proba=predict_proba)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2245</span>:     &gt;&gt;&gt; print(residuals)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2246</span>:     """</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2247</span>:     if task_type == 'regression':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2247,0,<span class='error_goto'>__PYX_ERR(0, 2247, __pyx_L1_error)</span>)
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_task_type, __pyx_n_u_regression, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2247, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2248</span>:         if predicted is None:</pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(2248,0,<span class='error_goto'>__PYX_ERR(0, 2248, __pyx_L1_error)</span>)
    __pyx_t_1 = (__pyx_v_predicted == Py_None);
    if (unlikely(__pyx_t_1)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2249</span>:             raise ValueError("Predicted values must be provided for regression tasks.")</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(2249,0,<span class='error_goto'>__PYX_ERR(0, 2249, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__55, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2249, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 2249, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__55 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Predicted_values_must_be_provide);<span class='error_goto'> if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 2249, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__55);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__55);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2250</span>:         return actual - predicted</pre>
<pre class='cython code score-6 '>    <span class='trace'>__Pyx_TraceLine</span>(2250,0,<span class='error_goto'>__PYX_ERR(0, 2250, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_actual, __pyx_v_predicted);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2250, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_r = __pyx_t_2;
    __pyx_t_2 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2251</span>:     elif task_type in ['binary', 'multiclass']:</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(2251,0,<span class='error_goto'>__PYX_ERR(0, 2251, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_task_type);
  __pyx_t_3 = __pyx_v_task_type;
  __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_3, __pyx_n_u_binary, Py_EQ)); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2251, __pyx_L1_error)</span>
  if (!__pyx_t_4) {
  } else {
    __pyx_t_1 = __pyx_t_4;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_3, __pyx_n_u_multiclass, Py_EQ)); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2251, __pyx_L1_error)</span>
  __pyx_t_1 = __pyx_t_4;
  __pyx_L5_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __pyx_t_1;
  if (likely(__pyx_t_4)) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2252</span>:         if predict_proba is not None:</pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(2252,0,<span class='error_goto'>__PYX_ERR(0, 2252, __pyx_L1_error)</span>)
    __pyx_t_4 = (__pyx_v_predict_proba != Py_None);
    if (__pyx_t_4) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2253</span>:             if predict_proba.shape[0] != actual.shape[0]:</pre>
<pre class='cython code score-20 '>      <span class='trace'>__Pyx_TraceLine</span>(2253,0,<span class='error_goto'>__PYX_ERR(0, 2253, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_predict_proba, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2253, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2253, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_actual, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2253, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2253, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_6, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2253, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2253, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(__pyx_t_4)) {
/* … */
      }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2254</span>:                 raise ValueError("The length of predict_proba does not match "</pre>
<pre class='cython code score-10 '>        <span class='trace'>__Pyx_TraceLine</span>(2254,0,<span class='error_goto'>__PYX_ERR(0, 2254, __pyx_L1_error)</span>)
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__56, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2254, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='error_goto'>__PYX_ERR(0, 2254, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__56 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_The_length_of_predict_proba_does);<span class='error_goto'> if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 2254, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__56);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__56);
</pre><pre class="cython line score-0">&#xA0;<span class="">2255</span>:                                  "the number of actual values.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2256</span>:             # For each sample, find the predicted probability of the true class</pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2257</span>:             prob_true_class = predict_proba[np.arange(len(actual)), actual]</pre>
<pre class='cython code score-43 '>      <span class='trace'>__Pyx_TraceLine</span>(2257,0,<span class='error_goto'>__PYX_ERR(0, 2257, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_actual);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2257, __pyx_L1_error)</span>
      __pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_8 = NULL;
      __pyx_t_9 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_9 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_t_6};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2257, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2257, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_actual);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_actual);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_actual)) <span class='error_goto'>__PYX_ERR(0, 2257, __pyx_L1_error)</span>;
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_predict_proba, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2257, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_v_prob_true_class = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2258</span>:             residuals = 1 - prob_true_class  # Residuals are 1 - P(true class)</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2258,0,<span class='error_goto'>__PYX_ERR(0, 2258, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_prob_true_class, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2258, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_v_residuals = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2259</span>:         elif predicted is not None:</pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(2259,0,<span class='error_goto'>__PYX_ERR(0, 2259, __pyx_L1_error)</span>)
    __pyx_t_4 = (__pyx_v_predicted != Py_None);
    if (likely(__pyx_t_4)) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">2260</span>:             # For binary classification without probabilities, residuals</pre>
<pre class="cython line score-0">&#xA0;<span class="">2261</span>:             # are 0 for correct predictions and 1 for incorrect</pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2262</span>:             residuals = np.where(actual == predicted, 0, 1)</pre>
<pre class='cython code score-25 '>      <span class='trace'>__Pyx_TraceLine</span>(2262,0,<span class='error_goto'>__PYX_ERR(0, 2262, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2262, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_where);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2262, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_actual, __pyx_v_predicted, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2262, __pyx_L1_error)</span>
      __pyx_t_8 = NULL;
      __pyx_t_9 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
          __pyx_t_9 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[4] = {__pyx_t_8, __pyx_t_5, __pyx_int_0, __pyx_int_1};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_9, 3+__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2262, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      __pyx_v_residuals = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2263</span>:         else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2264</span>:             raise ValueError("Either predicted class labels or predict_proba "</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2264,0,<span class='error_goto'>__PYX_ERR(0, 2264, __pyx_L1_error)</span>)
    /*else*/ {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__57, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2264, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 2264, __pyx_L1_error)</span>
    }
    __pyx_L7:;
/* … */
  __pyx_tuple__57 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Either_predicted_class_labels_or);<span class='error_goto'> if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 2264, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__57);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__57);
</pre><pre class="cython line score-0">&#xA0;<span class="">2265</span>:                              "must be provided for classification tasks.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2266</span>:     else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2267</span>:         raise ValueError("The task_type must be 'regression', 'binary', or"</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(2267,0,<span class='error_goto'>__PYX_ERR(0, 2267, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__58, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2267, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2267, __pyx_L1_error)</span>
  }
  __pyx_L3:;
/* … */
  __pyx_tuple__58 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_The_task_type_must_be_regression);<span class='error_goto'> if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 2267, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__58);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__58);
</pre><pre class="cython line score-0">&#xA0;<span class="">2268</span>:                          " 'multiclass'.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2269</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2270</span>:     return residuals</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2270,0,<span class='error_goto'>__PYX_ERR(0, 2270, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_residuals);
  __pyx_r = __pyx_v_residuals;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2271</span>: </pre>
<pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2272</span>: def infer_sankey_columns(data: DataFrame,</pre>
<pre class='cython code score-78 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_51infer_sankey_columns(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_50infer_sankey_columns, "\n    Infers source, target, and value columns for a Sankey diagram \n    from a DataFrame.\n\n    Parameters\n    ----------\n    data : pd.DataFrame\n        The DataFrame from which to infer the source, target, and value columns.\n\n    Returns\n    -------\n    Tuple[List[str], List[str], List[int]]\n        Three lists containing the names of the source nodes, target nodes,\n        and the values of the flows between them, respectively.\n\n    Raises\n    ------\n    ValueError\n        If the DataFrame does not contain at least two columns for source and target,\n        and an additional column for value.\n\n    Examples\n    --------\n    &gt;&gt;&gt; import pandas as pd\n    &gt;&gt;&gt; from gofast.tools.mathex import infer_sankey_columns\n    &gt;&gt;&gt; df = pd.DataFrame({\n    ...     'from': ['A', 'A', 'B', 'B'],\n    ...     'to': ['X', 'Y', 'X', 'Y'],\n    ...     'amount': [10, 20, 30, 40]\n    ... })\n    &gt;&gt;&gt; sources, targets, values = infer_sankey_columns(df)\n    &gt;&gt;&gt; print(sources, targets, values)\n    ['A', 'A', 'B', 'B'] ['X', 'Y', 'X', 'Y'] [10, 20, 30, 40]\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_51infer_sankey_columns = {"infer_sankey_columns", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_51infer_sankey_columns, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_50infer_sankey_columns};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_51infer_sankey_columns(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("infer_sankey_columns (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2272, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "infer_sankey_columns") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2272, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_data = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("infer_sankey_columns", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2272, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.infer_sankey_columns", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_50infer_sankey_columns(__pyx_self, __pyx_v_data);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_50infer_sankey_columns(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data) {
  PyObject *__pyx_v_numeric_cols = NULL;
  PyObject *__pyx_v_value_col = NULL;
  PyObject *__pyx_v_source_col = NULL;
  PyObject *__pyx_v_target_col = NULL;
  PyObject *__pyx_v_col = NULL;
  PyObject *__pyx_v_sources = NULL;
  PyObject *__pyx_v_targets = NULL;
  PyObject *__pyx_v_values = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__59)
  <span class='trace'>__Pyx_TraceCall</span>("infer_sankey_columns", __pyx_f[0], 2272, 0, <span class='error_goto'>__PYX_ERR(0, 2272, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.infer_sankey_columns", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numeric_cols);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value_col);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_source_col);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_target_col);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_col);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sources);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_targets);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_values);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__189 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_data, __pyx_n_s_numeric_cols, __pyx_n_s_value_col, __pyx_n_s_source_col, __pyx_n_s_target_col, __pyx_n_s_col, __pyx_n_s_sources, __pyx_n_s_targets, __pyx_n_s_values);<span class='error_goto'> if (unlikely(!__pyx_tuple__189)) __PYX_ERR(0, 2272, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__189);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__189);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2272,0,<span class='error_goto'>__PYX_ERR(0, 2272, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2272, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_data, __pyx_n_s_DataFrame) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2272, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_return, __pyx_kp_s_Tuple_List_str_List_str_List_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2272, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_51infer_sankey_columns, 0, __pyx_n_s_infer_sankey_columns, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__59));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2272, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_infer_sankey_columns, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2272, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__59 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__189, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_infer_sankey_columns, 2272, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__59)) __PYX_ERR(0, 2272, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2273</span>:   ) -&gt; Tuple[List[str], List[str], List[int]]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2274</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2275</span>:     Infers source, target, and value columns for a Sankey diagram</pre>
<pre class="cython line score-0">&#xA0;<span class="">2276</span>:     from a DataFrame.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2277</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2278</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2279</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2280</span>:     data : pd.DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">2281</span>:         The DataFrame from which to infer the source, target, and value columns.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2282</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2283</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2284</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2285</span>:     Tuple[List[str], List[str], List[int]]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2286</span>:         Three lists containing the names of the source nodes, target nodes,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2287</span>:         and the values of the flows between them, respectively.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2288</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2289</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">2290</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2291</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2292</span>:         If the DataFrame does not contain at least two columns for source and target,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2293</span>:         and an additional column for value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2294</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2295</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2296</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2297</span>:     &gt;&gt;&gt; import pandas as pd</pre>
<pre class="cython line score-0">&#xA0;<span class="">2298</span>:     &gt;&gt;&gt; from gofast.tools.mathex import infer_sankey_columns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2299</span>:     &gt;&gt;&gt; df = pd.DataFrame({</pre>
<pre class="cython line score-0">&#xA0;<span class="">2300</span>:     ...     'from': ['A', 'A', 'B', 'B'],</pre>
<pre class="cython line score-0">&#xA0;<span class="">2301</span>:     ...     'to': ['X', 'Y', 'X', 'Y'],</pre>
<pre class="cython line score-0">&#xA0;<span class="">2302</span>:     ...     'amount': [10, 20, 30, 40]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2303</span>:     ... })</pre>
<pre class="cython line score-0">&#xA0;<span class="">2304</span>:     &gt;&gt;&gt; sources, targets, values = infer_sankey_columns(df)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2305</span>:     &gt;&gt;&gt; print(sources, targets, values)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2306</span>:     ['A', 'A', 'B', 'B'] ['X', 'Y', 'X', 'Y'] [10, 20, 30, 40]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2307</span>:     """</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2308</span>:     if len(data.columns) &lt; 3:</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(2308,0,<span class='error_goto'>__PYX_ERR(0, 2308, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2308, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (__pyx_t_2 &lt; 3);
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2309</span>:         raise ValueError("DataFrame must have at least three columns:"</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2309,0,<span class='error_goto'>__PYX_ERR(0, 2309, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__60, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2309, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2309, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__60 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_DataFrame_must_have_at_least_thr);<span class='error_goto'> if (unlikely(!__pyx_tuple__60)) __PYX_ERR(0, 2309, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__60);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__60);
</pre><pre class="cython line score-0">&#xA0;<span class="">2310</span>:                          " source, target, and value")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2311</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2312</span>:     # Heuristic: The source is often the first column, the target is the second,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2313</span>:     # and the value is the third or the one with numeric data</pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2314</span>:     numeric_cols = data.select_dtypes([float, int]).columns</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(2314,0,<span class='error_goto'>__PYX_ERR(0, 2314, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_select_dtypes);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)(&amp;PyFloat_Type));
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)(&amp;PyFloat_Type));
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, 0, ((PyObject *)(&amp;PyFloat_Type)))) <span class='error_goto'>__PYX_ERR(0, 2314, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)(&amp;PyInt_Type));
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)(&amp;PyInt_Type));
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_5, 1, ((PyObject *)(&amp;PyInt_Type)))) <span class='error_goto'>__PYX_ERR(0, 2314, __pyx_L1_error)</span>;
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2314, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_numeric_cols = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2315</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2316</span>:     if len(numeric_cols) == 0:</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2316,0,<span class='error_goto'>__PYX_ERR(0, 2316, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_numeric_cols);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2316, __pyx_L1_error)</span>
  __pyx_t_3 = (__pyx_t_2 == 0);
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2317</span>:         raise ValueError(</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2317,0,<span class='error_goto'>__PYX_ERR(0, 2317, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__61, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_4, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2317, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__61 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_DataFrame_does_not_contain_any_n);<span class='error_goto'> if (unlikely(!__pyx_tuple__61)) __PYX_ERR(0, 2317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__61);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__61);
</pre><pre class="cython line score-0">&#xA0;<span class="">2318</span>:             "DataFrame does not contain any numeric columns for values")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2319</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2320</span>:     # Choose the first numeric column as the value by default</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2321</span>:     value_col = numeric_cols[0]</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2321,0,<span class='error_goto'>__PYX_ERR(0, 2321, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_numeric_cols, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v_value_col = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2322</span>:     source_col = data.columns[0]</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2322,0,<span class='error_goto'>__PYX_ERR(0, 2322, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_source_col = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2323</span>:     target_col = data.columns[1]</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2323,0,<span class='error_goto'>__PYX_ERR(0, 2323, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_target_col = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2324</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2325</span>:     # If there's a 'source' or 'target' column, prefer that</pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2326</span>:     for col in data.columns:</pre>
<pre class='cython code score-52 '>  <span class='trace'>__Pyx_TraceLine</span>(2326,0,<span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
    __pyx_t_1 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_2 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_2 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2326, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2326, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2326, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_2 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2326, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_8(__pyx_t_1);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_col, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(2326,0,<span class='error_goto'>__PYX_ERR(0, 2326, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2327</span>:         if 'source' in col.lower():</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(2327,0,<span class='error_goto'>__PYX_ERR(0, 2327, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_col, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2327, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2327, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_u_source, __pyx_t_4, Py_EQ)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2327, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_3) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2328</span>:             source_col = col</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2328,0,<span class='error_goto'>__PYX_ERR(0, 2328, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_col);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_source_col, __pyx_v_col);
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2329</span>:         elif 'target' in col.lower():</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(2329,0,<span class='error_goto'>__PYX_ERR(0, 2329, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_col, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2329, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2329, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_u_target, __pyx_t_4, Py_EQ)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2329, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (__pyx_t_3) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2330</span>:             target_col = col</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2330,0,<span class='error_goto'>__PYX_ERR(0, 2330, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_col);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_target_col, __pyx_v_col);
</pre><pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2331</span>:         elif 'value' in col.lower() or 'amount' in col.lower() or 'count' in col.lower():</pre>
<pre class='cython code score-57 '>    <span class='trace'>__Pyx_TraceLine</span>(2331,0,<span class='error_goto'>__PYX_ERR(0, 2331, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_col, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2331, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_u_value, __pyx_t_4, Py_EQ)); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2331, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (!__pyx_t_9) {
    } else {
      __pyx_t_3 = __pyx_t_9;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_col, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2331, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_u_amount, __pyx_t_4, Py_EQ)); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2331, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (!__pyx_t_9) {
    } else {
      __pyx_t_3 = __pyx_t_9;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_col, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2331, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2331, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_n_u_count, __pyx_t_4, Py_EQ)); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2331, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_3 = __pyx_t_9;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_3) {
/* … */
    }
    __pyx_L7:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2332</span>:             value_col = col</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(2332,0,<span class='error_goto'>__PYX_ERR(0, 2332, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_col);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_value_col, __pyx_v_col);
</pre><pre class="cython line score-0">&#xA0;<span class="">2333</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2334</span>:     # Check for consistency in data</pre>
<pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2335</span>:     if data[source_col].isnull().any() or data[target_col].isnull().any():</pre>
<pre class='cython code score-78 '>  <span class='trace'>__Pyx_TraceLine</span>(2335,0,<span class='error_goto'>__PYX_ERR(0, 2335, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_data, __pyx_v_source_col);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2335, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_isnull);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2335, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2335, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2335, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!__pyx_t_9) {
  } else {
    __pyx_t_3 = __pyx_t_9;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_data, __pyx_v_target_col);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2335, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_isnull);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2335, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2335, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2335, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2335, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_t_9;
  __pyx_L13_bool_binop_done:;
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2336</span>:         raise ValueError("Source and Target columns must not contain null values")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2336,0,<span class='error_goto'>__PYX_ERR(0, 2336, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__62, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2336, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2336, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__62 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Source_and_Target_columns_must_n);<span class='error_goto'> if (unlikely(!__pyx_tuple__62)) __PYX_ERR(0, 2336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__62);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__62);
</pre><pre class="cython line score-0">&#xA0;<span class="">2337</span>: </pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2338</span>:     if data[value_col].isnull().any():</pre>
<pre class='cython code score-39 '>  <span class='trace'>__Pyx_TraceLine</span>(2338,0,<span class='error_goto'>__PYX_ERR(0, 2338, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_data, __pyx_v_value_col);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_isnull);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 2338, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2338, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2338, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2339</span>:         raise ValueError("Value column must not contain null values")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2339,0,<span class='error_goto'>__PYX_ERR(0, 2339, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__63, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2339, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2339, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__63 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Value_column_must_not_contain_nu);<span class='error_goto'> if (unlikely(!__pyx_tuple__63)) __PYX_ERR(0, 2339, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__63);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__63);
</pre><pre class="cython line score-0">&#xA0;<span class="">2340</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2341</span>:     # Extract the columns and return</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2342</span>:     sources = data[source_col].tolist()</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(2342,0,<span class='error_goto'>__PYX_ERR(0, 2342, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_data, __pyx_v_source_col);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_tolist);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2342, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_v_sources = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2343</span>:     targets = data[target_col].tolist()</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(2343,0,<span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_data, __pyx_v_target_col);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_tolist);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2343, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_v_targets = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2344</span>:     values = data[value_col].tolist()</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(2344,0,<span class='error_goto'>__PYX_ERR(0, 2344, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_data, __pyx_v_value_col);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_tolist);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2344, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_v_values = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2345</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2346</span>:     return sources, targets, values</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(2346,0,<span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2346, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_sources);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_sources);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_sources)) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_targets);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_targets);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_targets)) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_values);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_v_values)) <span class='error_goto'>__PYX_ERR(0, 2346, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2347</span>: </pre>
<pre class="cython line score-81" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2348</span>: def compute_sunburst_data(</pre>
<pre class='cython code score-81 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_53compute_sunburst_data(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_52compute_sunburst_data, "\n    Computes the data structure required for generating a sunburst chart from\n    a DataFrame.\n    \n    The function allows for automatic inference of hierarchy and values if \n    not explicitly provided. This is useful for visualizing hierarchical \n    datasets where the relationship between parent and child categories is \n    important.\n\n    The sunburst chart provides insights into the proportion of categories at \n    multiple levels of the hierarchy through their area size. It is especially \n    useful in identifying patterns and contributions of various parts to the \n    whole in a dataset.\n\n    Parameters\n    ----------\n    df : pd.DataFrame\n        The DataFrame containing the hierarchical data. It should have columns \n        representing levels of the hierarchy and optionally a column for values.\n    hierarchy : Optional[List[str]], optional\n        The list of columns that represent the hierarchy levels, ordered from \n        top to bottom. If not provided, the function assumes all columns except\n        the last one are part of the hierarchy.\n    value_column : Optional[str], optional\n        The name of the column that contains the values for each leaf node in \n        the sunburst chart. If not provided, the function will count the \n        occurrences of the lowest hierarchy level and use this count as the \n        value for each leaf node.\n\n    Returns\n    -------\n    List[Dict[str, str]]\n        A list of dictionaries where each dictionary represents a node in the\n        sunburst chart with 'name', 'value', and 'parent' keys.\n\n    Examples\n    --------\n    &gt;&gt;&gt; df = pd.DataFrame({\n    ...     'Category': ['A', 'A', 'B', 'B'],\n    ...     'Subcategory': ['A1', 'A2', 'B1', 'B2']\n    ... })\n    &gt;&gt;&gt; data = compute_sunburst_data(df)\n    &gt;&gt;&gt; print(data)\n    [\n        {'name': 'A', 'value': 2, 'parent': ''},\n        {'name': 'B', 'value': 2, 'parent': ''},\n        {'name': 'A1', 'value': 1, 'parent': 'A'},\n   ""     {'name': 'A2', 'value': 1, 'parent': 'A'},\n        {'name': 'B1', 'value': 1, 'parent': 'B'},\n        {'name': 'B2', 'value': 1, 'parent': 'B'}\n    ]\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_53compute_sunburst_data = {"compute_sunburst_data", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_53compute_sunburst_data, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_52compute_sunburst_data};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_53compute_sunburst_data(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_hierarchy = 0;
  PyObject *__pyx_v_value_column = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_sunburst_data (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_hierarchy,&amp;__pyx_n_s_value_column,0};
  PyObject* values[3] = {0,0,0};
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_52compute_sunburst_data(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_hierarchy, PyObject *__pyx_v_value_column) {
  PyObject *__pyx_v_df_full = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_df_level = NULL;
  PyObject *__pyx_v_sunburst_data = NULL;
  PyObject *__pyx_v_seen = NULL;
  Py_ssize_t __pyx_8genexpr6__pyx_v_i;
  CYTHON_UNUSED PyObject *__pyx_8genexpr6__pyx_v__ = NULL;
  PyObject *__pyx_8genexpr6__pyx_v_row = NULL;
  PyObject *__pyx_8genexpr7__pyx_v_x = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__64)
  <span class='trace'>__Pyx_TraceCall</span>("compute_sunburst_data", __pyx_f[0], 2348, 0, <span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_hierarchy);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value_column);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_sunburst_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_df_full);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_df_level);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sunburst_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_seen);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr6__pyx_v__);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr6__pyx_v_row);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr7__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_hierarchy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value_column);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__190 = <span class='py_c_api'>PyTuple_Pack</span>(12, __pyx_n_s_data, __pyx_n_s_hierarchy, __pyx_n_s_value_column, __pyx_n_s_df_full, __pyx_n_s_i, __pyx_n_s_df_level, __pyx_n_s_sunburst_data, __pyx_n_s_seen, __pyx_n_s_i, __pyx_n_s__177, __pyx_n_s_row, __pyx_n_s_x);<span class='error_goto'> if (unlikely(!__pyx_tuple__190)) __PYX_ERR(0, 2348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__190);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__190);
  __pyx_codeobj__64 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__190, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_sunburst_data, 2348, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__64)) __PYX_ERR(0, 2348, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2348,0,<span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_data, __pyx_n_s_DataFrame) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_hierarchy, __pyx_kp_s_Optional_List_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_value_column, __pyx_kp_s_Optional_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_kp_s_List_Dict_str_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_53compute_sunburst_data, 0, __pyx_n_s_compute_sunburst_data, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__64));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_tuple__191);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_4, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_sunburst_data, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__191 = <span class='py_c_api'>PyTuple_Pack</span>(2, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__191)) __PYX_ERR(0, 2348, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__191);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__191);
</pre><pre class="cython line score-0">&#xA0;<span class="">2349</span>:     data: DataFrame,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2350</span>:     hierarchy: Optional[List[str]] = None,</pre>
<pre class='cython code score-2 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2351</span>:     value_column: Optional[str] = None</pre>
<pre class='cython code score-51 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_hierarchy);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_value_column);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_sunburst_data") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_data = values[0];
    __pyx_v_hierarchy = values[1];
    __pyx_v_value_column = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_sunburst_data", 0, 1, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2348, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_sunburst_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_52compute_sunburst_data(__pyx_self, __pyx_v_data, __pyx_v_hierarchy, __pyx_v_value_column);
</pre><pre class="cython line score-0">&#xA0;<span class="">2352</span>:   ) -&gt; List[Dict[str, str]]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2353</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2354</span>:     Computes the data structure required for generating a sunburst chart from</pre>
<pre class="cython line score-0">&#xA0;<span class="">2355</span>:     a DataFrame.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2356</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2357</span>:     The function allows for automatic inference of hierarchy and values if</pre>
<pre class="cython line score-0">&#xA0;<span class="">2358</span>:     not explicitly provided. This is useful for visualizing hierarchical</pre>
<pre class="cython line score-0">&#xA0;<span class="">2359</span>:     datasets where the relationship between parent and child categories is</pre>
<pre class="cython line score-0">&#xA0;<span class="">2360</span>:     important.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2361</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2362</span>:     The sunburst chart provides insights into the proportion of categories at</pre>
<pre class="cython line score-0">&#xA0;<span class="">2363</span>:     multiple levels of the hierarchy through their area size. It is especially</pre>
<pre class="cython line score-0">&#xA0;<span class="">2364</span>:     useful in identifying patterns and contributions of various parts to the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2365</span>:     whole in a dataset.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2366</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2367</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2368</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2369</span>:     df : pd.DataFrame</pre>
<pre class="cython line score-0">&#xA0;<span class="">2370</span>:         The DataFrame containing the hierarchical data. It should have columns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2371</span>:         representing levels of the hierarchy and optionally a column for values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2372</span>:     hierarchy : Optional[List[str]], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2373</span>:         The list of columns that represent the hierarchy levels, ordered from</pre>
<pre class="cython line score-0">&#xA0;<span class="">2374</span>:         top to bottom. If not provided, the function assumes all columns except</pre>
<pre class="cython line score-0">&#xA0;<span class="">2375</span>:         the last one are part of the hierarchy.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2376</span>:     value_column : Optional[str], optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2377</span>:         The name of the column that contains the values for each leaf node in</pre>
<pre class="cython line score-0">&#xA0;<span class="">2378</span>:         the sunburst chart. If not provided, the function will count the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2379</span>:         occurrences of the lowest hierarchy level and use this count as the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2380</span>:         value for each leaf node.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2381</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2382</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2383</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2384</span>:     List[Dict[str, str]]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2385</span>:         A list of dictionaries where each dictionary represents a node in the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2386</span>:         sunburst chart with 'name', 'value', and 'parent' keys.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2387</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2388</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2389</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2390</span>:     &gt;&gt;&gt; df = pd.DataFrame({</pre>
<pre class="cython line score-0">&#xA0;<span class="">2391</span>:     ...     'Category': ['A', 'A', 'B', 'B'],</pre>
<pre class="cython line score-0">&#xA0;<span class="">2392</span>:     ...     'Subcategory': ['A1', 'A2', 'B1', 'B2']</pre>
<pre class="cython line score-0">&#xA0;<span class="">2393</span>:     ... })</pre>
<pre class="cython line score-0">&#xA0;<span class="">2394</span>:     &gt;&gt;&gt; data = compute_sunburst_data(df)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2395</span>:     &gt;&gt;&gt; print(data)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2396</span>:     [</pre>
<pre class="cython line score-0">&#xA0;<span class="">2397</span>:         {'name': 'A', 'value': 2, 'parent': ''},</pre>
<pre class="cython line score-0">&#xA0;<span class="">2398</span>:         {'name': 'B', 'value': 2, 'parent': ''},</pre>
<pre class="cython line score-0">&#xA0;<span class="">2399</span>:         {'name': 'A1', 'value': 1, 'parent': 'A'},</pre>
<pre class="cython line score-0">&#xA0;<span class="">2400</span>:         {'name': 'A2', 'value': 1, 'parent': 'A'},</pre>
<pre class="cython line score-0">&#xA0;<span class="">2401</span>:         {'name': 'B1', 'value': 1, 'parent': 'B'},</pre>
<pre class="cython line score-0">&#xA0;<span class="">2402</span>:         {'name': 'B2', 'value': 1, 'parent': 'B'}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2403</span>:     ]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2404</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2405</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2406</span>:     is_frame ( data, df_only =True , raise_exception=True )</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(2406,0,<span class='error_goto'>__PYX_ERR(0, 2406, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_is_frame);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_data);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_data)) <span class='error_goto'>__PYX_ERR(0, 2406, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_df_only, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2406, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_raise_exception, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2406, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2406, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2407</span>:     # If hierarchy is not provided, infer it from all columns except the last</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2408</span>:     if hierarchy is None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(2408,0,<span class='error_goto'>__PYX_ERR(0, 2408, __pyx_L1_error)</span>)
  __pyx_t_5 = (__pyx_v_hierarchy == Py_None);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2409</span>:         hierarchy = data.columns[:-1].tolist()</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(2409,0,<span class='error_goto'>__PYX_ERR(0, 2409, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2409, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_3, 0, -1L, NULL, NULL, &amp;__pyx_slice__16, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2409, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_tolist);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2409, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2409, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_hierarchy, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2410</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2411</span>:     # If value_column is not provided, create a 'Count' column and use</pre>
<pre class="cython line score-0">&#xA0;<span class="">2412</span>:     # it as the value column</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2413</span>:     if value_column is None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(2413,0,<span class='error_goto'>__PYX_ERR(0, 2413, __pyx_L1_error)</span>)
  __pyx_t_5 = (__pyx_v_value_column == Py_None);
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2414</span>:         data = data.assign(Count=1)</pre>
<pre class='cython code score-14 '>    <span class='trace'>__Pyx_TraceLine</span>(2414,0,<span class='error_goto'>__PYX_ERR(0, 2414, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_assign);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2414, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2414, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_Count, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2414, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_empty_tuple, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2414, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2415</span>:         value_column = 'Count'</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2415,0,<span class='error_goto'>__PYX_ERR(0, 2415, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_Count);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_value_column, __pyx_n_u_Count);
</pre><pre class="cython line score-0">&#xA0;<span class="">2416</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2417</span>:     # Compute the values for each level of the hierarchy</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2418</span>:     df_full = data.copy()</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(2418,0,<span class='error_goto'>__PYX_ERR(0, 2418, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_data, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2418, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2418, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_df_full = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2419</span>:     for i in range(1, len(hierarchy)):</pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(2419,0,<span class='error_goto'>__PYX_ERR(0, 2419, __pyx_L1_error)</span>)
  __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_hierarchy);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2419, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2419, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2419, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 2419, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2419, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2419, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2419, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2419, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2419, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_7 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2419, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2419, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2419, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_7 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2419, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2419, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_8(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 2419, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(2419,0,<span class='error_goto'>__PYX_ERR(0, 2419, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2420</span>:         df_level = df_full[hierarchy[:i+1] + [value_column]].groupby(</pre>
<pre class='cython code score-26 '>    <span class='trace'>__Pyx_TraceLine</span>(2420,0,<span class='error_goto'>__PYX_ERR(0, 2420, __pyx_L1_error)</span>)
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2420, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_hierarchy, 0, 0, NULL, &amp;__pyx_t_9, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2420, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2420, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value_column);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value_column);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_value_column)) <span class='error_goto'>__PYX_ERR(0, 2420, __pyx_L1_error)</span>;
    __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_10, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2420, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_df_full, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2420, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_groupby);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2420, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2421</span>:             hierarchy[:i+1]).sum().reset_index()</pre>
<pre class='cython code score-55 '>    <span class='trace'>__Pyx_TraceLine</span>(2421,0,<span class='error_goto'>__PYX_ERR(0, 2421, __pyx_L1_error)</span>)
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2421, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_hierarchy, 0, 0, NULL, &amp;__pyx_t_9, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2421, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_10};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2420, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2421, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2421, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_reset_index);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2421, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2421, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_df_level, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2422</span>:         df_full = pd.concat([df_full, df_level], ignore_index=True)</pre>
<pre class='cython code score-36 '>    <span class='trace'>__Pyx_TraceLine</span>(2422,0,<span class='error_goto'>__PYX_ERR(0, 2422, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2422, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_concat);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2422, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2422, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df_full);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_df_full);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_df_full)) <span class='error_goto'>__PYX_ERR(0, 2422, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df_level);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_df_level);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_df_level)) <span class='error_goto'>__PYX_ERR(0, 2422, __pyx_L1_error)</span>;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2422, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2422, __pyx_L1_error)</span>;
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2422, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_ignore_index, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2422, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2422, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_df_full, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2423</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2424</span>:     df_full = df_full.drop_duplicates(subset=hierarchy).reset_index(drop=True)</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(2424,0,<span class='error_goto'>__PYX_ERR(0, 2424, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df_full, __pyx_n_s_drop_duplicates);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_subset, __pyx_v_hierarchy) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2424, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_reset_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_drop, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2424, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2424, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_df_full, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2425</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2426</span>:     # Generate the sunburst data structure</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2427</span>:     sunburst_data = [</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2427,0,<span class='error_goto'>__PYX_ERR(0, 2427, __pyx_L1_error)</span>)
  { /* enter inner scope */
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2427, __pyx_L10_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2428</span>:         {"name": row[hierarchy[-1]],</pre>
<pre class='cython code score-13 '>        <span class='trace'>__Pyx_TraceLine</span>(2428,0,<span class='error_goto'>__PYX_ERR(0, 2428, __pyx_L10_error)</span>)
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2428, __pyx_L10_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_hierarchy, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2428, __pyx_L10_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_8genexpr6__pyx_v_row, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2428, __pyx_L10_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_name_2, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2428, __pyx_L10_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2429</span>:          "value": row[value_column],</pre>
<pre class='cython code score-8 '>        <span class='trace'>__Pyx_TraceLine</span>(2429,0,<span class='error_goto'>__PYX_ERR(0, 2429, __pyx_L10_error)</span>)
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_8genexpr6__pyx_v_row, __pyx_v_value_column);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2429, __pyx_L10_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_value, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2428, __pyx_L10_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2430</span>:          "parent": row[hierarchy[-2]] if i &gt; 0 else ""}</pre>
<pre class='cython code score-15 '>        <span class='trace'>__Pyx_TraceLine</span>(2430,0,<span class='error_goto'>__PYX_ERR(0, 2430, __pyx_L10_error)</span>)
        __pyx_t_5 = (__pyx_8genexpr6__pyx_v_i &gt; 0);
        if (__pyx_t_5) {
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_hierarchy, -2L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2430, __pyx_L10_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_8genexpr6__pyx_v_row, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2430, __pyx_L10_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_4 = __pyx_t_10;
          __pyx_t_10 = 0;
        } else {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__65);
          __pyx_t_4 = __pyx_kp_u__65;
        }
        if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_parent, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2428, __pyx_L10_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 2427, __pyx_L10_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2431</span>:         for i in range(len(hierarchy))</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(2431,0,<span class='error_goto'>__PYX_ERR(0, 2431, __pyx_L10_error)</span>)
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_hierarchy);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 2431, __pyx_L10_error)</span>
    __pyx_t_12 = __pyx_t_7;
    for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
      __pyx_8genexpr6__pyx_v_i = __pyx_t_13;
</pre><pre class="cython line score-138" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2432</span>:         for _, row in df_full[hierarchy[:i+1] + [value_column]].iterrows()</pre>
<pre class='cython code score-138 '>      <span class='trace'>__Pyx_TraceLine</span>(2432,0,<span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_hierarchy, 0, (__pyx_8genexpr6__pyx_v_i + 1), NULL, NULL, NULL, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value_column);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value_column);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_value_column)) <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>;
      __pyx_t_11 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_df_full, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_iterrows);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_11))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_11);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_11, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_11, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
        __pyx_t_11 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        __pyx_t_14 = 0;
        __pyx_t_8 = NULL;
      } else {
        __pyx_t_14 = -1; __pyx_t_11 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      for (;;) {
        if (likely(!__pyx_t_8)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_11))) {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_11);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>
              #endif
              if (__pyx_t_14 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_11, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_14++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>
            #else
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_11, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            #endif
          } else {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_11);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>
              #endif
              if (__pyx_t_14 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_11, __pyx_t_14); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_14++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>
            #else
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_11, __pyx_t_14); __pyx_t_14++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            #endif
          }
        } else {
          __pyx_t_2 = __pyx_t_8(__pyx_t_11);
          if (unlikely(!__pyx_t_2)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        }
        if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
          PyObject* sequence = __pyx_t_2;
          Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
          if (unlikely(size != 2)) {
            if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
            else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
            <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
            __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
            __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
          } else {
            __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
            __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
          }
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          #else
          __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        } else {
          Py_ssize_t index = -1;
          __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2432, __pyx_L10_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_10);
          index = 0; __pyx_t_4 = __pyx_t_15(__pyx_t_10); if (unlikely(!__pyx_t_4)) goto __pyx_L15_unpacking_failed;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          index = 1; __pyx_t_1 = __pyx_t_15(__pyx_t_10); if (unlikely(!__pyx_t_1)) goto __pyx_L15_unpacking_failed;
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_10), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>
          __pyx_t_15 = NULL;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          goto __pyx_L16_unpacking_done;
          __pyx_L15_unpacking_failed:;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          __pyx_t_15 = NULL;
          if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
          <span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>
          __pyx_L16_unpacking_done:;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr6__pyx_v__, __pyx_t_4);
        __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr6__pyx_v_row, __pyx_t_1);
        __pyx_t_1 = 0;
/* … */
        <span class='trace'>__Pyx_TraceLine</span>(2432,0,<span class='error_goto'>__PYX_ERR(0, 2432, __pyx_L10_error)</span>)
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr6__pyx_v__); __pyx_8genexpr6__pyx_v__ = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr6__pyx_v_row); __pyx_8genexpr6__pyx_v_row = 0;
    goto __pyx_L18_exit_scope;
    __pyx_L10_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr6__pyx_v__); __pyx_8genexpr6__pyx_v__ = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr6__pyx_v_row); __pyx_8genexpr6__pyx_v_row = 0;
    goto __pyx_L1_error;
    __pyx_L18_exit_scope:;
  } /* exit inner scope */
  __pyx_v_sunburst_data = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2433</span>:     ]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2434</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2435</span>:     # Remove duplicates, preserve order, and return</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2436</span>:     seen = set()</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2436,0,<span class='error_goto'>__PYX_ERR(0, 2436, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PySet_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2436, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_seen = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2437</span>:     return [x for x in sunburst_data if not (</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(2437,0,<span class='error_goto'>__PYX_ERR(0, 2437, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  { /* enter inner scope */
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2437, __pyx_L21_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_11 = __pyx_v_sunburst_data; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
    __pyx_t_7 = 0;
    for (;;) {
      {
        Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_11);
        #if !CYTHON_ASSUME_SAFE_MACROS
        if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2437, __pyx_L21_error)</span>
        #endif
        if (__pyx_t_7 &gt;= __pyx_temp) break;
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_11, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2437, __pyx_L21_error)</span>
      #else
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_11, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2437, __pyx_L21_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      #endif
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr7__pyx_v_x, __pyx_t_2);
      __pyx_t_2 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(2437,0,<span class='error_goto'>__PYX_ERR(0, 2437, __pyx_L21_error)</span>)
      __pyx_t_16 = (!__pyx_t_5);
      if (__pyx_t_16) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_8genexpr7__pyx_v_x))) <span class='error_goto'>__PYX_ERR(0, 2437, __pyx_L21_error)</span>
      }
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr7__pyx_v_x); __pyx_8genexpr7__pyx_v_x = 0;
    goto __pyx_L28_exit_scope;
    __pyx_L21_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr7__pyx_v_x); __pyx_8genexpr7__pyx_v_x = 0;
    goto __pyx_L1_error;
    __pyx_L28_exit_scope:;
  } /* exit inner scope */
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2438</span>:         tuple(x.items()) in seen or seen.add(tuple(x.items())))]</pre>
<pre class='cython code score-47 '>      <span class='trace'>__Pyx_TraceLine</span>(2438,0,<span class='error_goto'>__PYX_ERR(0, 2438, __pyx_L21_error)</span>)
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_8genexpr7__pyx_v_x, __pyx_n_s_items);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2438, __pyx_L21_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_10 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, NULL};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2438, __pyx_L21_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      }
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2438, __pyx_L21_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_16 = (<span class='pyx_c_api'>__Pyx_PySet_ContainsTF</span>(__pyx_t_4, __pyx_v_seen, Py_EQ)); if (unlikely((__pyx_t_16 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2438, __pyx_L21_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (!__pyx_t_16) {
      } else {
        __pyx_t_5 = __pyx_t_16;
        goto __pyx_L25_bool_binop_done;
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_8genexpr7__pyx_v_x, __pyx_n_s_items);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2438, __pyx_L21_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_10 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, NULL};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 2438, __pyx_L21_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2438, __pyx_L21_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_17 = <span class='py_c_api'>PySet_Add</span>(__pyx_v_seen, __pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_17 == ((int)-1))) __PYX_ERR(0, 2438, __pyx_L21_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_16 = (__pyx_t_17 != 0);
      __pyx_t_5 = __pyx_t_16;
      __pyx_L25_bool_binop_done:;
</pre><pre class="cython line score-0">&#xA0;<span class="">2439</span>: </pre>
<pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2440</span>: def compute_effort_yield(</pre>
<pre class='cython code score-62 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_55compute_effort_yield(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_54compute_effort_yield, "\n    Compute effort and yield values from importance data for use in \n    ABC analysis or similar plots.\n\n    This function takes an array of importance measures (e.g., weights, scores) \n    and computes the cumulative effort and corresponding yield. \n    The effort is the cumulative percentage of items when sorted by importance,\n    and the yield is the cumulative sum of importance\n    measures, also as a percentage of the total sum.\n\n    Parameters\n    ----------\n    d : np.ndarray\n        1D array of importance measures for each item or feature.\n    reverse : bool, optional\n        If True (default), sort the data in descending order \n        (highest importance first).\n        If False, sort in ascending order (lowest importance first).\n    \n    Returns\n    -------\n    effort : np.ndarray\n        The cumulative percentage of items considered, sorted by importance.\n    yield_ : np.ndarray\n        The cumulative sum of importance measures, normalized to the total \n        sum to represent the yield as a proportion of the total importance.\n\n    Example\n    -------\n    &gt;&gt;&gt; import numpy as np \n    &gt;&gt;&gt; from gofast.tools.mathex import compute_effort_yield\n    &gt;&gt;&gt; importances = np.array([0.1, 0.4, 0.3, 0.2])\n    &gt;&gt;&gt; effort, yield_ = compute_effort_yield(importances)\n    &gt;&gt;&gt; print(effort)\n    &gt;&gt;&gt; print(yield_)\n    \n    This would output:\n    &gt;&gt;&gt; effort\n    [0.25 0.5  0.75 1.  ]\n    &gt;&gt;&gt; yield_\n    [0.4  0.7  0.9  1.  ]\n\n    Note that the effort is simply the proportion of total items, \n    and the yield is the\n    cumulative proportion of the sum of importances.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_55compute_effort_yield = {"compute_effort_yield", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_55compute_effort_yield, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_54compute_effort_yield};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_55compute_effort_yield(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_d = 0;
  PyObject *__pyx_v_reverse = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_effort_yield (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_d,&amp;__pyx_n_s_reverse,0};
  PyObject* values[2] = {0,0};
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_54compute_effort_yield(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_d, PyObject *__pyx_v_reverse) {
  PyObject *__pyx_v_sorted_indices = NULL;
  PyObject *__pyx_v_sorted_data = NULL;
  PyObject *__pyx_v_cumulative_data = NULL;
  PyObject *__pyx_v_yield_ = NULL;
  PyObject *__pyx_v_effort = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__66)
  <span class='trace'>__Pyx_TraceCall</span>("compute_effort_yield", __pyx_f[0], 2440, 0, <span class='error_goto'>__PYX_ERR(0, 2440, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_d);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_effort_yield", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sorted_indices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_sorted_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cumulative_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yield_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_effort);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_d);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__192 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_d, __pyx_n_s_reverse, __pyx_n_s_sorted_indices, __pyx_n_s_sorted_data, __pyx_n_s_cumulative_data, __pyx_n_s_yield, __pyx_n_s_effort);<span class='error_goto'> if (unlikely(!__pyx_tuple__192)) __PYX_ERR(0, 2440, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__192);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__192);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2440,0,<span class='error_goto'>__PYX_ERR(0, 2440, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2440, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_d, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2440, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_reverse, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2440, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_return, __pyx_kp_s_Tuple_ArrayLike_np_ndarray) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2440, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_55compute_effort_yield, 0, __pyx_n_s_compute_effort_yield, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__66));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2440, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__169);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_effort_yield, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2440, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__66 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__192, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_effort_yield, 2440, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__66)) __PYX_ERR(0, 2440, __pyx_L1_error)</span>
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2441</span>:         d: ArrayLike,  reverse: bool = True</pre>
<pre class='cython code score-38 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_d)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2440, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_reverse);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2440, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_effort_yield") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2440, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_d = values[0];
    __pyx_v_reverse = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_effort_yield", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2440, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_effort_yield", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_54compute_effort_yield(__pyx_self, __pyx_v_d, __pyx_v_reverse);
</pre><pre class="cython line score-0">&#xA0;<span class="">2442</span>:         ) -&gt; Tuple[ArrayLike, np.ndarray]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2443</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2444</span>:     Compute effort and yield values from importance data for use in</pre>
<pre class="cython line score-0">&#xA0;<span class="">2445</span>:     ABC analysis or similar plots.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2446</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2447</span>:     This function takes an array of importance measures (e.g., weights, scores)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2448</span>:     and computes the cumulative effort and corresponding yield.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2449</span>:     The effort is the cumulative percentage of items when sorted by importance,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2450</span>:     and the yield is the cumulative sum of importance</pre>
<pre class="cython line score-0">&#xA0;<span class="">2451</span>:     measures, also as a percentage of the total sum.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2452</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2453</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2454</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2455</span>:     d : np.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2456</span>:         1D array of importance measures for each item or feature.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2457</span>:     reverse : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2458</span>:         If True (default), sort the data in descending order</pre>
<pre class="cython line score-0">&#xA0;<span class="">2459</span>:         (highest importance first).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2460</span>:         If False, sort in ascending order (lowest importance first).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2461</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2462</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2463</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2464</span>:     effort : np.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2465</span>:         The cumulative percentage of items considered, sorted by importance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2466</span>:     yield_ : np.ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2467</span>:         The cumulative sum of importance measures, normalized to the total</pre>
<pre class="cython line score-0">&#xA0;<span class="">2468</span>:         sum to represent the yield as a proportion of the total importance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2469</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2470</span>:     Example</pre>
<pre class="cython line score-0">&#xA0;<span class="">2471</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2472</span>:     &gt;&gt;&gt; import numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">2473</span>:     &gt;&gt;&gt; from gofast.tools.mathex import compute_effort_yield</pre>
<pre class="cython line score-0">&#xA0;<span class="">2474</span>:     &gt;&gt;&gt; importances = np.array([0.1, 0.4, 0.3, 0.2])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2475</span>:     &gt;&gt;&gt; effort, yield_ = compute_effort_yield(importances)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2476</span>:     &gt;&gt;&gt; print(effort)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2477</span>:     &gt;&gt;&gt; print(yield_)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2478</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2479</span>:     This would output:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2480</span>:     &gt;&gt;&gt; effort</pre>
<pre class="cython line score-0">&#xA0;<span class="">2481</span>:     [0.25 0.5  0.75 1.  ]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2482</span>:     &gt;&gt;&gt; yield_</pre>
<pre class="cython line score-0">&#xA0;<span class="">2483</span>:     [0.4  0.7  0.9  1.  ]</pre>
<pre class="cython line score-0">&#xA0;<span class="">2484</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2485</span>:     Note that the effort is simply the proportion of total items,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2486</span>:     and the yield is the</pre>
<pre class="cython line score-0">&#xA0;<span class="">2487</span>:     cumulative proportion of the sum of importances.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2488</span>:     """</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2489</span>:     d = np.array (d)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(2489,0,<span class='error_goto'>__PYX_ERR(0, 2489, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_d};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2489, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_d, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2490</span>:     # Validate input data</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2491</span>:     if not isinstance(d, np.ndarray) or d.ndim != 1:</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(2491,0,<span class='error_goto'>__PYX_ERR(0, 2491, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_d, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 2491, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = (!__pyx_t_6);
  if (!__pyx_t_7) {
  } else {
    __pyx_t_5 = __pyx_t_7;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_d, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolNeObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2491, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = __pyx_t_7;
  __pyx_L4_bool_binop_done:;
  if (unlikely(__pyx_t_5)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2492</span>:         raise ValueError("Input data must be a one-dimensional numpy array.")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2492,0,<span class='error_goto'>__PYX_ERR(0, 2492, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__67, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2492, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2492, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__67 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Input_data_must_be_a_one_dimensi);<span class='error_goto'> if (unlikely(!__pyx_tuple__67)) __PYX_ERR(0, 2492, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__67);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__67);
</pre><pre class="cython line score-0">&#xA0;<span class="">2493</span>: </pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2494</span>:     if not np.issubdtype(d.dtype, np.number):</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(2494,0,<span class='error_goto'>__PYX_ERR(0, 2494, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_issubdtype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_d, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_number);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_8, __pyx_t_1, __pyx_t_9};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2494, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2494, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = (!__pyx_t_5);
  if (unlikely(__pyx_t_7)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2495</span>:         raise ValueError("Input data must be a numpy array of numerical type.")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2495,0,<span class='error_goto'>__PYX_ERR(0, 2495, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__68, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2495, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2495, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__68 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Input_data_must_be_a_numpy_array);<span class='error_goto'> if (unlikely(!__pyx_tuple__68)) __PYX_ERR(0, 2495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__68);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__68);
</pre><pre class="cython line score-0">&#xA0;<span class="">2496</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2497</span>:     # Sort the data by importance</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2498</span>:     sorted_indices = np.argsort(d)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(2498,0,<span class='error_goto'>__PYX_ERR(0, 2498, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2498, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_argsort);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2498, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_d};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2498, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  __pyx_v_sorted_indices = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2499</span>:     sorted_data = d[sorted_indices]</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2499,0,<span class='error_goto'>__PYX_ERR(0, 2499, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_d, __pyx_v_sorted_indices);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2499, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_sorted_data = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2500</span>:     if reverse:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2500,0,<span class='error_goto'>__PYX_ERR(0, 2500, __pyx_L1_error)</span>)
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_reverse); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2500, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2501</span>:         sorted_data = sorted_data[::-1]</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(2501,0,<span class='error_goto'>__PYX_ERR(0, 2501, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_sorted_data, __pyx_slice__69);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2501, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_sorted_data, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
  __pyx_slice__69 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_int_neg_1);<span class='error_goto'> if (unlikely(!__pyx_slice__69)) __PYX_ERR(0, 2501, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__69);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__69);
</pre><pre class="cython line score-0">&#xA0;<span class="">2502</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2503</span>:     # Calculate cumulative sum of the sorted data</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2504</span>:     cumulative_data = np.cumsum(sorted_data)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(2504,0,<span class='error_goto'>__PYX_ERR(0, 2504, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2504, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2504, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_v_sorted_data};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2504, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_cumulative_data = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2505</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2506</span>:     # Normalize cumulative sum to get yield as a proportion of the total sum</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2507</span>:     yield_ = cumulative_data / cumulative_data[-1]</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2507,0,<span class='error_goto'>__PYX_ERR(0, 2507, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_cumulative_data, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_cumulative_data, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_yield_ = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2508</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2509</span>:     # Calculate the effort as the proportion of total number of items</pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2510</span>:     effort = np.arange(1, d.size + 1) / d.size</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(2510,0,<span class='error_goto'>__PYX_ERR(0, 2510, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2510, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2510, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_d, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2510, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2510, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_int_1, __pyx_t_1};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2510, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_d, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2510, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2510, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_effort = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2511</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2512</span>:     return effort, yield_</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(2512,0,<span class='error_goto'>__PYX_ERR(0, 2512, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2512, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_effort);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_effort);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_effort)) <span class='error_goto'>__PYX_ERR(0, 2512, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_yield_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_yield_);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_yield_)) <span class='error_goto'>__PYX_ERR(0, 2512, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2513</span>: </pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2514</span>: def make_mxs(</pre>
<pre class='cython code score-55 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_57make_mxs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_56make_mxs, "\n    Compute the similarity between labels in arrays true y and predicted yt. \n    \n    Function transform yt based on these similarities, and create a new \n    array `ymxs` by filling NaN values in y with corresponding labels from \n    transformed yt. Handles NaN values in `yt` based on the `mode` and\n    `include_nan` parameters. See more in [1]_\n\n    Parameters\n    ----------\n    y : array-like\n        The target array containing valid labels and potentially NaN values.\n    yt : array-like\n        The array containing predicted labels from KMeans.\n    threshold : float, optional\n        The threshold for considering a label in `y` as similar to a label \n        in `yt` (default is 0.5).\n    star_mxs : bool, optional\n        If True, appends `trailer` to labels in `yt` when similarity is found \n        (default is True).\n    return_ymx : bool, optional\n        If True, returns the mixed array `ymx`; otherwise, returns a \n        dictionary of label similarities (default is False).\n    mode : str, optional\n        \"strict\" or \"soft\" handling of NaN values in `yt` (default is \"strict\").\n    include_nan : bool, optional\n        If True and `mode` is \"soft\", includes NaN values in `yt` during \n        similarity computation (default is False).\n    trailer : str, optional\n        The string to append to labels in `yt` when `star_mxs` is True\n        (default is \"*\").\n\n    Returns\n    -------\n    array or dict\n        Mixed array `ymx` if `return_ymx` is True; otherwise, a \n        dictionary representing similarities of labels in `y` and `yt`.\n\n    Raises\n    ------\n    ValueError\n        If `yt` contains NaN values in \"strict\" mode or if `trailer` \n        is a number.\n        \n    References\n    -----------\n    [1] Kouadio, K.L, Liu R., Liu J., A mixture Learning Strategy for predicting \n        permeability coefficient K (2024). Computers and Geosciences, doi:XXXXX \n\n    Examples\n    --------\n    &gt;&gt;&gt; y ="" np.array([1, 2, np.nan, 4])\n    &gt;&gt;&gt; yt = np.array([1, 2, 3, 4])\n    &gt;&gt;&gt; make_mxs(y, yt, threshold=0.5, star_mxs=True, return_ymx=True, trailer=\"#\")\n    array([1, 2, '3#', '44#'])\n\n    &gt;&gt;&gt; make_mxs(y, yt, threshold=1.5, star_mxs=False, return_ymx=False, mode=\"soft\")\n    {1: True, 2: True, np.nan: False, 4: True}\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_57make_mxs = {"make_mxs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_57make_mxs, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_56make_mxs};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_57make_mxs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_v_yt = 0;
  PyObject *__pyx_v_threshold = 0;
  PyObject *__pyx_v_star_mxs = 0;
  PyObject *__pyx_v_return_ymxs = 0;
  PyObject *__pyx_v_mode = 0;
  PyObject *__pyx_v_include_nan = 0;
  PyObject *__pyx_v_trailer = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("make_mxs (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y,&amp;__pyx_n_s_yt,&amp;__pyx_n_s_threshold,&amp;__pyx_n_s_star_mxs,&amp;__pyx_n_s_return_ymxs,&amp;__pyx_n_s_mode,&amp;__pyx_n_s_include_nan,&amp;__pyx_n_s_trailer,0};
  PyObject* values[8] = {0,0,0,0,0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_5)));
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_56make_mxs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y, PyObject *__pyx_v_yt, PyObject *__pyx_v_threshold, PyObject *__pyx_v_star_mxs, PyObject *__pyx_v_return_ymxs, PyObject *__pyx_v_mode, PyObject *__pyx_v_include_nan, PyObject *__pyx_v_trailer) {
  PyObject *__pyx_v_pairwise_distances = NULL;
  PyObject *__pyx_v_yt_transformed = NULL;
  PyObject *__pyx_v_similarities = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_label_y = NULL;
  PyObject *__pyx_v_include_label = NULL;
  PyObject *__pyx_v_similarity = NULL;
  PyObject *__pyx_v_label_yt_trailer = NULL;
  PyObject *__pyx_v_ymxs = NULL;
  PyObject *__pyx_8genexpr8__pyx_v_label = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__71)
  <span class='trace'>__Pyx_TraceCall</span>("make_mxs", __pyx_f[0], 2514, 0, <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.make_mxs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pairwise_distances);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yt_transformed);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_similarities);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_label_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_include_label);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_similarity);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_label_yt_trailer);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ymxs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr8__pyx_v_label);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__193 = <span class='py_c_api'>PyTuple_Pack</span>(18, __pyx_n_s_y, __pyx_n_s_yt, __pyx_n_s_threshold, __pyx_n_s_star_mxs, __pyx_n_s_return_ymxs, __pyx_n_s_mode, __pyx_n_s_include_nan, __pyx_n_s_trailer, __pyx_n_s_pairwise_distances, __pyx_n_s_yt_transformed, __pyx_n_s_similarities, __pyx_n_s_i, __pyx_n_s_label_y, __pyx_n_s_include_label, __pyx_n_s_similarity, __pyx_n_s_label_yt_trailer, __pyx_n_s_ymxs, __pyx_n_s_label);<span class='error_goto'> if (unlikely(!__pyx_tuple__193)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__193);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__193);
  __pyx_codeobj__71 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 0, 18, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__193, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_make_mxs, 2514, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__71)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2514,0,<span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_57make_mxs, 0, __pyx_n_s_make_mxs, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__71));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__194);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_make_mxs, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__194 = <span class='py_c_api'>PyTuple_Pack</span>(6, ((PyObject*)__pyx_float_0_5), ((PyObject *)Py_True), ((PyObject *)Py_False), ((PyObject*)__pyx_n_u_strict), ((PyObject *)Py_False), ((PyObject*)__pyx_kp_u__70));<span class='error_goto'> if (unlikely(!__pyx_tuple__194)) __PYX_ERR(0, 2514, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__194);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__194);
</pre><pre class="cython line score-0">&#xA0;<span class="">2515</span>:     y,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2516</span>:     yt,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2517</span>:     threshold=0.5,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2518</span>:     star_mxs=True,</pre>
<pre class='cython code score-2 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2519</span>:     return_ymxs=False,</pre>
<pre class='cython code score-4 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_strict)));
</pre><pre class="cython line score-0">&#xA0;<span class="">2520</span>:     mode="strict",</pre>
<pre class="cython line score-120" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2521</span>:     include_nan=False,</pre>
<pre class='cython code score-120 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_kp_u__70)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_yt)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_mxs", 0, 2, 8, 1); <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_threshold);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_star_mxs);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_ymxs);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_mode);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_include_nan);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_trailer);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "make_mxs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y = values[0];
    __pyx_v_yt = values[1];
    __pyx_v_threshold = values[2];
    __pyx_v_star_mxs = values[3];
    __pyx_v_return_ymxs = values[4];
    __pyx_v_mode = values[5];
    __pyx_v_include_nan = values[6];
    __pyx_v_trailer = values[7];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("make_mxs", 0, 2, 8, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2514, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.make_mxs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_56make_mxs(__pyx_self, __pyx_v_y, __pyx_v_yt, __pyx_v_threshold, __pyx_v_star_mxs, __pyx_v_return_ymxs, __pyx_v_mode, __pyx_v_include_nan, __pyx_v_trailer);
</pre><pre class="cython line score-0">&#xA0;<span class="">2522</span>:     trailer="*"</pre>
<pre class="cython line score-0">&#xA0;<span class="">2523</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">2524</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2525</span>:     Compute the similarity between labels in arrays true y and predicted yt.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2526</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2527</span>:     Function transform yt based on these similarities, and create a new</pre>
<pre class="cython line score-0">&#xA0;<span class="">2528</span>:     array `ymxs` by filling NaN values in y with corresponding labels from</pre>
<pre class="cython line score-0">&#xA0;<span class="">2529</span>:     transformed yt. Handles NaN values in `yt` based on the `mode` and</pre>
<pre class="cython line score-0">&#xA0;<span class="">2530</span>:     `include_nan` parameters. See more in [1]_</pre>
<pre class="cython line score-0">&#xA0;<span class="">2531</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2532</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2533</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2534</span>:     y : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">2535</span>:         The target array containing valid labels and potentially NaN values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2536</span>:     yt : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">2537</span>:         The array containing predicted labels from KMeans.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2538</span>:     threshold : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2539</span>:         The threshold for considering a label in `y` as similar to a label</pre>
<pre class="cython line score-0">&#xA0;<span class="">2540</span>:         in `yt` (default is 0.5).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2541</span>:     star_mxs : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2542</span>:         If True, appends `trailer` to labels in `yt` when similarity is found</pre>
<pre class="cython line score-0">&#xA0;<span class="">2543</span>:         (default is True).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2544</span>:     return_ymx : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2545</span>:         If True, returns the mixed array `ymx`; otherwise, returns a</pre>
<pre class="cython line score-0">&#xA0;<span class="">2546</span>:         dictionary of label similarities (default is False).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2547</span>:     mode : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2548</span>:         "strict" or "soft" handling of NaN values in `yt` (default is "strict").</pre>
<pre class="cython line score-0">&#xA0;<span class="">2549</span>:     include_nan : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2550</span>:         If True and `mode` is "soft", includes NaN values in `yt` during</pre>
<pre class="cython line score-0">&#xA0;<span class="">2551</span>:         similarity computation (default is False).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2552</span>:     trailer : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2553</span>:         The string to append to labels in `yt` when `star_mxs` is True</pre>
<pre class="cython line score-0">&#xA0;<span class="">2554</span>:         (default is "*").</pre>
<pre class="cython line score-0">&#xA0;<span class="">2555</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2556</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2557</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2558</span>:     array or dict</pre>
<pre class="cython line score-0">&#xA0;<span class="">2559</span>:         Mixed array `ymx` if `return_ymx` is True; otherwise, a</pre>
<pre class="cython line score-0">&#xA0;<span class="">2560</span>:         dictionary representing similarities of labels in `y` and `yt`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2561</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2562</span>:     Raises</pre>
<pre class="cython line score-0">&#xA0;<span class="">2563</span>:     ------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2564</span>:     ValueError</pre>
<pre class="cython line score-0">&#xA0;<span class="">2565</span>:         If `yt` contains NaN values in "strict" mode or if `trailer`</pre>
<pre class="cython line score-0">&#xA0;<span class="">2566</span>:         is a number.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2567</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2568</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">2569</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2570</span>:     [1] Kouadio, K.L, Liu R., Liu J., A mixture Learning Strategy for predicting</pre>
<pre class="cython line score-0">&#xA0;<span class="">2571</span>:         permeability coefficient K (2024). Computers and Geosciences, doi:XXXXX</pre>
<pre class="cython line score-0">&#xA0;<span class="">2572</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2573</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2574</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2575</span>:     &gt;&gt;&gt; y = np.array([1, 2, np.nan, 4])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2576</span>:     &gt;&gt;&gt; yt = np.array([1, 2, 3, 4])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2577</span>:     &gt;&gt;&gt; make_mxs(y, yt, threshold=0.5, star_mxs=True, return_ymx=True, trailer="#")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2578</span>:     array([1, 2, '3#', '44#'])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2579</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2580</span>:     &gt;&gt;&gt; make_mxs(y, yt, threshold=1.5, star_mxs=False, return_ymx=False, mode="soft")</pre>
<pre class="cython line score-0">&#xA0;<span class="">2581</span>:     {1: True, 2: True, np.nan: False, 4: True}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2582</span>:     """</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2583</span>:     from sklearn.metrics import pairwise_distances</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(2583,0,<span class='error_goto'>__PYX_ERR(0, 2583, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_pairwise_distances);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_pairwise_distances);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_pairwise_distances)) <span class='error_goto'>__PYX_ERR(0, 2583, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sklearn_metrics, __pyx_t_1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_pairwise_distances);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2583, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_pairwise_distances = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2584</span>: </pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2585</span>:     if not isinstance(trailer, str) or trailer.isdigit():</pre>
<pre class='cython code score-24 '>  <span class='trace'>__Pyx_TraceLine</span>(2585,0,<span class='error_goto'>__PYX_ERR(0, 2585, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_trailer); 
  __pyx_t_5 = (!__pyx_t_4);
  if (!__pyx_t_5) {
  } else {
    __pyx_t_3 = __pyx_t_5;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_trailer, __pyx_n_s_isdigit);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2585, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2585, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2585, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __pyx_t_5;
  __pyx_L4_bool_binop_done:;
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2586</span>:         raise ValueError("trailer must be a non-numeric string.")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2586,0,<span class='error_goto'>__PYX_ERR(0, 2586, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__72, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2586, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2586, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__72 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_trailer_must_be_a_non_numeric_st);<span class='error_goto'> if (unlikely(!__pyx_tuple__72)) __PYX_ERR(0, 2586, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__72);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__72);
</pre><pre class="cython line score-0">&#xA0;<span class="">2587</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2588</span>:     if mode == "strict" and np.isnan(yt).any():</pre>
<pre class='cython code score-41 '>  <span class='trace'>__Pyx_TraceLine</span>(2588,0,<span class='error_goto'>__PYX_ERR(0, 2588, __pyx_L1_error)</span>)
  __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_mode, __pyx_n_u_strict, Py_EQ)); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2588, __pyx_L1_error)</span>
  if (__pyx_t_5) {
  } else {
    __pyx_t_3 = __pyx_t_5;
    goto __pyx_L7_bool_binop_done;
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_v_yt};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2588, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_any);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2588, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2588, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2588, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __pyx_t_5;
  __pyx_L7_bool_binop_done:;
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2589</span>:         raise ValueError("yt should not contain NaN values in 'strict' mode.")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(2589,0,<span class='error_goto'>__PYX_ERR(0, 2589, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__73, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2589, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 2589, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__73 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_yt_should_not_contain_NaN_values);<span class='error_goto'> if (unlikely(!__pyx_tuple__73)) __PYX_ERR(0, 2589, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__73);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__73);
</pre><pre class="cython line score-0">&#xA0;<span class="">2590</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2591</span>:     # Appending trailer to yt if star_mxs is True</pre>
<pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2592</span>:     yt_transformed = np.array([f"{label}{trailer}" for label in yt]</pre>
<pre class='cython code score-87 '>    <span class='trace'>__Pyx_TraceLine</span>(2592,0,<span class='error_goto'>__PYX_ERR(0, 2592, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2592, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2592, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    { /* enter inner scope */
      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2592, __pyx_L11_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_yt)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_yt)) {
        __pyx_t_9 = __pyx_v_yt; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        __pyx_t_10 = 0;
        __pyx_t_11 = NULL;
      } else {
        __pyx_t_10 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_yt);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2592, __pyx_L11_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2592, __pyx_L11_error)</span>
      }
      for (;;) {
        if (likely(!__pyx_t_11)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_9);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2592, __pyx_L11_error)</span>
              #endif
              if (__pyx_t_10 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_12 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2592, __pyx_L11_error)</span>
            #else
            __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_9, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2592, __pyx_L11_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
            #endif
          } else {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_9);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2592, __pyx_L11_error)</span>
              #endif
              if (__pyx_t_10 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_12 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2592, __pyx_L11_error)</span>
            #else
            __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_9, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2592, __pyx_L11_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
            #endif
          }
        } else {
          __pyx_t_12 = __pyx_t_11(__pyx_t_9);
          if (unlikely(!__pyx_t_12)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 2592, __pyx_L11_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr8__pyx_v_label, __pyx_t_12);
        __pyx_t_12 = 0;
        __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_8genexpr8__pyx_v_label, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2592, __pyx_L11_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_trailer, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 2592, __pyx_L11_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_12, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 2592, __pyx_L11_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_14))) <span class='error_goto'>__PYX_ERR(0, 2592, __pyx_L11_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr8__pyx_v_label); __pyx_8genexpr8__pyx_v_label = 0;
      goto __pyx_L15_exit_scope;
      __pyx_L11_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr8__pyx_v_label); __pyx_8genexpr8__pyx_v_label = 0;
      goto __pyx_L1_error;
      __pyx_L15_exit_scope:;
    } /* exit inner scope */
    __pyx_t_9 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_1};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 2592, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_t_2 = __pyx_t_8;
    __pyx_t_8 = 0;
  } else {
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2593</span>:                               ) if star_mxs else yt.copy()</pre>
<pre class='cython code score-18 '>  <span class='trace'>__Pyx_TraceLine</span>(2593,0,<span class='error_goto'>__PYX_ERR(0, 2593, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_star_mxs); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2593, __pyx_L1_error)</span>
  if (__pyx_t_3) {
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(2593,0,<span class='error_goto'>__PYX_ERR(0, 2593, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_yt, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2593, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 2593, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_t_2 = __pyx_t_8;
    __pyx_t_8 = 0;
  }
  __pyx_v_yt_transformed = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2594</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2595</span>:     # Computing similarities and transforming yt</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2596</span>:     similarities = {}</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2596,0,<span class='error_goto'>__PYX_ERR(0, 2596, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2596, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_v_similarities = ((PyObject*)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2597</span>:     for i, label_y in enumerate(y):</pre>
<pre class='cython code score-56 '>  <span class='trace'>__Pyx_TraceLine</span>(2597,0,<span class='error_goto'>__PYX_ERR(0, 2597, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_2 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_y)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_y)) {
    __pyx_t_8 = __pyx_v_y; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
    __pyx_t_10 = 0;
    __pyx_t_11 = NULL;
  } else {
    __pyx_t_10 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2597, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_11)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_8);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2597, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_10 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2597, __pyx_L1_error)</span>
        #else
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_8, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2597, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_8);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2597, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_10 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2597, __pyx_L1_error)</span>
        #else
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_8, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2597, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        #endif
      }
    } else {
      __pyx_t_6 = __pyx_t_11(__pyx_t_8);
      if (unlikely(!__pyx_t_6)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 2597, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_label_y, __pyx_t_6);
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_2);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_2, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2597, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2);
    __pyx_t_2 = __pyx_t_6;
    __pyx_t_6 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(2597,0,<span class='error_goto'>__PYX_ERR(0, 2597, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2598</span>:         include_label = not np.isnan(label_y) or (include_nan and mode == "soft")</pre>
<pre class='cython code score-35 '>    <span class='trace'>__Pyx_TraceLine</span>(2598,0,<span class='error_goto'>__PYX_ERR(0, 2598, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2598, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 2598, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_14))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_14);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_14, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_v_label_y};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_14, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2598, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2598, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = (!__pyx_t_3);
    if (!__pyx_t_5) {
    } else {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2598, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = __pyx_t_1;
      __pyx_t_1 = 0;
      goto __pyx_L18_bool_binop_done;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_include_nan); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2598, __pyx_L1_error)</span>
    if (__pyx_t_5) {
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_include_nan);
      __pyx_t_6 = __pyx_v_include_nan;
      goto __pyx_L18_bool_binop_done;
    }
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_mode, __pyx_n_u_soft, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2598, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_6 = __pyx_t_1;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_L18_bool_binop_done:;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_include_label, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2599</span>:         if include_label:</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(2599,0,<span class='error_goto'>__PYX_ERR(0, 2599, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_include_label); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2599, __pyx_L1_error)</span>
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2600</span>:             similarity = pairwise_distances([[label_y]], [[yt[i]]])[0][0] &lt;= threshold</pre>
<pre class='cython code score-61 '>      <span class='trace'>__Pyx_TraceLine</span>(2600,0,<span class='error_goto'>__PYX_ERR(0, 2600, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2600, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_label_y);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_label_y);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_label_y)) <span class='error_goto'>__PYX_ERR(0, 2600, __pyx_L1_error)</span>;
      __pyx_t_14 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 2600, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_14, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2600, __pyx_L1_error)</span>;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_yt, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2600, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2600, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2600, __pyx_L1_error)</span>;
      __pyx_t_1 = 0;
      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2600, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 2600, __pyx_L1_error)</span>;
      __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pairwise_distances);
      __pyx_t_9 = __pyx_v_pairwise_distances; __pyx_t_13 = NULL;
      __pyx_t_7 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_13)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
          __pyx_t_7 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_13, __pyx_t_14, __pyx_t_1};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 2600, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2600, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_9, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2600, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_v_threshold, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2600, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_similarity, __pyx_t_9);
      __pyx_t_9 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2601</span>:             similarities[label_y] = similarity</pre>
<pre class='cython code score-5 '>      <span class='trace'>__Pyx_TraceLine</span>(2601,0,<span class='error_goto'>__PYX_ERR(0, 2601, __pyx_L1_error)</span>)
      if (unlikely((<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_similarities, __pyx_v_label_y, __pyx_v_similarity) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2601, __pyx_L1_error)</span>
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2602</span>:             if similarity and star_mxs:</pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(2602,0,<span class='error_goto'>__PYX_ERR(0, 2602, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_similarity); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2602, __pyx_L1_error)</span>
      if (__pyx_t_3) {
      } else {
        __pyx_t_5 = __pyx_t_3;
        goto __pyx_L23_bool_binop_done;
      }
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_star_mxs); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2602, __pyx_L1_error)</span>
      __pyx_t_5 = __pyx_t_3;
      __pyx_L23_bool_binop_done:;
      if (__pyx_t_5) {
/* … */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">2603</span>:                 # Transform similar labels in yt</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2604</span>:                 label_yt_trailer = f"{yt[i]}{trailer}"</pre>
<pre class='cython code score-12 '>        <span class='trace'>__Pyx_TraceLine</span>(2604,0,<span class='error_goto'>__PYX_ERR(0, 2604, __pyx_L1_error)</span>)
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_yt, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2604, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_9, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2604, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_trailer, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2604, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_6, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2604, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_label_yt_trailer, ((PyObject*)__pyx_t_1));
        __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2605</span>:                 yt_transformed[yt_transformed == label_yt_trailer</pre>
<pre class='cython code score-12 '>        <span class='trace'>__Pyx_TraceLine</span>(2605,0,<span class='error_goto'>__PYX_ERR(0, 2605, __pyx_L1_error)</span>)
        __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_yt_transformed, __pyx_v_label_yt_trailer, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2605, __pyx_L1_error)</span>
        if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_yt_transformed, __pyx_t_1, __pyx_t_9) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2605, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2606</span>:                                ] = f"{label_y}{label_yt_trailer}"</pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(2606,0,<span class='error_goto'>__PYX_ERR(0, 2606, __pyx_L1_error)</span>)
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_label_y, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2606, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_1, __pyx_v_label_yt_trailer);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2606, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2607</span>:     # Filling NaN positions in y with corresponding labels from transformed yt</pre>
<pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2608</span>:     ymxs = np.where(np.isnan(y), yt_transformed, y)</pre>
<pre class='cython code score-39 '>  <span class='trace'>__Pyx_TraceLine</span>(2608,0,<span class='error_goto'>__PYX_ERR(0, 2608, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 2608, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_where);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2608, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2608, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2608, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_y};
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 2608, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_6, __pyx_t_8, __pyx_v_yt_transformed, __pyx_v_y};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_7, 3+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2608, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  __pyx_v_ymxs = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2609</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2610</span>:     return ymxs if return_ymxs else similarities</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(2610,0,<span class='error_goto'>__PYX_ERR(0, 2610, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_ymxs); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2610, __pyx_L1_error)</span>
  if (__pyx_t_5) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ymxs);
    __pyx_t_2 = __pyx_v_ymxs;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_similarities);
    __pyx_t_2 = __pyx_v_similarities;
  }
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2611</span>: </pre>
<pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2612</span>: def label_importance(y, include_nan=False):</pre>
<pre class='cython code score-86 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_59label_importance(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_58label_importance, "\n    Compute the importance of each label in a target array.\n\n    This function calculates the frequency of each unique label \n    in the target array `y`. Importance is defined as the proportion of \n    occurrences of each label in the array.\n\n    Parameters\n    ----------\n    y : array-like\n        The target array containing labels.\n    include_nan : bool, optional\n        If True, includes NaN values in the calculation, otherwise \n        excludes them (default is False).\n\n    Returns\n    -------\n    dict\n        A dictionary with labels as keys and their corresponding \n        importance as values.\n\n    Notes\n    -----\n    The mathematical formulation for the importance of a label `l` is given by:\n\n    .. math::\n\n        I(l) = \\frac{\\text{{count of }} l \\text{{ in }} y}{\\text{{total number of elements in }} y}\n\n    Examples\n    --------\n    &gt;&gt;&gt; y = np.array([1, 2, 2, 3, 3, 3, np.nan])\n    &gt;&gt;&gt; label_importance(y)\n    {1.0: 0.16666666666666666, 2.0: 0.3333333333333333, 3.0: 0.5}\n\n    &gt;&gt;&gt; label_importance(y, include_nan=True)\n    {1.0: 0.14285714285714285, 2.0: 0.2857142857142857, 3.0: 0.42857142857142855,\n     nan: 0.14285714285714285}\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_59label_importance = {"label_importance", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_59label_importance, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_58label_importance};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_59label_importance(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_v_include_nan = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("label_importance (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y,&amp;__pyx_n_s_include_nan,0};
  PyObject* values[2] = {0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2612, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_include_nan);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2612, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "label_importance") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2612, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_y = values[0];
    __pyx_v_include_nan = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("label_importance", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2612, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.label_importance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_58label_importance(__pyx_self, __pyx_v_y, __pyx_v_include_nan);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_58label_importance(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y, PyObject *__pyx_v_include_nan) {
  PyObject *__pyx_v_labels = NULL;
  PyObject *__pyx_v_counts = NULL;
  PyObject *__pyx_v_total = NULL;
  PyObject *__pyx_8genexpr9__pyx_v_label = NULL;
  PyObject *__pyx_8genexpr9__pyx_v_count = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__74)
  <span class='trace'>__Pyx_TraceCall</span>("label_importance", __pyx_f[0], 2612, 0, <span class='error_goto'>__PYX_ERR(0, 2612, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.label_importance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_labels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_counts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_total);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr9__pyx_v_label);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr9__pyx_v_count);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__195 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_y, __pyx_n_s_include_nan, __pyx_n_s_labels, __pyx_n_s_counts, __pyx_n_s_total, __pyx_n_s_label, __pyx_n_s_count);<span class='error_goto'> if (unlikely(!__pyx_tuple__195)) __PYX_ERR(0, 2612, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__195);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__195);
  __pyx_codeobj__74 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__195, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_label_importance, 2612, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__74)) __PYX_ERR(0, 2612, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2612,0,<span class='error_goto'>__PYX_ERR(0, 2612, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_59label_importance, 0, __pyx_n_s_label_importance, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__74));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2612, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__196);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_label_importance, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2612, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__196 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__196)) __PYX_ERR(0, 2612, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__196);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__196);
</pre><pre class="cython line score-0">&#xA0;<span class="">2613</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2614</span>:     Compute the importance of each label in a target array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2615</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2616</span>:     This function calculates the frequency of each unique label</pre>
<pre class="cython line score-0">&#xA0;<span class="">2617</span>:     in the target array `y`. Importance is defined as the proportion of</pre>
<pre class="cython line score-0">&#xA0;<span class="">2618</span>:     occurrences of each label in the array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2619</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2620</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2621</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2622</span>:     y : array-like</pre>
<pre class="cython line score-0">&#xA0;<span class="">2623</span>:         The target array containing labels.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2624</span>:     include_nan : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2625</span>:         If True, includes NaN values in the calculation, otherwise</pre>
<pre class="cython line score-0">&#xA0;<span class="">2626</span>:         excludes them (default is False).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2627</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2628</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2629</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2630</span>:     dict</pre>
<pre class="cython line score-0">&#xA0;<span class="">2631</span>:         A dictionary with labels as keys and their corresponding</pre>
<pre class="cython line score-0">&#xA0;<span class="">2632</span>:         importance as values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2633</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2634</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">2635</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">2636</span>:     The mathematical formulation for the importance of a label `l` is given by:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2637</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2638</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">2639</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2640</span>:         I(l) = \\frac{\\text{{count of }} l \\text{{ in }} y}{\\text{{total number of elements in }} y}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2641</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2642</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2643</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2644</span>:     &gt;&gt;&gt; y = np.array([1, 2, 2, 3, 3, 3, np.nan])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2645</span>:     &gt;&gt;&gt; label_importance(y)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2646</span>:     {1.0: 0.16666666666666666, 2.0: 0.3333333333333333, 3.0: 0.5}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2647</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2648</span>:     &gt;&gt;&gt; label_importance(y, include_nan=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2649</span>:     {1.0: 0.14285714285714285, 2.0: 0.2857142857142857, 3.0: 0.42857142857142855,</pre>
<pre class="cython line score-0">&#xA0;<span class="">2650</span>:      nan: 0.14285714285714285}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2651</span>:     """</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2652</span>:     y = np.array ( y )</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(2652,0,<span class='error_goto'>__PYX_ERR(0, 2652, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2652, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_y};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2652, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2653</span>:     if not include_nan:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2653,0,<span class='error_goto'>__PYX_ERR(0, 2653, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_include_nan); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2653, __pyx_L1_error)</span>
  __pyx_t_6 = (!__pyx_t_5);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2654</span>:         y = y[~np.isnan(y)]</pre>
<pre class='cython code score-29 '>    <span class='trace'>__Pyx_TraceLine</span>(2654,0,<span class='error_goto'>__PYX_ERR(0, 2654, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2654, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2654, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_y};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2654, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Invert</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2654, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2654, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2655</span>:     labels, counts = np.unique(y, return_counts=True)</pre>
<pre class='cython code score-71 '>  <span class='trace'>__Pyx_TraceLine</span>(2655,0,<span class='error_goto'>__PYX_ERR(0, 2655, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_unique);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 2655, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return_counts, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2655, __pyx_L1_error)</span>
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2655, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7))) {
    PyObject* sequence = __pyx_t_7;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 2655, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);
    index = 0; __pyx_t_3 = __pyx_t_8(__pyx_t_2); if (unlikely(!__pyx_t_3)) goto __pyx_L4_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_1 = __pyx_t_8(__pyx_t_2); if (unlikely(!__pyx_t_1)) goto __pyx_L4_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_2), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2655, __pyx_L1_error)</span>
    __pyx_t_8 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L5_unpacking_done;
    __pyx_L4_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_8 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 2655, __pyx_L1_error)</span>
    __pyx_L5_unpacking_done:;
  }
  __pyx_v_labels = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_counts = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2656</span>:     total = counts.sum()</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(2656,0,<span class='error_goto'>__PYX_ERR(0, 2656, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_counts, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2656, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 2656, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_v_total = __pyx_t_7;
  __pyx_t_7 = 0;
</pre><pre class="cython line score-129" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2657</span>:     return {label: count / total for label, count in zip(labels, counts)}</pre>
<pre class='cython code score-129 '>  <span class='trace'>__Pyx_TraceLine</span>(2657,0,<span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  { /* enter inner scope */
    __pyx_t_7 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 2657, __pyx_L8_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2657, __pyx_L8_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_labels);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_labels);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_labels)) <span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L8_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_counts);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_counts);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_counts)) <span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L8_error)</span>;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2657, __pyx_L8_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
      __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_9 = 0;
      __pyx_t_10 = NULL;
    } else {
      __pyx_t_9 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2657, __pyx_L8_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 2657, __pyx_L8_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    for (;;) {
      if (likely(!__pyx_t_10)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L8_error)</span>
            #endif
            if (__pyx_t_9 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_9++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L8_error)</span>
          #else
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2657, __pyx_L8_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L8_error)</span>
            #endif
            if (__pyx_t_9 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_9); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_9++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L8_error)</span>
          #else
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_9); __pyx_t_9++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2657, __pyx_L8_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          #endif
        }
      } else {
        __pyx_t_3 = __pyx_t_10(__pyx_t_1);
        if (unlikely(!__pyx_t_3)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L8_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        PyObject* sequence = __pyx_t_3;
        Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
        if (unlikely(size != 2)) {
          if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L8_error)</span>
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
        } else {
          __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_11 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        #else
        __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2657, __pyx_L8_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_11 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 2657, __pyx_L8_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_12 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2657, __pyx_L8_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_12);
        index = 0; __pyx_t_2 = __pyx_t_8(__pyx_t_12); if (unlikely(!__pyx_t_2)) goto __pyx_L11_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        index = 1; __pyx_t_11 = __pyx_t_8(__pyx_t_12); if (unlikely(!__pyx_t_11)) goto __pyx_L11_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_12), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L8_error)</span>
        __pyx_t_8 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        goto __pyx_L12_unpacking_done;
        __pyx_L11_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        __pyx_t_8 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L8_error)</span>
        __pyx_L12_unpacking_done:;
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr9__pyx_v_label, __pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_8genexpr9__pyx_v_count, __pyx_t_11);
      __pyx_t_11 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_8genexpr9__pyx_v_count, __pyx_v_total);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2657, __pyx_L8_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, (PyObject*)__pyx_8genexpr9__pyx_v_label, (PyObject*)__pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 2657, __pyx_L8_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr9__pyx_v_count); __pyx_8genexpr9__pyx_v_count = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr9__pyx_v_label); __pyx_8genexpr9__pyx_v_label = 0;
    goto __pyx_L14_exit_scope;
    __pyx_L8_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr9__pyx_v_count); __pyx_8genexpr9__pyx_v_count = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_8genexpr9__pyx_v_label); __pyx_8genexpr9__pyx_v_label = 0;
    goto __pyx_L1_error;
    __pyx_L14_exit_scope:;
  } /* exit inner scope */
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2658</span>: </pre>
<pre class="cython line score-108" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2659</span>: def linear_regression(X, coef, bias=0., noise=0.):</pre>
<pre class='cython code score-108 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_61linear_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_60linear_regression, "\n    linear regression.\n    \n    Generate output for linear regression, modeling a relationship between\n    features and a response using a linear approach.\n\n    Linear regression is one of the simplest formss of regression, useful for\n    understanding relationships between variables and for making predictions.\n    It's widely used in various fields like economics, biology, and engineering.\n\n    Parameters\n    ----------\n    X : ndarray\n        The input samples with shape (n_samples, n_features).\n    coef : ndarray\n        The coefficients for the linear regression with shape (n_features,).\n    bias : float\n        The bias term in the linear equation.\n    noise : float\n        The standard deviation of the Gaussian noise added to the output.\n\n    Returns\n    -------\n    y : ndarray\n        The output values for linear regression with shape (n_samples,).\n\n    Formula\n    -------\n    y = X \\cdot coef + bias + noise\n    \n    Applications\n    ------------\n    - Trend analysis in time series data.\n    - Predictive modeling in business and finance.\n    - Estimating relationships in scientific experiments.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_61linear_regression = {"linear_regression", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_61linear_regression, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_60linear_regression};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_61linear_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_coef = 0;
  PyObject *__pyx_v_bias = 0;
  PyObject *__pyx_v_noise = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("linear_regression (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_coef,&amp;__pyx_n_s_bias,&amp;__pyx_n_s_noise,0};
  PyObject* values[4] = {0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2659, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coef)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2659, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("linear_regression", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 2659, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bias);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2659, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_noise);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2659, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "linear_regression") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2659, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_coef = values[1];
    __pyx_v_bias = values[2];
    __pyx_v_noise = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("linear_regression", 0, 2, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2659, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.linear_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_60linear_regression(__pyx_self, __pyx_v_X, __pyx_v_coef, __pyx_v_bias, __pyx_v_noise);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_60linear_regression(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_coef, PyObject *__pyx_v_bias, PyObject *__pyx_v_noise) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__75)
  <span class='trace'>__Pyx_TraceCall</span>("linear_regression", __pyx_f[0], 2659, 0, <span class='error_goto'>__PYX_ERR(0, 2659, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.linear_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__197 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_X, __pyx_n_s_coef, __pyx_n_s_bias, __pyx_n_s_noise);<span class='error_goto'> if (unlikely(!__pyx_tuple__197)) __PYX_ERR(0, 2659, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__197);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__197);
  __pyx_codeobj__75 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__197, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_linear_regression, 2659, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__75)) __PYX_ERR(0, 2659, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2659,0,<span class='error_goto'>__PYX_ERR(0, 2659, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_61linear_regression, 0, __pyx_n_s_linear_regression, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__75));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2659, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__198);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_linear_regression, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2659, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__198 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject*)__pyx_float_0_), ((PyObject*)__pyx_float_0_));<span class='error_goto'> if (unlikely(!__pyx_tuple__198)) __PYX_ERR(0, 2659, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__198);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__198);
</pre><pre class="cython line score-0">&#xA0;<span class="">2660</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2661</span>:     linear regression.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2662</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2663</span>:     Generate output for linear regression, modeling a relationship between</pre>
<pre class="cython line score-0">&#xA0;<span class="">2664</span>:     features and a response using a linear approach.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2665</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2666</span>:     Linear regression is one of the simplest formss of regression, useful for</pre>
<pre class="cython line score-0">&#xA0;<span class="">2667</span>:     understanding relationships between variables and for making predictions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2668</span>:     It's widely used in various fields like economics, biology, and engineering.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2669</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2670</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2671</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2672</span>:     X : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2673</span>:         The input samples with shape (n_samples, n_features).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2674</span>:     coef : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2675</span>:         The coefficients for the linear regression with shape (n_features,).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2676</span>:     bias : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2677</span>:         The bias term in the linear equation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2678</span>:     noise : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2679</span>:         The standard deviation of the Gaussian noise added to the output.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2680</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2681</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2682</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2683</span>:     y : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2684</span>:         The output values for linear regression with shape (n_samples,).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2685</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2686</span>:     Formula</pre>
<pre class="cython line score-0">&#xA0;<span class="">2687</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2688</span>:     y = X \cdot coef + bias + noise</pre>
<pre class="cython line score-0">&#xA0;<span class="">2689</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2690</span>:     Applications</pre>
<pre class="cython line score-0">&#xA0;<span class="">2691</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2692</span>:     - Trend analysis in time series data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2693</span>:     - Predictive modeling in business and finance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2694</span>:     - Estimating relationships in scientific experiments.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2695</span>:     """</pre>
<pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2696</span>:     return np.dot(X, coef) + bias + noise * np.random.randn(X.shape[0])</pre>
<pre class='cython code score-67 '>  <span class='trace'>__Pyx_TraceLine</span>(2696,0,<span class='error_goto'>__PYX_ERR(0, 2696, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_X, __pyx_v_coef};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_bias);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_randn);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_noise, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2696, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2697</span>: </pre>
<pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2698</span>: def quadratic_regression(X, coef, bias=0., noise=0.):</pre>
<pre class='cython code score-98 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_63quadratic_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_62quadratic_regression, "\n    Quadratic regression.\n\n    Generate output for quadratic regression, which models a parabolic \n    relationship between the dependent variable and independent variables.\n\n    Quadratic regression is suitable for datasets with a non-linear trend. It's \n    often used in areas where the rate of change increases or decreases rapidly.\n\n    Applications\n    ------------\n    - Modeling acceleration or deceleration patterns in physics.\n    - Growth rate analysis in biology and economics.\n    - Prediction in financial markets with parabolic trends.\n    \n    Parameters\n    ----------\n    X : ndarray\n        The input samples with shape (n_samples, n_features).\n    coef : ndarray\n        The coefficients for the linear regression with shape (n_features,).\n    bias : float\n        The bias term in the linear equation.\n    noise : float\n        The standard deviation of the Gaussian noise added to the output.\n        \n    Formula\n    -------\n    y = (X^2) \\cdot coef + bias + noise\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_63quadratic_regression = {"quadratic_regression", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_63quadratic_regression, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_62quadratic_regression};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_63quadratic_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_coef = 0;
  PyObject *__pyx_v_bias = 0;
  PyObject *__pyx_v_noise = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("quadratic_regression (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_coef,&amp;__pyx_n_s_bias,&amp;__pyx_n_s_noise,0};
  PyObject* values[4] = {0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coef)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("quadratic_regression", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bias);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_noise);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "quadratic_regression") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_coef = values[1];
    __pyx_v_bias = values[2];
    __pyx_v_noise = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("quadratic_regression", 0, 2, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.quadratic_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_62quadratic_regression(__pyx_self, __pyx_v_X, __pyx_v_coef, __pyx_v_bias, __pyx_v_noise);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_62quadratic_regression(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_coef, PyObject *__pyx_v_bias, PyObject *__pyx_v_noise) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__76)
  <span class='trace'>__Pyx_TraceCall</span>("quadratic_regression", __pyx_f[0], 2698, 0, <span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.quadratic_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2698,0,<span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_63quadratic_regression, 0, __pyx_n_s_quadratic_regression, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__76));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2698, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__198);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_quadratic_regression, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2698, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_codeobj__76 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__197, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_quadratic_regression, 2698, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__76)) __PYX_ERR(0, 2698, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2699</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2700</span>:     Quadratic regression.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2701</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2702</span>:     Generate output for quadratic regression, which models a parabolic</pre>
<pre class="cython line score-0">&#xA0;<span class="">2703</span>:     relationship between the dependent variable and independent variables.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2704</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2705</span>:     Quadratic regression is suitable for datasets with a non-linear trend. It's</pre>
<pre class="cython line score-0">&#xA0;<span class="">2706</span>:     often used in areas where the rate of change increases or decreases rapidly.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2707</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2708</span>:     Applications</pre>
<pre class="cython line score-0">&#xA0;<span class="">2709</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2710</span>:     - Modeling acceleration or deceleration patterns in physics.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2711</span>:     - Growth rate analysis in biology and economics.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2712</span>:     - Prediction in financial markets with parabolic trends.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2713</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2714</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2715</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2716</span>:     X : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2717</span>:         The input samples with shape (n_samples, n_features).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2718</span>:     coef : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2719</span>:         The coefficients for the linear regression with shape (n_features,).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2720</span>:     bias : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2721</span>:         The bias term in the linear equation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2722</span>:     noise : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2723</span>:         The standard deviation of the Gaussian noise added to the output.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2724</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2725</span>:     Formula</pre>
<pre class="cython line score-0">&#xA0;<span class="">2726</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2727</span>:     y = (X^2) \cdot coef + bias + noise</pre>
<pre class="cython line score-0">&#xA0;<span class="">2728</span>:     """</pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2729</span>:     return np.dot(X**2, coef) + bias + noise * np.random.randn(X.shape[0])</pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(2729,0,<span class='error_goto'>__PYX_ERR(0, 2729, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_X, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_2, __pyx_v_coef};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2729, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_bias);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_randn);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2729, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_noise, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2730</span>: </pre>
<pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2731</span>: def cubic_regression(X, coef, bias=0., noise=0.):</pre>
<pre class='cython code score-98 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_65cubic_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_64cubic_regression, "\n    Cubic regression.\n\n    Generate output for cubic regression, fitting a cubic polynomial to the data.\n\n    Cubic regression provides a more flexible curve than quadratic models and is \n    beneficial in studying more complex relationships, especially where inflection \n    points are present.\n\n    Applications\n    ------------\n    - Analyzing drug response curves in pharmacology.\n    - Studying the growth patterns of organisms or populations.\n    - Complex trend analysis in economic data.\n    \n    Parameters\n    ----------\n    X : ndarray\n        The input samples with shape (n_samples, n_features).\n    coef : ndarray\n        The coefficients for the linear regression with shape (n_features,).\n    bias : float\n        The bias term in the linear equation.\n    noise : float\n        The standard deviation of the Gaussian noise added to the output.\n\n    Formula\n    -------\n    y = (X^3) \\cdot coef + bias + noise\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_65cubic_regression = {"cubic_regression", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_65cubic_regression, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_64cubic_regression};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_65cubic_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_coef = 0;
  PyObject *__pyx_v_bias = 0;
  PyObject *__pyx_v_noise = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cubic_regression (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_coef,&amp;__pyx_n_s_bias,&amp;__pyx_n_s_noise,0};
  PyObject* values[4] = {0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coef)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cubic_regression", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bias);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_noise);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "cubic_regression") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_coef = values[1];
    __pyx_v_bias = values[2];
    __pyx_v_noise = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cubic_regression", 0, 2, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.cubic_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_64cubic_regression(__pyx_self, __pyx_v_X, __pyx_v_coef, __pyx_v_bias, __pyx_v_noise);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_64cubic_regression(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_coef, PyObject *__pyx_v_bias, PyObject *__pyx_v_noise) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__77)
  <span class='trace'>__Pyx_TraceCall</span>("cubic_regression", __pyx_f[0], 2731, 0, <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.cubic_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2731,0,<span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_65cubic_regression, 0, __pyx_n_s_cubic_regression, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__77));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2731, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__198);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cubic_regression, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2731, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_codeobj__77 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__197, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_cubic_regression, 2731, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__77)) __PYX_ERR(0, 2731, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2732</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2733</span>:     Cubic regression.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2734</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2735</span>:     Generate output for cubic regression, fitting a cubic polynomial to the data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2736</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2737</span>:     Cubic regression provides a more flexible curve than quadratic models and is</pre>
<pre class="cython line score-0">&#xA0;<span class="">2738</span>:     beneficial in studying more complex relationships, especially where inflection</pre>
<pre class="cython line score-0">&#xA0;<span class="">2739</span>:     points are present.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2740</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2741</span>:     Applications</pre>
<pre class="cython line score-0">&#xA0;<span class="">2742</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2743</span>:     - Analyzing drug response curves in pharmacology.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2744</span>:     - Studying the growth patterns of organisms or populations.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2745</span>:     - Complex trend analysis in economic data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2746</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2747</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2748</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2749</span>:     X : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2750</span>:         The input samples with shape (n_samples, n_features).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2751</span>:     coef : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2752</span>:         The coefficients for the linear regression with shape (n_features,).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2753</span>:     bias : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2754</span>:         The bias term in the linear equation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2755</span>:     noise : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2756</span>:         The standard deviation of the Gaussian noise added to the output.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2757</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2758</span>:     Formula</pre>
<pre class="cython line score-0">&#xA0;<span class="">2759</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2760</span>:     y = (X^3) \cdot coef + bias + noise</pre>
<pre class="cython line score-0">&#xA0;<span class="">2761</span>:     """</pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2762</span>:     return np.dot(X**3, coef) + bias + noise * np.random.randn(X.shape[0])</pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(2762,0,<span class='error_goto'>__PYX_ERR(0, 2762, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_X, __pyx_int_3, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_t_2, __pyx_v_coef};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_bias);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_randn);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_noise, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2763</span>: </pre>
<pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2764</span>: def exponential_regression(X, coef, bias=0., noise=0.):</pre>
<pre class='cython code score-98 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_67exponential_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_66exponential_regression, "\n    Exponential regression.\n\n    Generate output for exponential regression, ideal for modeling growth or decay.\n\n    Exponential regression is used when data grows or decays at a constant\n    percentage rate. It's crucial in fields like biology for population growth \n    studies or in finance for compound interest calculations.\n\n    Applications\n    ------------\n    - Modeling population growth or decline.\n    - Financial modeling for compound interest.\n    - Radioactive decay in physics.\n    Parameters\n    ----------\n    X : ndarray\n        The input samples with shape (n_samples, n_features).\n    coef : ndarray\n        The coefficients for the linear regression with shape (n_features,).\n    bias : float\n        The bias term in the linear equation.\n    noise : float\n        The standard deviation of the Gaussian noise added to the output.\n\n    Formula\n    -------\n    y = exp(X \\cdot coef) + bias + noise\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_67exponential_regression = {"exponential_regression", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_67exponential_regression, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_66exponential_regression};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_67exponential_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_coef = 0;
  PyObject *__pyx_v_bias = 0;
  PyObject *__pyx_v_noise = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("exponential_regression (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_coef,&amp;__pyx_n_s_bias,&amp;__pyx_n_s_noise,0};
  PyObject* values[4] = {0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coef)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("exponential_regression", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bias);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_noise);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "exponential_regression") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_coef = values[1];
    __pyx_v_bias = values[2];
    __pyx_v_noise = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("exponential_regression", 0, 2, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.exponential_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_66exponential_regression(__pyx_self, __pyx_v_X, __pyx_v_coef, __pyx_v_bias, __pyx_v_noise);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_66exponential_regression(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_coef, PyObject *__pyx_v_bias, PyObject *__pyx_v_noise) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__78)
  <span class='trace'>__Pyx_TraceCall</span>("exponential_regression", __pyx_f[0], 2764, 0, <span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.exponential_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2764,0,<span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_67exponential_regression, 0, __pyx_n_s_exponential_regression, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__78));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2764, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__198);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_exponential_regression, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2764, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_codeobj__78 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__197, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_exponential_regression, 2764, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__78)) __PYX_ERR(0, 2764, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2765</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2766</span>:     Exponential regression.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2767</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2768</span>:     Generate output for exponential regression, ideal for modeling growth or decay.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2769</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2770</span>:     Exponential regression is used when data grows or decays at a constant</pre>
<pre class="cython line score-0">&#xA0;<span class="">2771</span>:     percentage rate. It's crucial in fields like biology for population growth</pre>
<pre class="cython line score-0">&#xA0;<span class="">2772</span>:     studies or in finance for compound interest calculations.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2773</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2774</span>:     Applications</pre>
<pre class="cython line score-0">&#xA0;<span class="">2775</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2776</span>:     - Modeling population growth or decline.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2777</span>:     - Financial modeling for compound interest.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2778</span>:     - Radioactive decay in physics.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2779</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2780</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2781</span>:     X : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2782</span>:         The input samples with shape (n_samples, n_features).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2783</span>:     coef : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2784</span>:         The coefficients for the linear regression with shape (n_features,).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2785</span>:     bias : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2786</span>:         The bias term in the linear equation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2787</span>:     noise : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2788</span>:         The standard deviation of the Gaussian noise added to the output.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2789</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2790</span>:     Formula</pre>
<pre class="cython line score-0">&#xA0;<span class="">2791</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2792</span>:     y = exp(X \cdot coef) + bias + noise</pre>
<pre class="cython line score-0">&#xA0;<span class="">2793</span>:     """</pre>
<pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2794</span>:     return np.exp(np.dot(X, coef)) + bias + noise * np.random.randn(X.shape[0])</pre>
<pre class='cython code score-87 '>  <span class='trace'>__Pyx_TraceLine</span>(2794,0,<span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_exp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_v_X, __pyx_v_coef};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_bias);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_randn);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2794, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_noise, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2795</span>: </pre>
<pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2796</span>: def logarithmic_regression(X, coef, bias=0., noise=0.):</pre>
<pre class='cython code score-98 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_69logarithmic_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_68logarithmic_regression, "\n    Logarithmic regression.\n\n    Generate output for logarithmic regression, suitable for modeling processes \n    that rapidly increase or decrease and then level off.\n\n    Logarithmic regression is particularly useful in situations where the rate of\n    change decreases over time. It's often used in scientific data analysis.\n\n    Applications\n    ------------\n    - Analyzing diminishing returns in economics.\n    - Growth rate analysis in biological processes.\n    - Signal processing and sound intensity measurements.\n    \n    Parameters\n    ----------\n    X : ndarray\n        The input samples with shape (n_samples, n_features).\n    coef : ndarray\n        The coefficients for the linear regression with shape (n_features,).\n    bias : float\n        The bias term in the linear equation.\n    noise : float\n        The standard deviation of the Gaussian noise added to the output.\n\n    Formula\n    -------\n    y = log(X) \\cdot coef + bias + noise\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_69logarithmic_regression = {"logarithmic_regression", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_69logarithmic_regression, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_68logarithmic_regression};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_69logarithmic_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_coef = 0;
  PyObject *__pyx_v_bias = 0;
  PyObject *__pyx_v_noise = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("logarithmic_regression (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_coef,&amp;__pyx_n_s_bias,&amp;__pyx_n_s_noise,0};
  PyObject* values[4] = {0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2796, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coef)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2796, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("logarithmic_regression", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 2796, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bias);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2796, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_noise);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2796, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "logarithmic_regression") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2796, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_coef = values[1];
    __pyx_v_bias = values[2];
    __pyx_v_noise = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("logarithmic_regression", 0, 2, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2796, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.logarithmic_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_68logarithmic_regression(__pyx_self, __pyx_v_X, __pyx_v_coef, __pyx_v_bias, __pyx_v_noise);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_68logarithmic_regression(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_coef, PyObject *__pyx_v_bias, PyObject *__pyx_v_noise) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__79)
  <span class='trace'>__Pyx_TraceCall</span>("logarithmic_regression", __pyx_f[0], 2796, 0, <span class='error_goto'>__PYX_ERR(0, 2796, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.logarithmic_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2796,0,<span class='error_goto'>__PYX_ERR(0, 2796, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_69logarithmic_regression, 0, __pyx_n_s_logarithmic_regression, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__79));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2796, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__198);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_logarithmic_regression, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2796, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_codeobj__79 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__197, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_logarithmic_regression, 2796, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__79)) __PYX_ERR(0, 2796, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2797</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2798</span>:     Logarithmic regression.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2799</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2800</span>:     Generate output for logarithmic regression, suitable for modeling processes</pre>
<pre class="cython line score-0">&#xA0;<span class="">2801</span>:     that rapidly increase or decrease and then level off.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2802</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2803</span>:     Logarithmic regression is particularly useful in situations where the rate of</pre>
<pre class="cython line score-0">&#xA0;<span class="">2804</span>:     change decreases over time. It's often used in scientific data analysis.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2805</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2806</span>:     Applications</pre>
<pre class="cython line score-0">&#xA0;<span class="">2807</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2808</span>:     - Analyzing diminishing returns in economics.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2809</span>:     - Growth rate analysis in biological processes.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2810</span>:     - Signal processing and sound intensity measurements.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2811</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2812</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2813</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2814</span>:     X : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2815</span>:         The input samples with shape (n_samples, n_features).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2816</span>:     coef : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2817</span>:         The coefficients for the linear regression with shape (n_features,).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2818</span>:     bias : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2819</span>:         The bias term in the linear equation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2820</span>:     noise : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2821</span>:         The standard deviation of the Gaussian noise added to the output.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2822</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2823</span>:     Formula</pre>
<pre class="cython line score-0">&#xA0;<span class="">2824</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2825</span>:     y = log(X) \cdot coef + bias + noise</pre>
<pre class="cython line score-0">&#xA0;<span class="">2826</span>:     """</pre>
<pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2827</span>:     return np.dot(np.log(X), coef) + bias + noise * np.random.randn(X.shape[0])</pre>
<pre class='cython code score-87 '>  <span class='trace'>__Pyx_TraceLine</span>(2827,0,<span class='error_goto'>__PYX_ERR(0, 2827, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_X};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2827, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_t_2, __pyx_v_coef};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2827, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_bias);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_randn);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2827, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_noise, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2828</span>: </pre>
<pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2829</span>: def sinusoidal_regression(X, coef, bias=0., noise=0.):</pre>
<pre class='cython code score-98 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_71sinusoidal_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_70sinusoidal_regression, "\n    Sinusoidal regression.\n\n    Generate output for sinusoidal regression, fitting a sinusoidal model to the data.\n\n    This type of regression is useful for modeling cyclical patterns and is commonly\n    used in fields like meteorology, seasonal studies, and signal processing.\n\n    Applications\n    ------------\n    - Seasonal pattern analysis in climatology.\n    - Modeling cyclical trends in economics.\n    - Signal analysis in electrical engineering.\n    \n    Parameters\n    ----------\n    X : ndarray\n        The input samples with shape (n_samples, n_features).\n    coef : ndarray\n        The coefficients for the linear regression with shape (n_features,).\n    bias : float\n        The bias term in the linear equation.\n    noise : float\n        The standard deviation of the Gaussian noise added to the output.\n\n    Formula\n    -------\n    y = sin(X \\cdot coef) + bias + noise\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_71sinusoidal_regression = {"sinusoidal_regression", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_71sinusoidal_regression, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_70sinusoidal_regression};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_71sinusoidal_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_coef = 0;
  PyObject *__pyx_v_bias = 0;
  PyObject *__pyx_v_noise = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("sinusoidal_regression (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_coef,&amp;__pyx_n_s_bias,&amp;__pyx_n_s_noise,0};
  PyObject* values[4] = {0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2829, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coef)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2829, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sinusoidal_regression", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 2829, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bias);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2829, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_noise);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2829, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "sinusoidal_regression") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2829, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_coef = values[1];
    __pyx_v_bias = values[2];
    __pyx_v_noise = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("sinusoidal_regression", 0, 2, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2829, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.sinusoidal_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_70sinusoidal_regression(__pyx_self, __pyx_v_X, __pyx_v_coef, __pyx_v_bias, __pyx_v_noise);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_70sinusoidal_regression(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_coef, PyObject *__pyx_v_bias, PyObject *__pyx_v_noise) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__80)
  <span class='trace'>__Pyx_TraceCall</span>("sinusoidal_regression", __pyx_f[0], 2829, 0, <span class='error_goto'>__PYX_ERR(0, 2829, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.sinusoidal_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2829,0,<span class='error_goto'>__PYX_ERR(0, 2829, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_71sinusoidal_regression, 0, __pyx_n_s_sinusoidal_regression, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__80));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2829, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__198);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sinusoidal_regression, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2829, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  __pyx_codeobj__80 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__197, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_sinusoidal_regression, 2829, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__80)) __PYX_ERR(0, 2829, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2830</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2831</span>:     Sinusoidal regression.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2832</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2833</span>:     Generate output for sinusoidal regression, fitting a sinusoidal model to the data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2834</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2835</span>:     This type of regression is useful for modeling cyclical patterns and is commonly</pre>
<pre class="cython line score-0">&#xA0;<span class="">2836</span>:     used in fields like meteorology, seasonal studies, and signal processing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2837</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2838</span>:     Applications</pre>
<pre class="cython line score-0">&#xA0;<span class="">2839</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2840</span>:     - Seasonal pattern analysis in climatology.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2841</span>:     - Modeling cyclical trends in economics.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2842</span>:     - Signal analysis in electrical engineering.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2843</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2844</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2845</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2846</span>:     X : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2847</span>:         The input samples with shape (n_samples, n_features).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2848</span>:     coef : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2849</span>:         The coefficients for the linear regression with shape (n_features,).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2850</span>:     bias : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2851</span>:         The bias term in the linear equation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2852</span>:     noise : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2853</span>:         The standard deviation of the Gaussian noise added to the output.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2854</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2855</span>:     Formula</pre>
<pre class="cython line score-0">&#xA0;<span class="">2856</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2857</span>:     y = sin(X \cdot coef) + bias + noise</pre>
<pre class="cython line score-0">&#xA0;<span class="">2858</span>:     """</pre>
<pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2859</span>:     return np.sin(np.dot(X, coef)) + bias + noise * np.random.randn(X.shape[0])</pre>
<pre class='cython code score-87 '>  <span class='trace'>__Pyx_TraceLine</span>(2859,0,<span class='error_goto'>__PYX_ERR(0, 2859, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_v_X, __pyx_v_coef};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2859, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2859, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_bias);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_randn);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2859, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_noise, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2859, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2860</span>: </pre>
<pre class="cython line score-104" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2861</span>: def step_regression(X, coef, bias=0., noise=0.):</pre>
<pre class='cython code score-104 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_73step_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_72step_regression, "\n    Step regression.\n\n    Step regression is valuable for modeling scenarios where the dependent variable\n    changes abruptly at specific thresholds. It's used in quality control and market\n    segmentation analysis.\n\n    Applications\n    ------------\n    - Quality assessment in manufacturing processes.\n    - Customer segmentation in marketing.\n    - Modeling sudden changes in environmental data.\n    \n    Parameters\n    ----------\n    X : ndarray\n        The input samples with shape (n_samples, n_features).\n    coef : ndarray\n        The coefficients for the linear regression with shape (n_features,).\n    bias : float\n        The bias term in the linear equation.\n    noise : float\n        The standard deviation of the Gaussian noise added to the output.\n\n\n    Formula\n    -------\n    y = step_function(X \\cdot coef) + bias + noise\n\n    Note: step_function returns 1 if x &gt;= 0, else 0.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_73step_regression = {"step_regression", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_73step_regression, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_72step_regression};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_73step_regression(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_coef = 0;
  PyObject *__pyx_v_bias = 0;
  PyObject *__pyx_v_noise = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("step_regression (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_coef,&amp;__pyx_n_s_bias,&amp;__pyx_n_s_noise,0};
  PyObject* values[4] = {0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_coef)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("step_regression", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_bias);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_noise);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "step_regression") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_coef = values[1];
    __pyx_v_bias = values[2];
    __pyx_v_noise = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("step_regression", 0, 2, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.step_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_72step_regression(__pyx_self, __pyx_v_X, __pyx_v_coef, __pyx_v_bias, __pyx_v_noise);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_6gofast_5tools_6mathex_72step_regression(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_coef, PyObject *__pyx_v_bias, PyObject *__pyx_v_noise) {
  PyObject *__pyx_v_step_function = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__81)
  <span class='trace'>__Pyx_TraceCall</span>("step_regression", __pyx_f[0], 2861, 0, <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.step_regression", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_step_function);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__199 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_X, __pyx_n_s_coef, __pyx_n_s_bias, __pyx_n_s_noise, __pyx_n_s_step_function);<span class='error_goto'> if (unlikely(!__pyx_tuple__199)) __PYX_ERR(0, 2861, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__199);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__199);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2861,0,<span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_73step_regression, 0, __pyx_n_s_step_regression, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__81));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2861, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__198);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_step_regression, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2861, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__81 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__199, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_step_regression, 2861, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__81)) __PYX_ERR(0, 2861, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2862</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2863</span>:     Step regression.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2864</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2865</span>:     Step regression is valuable for modeling scenarios where the dependent variable</pre>
<pre class="cython line score-0">&#xA0;<span class="">2866</span>:     changes abruptly at specific thresholds. It's used in quality control and market</pre>
<pre class="cython line score-0">&#xA0;<span class="">2867</span>:     segmentation analysis.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2868</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2869</span>:     Applications</pre>
<pre class="cython line score-0">&#xA0;<span class="">2870</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2871</span>:     - Quality assessment in manufacturing processes.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2872</span>:     - Customer segmentation in marketing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2873</span>:     - Modeling sudden changes in environmental data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2874</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2875</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2876</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2877</span>:     X : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2878</span>:         The input samples with shape (n_samples, n_features).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2879</span>:     coef : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2880</span>:         The coefficients for the linear regression with shape (n_features,).</pre>
<pre class="cython line score-0">&#xA0;<span class="">2881</span>:     bias : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2882</span>:         The bias term in the linear equation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2883</span>:     noise : float</pre>
<pre class="cython line score-0">&#xA0;<span class="">2884</span>:         The standard deviation of the Gaussian noise added to the output.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2885</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2886</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2887</span>:     Formula</pre>
<pre class="cython line score-0">&#xA0;<span class="">2888</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2889</span>:     y = step_function(X \cdot coef) + bias + noise</pre>
<pre class="cython line score-0">&#xA0;<span class="">2890</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2891</span>:     Note: step_function returns 1 if x &gt;= 0, else 0.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2892</span>:     """</pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2893</span>:     step_function = np.vectorize(lambda x: 1 if x &gt;= 0 else 0)</pre>
<pre class='cython code score-70 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_15step_regression_lambda1(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_15step_regression_lambda1 = {"lambda1", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_15step_regression_lambda1, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_15step_regression_lambda1(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda1 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2893, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "lambda1") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2893, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_x = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lambda1", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2893, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.step_regression.lambda1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_lambda_funcdef_lambda1(__pyx_self, __pyx_v_x);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("lambda1", __pyx_f[0], 2893, 0, <span class='error_goto'>__PYX_ERR(0, 2893, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_x, __pyx_int_0, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2893, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 2893, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    __pyx_t_1 = __pyx_int_1;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_t_1 = __pyx_int_0;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.step_regression.lambda1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2893,0,<span class='error_goto'>__PYX_ERR(0, 2893, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2893, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_vectorize);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2893, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_15step_regression_lambda1, 0, __pyx_n_s_step_regression_locals_lambda, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2893, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2893, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_step_function = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-83" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2894</span>:     return step_function(np.dot(X, coef)) + bias + noise * np.random.randn(X.shape[0])</pre>
<pre class='cython code score-83 '>  <span class='trace'>__Pyx_TraceLine</span>(2894,0,<span class='error_goto'>__PYX_ERR(0, 2894, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_X, __pyx_v_coef};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 2+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2894, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_step_function);
  __pyx_t_4 = __pyx_v_step_function; __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2894, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_bias);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 2894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_randn);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 2894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 2894, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_noise, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2894, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2895</span>: </pre>
<pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2896</span>: def standard_scaler(X, y=None):</pre>
<pre class='cython code score-77 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_75standard_scaler(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_74standard_scaler, "\n    Scales features to have zero mean and unit variance.\n\n    Standard scaling is vital in many machine learning algorithms that are \n    sensitive to the scale of input features. It's commonly used in algorithms\n    like Support Vector Machines and k-Nearest Neighbors.\n\n    Applications\n    ------------\n    - Data preprocessing for machine learning models.\n    - Feature normalization in image processing.\n    - Standardizing variables in statistical analysis.\n    \n    Parameters\n    ----------\n    X : ndarray of shape (n_samples, n_features)\n        The input samples.\n    y : ndarray of shape (n_samples,), optional\n        The output values. If provided, it will be scaled as well.\n\n    Returns\n    -------\n    X_scaled : ndarray\n        Scaled version of X.\n    y_scaled : ndarray, optional\n        Scaled version of y, if y is provided.\n\n    Formula\n    -------\n    For each feature, the Standard Scaler performs the following operation:\n        z = \014rac{x - \\mu}{\\sigma}\n    where \\mu is the mean and \\sigma is the standard deviation of the feature.\n\n    Examples\n    --------\n    &gt;&gt;&gt; X = np.array([[1, 2], [3, 4], [5, 6]])\n    &gt;&gt;&gt; X_scaled = standard_scaler(X)\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_75standard_scaler = {"standard_scaler", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_75standard_scaler, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_74standard_scaler};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_75standard_scaler(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_y = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("standard_scaler (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_y,0};
  PyObject* values[2] = {0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2896, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2896, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "standard_scaler") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2896, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_y = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("standard_scaler", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2896, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.standard_scaler", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_74standard_scaler(__pyx_self, __pyx_v_X, __pyx_v_y);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_74standard_scaler(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_y) {
  PyObject *__pyx_v_X_mean = NULL;
  PyObject *__pyx_v_X_std = NULL;
  PyObject *__pyx_v_X_scaled = NULL;
  PyObject *__pyx_v_y_mean = NULL;
  PyObject *__pyx_v_y_std = NULL;
  PyObject *__pyx_v_y_scaled = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__82)
  <span class='trace'>__Pyx_TraceCall</span>("standard_scaler", __pyx_f[0], 2896, 0, <span class='error_goto'>__PYX_ERR(0, 2896, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.standard_scaler", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X_mean);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X_std);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X_scaled);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_mean);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_std);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_scaled);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__200 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_X, __pyx_n_s_y, __pyx_n_s_X_mean, __pyx_n_s_X_std, __pyx_n_s_X_scaled, __pyx_n_s_y_mean, __pyx_n_s_y_std, __pyx_n_s_y_scaled);<span class='error_goto'> if (unlikely(!__pyx_tuple__200)) __PYX_ERR(0, 2896, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__200);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__200);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2896,0,<span class='error_goto'>__PYX_ERR(0, 2896, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_75standard_scaler, 0, __pyx_n_s_standard_scaler, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__82));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2896, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__158);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_standard_scaler, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2896, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__82 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__200, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_standard_scaler, 2896, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__82)) __PYX_ERR(0, 2896, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2897</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2898</span>:     Scales features to have zero mean and unit variance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2899</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2900</span>:     Standard scaling is vital in many machine learning algorithms that are</pre>
<pre class="cython line score-0">&#xA0;<span class="">2901</span>:     sensitive to the scale of input features. It's commonly used in algorithms</pre>
<pre class="cython line score-0">&#xA0;<span class="">2902</span>:     like Support Vector Machines and k-Nearest Neighbors.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2903</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2904</span>:     Applications</pre>
<pre class="cython line score-0">&#xA0;<span class="">2905</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2906</span>:     - Data preprocessing for machine learning models.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2907</span>:     - Feature normalization in image processing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2908</span>:     - Standardizing variables in statistical analysis.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2909</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2910</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2911</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2912</span>:     X : ndarray of shape (n_samples, n_features)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2913</span>:         The input samples.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2914</span>:     y : ndarray of shape (n_samples,), optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2915</span>:         The output values. If provided, it will be scaled as well.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2916</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2917</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2918</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2919</span>:     X_scaled : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2920</span>:         Scaled version of X.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2921</span>:     y_scaled : ndarray, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2922</span>:         Scaled version of y, if y is provided.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2923</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2924</span>:     Formula</pre>
<pre class="cython line score-0">&#xA0;<span class="">2925</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2926</span>:     For each feature, the Standard Scaler performs the following operation:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2927</span>:         z = \frac{x - \mu}{\sigma}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2928</span>:     where \mu is the mean and \sigma is the standard deviation of the feature.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2929</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2930</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2931</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2932</span>:     &gt;&gt;&gt; X = np.array([[1, 2], [3, 4], [5, 6]])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2933</span>:     &gt;&gt;&gt; X_scaled = standard_scaler(X)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2934</span>:     """</pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2935</span>:     X_mean = X.mean(axis=0)</pre>
<pre class='cython code score-13 '>  <span class='trace'>__Pyx_TraceLine</span>(2935,0,<span class='error_goto'>__PYX_ERR(0, 2935, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2935, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2935, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2935, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2935, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_X_mean = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2936</span>:     X_std = X.std(axis=0)</pre>
<pre class='cython code score-13 '>  <span class='trace'>__Pyx_TraceLine</span>(2936,0,<span class='error_goto'>__PYX_ERR(0, 2936, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_std);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2936, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2936, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2936, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2936, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_X_std = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2937</span>:     X_scaled = (X - X_mean) / X_std</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(2937,0,<span class='error_goto'>__PYX_ERR(0, 2937, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_X, __pyx_v_X_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_v_X_std);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_X_scaled = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2938</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2939</span>:     if y is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(2939,0,<span class='error_goto'>__PYX_ERR(0, 2939, __pyx_L1_error)</span>)
  __pyx_t_4 = (__pyx_v_y != Py_None);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2940</span>:         y_mean = y.mean()</pre>
<pre class='cython code score-16 '>    <span class='trace'>__Pyx_TraceLine</span>(2940,0,<span class='error_goto'>__PYX_ERR(0, 2940, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2940, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_v_y_mean = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2941</span>:         y_std = y.std()</pre>
<pre class='cython code score-16 '>    <span class='trace'>__Pyx_TraceLine</span>(2941,0,<span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_std);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2941, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 2941, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_v_y_std = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2942</span>:         y_scaled = (y - y_mean) / y_std</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(2942,0,<span class='error_goto'>__PYX_ERR(0, 2942, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_y, __pyx_v_y_mean);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2942, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_2, __pyx_v_y_std);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2942, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_y_scaled = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2943</span>:         return X_scaled, y_scaled</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(2943,0,<span class='error_goto'>__PYX_ERR(0, 2943, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2943, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X_scaled);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X_scaled);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_X_scaled)) <span class='error_goto'>__PYX_ERR(0, 2943, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_scaled);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_scaled);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_y_scaled)) <span class='error_goto'>__PYX_ERR(0, 2943, __pyx_L1_error)</span>;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2944</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2945</span>:     return X_scaled</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2945,0,<span class='error_goto'>__PYX_ERR(0, 2945, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X_scaled);
  __pyx_r = __pyx_v_X_scaled;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2946</span>: </pre>
<pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2947</span>: def minmax_scaler(X, y=None):</pre>
<pre class='cython code score-77 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_77minmax_scaler(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_76minmax_scaler, "\n    Scales each feature to a given range, typically [0, 1].\n\n    MinMax scaling is often used when the algorithm requires a bounded interval. \n    It's particularly useful in neural networks and image processing where values \n    need to be normalized.\n\n    Applications\n    ------------\n    - Data normalization for neural networks.\n    - Preprocessing data in computer vision tasks.\n    - Scaling features for optimization problems.\n    \n    Parameters\n    ----------\n    X : ndarray of shape (n_samples, n_features)\n        The input samples.\n    y : ndarray of shape (n_samples,), optional\n        The output values. If provided, it will be scaled as well.\n\n    Returns\n    -------\n    X_scaled : ndarray\n        Scaled version of X.\n    y_scaled : ndarray, optional\n        Scaled version of y, if y is provided.\n\n    Formula\n    -------\n    The MinMax Scaler performs the following operation for each feature:\n        z = \014rac{x - \\min(x)}{\\max(x) - \\min(x)}\n\n    Examples\n    --------\n    &gt;&gt;&gt; X = np.array([[1, 2], [3, 4], [5, 6]])\n    &gt;&gt;&gt; X_scaled = minmax_scaler(X)\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_77minmax_scaler = {"minmax_scaler", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_77minmax_scaler, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_76minmax_scaler};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_77minmax_scaler(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_y = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("minmax_scaler (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_y,0};
  PyObject* values[2] = {0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2947, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2947, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "minmax_scaler") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2947, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_y = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("minmax_scaler", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2947, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.minmax_scaler", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_76minmax_scaler(__pyx_self, __pyx_v_X, __pyx_v_y);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_76minmax_scaler(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_y) {
  PyObject *__pyx_v_X_min = NULL;
  PyObject *__pyx_v_X_max = NULL;
  PyObject *__pyx_v_X_scaled = NULL;
  PyObject *__pyx_v_y_min = NULL;
  PyObject *__pyx_v_y_max = NULL;
  PyObject *__pyx_v_y_scaled = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__83)
  <span class='trace'>__Pyx_TraceCall</span>("minmax_scaler", __pyx_f[0], 2947, 0, <span class='error_goto'>__PYX_ERR(0, 2947, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.minmax_scaler", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X_min);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X_max);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X_scaled);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_min);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_max);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_scaled);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__201 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_X, __pyx_n_s_y, __pyx_n_s_X_min, __pyx_n_s_X_max, __pyx_n_s_X_scaled, __pyx_n_s_y_min, __pyx_n_s_y_max, __pyx_n_s_y_scaled);<span class='error_goto'> if (unlikely(!__pyx_tuple__201)) __PYX_ERR(0, 2947, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__201);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__201);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2947,0,<span class='error_goto'>__PYX_ERR(0, 2947, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_77minmax_scaler, 0, __pyx_n_s_minmax_scaler, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__83));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2947, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__158);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_minmax_scaler, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2947, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__83 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__201, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_minmax_scaler, 2947, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__83)) __PYX_ERR(0, 2947, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2948</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2949</span>:     Scales each feature to a given range, typically [0, 1].</pre>
<pre class="cython line score-0">&#xA0;<span class="">2950</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2951</span>:     MinMax scaling is often used when the algorithm requires a bounded interval.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2952</span>:     It's particularly useful in neural networks and image processing where values</pre>
<pre class="cython line score-0">&#xA0;<span class="">2953</span>:     need to be normalized.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2954</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2955</span>:     Applications</pre>
<pre class="cython line score-0">&#xA0;<span class="">2956</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2957</span>:     - Data normalization for neural networks.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2958</span>:     - Preprocessing data in computer vision tasks.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2959</span>:     - Scaling features for optimization problems.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2960</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2961</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">2962</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2963</span>:     X : ndarray of shape (n_samples, n_features)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2964</span>:         The input samples.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2965</span>:     y : ndarray of shape (n_samples,), optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2966</span>:         The output values. If provided, it will be scaled as well.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2967</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2968</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">2969</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2970</span>:     X_scaled : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">2971</span>:         Scaled version of X.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2972</span>:     y_scaled : ndarray, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">2973</span>:         Scaled version of y, if y is provided.</pre>
<pre class="cython line score-0">&#xA0;<span class="">2974</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2975</span>:     Formula</pre>
<pre class="cython line score-0">&#xA0;<span class="">2976</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2977</span>:     The MinMax Scaler performs the following operation for each feature:</pre>
<pre class="cython line score-0">&#xA0;<span class="">2978</span>:         z = \frac{x - \min(x)}{\max(x) - \min(x)}</pre>
<pre class="cython line score-0">&#xA0;<span class="">2979</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">2980</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">2981</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">2982</span>:     &gt;&gt;&gt; X = np.array([[1, 2], [3, 4], [5, 6]])</pre>
<pre class="cython line score-0">&#xA0;<span class="">2983</span>:     &gt;&gt;&gt; X_scaled = minmax_scaler(X)</pre>
<pre class="cython line score-0">&#xA0;<span class="">2984</span>:     """</pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2985</span>:     X_min = X.min(axis=0)</pre>
<pre class='cython code score-13 '>  <span class='trace'>__Pyx_TraceLine</span>(2985,0,<span class='error_goto'>__PYX_ERR(0, 2985, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2985, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2985, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_X_min = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2986</span>:     X_max = X.max(axis=0)</pre>
<pre class='cython code score-13 '>  <span class='trace'>__Pyx_TraceLine</span>(2986,0,<span class='error_goto'>__PYX_ERR(0, 2986, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_X, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2986, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2986, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2986, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2986, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_X_max = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2987</span>:     X_scaled = (X - X_min) / (X_max - X_min)</pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(2987,0,<span class='error_goto'>__PYX_ERR(0, 2987, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_X, __pyx_v_X_min);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2987, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_X_max, __pyx_v_X_min);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2987, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2987, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_X_scaled = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2988</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2989</span>:     if y is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(2989,0,<span class='error_goto'>__PYX_ERR(0, 2989, __pyx_L1_error)</span>)
  __pyx_t_4 = (__pyx_v_y != Py_None);
  if (__pyx_t_4) {
/* … */
  }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2990</span>:         y_min = y.min()</pre>
<pre class='cython code score-16 '>    <span class='trace'>__Pyx_TraceLine</span>(2990,0,<span class='error_goto'>__PYX_ERR(0, 2990, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2990, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2990, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_v_y_min = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2991</span>:         y_max = y.max()</pre>
<pre class='cython code score-16 '>    <span class='trace'>__Pyx_TraceLine</span>(2991,0,<span class='error_goto'>__PYX_ERR(0, 2991, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2991, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 0+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 2991, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_v_y_max = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2992</span>:         y_scaled = (y - y_min) / (y_max - y_min)</pre>
<pre class='cython code score-14 '>    <span class='trace'>__Pyx_TraceLine</span>(2992,0,<span class='error_goto'>__PYX_ERR(0, 2992, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_y, __pyx_v_y_min);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2992, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_y_max, __pyx_v_y_min);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 2992, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2992, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_y_scaled = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2993</span>:         return X_scaled, y_scaled</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(2993,0,<span class='error_goto'>__PYX_ERR(0, 2993, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 2993, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X_scaled);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X_scaled);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_X_scaled)) <span class='error_goto'>__PYX_ERR(0, 2993, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_scaled);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_scaled);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_y_scaled)) <span class='error_goto'>__PYX_ERR(0, 2993, __pyx_L1_error)</span>;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2994</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2995</span>:     return X_scaled</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(2995,0,<span class='error_goto'>__PYX_ERR(0, 2995, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X_scaled);
  __pyx_r = __pyx_v_X_scaled;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">2996</span>: </pre>
<pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">2997</span>: def normalize(X, y=None):</pre>
<pre class='cython code score-78 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_79normalize(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_78normalize, "\n    Scales individual samples to have unit norm.\n\n    Normalization is critical for distance-based algorithms like k-Nearest \n    Neighbors and clustering algorithms. It ensures that each feature \n    contributes proportionately to the final distance.\n\n    Applications\n    ------------\n    - Preprocessing for clustering algorithms.\n    - Normalizing data in natural language processing.\n    - Feature scaling in bioinformatics.\n    \n    Parameters\n    ----------\n    X : ndarray of shape (n_samples, n_features)\n        The input samples.\n    y : ndarray of shape (n_samples,), optional\n        The output values. If provided, it will be normalized as well.\n\n    Returns\n    -------\n    X_normalized : ndarray\n        Normalized version of X.\n    y_normalized : ndarray, optional\n        Normalized version of y, if y is provided.\n\n    Formula\n    -------\n    The Normalize method scales each sample as follows:\n        z = \014rac{x}{||x||}\n    where ||x|| is the Euclidean norm (L2 norm) of the sample.\n\n    Examples\n    --------\n    &gt;&gt;&gt; X = np.array([[1, 2], [3, 4], [5, 6]])\n    &gt;&gt;&gt; X_normalized = normalize(X)\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_79normalize = {"normalize", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_79normalize, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_78normalize};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_79normalize(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_y = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("normalize (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_y,0};
  PyObject* values[2] = {0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2997, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 2997, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "normalize") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 2997, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_y = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("normalize", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 2997, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.normalize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_78normalize(__pyx_self, __pyx_v_X, __pyx_v_y);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_78normalize(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_y) {
  PyObject *__pyx_v_X_norm = NULL;
  PyObject *__pyx_v_X_normalized = NULL;
  PyObject *__pyx_v_y_norm = NULL;
  PyObject *__pyx_v_y_normalized = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__84)
  <span class='trace'>__Pyx_TraceCall</span>("normalize", __pyx_f[0], 2997, 0, <span class='error_goto'>__PYX_ERR(0, 2997, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.normalize", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X_norm);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X_normalized);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_norm);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_normalized);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_X);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__202 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_X, __pyx_n_s_y, __pyx_n_s_X_norm, __pyx_n_s_X_normalized, __pyx_n_s_y_norm, __pyx_n_s_y_normalized);<span class='error_goto'> if (unlikely(!__pyx_tuple__202)) __PYX_ERR(0, 2997, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__202);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__202);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(2997,0,<span class='error_goto'>__PYX_ERR(0, 2997, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_79normalize, 0, __pyx_n_s_normalize, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__84));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 2997, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__158);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_normalize, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 2997, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__84 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__202, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_normalize, 2997, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__84)) __PYX_ERR(0, 2997, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">2998</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">2999</span>:     Scales individual samples to have unit norm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3000</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3001</span>:     Normalization is critical for distance-based algorithms like k-Nearest</pre>
<pre class="cython line score-0">&#xA0;<span class="">3002</span>:     Neighbors and clustering algorithms. It ensures that each feature</pre>
<pre class="cython line score-0">&#xA0;<span class="">3003</span>:     contributes proportionately to the final distance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3004</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3005</span>:     Applications</pre>
<pre class="cython line score-0">&#xA0;<span class="">3006</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3007</span>:     - Preprocessing for clustering algorithms.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3008</span>:     - Normalizing data in natural language processing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3009</span>:     - Feature scaling in bioinformatics.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3010</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3011</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">3012</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3013</span>:     X : ndarray of shape (n_samples, n_features)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3014</span>:         The input samples.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3015</span>:     y : ndarray of shape (n_samples,), optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">3016</span>:         The output values. If provided, it will be normalized as well.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3017</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3018</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3019</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3020</span>:     X_normalized : ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">3021</span>:         Normalized version of X.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3022</span>:     y_normalized : ndarray, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">3023</span>:         Normalized version of y, if y is provided.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3024</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3025</span>:     Formula</pre>
<pre class="cython line score-0">&#xA0;<span class="">3026</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3027</span>:     The Normalize method scales each sample as follows:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3028</span>:         z = \frac{x}{||x||}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3029</span>:     where ||x|| is the Euclidean norm (L2 norm) of the sample.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3030</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3031</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">3032</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3033</span>:     &gt;&gt;&gt; X = np.array([[1, 2], [3, 4], [5, 6]])</pre>
<pre class="cython line score-0">&#xA0;<span class="">3034</span>:     &gt;&gt;&gt; X_normalized = normalize(X)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3035</span>:     """</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3036</span>:     X = ensure_2d(X)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(3036,0,<span class='error_goto'>__PYX_ERR(0, 3036, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_ensure_2d);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3036, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_X};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3036, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_X, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3037</span>:     X_norm = np.linalg.norm(X, axis=1, keepdims=True)</pre>
<pre class='cython code score-33 '>  <span class='trace'>__Pyx_TraceLine</span>(3037,0,<span class='error_goto'>__PYX_ERR(0, 3037, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3037, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3037, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_norm);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3037, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3037, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_X)) <span class='error_goto'>__PYX_ERR(0, 3037, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3037, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3037, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_keepdims, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3037, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3037, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_X_norm = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3038</span>:     X_normalized = X / X_norm</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3038,0,<span class='error_goto'>__PYX_ERR(0, 3038, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_X, __pyx_v_X_norm);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3038, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_v_X_normalized = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3039</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3040</span>:     if y is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(3040,0,<span class='error_goto'>__PYX_ERR(0, 3040, __pyx_L1_error)</span>)
  __pyx_t_6 = (__pyx_v_y != Py_None);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3041</span>:         y_norm = np.linalg.norm(y, axis=0, keepdims=True)</pre>
<pre class='cython code score-33 '>    <span class='trace'>__Pyx_TraceLine</span>(3041,0,<span class='error_goto'>__PYX_ERR(0, 3041, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3041, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_linalg);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3041, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_norm);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3041, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3041, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 3041, __pyx_L1_error)</span>;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3041, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3041, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_keepdims, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3041, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3041, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_y_norm = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3042</span>:         y_normalized = y / y_norm</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3042,0,<span class='error_goto'>__PYX_ERR(0, 3042, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_y, __pyx_v_y_norm);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3042, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_v_y_normalized = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3043</span>:         return X_normalized, y_normalized</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(3043,0,<span class='error_goto'>__PYX_ERR(0, 3043, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3043, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X_normalized);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_X_normalized);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_X_normalized)) <span class='error_goto'>__PYX_ERR(0, 3043, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y_normalized);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y_normalized);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_y_normalized)) <span class='error_goto'>__PYX_ERR(0, 3043, __pyx_L1_error)</span>;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3044</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3045</span>:     return X_normalized</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3045,0,<span class='error_goto'>__PYX_ERR(0, 3045, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_X_normalized);
  __pyx_r = __pyx_v_X_normalized;
  goto __pyx_L0;
</pre><pre class="cython line score-160" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3046</span>: def moving_average (</pre>
<pre class='cython code score-160 '>static PyObject *__pyx_pf_6gofast_5tools_6mathex_136__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("__defaults__", __pyx_f[0], 3046, 0, <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3046, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_window_size, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self)-&gt;__pyx_arg_window_size) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_method, ((PyObject*)__pyx_n_u_sma)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_mode, ((PyObject*)__pyx_n_u_same)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_alpha, ((PyObject*)__pyx_float__5)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3046, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, Py_None)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_81moving_average(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_80moving_average, " A moving average is  used with time series data to smooth out\n    short-term fluctuations and highlight longer-term trends or cycles.\n    \n    Funtion analyzes data points by creating a series of averages of different\n    subsets of the full data set. \n    \n    Parameters \n    ----------\n    y : array_like, shape (N,)\n        the values of the time history of the signal.\n        \n    window_size : int\n        the length of the window. Must be greater than 1 and preferably\n        an odd integer number.Default is ``3``\n        \n    method: str \n        variant of moving-average. Can be ``sma``, ``cma``, ``wma`` and ``ema`` \n        for simple, cummulative, weight and exponential moving average. Default \n        is ``sma``. \n        \n    mode: str\n        returns the convolution at each point of overlap, with an output shape\n        of (N+M-1,). At the end-points of the convolution, the signals do not \n        overlap completely, and boundary effects may be seen. Can be ``full``,\n        ``same`` and ``valid``. See :doc:`~np.convole` for more details. Default \n        is ``same``. \n        \n    alpha: float, \n        smoothing factor. Only uses in exponential moving-average. Default is \n        ``.5``.\n    \n    Returns \n    --------\n    ya: array like, shape (N,) \n        Averaged time history of the signal\n    \n    Notes \n    -------\n    The first element of the moving average is obtained by taking the average \n    of the initial fixed subset of the number series. Then the subset is\n    modified by \"shifting forward\"; that is, excluding the first number of the\n    series and including the next value in the subset.\n    \n    Examples\n    --------- \n    &gt;&gt;&gt; import numpy as np ; import matplotlib.pyplot as plt \n    &gt;&gt;&gt; from gofast.tools.tools   import moving_average \n    &gt;&gt;&gt; data = np.random.randn (37) \n    &gt;&gt;&gt; # add gaussion noise to the data \n    &gt;&gt;&gt; data = 2 * np.sin( data)  + np.random.normal (0, 1 , len(data))\n   "" &gt;&gt;&gt; window = 5  # fixed size to 5 \n    &gt;&gt;&gt; sma = moving_average(data, window) \n    &gt;&gt;&gt; cma = moving_average(data, window, method ='cma' )\n    &gt;&gt;&gt; wma = moving_average(data, window, method ='wma' )\n    &gt;&gt;&gt; ema = moving_average(data, window, method ='ema' , alpha =0.6)\n    &gt;&gt;&gt; x = np.arange(len(data))\n    &gt;&gt;&gt; plt.plot (x, data, 'o', x, sma , 'ok--', x, cma, 'g-.', x, wma, 'b:')\n    &gt;&gt;&gt; plt.legend (['data', 'sma', 'cma', 'wma'])\n    \n    References \n    ----------\n    .. * [1] https://en.wikipedia.org/wiki/Moving_average\n    .. * [2] https://www.sciencedirect.com/topics/engineering/hanning-window\n    .. * [3] https://stackoverflow.com/questions/12816011/weighted-moving-average-with-numpy-convolve\n    \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_81moving_average = {"moving_average", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_81moving_average, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_80moving_average};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_81moving_average(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_v_window_size = 0;
  PyObject *__pyx_v_method = 0;
  PyObject *__pyx_v_mode = 0;
  PyObject *__pyx_v_alpha = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("moving_average (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_y,&amp;__pyx_n_s_window_size,&amp;__pyx_n_s_method,&amp;__pyx_n_s_mode,&amp;__pyx_n_s_alpha,0};
  PyObject* values[5] = {0,0,0,0,0};
    __pyx_defaults1 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_self);
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_window_size);
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_sma)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_same)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float__5)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 4)) {
        Py_ssize_t index;
        for (index = 1; index &lt; 5 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "moving_average") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_y = values[0];
    __pyx_v_window_size = ((PyObject*)values[1]);
    __pyx_v_method = ((PyObject*)values[2]);
    __pyx_v_mode = ((PyObject*)values[3]);
    __pyx_v_alpha = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("moving_average", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.moving_average", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_window_size), (&amp;PyInt_Type), 0, "window_size", 1))) <span class='error_goto'>__PYX_ERR(0, 3049, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_method), (&amp;PyUnicode_Type), 0, "method", 1))) <span class='error_goto'>__PYX_ERR(0, 3050, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_mode), (&amp;PyUnicode_Type), 0, "mode", 1))) <span class='error_goto'>__PYX_ERR(0, 3051, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_80moving_average(__pyx_self, __pyx_v_y, __pyx_v_window_size, __pyx_v_method, __pyx_v_mode, __pyx_v_alpha);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_80moving_average(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_y, PyObject *__pyx_v_window_size, PyObject *__pyx_v_method, PyObject *__pyx_v_mode, PyObject *__pyx_v_alpha) {
  PyObject *__pyx_v_ya = NULL;
  PyObject *__pyx_v_w = NULL;
  PyObject *__pyx_v_ii = NULL;
  PyObject *__pyx_v_v = NULL;
  Py_ssize_t __pyx_9genexpr10__pyx_v_ii;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__85)
  <span class='trace'>__Pyx_TraceCall</span>("moving_average", __pyx_f[0], 3046, 0, <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_window_size);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.moving_average", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ya);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_w);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ii);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_window_size);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_method);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__203 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_y, __pyx_n_s_window_size, __pyx_n_s_method, __pyx_n_s_mode, __pyx_n_s_alpha, __pyx_n_s_ya, __pyx_n_s_w, __pyx_n_s_ii, __pyx_n_s_v, __pyx_n_s_ii);<span class='error_goto'> if (unlikely(!__pyx_tuple__203)) __PYX_ERR(0, 3046, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__203);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__203);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3046,0,<span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3046, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_window_size, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_method, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_mode, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_alpha, __pyx_kp_s_Union_int_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_81moving_average, 0, __pyx_n_s_moving_average, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__85));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3046, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_4, sizeof(__pyx_defaults1), 1)) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  __pyx_codeobj__85 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 4, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__203, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_moving_average, 3046, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__85)) __PYX_ERR(0, 3046, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3047</span>:     y:ArrayLike,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3048</span>:     *,</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3049</span>:     window_size:int  = 3 ,</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(3049,0,<span class='error_goto'>__PYX_ERR(0, 3049, __pyx_L1_error)</span>)
  if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_3)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_3))) <span class='error_goto'>__PYX_ERR(0, 3049, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults1, __pyx_t_4)-&gt;__pyx_arg_window_size = ((PyObject*)__pyx_int_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_4, __pyx_pf_6gofast_5tools_6mathex_136__defaults__);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_4, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_moving_average, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3046, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3050</span>:     method:str  ='sma',</pre>
<pre class="cython line score-0">&#xA0;<span class="">3051</span>:     mode:str  ='same',</pre>
<pre class="cython line score-0">&#xA0;<span class="">3052</span>:     alpha: Union [int, float]  =.5</pre>
<pre class="cython line score-0">&#xA0;<span class="">3053</span>: )-&gt; ArrayLike:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3054</span>:     """ A moving average is  used with time series data to smooth out</pre>
<pre class="cython line score-0">&#xA0;<span class="">3055</span>:     short-term fluctuations and highlight longer-term trends or cycles.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3056</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3057</span>:     Funtion analyzes data points by creating a series of averages of different</pre>
<pre class="cython line score-0">&#xA0;<span class="">3058</span>:     subsets of the full data set.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3059</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3060</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">3061</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3062</span>:     y : array_like, shape (N,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3063</span>:         the values of the time history of the signal.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3064</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3065</span>:     window_size : int</pre>
<pre class="cython line score-0">&#xA0;<span class="">3066</span>:         the length of the window. Must be greater than 1 and preferably</pre>
<pre class="cython line score-0">&#xA0;<span class="">3067</span>:         an odd integer number.Default is ``3``</pre>
<pre class="cython line score-0">&#xA0;<span class="">3068</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3069</span>:     method: str</pre>
<pre class="cython line score-0">&#xA0;<span class="">3070</span>:         variant of moving-average. Can be ``sma``, ``cma``, ``wma`` and ``ema``</pre>
<pre class="cython line score-0">&#xA0;<span class="">3071</span>:         for simple, cummulative, weight and exponential moving average. Default</pre>
<pre class="cython line score-0">&#xA0;<span class="">3072</span>:         is ``sma``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3073</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3074</span>:     mode: str</pre>
<pre class="cython line score-0">&#xA0;<span class="">3075</span>:         returns the convolution at each point of overlap, with an output shape</pre>
<pre class="cython line score-0">&#xA0;<span class="">3076</span>:         of (N+M-1,). At the end-points of the convolution, the signals do not</pre>
<pre class="cython line score-0">&#xA0;<span class="">3077</span>:         overlap completely, and boundary effects may be seen. Can be ``full``,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3078</span>:         ``same`` and ``valid``. See :doc:`~np.convole` for more details. Default</pre>
<pre class="cython line score-0">&#xA0;<span class="">3079</span>:         is ``same``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3080</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3081</span>:     alpha: float,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3082</span>:         smoothing factor. Only uses in exponential moving-average. Default is</pre>
<pre class="cython line score-0">&#xA0;<span class="">3083</span>:         ``.5``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3084</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3085</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3086</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3087</span>:     ya: array like, shape (N,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3088</span>:         Averaged time history of the signal</pre>
<pre class="cython line score-0">&#xA0;<span class="">3089</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3090</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">3091</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3092</span>:     The first element of the moving average is obtained by taking the average</pre>
<pre class="cython line score-0">&#xA0;<span class="">3093</span>:     of the initial fixed subset of the number series. Then the subset is</pre>
<pre class="cython line score-0">&#xA0;<span class="">3094</span>:     modified by "shifting forward"; that is, excluding the first number of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3095</span>:     series and including the next value in the subset.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3096</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3097</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">3098</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3099</span>:     &gt;&gt;&gt; import numpy as np ; import matplotlib.pyplot as plt</pre>
<pre class="cython line score-0">&#xA0;<span class="">3100</span>:     &gt;&gt;&gt; from gofast.tools.tools   import moving_average</pre>
<pre class="cython line score-0">&#xA0;<span class="">3101</span>:     &gt;&gt;&gt; data = np.random.randn (37)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3102</span>:     &gt;&gt;&gt; # add gaussion noise to the data</pre>
<pre class="cython line score-0">&#xA0;<span class="">3103</span>:     &gt;&gt;&gt; data = 2 * np.sin( data)  + np.random.normal (0, 1 , len(data))</pre>
<pre class="cython line score-0">&#xA0;<span class="">3104</span>:     &gt;&gt;&gt; window = 5  # fixed size to 5</pre>
<pre class="cython line score-0">&#xA0;<span class="">3105</span>:     &gt;&gt;&gt; sma = moving_average(data, window)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3106</span>:     &gt;&gt;&gt; cma = moving_average(data, window, method ='cma' )</pre>
<pre class="cython line score-0">&#xA0;<span class="">3107</span>:     &gt;&gt;&gt; wma = moving_average(data, window, method ='wma' )</pre>
<pre class="cython line score-0">&#xA0;<span class="">3108</span>:     &gt;&gt;&gt; ema = moving_average(data, window, method ='ema' , alpha =0.6)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3109</span>:     &gt;&gt;&gt; x = np.arange(len(data))</pre>
<pre class="cython line score-0">&#xA0;<span class="">3110</span>:     &gt;&gt;&gt; plt.plot (x, data, 'o', x, sma , 'ok--', x, cma, 'g-.', x, wma, 'b:')</pre>
<pre class="cython line score-0">&#xA0;<span class="">3111</span>:     &gt;&gt;&gt; plt.legend (['data', 'sma', 'cma', 'wma'])</pre>
<pre class="cython line score-0">&#xA0;<span class="">3112</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3113</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">3114</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3115</span>:     .. * [1] https://en.wikipedia.org/wiki/Moving_average</pre>
<pre class="cython line score-0">&#xA0;<span class="">3116</span>:     .. * [2] https://www.sciencedirect.com/topics/engineering/hanning-window</pre>
<pre class="cython line score-0">&#xA0;<span class="">3117</span>:     .. * [3] https://stackoverflow.com/questions/12816011/weighted-moving-average-with-numpy-convolve</pre>
<pre class="cython line score-0">&#xA0;<span class="">3118</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3119</span>:     """</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3120</span>:     y = np.array(y)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(3120,0,<span class='error_goto'>__PYX_ERR(0, 3120, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_y};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3120, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3121</span>:     try:</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(3121,0,<span class='error_goto'>__PYX_ERR(0, 3121, __pyx_L1_error)</span>)
  {
    /*try:*/ {
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    goto __pyx_L8_try_end;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
    __pyx_L5_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_5, __pyx_t_6, __pyx_t_7);
    goto __pyx_L1_error;
    __pyx_L8_try_end:;
  }
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3122</span>:         window_size = np.abs(_assert_all_types(int(window_size), int))</pre>
<pre class='cython code score-42 '>      <span class='trace'>__Pyx_TraceLine</span>(3122,0,<span class='error_goto'>__PYX_ERR(0, 3122, __pyx_L3_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3122, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3122, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_assert_all_types);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3122, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_window_size);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3122, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_10 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_10, __pyx_t_9, ((PyObject *)(&amp;PyInt_Type))};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3122, __pyx_L3_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      }
      __pyx_t_8 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_t_3};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3122, __pyx_L3_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_t_1))) <span class='error_goto'>__PYX_ERR(0, 3122, __pyx_L3_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_window_size, ((PyObject*)__pyx_t_1));
      __pyx_t_1 = 0;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3123</span>:     except ValueError:</pre>
<pre class='cython code score-6 '>    <span class='trace'>__Pyx_TraceLine</span>(3123,0,<span class='error_goto'>__PYX_ERR(0, 3123, __pyx_L5_except_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyErr_ExceptionMatches</span>(__pyx_builtin_ValueError);
    if (__pyx_t_4) {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.moving_average", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_1, &amp;__pyx_t_2, &amp;__pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3123, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3124</span>:         raise ValueError("window_size has to be of type int")</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(3124,0,<span class='error_goto'>__PYX_ERR(0, 3124, __pyx_L5_except_error)</span>)
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__86, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3124, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='error_goto'>__PYX_ERR(0, 3124, __pyx_L5_except_error)</span>
    }
    goto __pyx_L5_except_error;
/* … */
  __pyx_tuple__86 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_window_size_has_to_be_of_type_in);<span class='error_goto'> if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 3124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__86);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__86);
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3125</span>:     if window_size &lt; 1:</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(3125,0,<span class='error_goto'>__PYX_ERR(0, 3125, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_window_size, __pyx_int_1, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3125, __pyx_L1_error)</span>
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3125, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(__pyx_t_11)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3126</span>:         raise TypeError("window_size size must be a positive odd number")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(3126,0,<span class='error_goto'>__PYX_ERR(0, 3126, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__87, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3126, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3126, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__87 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_window_size_size_must_be_a_posit);<span class='error_goto'> if (unlikely(!__pyx_tuple__87)) __PYX_ERR(0, 3126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__87);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__87);
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3127</span>:     if  window_size &gt; len(y):</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(3127,0,<span class='error_goto'>__PYX_ERR(0, 3127, __pyx_L1_error)</span>)
  __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3127, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_window_size, __pyx_t_3, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3127, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3127, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(__pyx_t_11)) {
/* … */
  }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3128</span>:         raise TypeError("window_size is too large for averaging. Window"</pre>
<pre class='cython code score-9 '>    <span class='trace'>__Pyx_TraceLine</span>(3128,0,<span class='error_goto'>__PYX_ERR(0, 3128, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_window_size_is_too_large_for_ave, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3128, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3129</span>:                         f" must be greater than 0 and less than {len(y)}")</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(3129,0,<span class='error_goto'>__PYX_ERR(0, 3129, __pyx_L1_error)</span>)
    __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3129, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_12, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3129, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-0">&#xA0;<span class="">3130</span>: </pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3131</span>:     method =str(method).lower().strip().replace ('-', ' ')</pre>
<pre class='cython code score-55 '>  <span class='trace'>__Pyx_TraceLine</span>(3131,0,<span class='error_goto'>__PYX_ERR(0, 3131, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_v_method);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_strip);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_replace);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_tuple__89, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (!(likely(<span class='py_c_api'>PyUnicode_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("unicode", __pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 3131, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_method, ((PyObject*)__pyx_t_2));
  __pyx_t_2 = 0;
/* … */
  __pyx_tuple__89 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_kp_u__88, __pyx_kp_u__31);<span class='error_goto'> if (unlikely(!__pyx_tuple__89)) __PYX_ERR(0, 3131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__89);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__89);
</pre><pre class="cython line score-0">&#xA0;<span class="">3132</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3133</span>:     if method in ('simple moving average',</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(3133,0,<span class='error_goto'>__PYX_ERR(0, 3133, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
  __pyx_t_13 = __pyx_v_method;
  __pyx_t_14 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_kp_u_simple_moving_average, Py_EQ)); if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3133, __pyx_L1_error)</span>
  if (!__pyx_t_14) {
  } else {
    __pyx_t_11 = __pyx_t_14;
    goto __pyx_L14_bool_binop_done;
  }
  __pyx_t_14 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_n_u_simple, Py_EQ)); if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3133, __pyx_L1_error)</span>
  if (!__pyx_t_14) {
  } else {
    __pyx_t_11 = __pyx_t_14;
    goto __pyx_L14_bool_binop_done;
  }
  __pyx_t_14 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_n_u_sma, Py_EQ)); if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3133, __pyx_L1_error)</span>
  __pyx_t_11 = __pyx_t_14;
  __pyx_L14_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_14 = __pyx_t_11;
  if (__pyx_t_14) {
/* … */
    goto __pyx_L13;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3134</span>:                   'simple', 'sma'):</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3135</span>:         method = 'sma'</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3135,0,<span class='error_goto'>__PYX_ERR(0, 3135, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_sma);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_method, __pyx_n_u_sma);
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3136</span>:     elif method  in ('cumulative average',</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(3136,0,<span class='error_goto'>__PYX_ERR(0, 3136, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
  __pyx_t_13 = __pyx_v_method;
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_kp_u_cumulative_average, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3136, __pyx_L1_error)</span>
  if (!__pyx_t_11) {
  } else {
    __pyx_t_14 = __pyx_t_11;
    goto __pyx_L17_bool_binop_done;
  }
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_n_u_cumulative, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3136, __pyx_L1_error)</span>
  if (!__pyx_t_11) {
  } else {
    __pyx_t_14 = __pyx_t_11;
    goto __pyx_L17_bool_binop_done;
  }
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_n_u_cma, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3136, __pyx_L1_error)</span>
  __pyx_t_14 = __pyx_t_11;
  __pyx_L17_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_11 = __pyx_t_14;
  if (__pyx_t_11) {
/* … */
    goto __pyx_L13;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3137</span>:                      'cumulative', 'cma'):</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3138</span>:         method ='cma'</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3138,0,<span class='error_goto'>__PYX_ERR(0, 3138, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_cma);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_method, __pyx_n_u_cma);
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3139</span>:     elif method  in ('weighted moving average',</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(3139,0,<span class='error_goto'>__PYX_ERR(0, 3139, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
  __pyx_t_13 = __pyx_v_method;
  __pyx_t_14 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_kp_u_weighted_moving_average, Py_EQ)); if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3139, __pyx_L1_error)</span>
  if (!__pyx_t_14) {
  } else {
    __pyx_t_11 = __pyx_t_14;
    goto __pyx_L20_bool_binop_done;
  }
  __pyx_t_14 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_n_u_weight, Py_EQ)); if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3139, __pyx_L1_error)</span>
  if (!__pyx_t_14) {
  } else {
    __pyx_t_11 = __pyx_t_14;
    goto __pyx_L20_bool_binop_done;
  }
  __pyx_t_14 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_n_u_wma, Py_EQ)); if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3139, __pyx_L1_error)</span>
  __pyx_t_11 = __pyx_t_14;
  __pyx_L20_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_14 = __pyx_t_11;
  if (__pyx_t_14) {
/* … */
    goto __pyx_L13;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3140</span>:                      'weight', 'wma'):</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3141</span>:         method = 'wma'</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3141,0,<span class='error_goto'>__PYX_ERR(0, 3141, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_wma);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_method, __pyx_n_u_wma);
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3142</span>:     elif method in('exponential moving average',</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(3142,0,<span class='error_goto'>__PYX_ERR(0, 3142, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
  __pyx_t_13 = __pyx_v_method;
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_kp_u_exponential_moving_average, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3142, __pyx_L1_error)</span>
  if (!__pyx_t_11) {
  } else {
    __pyx_t_14 = __pyx_t_11;
    goto __pyx_L23_bool_binop_done;
  }
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_n_u_exponential, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3142, __pyx_L1_error)</span>
  if (!__pyx_t_11) {
  } else {
    __pyx_t_14 = __pyx_t_11;
    goto __pyx_L23_bool_binop_done;
  }
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_13, __pyx_n_u_ema, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3142, __pyx_L1_error)</span>
  __pyx_t_14 = __pyx_t_11;
  __pyx_L23_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  __pyx_t_11 = __pyx_t_14;
  if (likely(__pyx_t_11)) {
/* … */
    goto __pyx_L13;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3143</span>:                    'exponential', 'ema'):</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3144</span>:         method = 'ema'</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3144,0,<span class='error_goto'>__PYX_ERR(0, 3144, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_ema);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_method, __pyx_n_u_ema);
</pre><pre class="cython line score-0">&#xA0;<span class="">3145</span>:     else :</pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3146</span>:         raise ValueError ("Variant average methods only includes "</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(3146,0,<span class='error_goto'>__PYX_ERR(0, 3146, __pyx_L1_error)</span>)
  /*else*/ {
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3146,0,<span class='error_goto'>__PYX_ERR(0, 3146, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_Variant_average_methods_only_inc, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3146, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3146, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3146, __pyx_L1_error)</span>
  }
  __pyx_L13:;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3147</span>:                           f" {smart_format(['sma', 'cma', 'wma', 'ema'], 'or')}")</pre>
<pre class='cython code score-37 '>    <span class='trace'>__Pyx_TraceLine</span>(3147,0,<span class='error_goto'>__PYX_ERR(0, 3147, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_smart_format);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_sma);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_sma);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_n_u_sma)) <span class='error_goto'>__PYX_ERR(0, 3147, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_cma);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_cma);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 1, __pyx_n_u_cma)) <span class='error_goto'>__PYX_ERR(0, 3147, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_wma);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_wma);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 2, __pyx_n_u_wma)) <span class='error_goto'>__PYX_ERR(0, 3147, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_ema);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_ema);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 3, __pyx_n_u_ema)) <span class='error_goto'>__PYX_ERR(0, 3147, __pyx_L1_error)</span>;
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_t_3, __pyx_n_u_or};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3147, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_2, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3147, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3148</span>:     if  1. &lt;= alpha &lt;= 0 :</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(3148,0,<span class='error_goto'>__PYX_ERR(0, 3148, __pyx_L1_error)</span>)
  __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_float_1_, __pyx_v_alpha, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3148, __pyx_L1_error)</span>
  if (<span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_8)) {
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8);
    __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_alpha, __pyx_int_0, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3148, __pyx_L1_error)</span>
  }
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_8); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3148, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (unlikely(__pyx_t_11)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3149</span>:         raise ValueError ('alpha should be less than 1. and greater than 0. ')</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(3149,0,<span class='error_goto'>__PYX_ERR(0, 3149, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__90, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3149, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3149, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__90 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_alpha_should_be_less_than_1_and);<span class='error_goto'> if (unlikely(!__pyx_tuple__90)) __PYX_ERR(0, 3149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__90);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__90);
</pre><pre class="cython line score-0">&#xA0;<span class="">3150</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3151</span>:     if method =='cma':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3151,0,<span class='error_goto'>__PYX_ERR(0, 3151, __pyx_L1_error)</span>)
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_cma, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3151, __pyx_L1_error)</span>
  if (__pyx_t_11) {
/* … */
    goto __pyx_L27;
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3152</span>:         y = np.cumsum (y)</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(3152,0,<span class='error_goto'>__PYX_ERR(0, 3152, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3152, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_y};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3152, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3153</span>:         ya = np.array([ y[ii]/ len(y[:ii +1]) for ii in range(len(y))])</pre>
<pre class='cython code score-52 '>    <span class='trace'>__Pyx_TraceLine</span>(3153,0,<span class='error_goto'>__PYX_ERR(0, 3153, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    { /* enter inner scope */
      __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3153, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3153, __pyx_L1_error)</span>
      __pyx_t_15 = __pyx_t_12;
      for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
        __pyx_9genexpr10__pyx_v_ii = __pyx_t_16;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_y, __pyx_9genexpr10__pyx_v_ii, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3153, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_y, 0, (__pyx_9genexpr10__pyx_v_ii + 1), NULL, NULL, NULL, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3153, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_17 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(__pyx_t_17 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3153, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3153, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3153, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_10))) <span class='error_goto'>__PYX_ERR(0, 3153, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
    } /* exit inner scope */
    __pyx_t_10 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_3};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3153, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_v_ya = __pyx_t_8;
    __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3154</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3155</span>:     elif method =='wma':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3155,0,<span class='error_goto'>__PYX_ERR(0, 3155, __pyx_L1_error)</span>)
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_wma, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3155, __pyx_L1_error)</span>
  if (__pyx_t_11) {
/* … */
    goto __pyx_L27;
  }
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3156</span>:         w = np.cumsum(np.ones(window_size, dtype = float))</pre>
<pre class='cython code score-45 '>    <span class='trace'>__Pyx_TraceLine</span>(3156,0,<span class='error_goto'>__PYX_ERR(0, 3156, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3156, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3156, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3156, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3156, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3156, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_window_size);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_window_size);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_window_size)) <span class='error_goto'>__PYX_ERR(0, 3156, __pyx_L1_error)</span>;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3156, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_9, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3156, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_2, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3156, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_1};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3156, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_v_w = __pyx_t_8;
    __pyx_t_8 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3157</span>:         w /= np.sum(w)</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(3157,0,<span class='error_goto'>__PYX_ERR(0, 3157, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3157, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3157, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_w};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3157, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_InPlaceDivide</span>(__pyx_v_w, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3157, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_w, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3158</span>:         ya = np.convolve(y, w[::-1], mode ) #/window_size</pre>
<pre class='cython code score-22 '>    <span class='trace'>__Pyx_TraceLine</span>(3158,0,<span class='error_goto'>__PYX_ERR(0, 3158, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3158, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_convolve);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3158, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_w, __pyx_slice__69);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3158, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_9, __pyx_v_y, __pyx_t_8, __pyx_v_mode};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 3+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3158, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_v_ya = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3159</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3160</span>:     elif method =='ema':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3160,0,<span class='error_goto'>__PYX_ERR(0, 3160, __pyx_L1_error)</span>)
  __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_ema, Py_EQ)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3160, __pyx_L1_error)</span>
  if (__pyx_t_11) {
/* … */
    goto __pyx_L27;
  }
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3161</span>:         ya = np.array ([y[0]])</pre>
<pre class='cython code score-29 '>    <span class='trace'>__Pyx_TraceLine</span>(3161,0,<span class='error_goto'>__PYX_ERR(0, 3161, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_y, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_9 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3161, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3161, __pyx_L1_error)</span>;
    __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_9};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3161, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    __pyx_v_ya = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3162</span>:         for ii in range(1, len(y)):</pre>
<pre class='cython code score-73 '>    <span class='trace'>__Pyx_TraceLine</span>(3162,0,<span class='error_goto'>__PYX_ERR(0, 3162, __pyx_L1_error)</span>)
    __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3162, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3162, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3162, __pyx_L1_error)</span>;
    __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3162, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
      __pyx_t_8 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      __pyx_t_12 = 0;
      __pyx_t_18 = NULL;
    } else {
      __pyx_t_12 = -1; __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3162, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 3162, __pyx_L1_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    for (;;) {
      if (likely(!__pyx_t_18)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_8);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3162, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_12 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_8, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3162, __pyx_L1_error)</span>
          #else
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_8, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3162, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_8);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3162, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_12 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_8, __pyx_t_12); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_12++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3162, __pyx_L1_error)</span>
          #else
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_8, __pyx_t_12); __pyx_t_12++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3162, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          #endif
        }
      } else {
        __pyx_t_1 = __pyx_t_18(__pyx_t_8);
        if (unlikely(!__pyx_t_1)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 3162, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ii, __pyx_t_1);
      __pyx_t_1 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(3162,0,<span class='error_goto'>__PYX_ERR(0, 3162, __pyx_L1_error)</span>)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3163</span>:             v = y[ii] * alpha + ( 1- alpha ) * ya[-1]</pre>
<pre class='cython code score-27 '>      <span class='trace'>__Pyx_TraceLine</span>(3163,0,<span class='error_goto'>__PYX_ERR(0, 3163, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_y, __pyx_v_ii);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3163, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_alpha);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3163, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_alpha, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3163, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ya, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3163, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3163, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3163, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3164</span>:             ya = np.append(ya, v)</pre>
<pre class='cython code score-20 '>      <span class='trace'>__Pyx_TraceLine</span>(3164,0,<span class='error_goto'>__PYX_ERR(0, 3164, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3164, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_append);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3164, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_ya, __pyx_v_v};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3164, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ya, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3165</span>:     else:</pre>
<pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3166</span>:         ya = np.convolve(y , np.ones (window_size), mode ) / window_size</pre>
<pre class='cython code score-42 '>  <span class='trace'>__Pyx_TraceLine</span>(3166,0,<span class='error_goto'>__PYX_ERR(0, 3166, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3166, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_convolve);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3166, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3166, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3166, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_window_size};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3166, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_1, __pyx_v_y, __pyx_t_3, __pyx_v_mode};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_4, 3+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3166, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_8, __pyx_v_window_size);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3166, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_v_ya = __pyx_t_9;
    __pyx_t_9 = 0;
  }
  __pyx_L27:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3167</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3168</span>:     return ya</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3168,0,<span class='error_goto'>__PYX_ERR(0, 3168, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ya);
  __pyx_r = __pyx_v_ya;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3169</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3170</span>: </pre>
<pre class="cython line score-100" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3171</span>: def count_local_minima(arr,  method='robust', order=1):</pre>
<pre class='cython code score-100 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_83count_local_minima(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_82count_local_minima, "\n    Count the number of local minima in a 1D array.\n    \n    Parameters\n    ----------\n    arr : array_like\n        Input array.\n    method : {'base', 'robust'}, optional\n        Method to use for finding local minima. \n        'base' uses a simple comparison, while 'robust' \n        uses scipy's argrelextrema function. Default is 'robust'.\n    order : int, optional\n        How many points on each side to use for the comparison \n        to consider a point as a local minimum (only used with \n        'robust' method). Default is 1.\n    \n    Returns\n    -------\n    int\n        Number of local minima in the array.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex import count_local_minima\n    &gt;&gt;&gt; arr = [1, 3, 2, 4, 1, 0, 2, 1]\n    &gt;&gt;&gt; count_local_minima(arr, method='base')\n    2\n    &gt;&gt;&gt; count_local_minima(arr, method='robust')\n    3\n    \n    Notes\n    -----\n    - The 'base' method compares each element with its immediate \n      neighbors, which might be less accurate for noisy data.\n    - The 'robust' method uses scipy's argrelextrema function, which \n      allows for more flexible and accurate detection of local minima \n      by considering a specified number of neighboring points.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_83count_local_minima = {"count_local_minima", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_83count_local_minima, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_82count_local_minima};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_83count_local_minima(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_arr = 0;
  PyObject *__pyx_v_method = 0;
  PyObject *__pyx_v_order = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("count_local_minima (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_arr,&amp;__pyx_n_s_method,&amp;__pyx_n_s_order,0};
  PyObject* values[3] = {0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_robust)));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_1)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_arr)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3171, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_method);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3171, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_order);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3171, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "count_local_minima") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3171, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_arr = values[0];
    __pyx_v_method = values[1];
    __pyx_v_order = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("count_local_minima", 0, 1, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3171, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.count_local_minima", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_82count_local_minima(__pyx_self, __pyx_v_arr, __pyx_v_method, __pyx_v_order);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_82count_local_minima(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_arr, PyObject *__pyx_v_method, PyObject *__pyx_v_order) {
  PyObject *__pyx_v_local_minima_count = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_local_minima_indices = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__91)
  <span class='trace'>__Pyx_TraceCall</span>("count_local_minima", __pyx_f[0], 3171, 0, <span class='error_goto'>__PYX_ERR(0, 3171, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_method);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.count_local_minima", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_local_minima_count);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_local_minima_indices);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_method);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__204 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_arr, __pyx_n_s_method, __pyx_n_s_order, __pyx_n_s_local_minima_count, __pyx_n_s_i, __pyx_n_s_local_minima_indices);<span class='error_goto'> if (unlikely(!__pyx_tuple__204)) __PYX_ERR(0, 3171, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__204);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__204);
  __pyx_codeobj__91 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__204, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_count_local_minima, 3171, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__91)) __PYX_ERR(0, 3171, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3171,0,<span class='error_goto'>__PYX_ERR(0, 3171, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_83count_local_minima, 0, __pyx_n_s_count_local_minima, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__91));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3171, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_tuple__205);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_count_local_minima, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3171, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__205 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject*)__pyx_n_u_robust), ((PyObject *)__pyx_int_1));<span class='error_goto'> if (unlikely(!__pyx_tuple__205)) __PYX_ERR(0, 3171, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__205);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__205);
</pre><pre class="cython line score-0">&#xA0;<span class="">3172</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">3173</span>:     Count the number of local minima in a 1D array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3174</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3175</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">3176</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3177</span>:     arr : array_like</pre>
<pre class="cython line score-0">&#xA0;<span class="">3178</span>:         Input array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3179</span>:     method : {'base', 'robust'}, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">3180</span>:         Method to use for finding local minima.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3181</span>:         'base' uses a simple comparison, while 'robust'</pre>
<pre class="cython line score-0">&#xA0;<span class="">3182</span>:         uses scipy's argrelextrema function. Default is 'robust'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3183</span>:     order : int, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">3184</span>:         How many points on each side to use for the comparison</pre>
<pre class="cython line score-0">&#xA0;<span class="">3185</span>:         to consider a point as a local minimum (only used with</pre>
<pre class="cython line score-0">&#xA0;<span class="">3186</span>:         'robust' method). Default is 1.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3187</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3188</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3189</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3190</span>:     int</pre>
<pre class="cython line score-0">&#xA0;<span class="">3191</span>:         Number of local minima in the array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3192</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3193</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">3194</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3195</span>:     &gt;&gt;&gt; from gofast.tools.mathex import count_local_minima</pre>
<pre class="cython line score-0">&#xA0;<span class="">3196</span>:     &gt;&gt;&gt; arr = [1, 3, 2, 4, 1, 0, 2, 1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">3197</span>:     &gt;&gt;&gt; count_local_minima(arr, method='base')</pre>
<pre class="cython line score-0">&#xA0;<span class="">3198</span>:     2</pre>
<pre class="cython line score-0">&#xA0;<span class="">3199</span>:     &gt;&gt;&gt; count_local_minima(arr, method='robust')</pre>
<pre class="cython line score-0">&#xA0;<span class="">3200</span>:     3</pre>
<pre class="cython line score-0">&#xA0;<span class="">3201</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3202</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">3203</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">3204</span>:     - The 'base' method compares each element with its immediate</pre>
<pre class="cython line score-0">&#xA0;<span class="">3205</span>:       neighbors, which might be less accurate for noisy data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3206</span>:     - The 'robust' method uses scipy's argrelextrema function, which</pre>
<pre class="cython line score-0">&#xA0;<span class="">3207</span>:       allows for more flexible and accurate detection of local minima</pre>
<pre class="cython line score-0">&#xA0;<span class="">3208</span>:       by considering a specified number of neighboring points.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3209</span>:     """</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3210</span>:     arr= check_y (arr , y_numeric =True, estimator="Array" )</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(3210,0,<span class='error_goto'>__PYX_ERR(0, 3210, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_check_y);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3210, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3210, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_arr);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_arr)) <span class='error_goto'>__PYX_ERR(0, 3210, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3210, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_y_numeric, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3210, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_estimator, __pyx_n_u_Array) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3210, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3210, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3211</span>:     method= parameter_validator(</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(3211,0,<span class='error_goto'>__PYX_ERR(0, 3211, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_parameter_validator);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3211, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3211,0,<span class='error_goto'>__PYX_ERR(0, 3211, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__92, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3211, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__92 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_u_method);<span class='error_goto'> if (unlikely(!__pyx_tuple__92)) __PYX_ERR(0, 3211, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__92);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__92);
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3212</span>:         "method", target_strs= {"base", "robust"})(method)</pre>
<pre class='cython code score-38 '>  <span class='trace'>__Pyx_TraceLine</span>(3212,0,<span class='error_goto'>__PYX_ERR(0, 3212, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PySet_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3212, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_1, __pyx_n_u_base) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3212, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PySet_Add</span>(__pyx_t_1, __pyx_n_u_robust) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3212, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_target_strs, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3212, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3212,0,<span class='error_goto'>__PYX_ERR(0, 3212, __pyx_L1_error)</span>)
  __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_method};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3212, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_method, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3213</span>:     if method == 'base':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3213,0,<span class='error_goto'>__PYX_ERR(0, 3213, __pyx_L1_error)</span>)
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_base, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3213, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3214</span>:         local_minima_count = 0</pre>
<pre class='cython code score-1 '>    <span class='trace'>__Pyx_TraceLine</span>(3214,0,<span class='error_goto'>__PYX_ERR(0, 3214, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_v_local_minima_count = __pyx_int_0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3215</span>:         # Iterate through the array from the second element</pre>
<pre class="cython line score-0">&#xA0;<span class="">3216</span>:         # to the second-to-last element</pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3217</span>:         for i in range(1, len(arr) - 1):</pre>
<pre class='cython code score-73 '>    <span class='trace'>__Pyx_TraceLine</span>(3217,0,<span class='error_goto'>__PYX_ERR(0, 3217, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_arr);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3217, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_t_7 - 1));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3217, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3217, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 3217, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3217, __pyx_L1_error)</span>;
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3217, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
      __pyx_t_1 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_7 = 0;
      __pyx_t_8 = NULL;
    } else {
      __pyx_t_7 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3217, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3217, __pyx_L1_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    for (;;) {
      if (likely(!__pyx_t_8)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3217, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3217, __pyx_L1_error)</span>
          #else
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3217, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3217, __pyx_L1_error)</span>
            #endif
            if (__pyx_t_7 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3217, __pyx_L1_error)</span>
          #else
          __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3217, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
          #endif
        }
      } else {
        __pyx_t_4 = __pyx_t_8(__pyx_t_1);
        if (unlikely(!__pyx_t_4)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 3217, __pyx_L1_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_4);
      __pyx_t_4 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(3217,0,<span class='error_goto'>__PYX_ERR(0, 3217, __pyx_L1_error)</span>)
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3218</span>:             if arr[i] &lt; arr[i - 1] and arr[i] &lt; arr[i + 1]:</pre>
<pre class='cython code score-34 '>      <span class='trace'>__Pyx_TraceLine</span>(3218,0,<span class='error_goto'>__PYX_ERR(0, 3218, __pyx_L1_error)</span>)
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_arr, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3218, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3218, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_arr, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3218, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_3, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3218, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3218, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (__pyx_t_9) {
      } else {
        __pyx_t_6 = __pyx_t_9;
        goto __pyx_L7_bool_binop_done;
      }
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_arr, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3218, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3218, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_arr, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3218, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_4, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3218, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3218, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_6 = __pyx_t_9;
      __pyx_L7_bool_binop_done:;
      if (__pyx_t_6) {
/* … */
      }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3219</span>:                 local_minima_count += 1</pre>
<pre class='cython code score-3 '>        <span class='trace'>__Pyx_TraceLine</span>(3219,0,<span class='error_goto'>__PYX_ERR(0, 3219, __pyx_L1_error)</span>)
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_local_minima_count, __pyx_int_1, 1, 1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3219, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_local_minima_count, __pyx_t_3);
        __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3220</span>:         return local_minima_count</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3220,0,<span class='error_goto'>__PYX_ERR(0, 3220, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_local_minima_count);
    __pyx_r = __pyx_v_local_minima_count;
    goto __pyx_L0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3221</span>:     elif method == 'robust':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3221,0,<span class='error_goto'>__PYX_ERR(0, 3221, __pyx_L1_error)</span>)
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_method, __pyx_n_u_robust, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3221, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3222</span>:         # Find indices of local minima</pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3223</span>:         local_minima_indices = argrelextrema(np.array(arr),</pre>
<pre class='cython code score-35 '>    <span class='trace'>__Pyx_TraceLine</span>(3223,0,<span class='error_goto'>__PYX_ERR(0, 3223, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_argrelextrema);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3223, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3223, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3223, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_arr};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3223, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3223,0,<span class='error_goto'>__PYX_ERR(0, 3223, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3223, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3223, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 3223, __pyx_L1_error)</span>;
    __pyx_t_3 = 0;
    __pyx_t_4 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3223,0,<span class='error_goto'>__PYX_ERR(0, 3223, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3223, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3224</span>:                                              np.less,</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(3224,0,<span class='error_goto'>__PYX_ERR(0, 3224, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3224, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_less);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3224, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3225</span>:                                              order=order)[0]</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(3225,0,<span class='error_goto'>__PYX_ERR(0, 3225, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3225, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_order, __pyx_v_order) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3225, __pyx_L1_error)</span>
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3225,0,<span class='error_goto'>__PYX_ERR(0, 3225, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3225, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_v_local_minima_indices = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3226</span>:         # The number of local minima is the length of the indices array</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3227</span>:         return len(local_minima_indices)</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(3227,0,<span class='error_goto'>__PYX_ERR(0, 3227, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_local_minima_indices);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3227, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3227, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3228</span>: </pre>
<pre class="cython line score-113" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3229</span>: def get_azimuth (</pre>
<pre class='cython code score-113 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_85get_azimuth(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_84get_azimuth, "Compute azimuth from coordinate locations ( latitude,  longitude). \n    \n    If `easting` and `northing` are given rather than `longitude` and  \n    `latitude`, the projection should explicitely set to ``UTM`` to perform \n    the ideal conversion. However if mode is set to `soft` (default), the type\n    of projection is automatically detected . Note that when UTM coordinates \n    are provided, `xlon` and `ylat` fit ``easting`` and ``northing`` \n    respectively.\n    \n    Parameters\n    -----------\n    xlon, ylat : Arraylike 1d or str, str \n       ArrayLike of easting/longitude and arraylike of nothing/latitude. They \n       should be one dimensional. In principle if data is supplied, they must \n       be series.  If `xlon` and `ylat` are given as string values, the \n       `data` must be supplied. xlon and ylat names must be included in the  \n       dataframe otherwise an error raises. \n       \n    data: pd.DataFrame, \n       Data containing x and y names. Need to be supplied when x and y \n       are given as string names. \n       \n    utm_zone: Optional, string\n       zone number and 'S' or 'N' e.g. '55S'. Default to the centre point\n       of coordinates points in the survey area. It should be a string (##N or ##S)\n       in the form of number and North or South hemisphere, 10S or 03N\n       \n    projection: str, ['utm'|'ll'] \n       The coordinate system in which the data points for the profile is collected. \n       when `mode='soft'`,  the auto-detection will be triggered and find the \n       suitable coordinate system. However, it is recommended to explicitly \n       provide projection when data is in UTM coordinates. \n       Note that if `x` and `y` are composed of value greater than 180 degrees \n       for longitude and 90 degrees for latitude, and method is still in \n       the ``soft` mode, it should be considered as  longitude-latitude ``UTM``\n       coordinates system. \n       \n    isdeg: bool, default=True \n      By ""default xlon and xlat are in degree coordinates. If both arguments \n      are given in radians, set to ``False`` instead. \n      \n    mode: str , ['soft'|'strict']\n      ``strict`` mode does not convert any coordinates system to other at least\n      it is explicitly set to `projection` whereas the `soft` does.\n      \n    extrapolate: bool, default=False \n      In principle, the azimuth is compute between two points. Thus, the number\n      of values computed for :math:`N` stations should  be  :math:`N-1`. To fit\n      values to match the number of size of the array, `extrapolate` should be \n      ``True``. In that case, the first station holds a &lt;&lt;fake&gt;&gt; azimuth as \n      the closer value computed from interpolation of all azimuths. \n      \n    view: bool, default=False, \n       Quick view of the azimuth. It is usefull especially when \n       extrapolate is set to ``True``. \n       \n    Return \n    --------\n    azim: ArrayLike \n       Azimuth computed from locations. \n       \n    Examples \n    ----------\n    &gt;&gt;&gt; import gofast as gf \n    &gt;&gt;&gt; from gofast.tools.mathex  import get_azimuth \n    &gt;&gt;&gt; # generate a data from ERP \n    &gt;&gt;&gt; data = gf.make_erp (n_stations =7 ).frame \n    &gt;&gt;&gt; get_azimuth ( data.longitude, data.latitude)\n    array([54.575, 54.575, 54.575, 54.575, 54.575, 54.575])\n    &gt;&gt;&gt; get_azimuth ( data.longitude, data.latitude, view =True, extrapolate=True)\n    array([54.57500007, 54.575     , 54.575     , 54.575     , 54.575     ,\n           54.575     , 54.575     ])\n    \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_85get_azimuth = {"get_azimuth", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_85get_azimuth, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_84get_azimuth};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_85get_azimuth(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_xlon = 0;
  PyObject *__pyx_v_ylat = 0;
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_utm_zone = 0;
  PyObject *__pyx_v_projection = 0;
  PyObject *__pyx_v_isdeg = 0;
  PyObject *__pyx_v_mode = 0;
  PyObject *__pyx_v_extrapolate = 0;
  PyObject *__pyx_v_view = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_azimuth (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_xlon,&amp;__pyx_n_s_ylat,&amp;__pyx_n_s_data,&amp;__pyx_n_s_utm_zone,&amp;__pyx_n_s_projection,&amp;__pyx_n_s_isdeg,&amp;__pyx_n_s_mode,&amp;__pyx_n_s_extrapolate,&amp;__pyx_n_s_view,0};
  PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_6gofast_5tools_6mathex_84get_azimuth(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_xlon, PyObject *__pyx_v_ylat, PyObject *__pyx_v_data, PyObject *__pyx_v_utm_zone, PyObject *__pyx_v_projection, PyObject *__pyx_v_isdeg, PyObject *__pyx_v_mode, PyObject *__pyx_v_extrapolate, PyObject *__pyx_v_view) {
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth *__pyx_cur_scope;
  PyObject *__pyx_v_Location = NULL;
  PyObject *__pyx_v_msg = NULL;
  PyObject *__pyx_v_dx = NULL;
  PyObject *__pyx_v_dy = NULL;
  PyObject *__pyx_v_z = NULL;
  PyObject *__pyx_v_azim = NULL;
  PyObject *__pyx_v_x = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_fig = NULL;
  PyObject *__pyx_v_ax = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__93)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth *)__pyx_tp_new_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth(__pyx_ptype_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("get_azimuth", __pyx_f[0], 3229, 0, <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_xlon = __pyx_v_xlon;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_xlon);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_xlon);
  __pyx_cur_scope-&gt;__pyx_v_ylat = __pyx_v_ylat;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_ylat);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_ylat);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_projection);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mode);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_extrapolate);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_view);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_azimuth", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Location);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_msg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_azim);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fig);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ax);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_projection);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_mode);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_extrapolate);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_view);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__206 = <span class='py_c_api'>PyTuple_Pack</span>(18, __pyx_n_s_xlon, __pyx_n_s_ylat, __pyx_n_s_data, __pyx_n_s_utm_zone, __pyx_n_s_projection, __pyx_n_s_isdeg, __pyx_n_s_mode, __pyx_n_s_extrapolate, __pyx_n_s_view, __pyx_n_s_Location, __pyx_n_s_msg, __pyx_n_s_dx, __pyx_n_s_dy, __pyx_n_s_z, __pyx_n_s_azim, __pyx_n_s_x, __pyx_n_s_fig, __pyx_n_s_ax);<span class='error_goto'> if (unlikely(!__pyx_tuple__206)) __PYX_ERR(0, 3229, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__206);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__206);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3229,0,<span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3229, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3229,0,<span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3229, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_xlon, __pyx_kp_s_Union_str_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_ylat, __pyx_kp_s_Union_str_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_data, __pyx_n_s_DataFrame) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_utm_zone, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_projection, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_isdeg, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_mode, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_extrapolate, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_view, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_85get_azimuth, 0, __pyx_n_s_get_azimuth, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__93));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3229, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_azimuth, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__93 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 7, 18, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__206, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_get_azimuth, 3229, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__93)) __PYX_ERR(0, 3229, __pyx_L1_error)</span>
/* … */
struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth {
  PyObject_HEAD
  PyObject *__pyx_v_xlon;
  PyObject *__pyx_v_ylat;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">3230</span>:     xlon: Union [str, ArrayLike],</pre>
<pre class="cython line score-0">&#xA0;<span class="">3231</span>:     ylat:Union[ str, ArrayLike],</pre>
<pre class="cython line score-0">&#xA0;<span class="">3232</span>:     *,</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3233</span>:     data: DataFrame =None,</pre>
<pre class='cython code score-7 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3233,0,<span class='error_goto'>__PYX_ERR(0, 3233, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_data, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3234</span>:     utm_zone:str=None,</pre>
<pre class='cython code score-34 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)Py_None));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_ll)));
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3234,0,<span class='error_goto'>__PYX_ERR(0, 3234, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_utm_zone, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_projection, ((PyObject*)__pyx_n_u_ll)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_isdeg, ((PyObject *)Py_True)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_mode, ((PyObject*)__pyx_n_u_soft)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_extrapolate, ((PyObject *)Py_Ellipsis)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_view, ((PyObject *)Py_Ellipsis)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3235</span>:     projection:str='ll',</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3236</span>:     isdeg:bool=True,</pre>
<pre class='cython code score-4 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_soft)));
</pre><pre class="cython line score-0">&#xA0;<span class="">3237</span>:     mode:str='soft',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3238</span>:     extrapolate:bool =...,</pre>
<pre class='cython code score-2 '>    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_Ellipsis)));
</pre><pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3239</span>:     view:bool=...,</pre>
<pre class='cython code score-55 '>    values[8] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_Ellipsis)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_xlon)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ylat)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_azimuth", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; likely(kw_args &lt;= 7)) {
        Py_ssize_t index;
        for (index = 2; index &lt; 9 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "get_azimuth") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_xlon = values[0];
    __pyx_v_ylat = values[1];
    __pyx_v_data = values[2];
    __pyx_v_utm_zone = ((PyObject*)values[3]);
    __pyx_v_projection = ((PyObject*)values[4]);
    __pyx_v_isdeg = values[5];
    __pyx_v_mode = ((PyObject*)values[6]);
    __pyx_v_extrapolate = values[7];
    __pyx_v_view = values[8];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_azimuth", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3229, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_azimuth", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_utm_zone), (&amp;PyUnicode_Type), 1, "utm_zone", 1))) <span class='error_goto'>__PYX_ERR(0, 3234, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_projection), (&amp;PyUnicode_Type), 0, "projection", 1))) <span class='error_goto'>__PYX_ERR(0, 3235, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_mode), (&amp;PyUnicode_Type), 0, "mode", 1))) <span class='error_goto'>__PYX_ERR(0, 3237, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_84get_azimuth(__pyx_self, __pyx_v_xlon, __pyx_v_ylat, __pyx_v_data, __pyx_v_utm_zone, __pyx_v_projection, __pyx_v_isdeg, __pyx_v_mode, __pyx_v_extrapolate, __pyx_v_view);
</pre><pre class="cython line score-0">&#xA0;<span class="">3240</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3241</span>:     """Compute azimuth from coordinate locations ( latitude,  longitude).</pre>
<pre class="cython line score-0">&#xA0;<span class="">3242</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3243</span>:     If `easting` and `northing` are given rather than `longitude` and</pre>
<pre class="cython line score-0">&#xA0;<span class="">3244</span>:     `latitude`, the projection should explicitely set to ``UTM`` to perform</pre>
<pre class="cython line score-0">&#xA0;<span class="">3245</span>:     the ideal conversion. However if mode is set to `soft` (default), the type</pre>
<pre class="cython line score-0">&#xA0;<span class="">3246</span>:     of projection is automatically detected . Note that when UTM coordinates</pre>
<pre class="cython line score-0">&#xA0;<span class="">3247</span>:     are provided, `xlon` and `ylat` fit ``easting`` and ``northing``</pre>
<pre class="cython line score-0">&#xA0;<span class="">3248</span>:     respectively.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3249</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3250</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">3251</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3252</span>:     xlon, ylat : Arraylike 1d or str, str</pre>
<pre class="cython line score-0">&#xA0;<span class="">3253</span>:        ArrayLike of easting/longitude and arraylike of nothing/latitude. They</pre>
<pre class="cython line score-0">&#xA0;<span class="">3254</span>:        should be one dimensional. In principle if data is supplied, they must</pre>
<pre class="cython line score-0">&#xA0;<span class="">3255</span>:        be series.  If `xlon` and `ylat` are given as string values, the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3256</span>:        `data` must be supplied. xlon and ylat names must be included in the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3257</span>:        dataframe otherwise an error raises.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3258</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3259</span>:     data: pd.DataFrame,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3260</span>:        Data containing x and y names. Need to be supplied when x and y</pre>
<pre class="cython line score-0">&#xA0;<span class="">3261</span>:        are given as string names.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3262</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3263</span>:     utm_zone: Optional, string</pre>
<pre class="cython line score-0">&#xA0;<span class="">3264</span>:        zone number and 'S' or 'N' e.g. '55S'. Default to the centre point</pre>
<pre class="cython line score-0">&#xA0;<span class="">3265</span>:        of coordinates points in the survey area. It should be a string (##N or ##S)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3266</span>:        in the form of number and North or South hemisphere, 10S or 03N</pre>
<pre class="cython line score-0">&#xA0;<span class="">3267</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3268</span>:     projection: str, ['utm'|'ll']</pre>
<pre class="cython line score-0">&#xA0;<span class="">3269</span>:        The coordinate system in which the data points for the profile is collected.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3270</span>:        when `mode='soft'`,  the auto-detection will be triggered and find the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3271</span>:        suitable coordinate system. However, it is recommended to explicitly</pre>
<pre class="cython line score-0">&#xA0;<span class="">3272</span>:        provide projection when data is in UTM coordinates.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3273</span>:        Note that if `x` and `y` are composed of value greater than 180 degrees</pre>
<pre class="cython line score-0">&#xA0;<span class="">3274</span>:        for longitude and 90 degrees for latitude, and method is still in</pre>
<pre class="cython line score-0">&#xA0;<span class="">3275</span>:        the ``soft` mode, it should be considered as  longitude-latitude ``UTM``</pre>
<pre class="cython line score-0">&#xA0;<span class="">3276</span>:        coordinates system.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3277</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3278</span>:     isdeg: bool, default=True</pre>
<pre class="cython line score-0">&#xA0;<span class="">3279</span>:       By default xlon and xlat are in degree coordinates. If both arguments</pre>
<pre class="cython line score-0">&#xA0;<span class="">3280</span>:       are given in radians, set to ``False`` instead.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3281</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3282</span>:     mode: str , ['soft'|'strict']</pre>
<pre class="cython line score-0">&#xA0;<span class="">3283</span>:       ``strict`` mode does not convert any coordinates system to other at least</pre>
<pre class="cython line score-0">&#xA0;<span class="">3284</span>:       it is explicitly set to `projection` whereas the `soft` does.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3285</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3286</span>:     extrapolate: bool, default=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">3287</span>:       In principle, the azimuth is compute between two points. Thus, the number</pre>
<pre class="cython line score-0">&#xA0;<span class="">3288</span>:       of values computed for :math:`N` stations should  be  :math:`N-1`. To fit</pre>
<pre class="cython line score-0">&#xA0;<span class="">3289</span>:       values to match the number of size of the array, `extrapolate` should be</pre>
<pre class="cython line score-0">&#xA0;<span class="">3290</span>:       ``True``. In that case, the first station holds a &lt;&lt;fake&gt;&gt; azimuth as</pre>
<pre class="cython line score-0">&#xA0;<span class="">3291</span>:       the closer value computed from interpolation of all azimuths.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3292</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3293</span>:     view: bool, default=False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3294</span>:        Quick view of the azimuth. It is usefull especially when</pre>
<pre class="cython line score-0">&#xA0;<span class="">3295</span>:        extrapolate is set to ``True``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3296</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3297</span>:     Return</pre>
<pre class="cython line score-0">&#xA0;<span class="">3298</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3299</span>:     azim: ArrayLike</pre>
<pre class="cython line score-0">&#xA0;<span class="">3300</span>:        Azimuth computed from locations.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3301</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3302</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">3303</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3304</span>:     &gt;&gt;&gt; import gofast as gf</pre>
<pre class="cython line score-0">&#xA0;<span class="">3305</span>:     &gt;&gt;&gt; from gofast.tools.mathex  import get_azimuth</pre>
<pre class="cython line score-0">&#xA0;<span class="">3306</span>:     &gt;&gt;&gt; # generate a data from ERP</pre>
<pre class="cython line score-0">&#xA0;<span class="">3307</span>:     &gt;&gt;&gt; data = gf.make_erp (n_stations =7 ).frame</pre>
<pre class="cython line score-0">&#xA0;<span class="">3308</span>:     &gt;&gt;&gt; get_azimuth ( data.longitude, data.latitude)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3309</span>:     array([54.575, 54.575, 54.575, 54.575, 54.575, 54.575])</pre>
<pre class="cython line score-0">&#xA0;<span class="">3310</span>:     &gt;&gt;&gt; get_azimuth ( data.longitude, data.latitude, view =True, extrapolate=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3311</span>:     array([54.57500007, 54.575     , 54.575     , 54.575     , 54.575     ,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3312</span>:            54.575     , 54.575     ])</pre>
<pre class="cython line score-0">&#xA0;<span class="">3313</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3314</span>:     """</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3315</span>:     from ..site import Location</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(3315,0,<span class='error_goto'>__PYX_ERR(0, 3315, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3315, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Location);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Location);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_Location)) <span class='error_goto'>__PYX_ERR(0, 3315, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_site, __pyx_t_1, 2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3315, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Location);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3315, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_Location = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3316</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3317</span>:     mode = str(mode).lower()</pre>
<pre class='cython code score-27 '>  <span class='trace'>__Pyx_TraceLine</span>(3317,0,<span class='error_goto'>__PYX_ERR(0, 3317, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_v_mode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3317, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  if (!(likely(<span class='py_c_api'>PyUnicode_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("unicode", __pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 3317, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_mode, ((PyObject*)__pyx_t_2));
  __pyx_t_2 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3318</span>:     projection= str(projection).lower()</pre>
<pre class='cython code score-27 '>  <span class='trace'>__Pyx_TraceLine</span>(3318,0,<span class='error_goto'>__PYX_ERR(0, 3318, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_v_projection);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3318, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3318, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  if (!(likely(<span class='py_c_api'>PyUnicode_CheckExact</span>(__pyx_t_2))||((__pyx_t_2) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("unicode", __pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 3318, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_projection, ((PyObject*)__pyx_t_2));
  __pyx_t_2 = 0;
</pre><pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3319</span>:     extrapolate, view = ellipsis2false (extrapolate, view)</pre>
<pre class='cython code score-64 '>  <span class='trace'>__Pyx_TraceLine</span>(3319,0,<span class='error_goto'>__PYX_ERR(0, 3319, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_ellipsis2false);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_extrapolate, __pyx_v_view};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
    PyObject* sequence = __pyx_t_2;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 3319, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);
    index = 0; __pyx_t_1 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_1)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    index = 1; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3319, __pyx_L1_error)</span>
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 3319, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_extrapolate, __pyx_t_1);
  __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_view, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3320</span>: </pre>
<pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3321</span>:     xlon , ylat = assert_xy_in(xlon , ylat , data = data )</pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(3321,0,<span class='error_goto'>__PYX_ERR(0, 3321, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_assert_xy_in);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_xlon);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_xlon);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_cur_scope-&gt;__pyx_v_xlon)) <span class='error_goto'>__PYX_ERR(0, 3321, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_ylat);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_ylat);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_cur_scope-&gt;__pyx_v_ylat)) <span class='error_goto'>__PYX_ERR(0, 3321, __pyx_L1_error)</span>;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_data, __pyx_v_data) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3321, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3321, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
    PyObject* sequence = __pyx_t_5;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 3321, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3321, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);
    index = 0; __pyx_t_1 = __pyx_t_6(__pyx_t_2); if (unlikely(!__pyx_t_1)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    index = 1; __pyx_t_3 = __pyx_t_6(__pyx_t_2); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_2), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3321, __pyx_L1_error)</span>
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 3321, __pyx_L1_error)</span>
    __pyx_L6_unpacking_done:;
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_xlon);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_xlon, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_ylat);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_ylat, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3322</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3323</span>:     if (</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(3323,0,<span class='error_goto'>__PYX_ERR(0, 3323, __pyx_L1_error)</span>)
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3324</span>:             xlon.max() &gt; 180.  and ylat.max() &gt; 90.</pre>
<pre class='cython code score-50 '>  <span class='trace'>__Pyx_TraceLine</span>(3324,0,<span class='error_goto'>__PYX_ERR(0, 3324, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_xlon, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_float_180_, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3324, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3324, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_8) {
  } else {
    __pyx_t_7 = __pyx_t_8;
    goto __pyx_L8_bool_binop_done;
  }
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3325,0,<span class='error_goto'>__PYX_ERR(0, 3325, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_ylat, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3324, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_float_90_, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3324, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3324,0,<span class='error_goto'>__PYX_ERR(0, 3324, __pyx_L1_error)</span>)
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3324, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (__pyx_t_8) {
  } else {
    __pyx_t_7 = __pyx_t_8;
    goto __pyx_L8_bool_binop_done;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3325</span>:             and projection=='ll'</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3325,0,<span class='error_goto'>__PYX_ERR(0, 3325, __pyx_L1_error)</span>)
  __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_projection, __pyx_n_u_ll, Py_EQ)); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3325, __pyx_L1_error)</span>
  if (__pyx_t_8) {
  } else {
    __pyx_t_7 = __pyx_t_8;
    goto __pyx_L8_bool_binop_done;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3326</span>:             and mode=='soft'</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3326,0,<span class='error_goto'>__PYX_ERR(0, 3326, __pyx_L1_error)</span>)
  __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_mode, __pyx_n_u_soft, Py_EQ)); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3326, __pyx_L1_error)</span>
  __pyx_t_7 = __pyx_t_8;
  __pyx_L8_bool_binop_done:;
</pre><pre class="cython line score-0">&#xA0;<span class="">3327</span>:             ):</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3328</span>:         warnings.warn("xlon and ylat arguments are greater than 180 degrees."</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(3328,0,<span class='error_goto'>__PYX_ERR(0, 3328, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3328, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3328, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_kp_u_xlon_and_ylat_arguments_are_grea};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3328, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3329</span>:                      " we assume the coordinates are UTM. Set explicitly"</pre>
<pre class="cython line score-0">&#xA0;<span class="">3330</span>:                      " projection to ``UTM`` to avoid this warning.")</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3331</span>:         projection='utm'</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3331,0,<span class='error_goto'>__PYX_ERR(0, 3331, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_utm);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_projection, __pyx_n_u_utm);
</pre><pre class="cython line score-0">&#xA0;<span class="">3332</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3333</span>:     if projection=='utm':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3333,0,<span class='error_goto'>__PYX_ERR(0, 3333, __pyx_L1_error)</span>)
  __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_projection, __pyx_n_u_utm, Py_EQ)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3333, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3334</span>:         if utm_zone is None:</pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(3334,0,<span class='error_goto'>__PYX_ERR(0, 3334, __pyx_L1_error)</span>)
    __pyx_t_7 = (__pyx_v_utm_zone == ((PyObject*)Py_None));
    if (unlikely(__pyx_t_7)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3335</span>:             raise TypeError ("utm_zone cannot be None when projection is UTM.")</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(3335,0,<span class='error_goto'>__PYX_ERR(0, 3335, __pyx_L1_error)</span>)
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__94, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3335, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='error_goto'>__PYX_ERR(0, 3335, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__94 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_utm_zone_cannot_be_None_when_pro);<span class='error_goto'> if (unlikely(!__pyx_tuple__94)) __PYX_ERR(0, 3335, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__94);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__94);
</pre><pre class="cython line score-0">&#xA0;<span class="">3336</span>: </pre>
<pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3337</span>:         ylat , xlon = Location.to_latlon_in(</pre>
<pre class='cython code score-66 '>    <span class='trace'>__Pyx_TraceLine</span>(3337,0,<span class='error_goto'>__PYX_ERR(0, 3337, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_Location, __pyx_n_s_to_latlon_in);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3337, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3338,0,<span class='error_goto'>__PYX_ERR(0, 3338, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3337, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_xlon);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_xlon);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_cur_scope-&gt;__pyx_v_xlon)) <span class='error_goto'>__PYX_ERR(0, 3337, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_ylat);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_ylat);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_cur_scope-&gt;__pyx_v_ylat)) <span class='error_goto'>__PYX_ERR(0, 3337, __pyx_L1_error)</span>;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3337,0,<span class='error_goto'>__PYX_ERR(0, 3337, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3337, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 3337, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3337, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3337, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3337, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);
      index = 0; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L14_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      index = 1; __pyx_t_1 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_1)) goto __pyx_L14_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3337, __pyx_L1_error)</span>
      __pyx_t_6 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L15_unpacking_done;
      __pyx_L14_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 3337, __pyx_L1_error)</span>
      __pyx_L15_unpacking_done:;
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_ylat);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_ylat, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_xlon);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_xlon, __pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3338</span>:             xlon, ylat, utm_zone= utm_zone)</pre>
<pre class='cython code score-7 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3338, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_utm_zone, __pyx_v_utm_zone) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3338, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3339</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3340</span>:     if len(xlon) ==1 or len(ylat)==1:</pre>
<pre class='cython code score-14 '>  <span class='trace'>__Pyx_TraceLine</span>(3340,0,<span class='error_goto'>__PYX_ERR(0, 3340, __pyx_L1_error)</span>)
  __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_v_xlon;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_9 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3340, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_8 = (__pyx_t_9 == 1);
  if (!__pyx_t_8) {
  } else {
    __pyx_t_7 = __pyx_t_8;
    goto __pyx_L17_bool_binop_done;
  }
  __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_v_ylat;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_9 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3340, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_8 = (__pyx_t_9 == 1);
  __pyx_t_7 = __pyx_t_8;
  __pyx_L17_bool_binop_done:;
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3341</span>:         msg = "Azimuth computation expects at least two points. Got 1"</pre>
<pre class='cython code score-1 '>    <span class='trace'>__Pyx_TraceLine</span>(3341,0,<span class='error_goto'>__PYX_ERR(0, 3341, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Azimuth_computation_expects_at_l);
    __pyx_v_msg = __pyx_kp_u_Azimuth_computation_expects_at_l;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3342</span>:         if mode=='soft':</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3342,0,<span class='error_goto'>__PYX_ERR(0, 3342, __pyx_L1_error)</span>)
    __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_mode, __pyx_n_u_soft, Py_EQ)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3342, __pyx_L1_error)</span>
    if (__pyx_t_7) {
/* … */
    }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3343</span>:             warnings.warn(msg)</pre>
<pre class='cython code score-20 '>      <span class='trace'>__Pyx_TraceLine</span>(3343,0,<span class='error_goto'>__PYX_ERR(0, 3343, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3343, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3343, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_msg};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3343, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3344</span>:             return 0.</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(3344,0,<span class='error_goto'>__PYX_ERR(0, 3344, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_float_0_);
      __pyx_r = __pyx_float_0_;
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3345</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3346</span>:         raise TypeError(msg )</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(3346,0,<span class='error_goto'>__PYX_ERR(0, 3346, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_v_msg);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3346, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3346, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3347</span>:     # convert to radian</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3348</span>:     if isdeg:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3348,0,<span class='error_goto'>__PYX_ERR(0, 3348, __pyx_L1_error)</span>)
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_isdeg); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3348, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3349</span>:         xlon = np.deg2rad (xlon ) ; ylat = np.deg2rad ( ylat)</pre>
<pre class='cython code score-40 '>    <span class='trace'>__Pyx_TraceLine</span>(3349,0,<span class='error_goto'>__PYX_ERR(0, 3349, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3349, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_deg2rad);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3349, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_cur_scope-&gt;__pyx_v_xlon};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3349, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_xlon);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_xlon, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3349, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_deg2rad);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3349, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_cur_scope-&gt;__pyx_v_ylat};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3349, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_ylat);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_ylat, __pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3350</span>: </pre>
<pre class="cython line score-124" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3351</span>:     dx = map (lambda ii: np.cos ( ylat[ii]) * np.sin( ylat [ii+1 ]) -</pre>
<pre class='cython code score-124 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_11get_azimuth_lambda2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_11get_azimuth_lambda2 = {"lambda2", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_11get_azimuth_lambda2, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_11get_azimuth_lambda2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_ii = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda2 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_ii,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ii)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "lambda2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_ii = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lambda2", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_azimuth.lambda2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_lambda_funcdef_lambda2(__pyx_self, __pyx_v_ii);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda2(PyObject *__pyx_self, PyObject *__pyx_v_ii) {
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("lambda2", __pyx_f[0], 3351, 0, <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_ylat)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("ylat"); <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_ylat, __pyx_v_ii);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_ylat)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("ylat"); <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_ii, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_ylat, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_6};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3351,0,<span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_azimuth.lambda2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3351,0,<span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_11get_azimuth_lambda2, 0, __pyx_n_s_get_azimuth_locals_lambda, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_mathex, __pyx_d, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3351,0,<span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3351, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_map, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3351, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dx = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-103" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3352</span>:         np.sin(ylat[ii]) * np.cos( ylat[ii+1]) * np.cos (xlon[ii+1]- xlon[ii]),</pre>
<pre class='cython code score-103 '>  <span class='trace'>__Pyx_TraceLine</span>(3352,0,<span class='error_goto'>__PYX_ERR(0, 3352, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_ylat)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("ylat"); <span class='error_goto'>__PYX_ERR(0, 3352, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_ylat, __pyx_v_ii);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_1};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3352, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_ylat)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("ylat"); <span class='error_goto'>__PYX_ERR(0, 3352, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_ii, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_ylat, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_7};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3352, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_xlon)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("xlon"); <span class='error_goto'>__PYX_ERR(0, 3352, __pyx_L1_error)</span> }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_ii, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_xlon, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_xlon)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("xlon"); <span class='error_goto'>__PYX_ERR(0, 3352, __pyx_L1_error)</span> }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_xlon, __pyx_v_ii);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_8};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3352, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3353</span>:         range (len(xlon)-1)</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(3353,0,<span class='error_goto'>__PYX_ERR(0, 3353, __pyx_L1_error)</span>)
  __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_xlon;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_9 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3353, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_t_9 - 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3354</span>:         )</pre>
<pre class="cython line score-130" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3355</span>:     dy = map( lambda ii: np.cos (ylat[ii+1])* np.sin( xlon[ii+1]- xlon[ii]),</pre>
<pre class='cython code score-130 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_11get_azimuth_1lambda3(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_11get_azimuth_1lambda3 = {"lambda3", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_11get_azimuth_1lambda3, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_11get_azimuth_1lambda3(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_ii = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda3 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_ii,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ii)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "lambda3") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_ii = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lambda3", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_azimuth.lambda3", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_lambda_funcdef_lambda3(__pyx_self, __pyx_v_ii);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda3(PyObject *__pyx_self, PyObject *__pyx_v_ii) {
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_1_get_azimuth *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("lambda3", __pyx_f[0], 3355, 0, <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_ylat)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("ylat"); <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_ii, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_ylat, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_xlon)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("xlon"); <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span> }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_ii, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_xlon, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_xlon)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("xlon"); <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span> }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_cur_scope-&gt;__pyx_v_xlon, __pyx_v_ii);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_7};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_azimuth.lambda3", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3355,0,<span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_11get_azimuth_1lambda3, 0, __pyx_n_s_get_azimuth_locals_lambda, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_mathex, __pyx_d, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3355,0,<span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3355, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_map, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_dy = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3356</span>:                    range ( len(xlon)-1)</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(3356,0,<span class='error_goto'>__PYX_ERR(0, 3356, __pyx_L1_error)</span>)
  __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_xlon;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_9 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3356, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_t_9 - 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3357</span>:                    )</pre>
<pre class="cython line score-0">&#xA0;<span class="">3358</span>:     # to deg</pre>
<pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3359</span>:     z = np.around ( np.rad2deg ( np.arctan2(list(dx) , list(dy) ) ), 3)</pre>
<pre class='cython code score-71 '>  <span class='trace'>__Pyx_TraceLine</span>(3359,0,<span class='error_goto'>__PYX_ERR(0, 3359, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_around);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_rad2deg);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_arctan2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 3359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_11 = <span class='py_c_api'>PySequence_List</span>(__pyx_v_dx);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_13 = <span class='py_c_api'>PySequence_List</span>(__pyx_v_dy);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 3359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
  __pyx_t_14 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_14)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_14, __pyx_t_11, __pyx_t_13};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_12, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3359, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  }
  __pyx_t_12 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
    __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
    if (likely(__pyx_t_12)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_12, __pyx_t_5};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3359, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  }
  __pyx_t_10 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_10, __pyx_t_3, __pyx_int_3};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3359, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_v_z = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3360</span>:     azim = z.copy()</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(3360,0,<span class='error_goto'>__PYX_ERR(0, 3360, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3360, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3360, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_v_azim = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3361</span>:     if extrapolate:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3361,0,<span class='error_goto'>__PYX_ERR(0, 3361, __pyx_L1_error)</span>)
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_extrapolate); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3361, __pyx_L1_error)</span>
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">3362</span>:         # use mean azimum of the total area zone and</pre>
<pre class="cython line score-0">&#xA0;<span class="">3363</span>:         # recompute the position by interpolation</pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3364</span>:         azim = np.hstack ( ( [z.mean(), z ]))</pre>
<pre class='cython code score-47 '>    <span class='trace'>__Pyx_TraceLine</span>(3364,0,<span class='error_goto'>__PYX_ERR(0, 3364, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3364, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_hstack);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3364, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_z, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3364, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_5 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3364, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3364, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3364, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_z);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_z);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_z)) <span class='error_goto'>__PYX_ERR(0, 3364, __pyx_L1_error)</span>;
    __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_10};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3364, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_azim, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3365</span>:         # reset the interpolare value at the first position</pre>
<pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3366</span>:         with warnings.catch_warnings():</pre>
<pre class='cython code score-86 '>    <span class='trace'>__Pyx_TraceLine</span>(3366,0,<span class='error_goto'>__PYX_ERR(0, 3366, __pyx_L1_error)</span>)
    /*with:*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3366, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_catch_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3366, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3366, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_2, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3366, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_2, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3366, __pyx_L22_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3366, __pyx_L22_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      /*try:*/ {
        {
          /*try:*/ {
/* … */
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
          goto __pyx_L31_try_end;
          __pyx_L26_error:;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          /*except:*/ {
            <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_azimuth", __pyx_clineno, __pyx_lineno, __pyx_filename);
            if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_2, &amp;__pyx_t_3, &amp;__pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3366, __pyx_L28_except_error)</span>
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_10);
            __pyx_t_1 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_2, __pyx_t_3, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3366, __pyx_L28_except_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_1, NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            if (unlikely(!__pyx_t_19)) <span class='error_goto'>__PYX_ERR(0, 3366, __pyx_L28_except_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_19);
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_19);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_19); __pyx_t_19 = 0;
            if (__pyx_t_7 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3366, __pyx_L28_except_error)</span>
            __pyx_t_8 = (!__pyx_t_7);
            if (unlikely(__pyx_t_8)) {
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
              <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_2, __pyx_t_3, __pyx_t_10);
              __pyx_t_2 = 0; __pyx_t_3 = 0; __pyx_t_10 = 0; 
              <span class='error_goto'>__PYX_ERR(0, 3366, __pyx_L28_except_error)</span>
            }
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
            goto __pyx_L27_exception_handled;
          }
          __pyx_L28_except_error:;
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_16);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_17);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_18);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);
          goto __pyx_L1_error;
          __pyx_L27_exception_handled:;
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_16);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_17);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_18);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);
          __pyx_L31_try_end:;
        }
      }
      /*finally:*/ {
        /*normal exit:*/{
          if (__pyx_t_15) {
            __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_tuple__95, NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
            if (unlikely(!__pyx_t_18)) <span class='error_goto'>__PYX_ERR(0, 3366, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
          }
          goto __pyx_L25;
        }
        __pyx_L25:;
      }
      goto __pyx_L35;
      __pyx_L22_error:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      goto __pyx_L1_error;
      __pyx_L35:;
    }
/* … */
  __pyx_tuple__95 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__95)) __PYX_ERR(0, 3366, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__95);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__95);
</pre><pre class="cython line score-0">&#xA0;<span class="">3367</span>:             #warnings.filterwarnings(action='ignore', category=OptimizeWarning)</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3368</span>:             warnings.simplefilter("ignore")</pre>
<pre class='cython code score-20 '>            <span class='trace'>__Pyx_TraceLine</span>(3368,0,<span class='error_goto'>__PYX_ERR(0, 3368, __pyx_L26_error)</span>)
            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3368, __pyx_L26_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_simplefilter);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3368, __pyx_L26_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
            __pyx_t_10 = NULL;
            __pyx_t_4 = 0;
            #if CYTHON_UNPACK_METHODS
            if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
              __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
              if (likely(__pyx_t_10)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
                __pyx_t_4 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_n_u_ignore};
              __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
              if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3368, __pyx_L26_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3369</span>:             azim [0] = scalePosition(azim )[0][0]</pre>
<pre class='cython code score-25 '>            <span class='trace'>__Pyx_TraceLine</span>(3369,0,<span class='error_goto'>__PYX_ERR(0, 3369, __pyx_L26_error)</span>)
            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_scalePosition);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3369, __pyx_L26_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            __pyx_t_10 = NULL;
            __pyx_t_4 = 0;
            #if CYTHON_UNPACK_METHODS
            if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
              __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
              if (likely(__pyx_t_10)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
                __pyx_t_4 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_v_azim};
              __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
              if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3369, __pyx_L26_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            }
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3369, __pyx_L26_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3369, __pyx_L26_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_azim, 0, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3369, __pyx_L26_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3370</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3371</span>:     if view:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3371,0,<span class='error_goto'>__PYX_ERR(0, 3371, __pyx_L1_error)</span>)
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_view); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3371, __pyx_L1_error)</span>
  if (__pyx_t_8) {
/* … */
  }
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3372</span>:         x = np.arange ( len(azim ))</pre>
<pre class='cython code score-30 '>    <span class='trace'>__Pyx_TraceLine</span>(3372,0,<span class='error_goto'>__PYX_ERR(0, 3372, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3372, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3372, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_azim);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3372, __pyx_L1_error)</span>
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3372, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_3};
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3372, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_v_x = __pyx_t_10;
    __pyx_t_10 = 0;
</pre><pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3373</span>:         fig,  ax = plt.subplots (1, 1, figsize = (10, 4))</pre>
<pre class='cython code score-67 '>    <span class='trace'>__Pyx_TraceLine</span>(3373,0,<span class='error_goto'>__PYX_ERR(0, 3373, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3373, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_subplots);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3373, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3373, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_figsize, __pyx_tuple__96) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3373, __pyx_L1_error)</span>
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__10, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3373, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
      PyObject* sequence = __pyx_t_3;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 3373, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      #else
      __pyx_t_10 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3373, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3373, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3373, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
      index = 0; __pyx_t_10 = __pyx_t_6(__pyx_t_1); if (unlikely(!__pyx_t_10)) goto __pyx_L37_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      index = 1; __pyx_t_2 = __pyx_t_6(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L37_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3373, __pyx_L1_error)</span>
      __pyx_t_6 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L38_unpacking_done;
      __pyx_L37_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_6 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 3373, __pyx_L1_error)</span>
      __pyx_L38_unpacking_done:;
    }
    __pyx_v_fig = __pyx_t_10;
    __pyx_t_10 = 0;
    __pyx_v_ax = __pyx_t_2;
    __pyx_t_2 = 0;
/* … */
  __pyx_tuple__96 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_10, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 3373, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__96);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__96);
</pre><pre class="cython line score-0">&#xA0;<span class="">3374</span>:         # add Nan to the first position of z</pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3375</span>:         z = np.hstack (([np.nan], z )) if extrapolate else z</pre>
<pre class='cython code score-46 '>    <span class='trace'>__Pyx_TraceLine</span>(3375,0,<span class='error_goto'>__PYX_ERR(0, 3375, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_extrapolate); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3375, __pyx_L1_error)</span>
    if (__pyx_t_8) {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3375, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_hstack);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3375, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3375, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_nan);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3375, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3375, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3375, __pyx_L1_error)</span>;
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3375, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3375, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_z);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_z);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_z)) <span class='error_goto'>__PYX_ERR(0, 3375, __pyx_L1_error)</span>;
      __pyx_t_10 = 0;
      __pyx_t_10 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_10)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_5};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3375, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_3 = __pyx_t_2;
      __pyx_t_2 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_z);
      __pyx_t_3 = __pyx_v_z;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_z, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3376</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3377</span>:         ax.plot (x,</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(3377,0,<span class='error_goto'>__PYX_ERR(0, 3377, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax, __pyx_n_s_plot);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3377, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3378,0,<span class='error_goto'>__PYX_ERR(0, 3378, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3377, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 3377, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_azim);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_azim);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_azim)) <span class='error_goto'>__PYX_ERR(0, 3377, __pyx_L1_error)</span>;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3377,0,<span class='error_goto'>__PYX_ERR(0, 3377, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3377, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3378</span>:                  azim,</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3379</span>:                  c='#0A4CEE',</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(3379,0,<span class='error_goto'>__PYX_ERR(0, 3379, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3379, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_c, __pyx_kp_u_0A4CEE) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3379, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_marker, __pyx_n_u_o) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3379, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_label, __pyx_kp_u_extra_azimuth) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3379, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3380</span>:                  marker = 'o',</pre>
<pre class="cython line score-0">&#xA0;<span class="">3381</span>:                  label ='extra-azimuth'</pre>
<pre class="cython line score-0">&#xA0;<span class="">3382</span>:                  )</pre>
<pre class="cython line score-0">&#xA0;<span class="">3383</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3384</span>:         ax.plot (x,</pre>
<pre class='cython code score-22 '>    <span class='trace'>__Pyx_TraceLine</span>(3384,0,<span class='error_goto'>__PYX_ERR(0, 3384, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax, __pyx_n_s_plot);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3384, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3385,0,<span class='error_goto'>__PYX_ERR(0, 3385, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3384, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 3384, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_z);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_z);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_z)) <span class='error_goto'>__PYX_ERR(0, 3384, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_ok);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_ok);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_ok)) <span class='error_goto'>__PYX_ERR(0, 3384, __pyx_L1_error)</span>;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3384,0,<span class='error_goto'>__PYX_ERR(0, 3384, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3384, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3385</span>:                 z,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3386</span>:                 'ok-',</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3387</span>:                 label ='raw azimuth'</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(3387,0,<span class='error_goto'>__PYX_ERR(0, 3387, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3387, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_label, __pyx_kp_u_raw_azimuth) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3387, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3388</span>:                 )</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3389</span>:         ax.legend ( )</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(3389,0,<span class='error_goto'>__PYX_ERR(0, 3389, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax, __pyx_n_s_legend);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3389, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3389, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3390</span>:         ax.set_xlabel ('x')</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(3390,0,<span class='error_goto'>__PYX_ERR(0, 3390, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax, __pyx_n_s_set_xlabel);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3390, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_n_u_x};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3390, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3391</span>:         ax.set_ylabel ('y')</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(3391,0,<span class='error_goto'>__PYX_ERR(0, 3391, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ax, __pyx_n_s_set_ylabel);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3391, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_n_u_y};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3391, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3392</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3393</span>:     return azim</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3393,0,<span class='error_goto'>__PYX_ERR(0, 3393, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_azim);
  __pyx_r = __pyx_v_azim;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3394</span>: </pre>
<pre class="cython line score-88" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3395</span>: def linkage_matrix(</pre>
<pre class='cython code score-88 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_87linkage_matrix(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_86linkage_matrix, " Compute the distance matrix from the hierachical clustering algorithm.\n    \n    Parameters \n    ------------ \n    df: dataframe or NDArray of (n_samples, n_features) \n        dataframe of Ndarray. If array is given , must specify the column names\n        to much the array shape 1 \n    columns: list \n        list of labels to name each columns of arrays of (n_samples, n_features) \n        If dataframe is given, don't need to specify the columns. \n        \n    kind: str, ['squareform'|'condense'|'design'], default is {'design'}\n        kind of approach to summing up the linkage matrix. \n        Indeed, a condensed distance matrix is a flat array containing the \n        upper triangular of the distance matrix. This is the form that ``pdist`` \n        returns. Alternatively, a collection of :math:`m` observation vectors \n        in :math:`n` dimensions may be passed as  an :math:`m` by :math:`n` \n        array. All elements of the condensed distance matrix must be finite, \n        i.e., no NaNs or infs.\n        Alternatively, we could used the ``squareform`` distance matrix to yield\n        different distance values than expected. \n        the ``design`` approach uses the complete inpout example matrix  also \n        called 'design matrix' to lead correct linkage matrix similar to \n        `squareform` and `condense``. \n        \n    metric : str or callable, default is {'euclidean'}\n        The metric to use when calculating distance between instances in a\n        feature array. If metric is a string, it must be one of the options\n        allowed by :func:`sklearn.metrics.pairwise.pairwise_distances`.\n        If ``X`` is the distance array itself, use \"precomputed\" as the metric.\n        Precomputed distance matrices must have 0 along the diagonal.\n        \n    method : str, optional, default is {'complete'}\n        The linkage algorithm to use. See the ``Linkage Methods`` section below\n        for full descriptions.\n        \n    o""ptimal_ordering : bool, optional\n        If True, the linkage matrix will be reordered so that the distance\n        between successive leaves is minimal. This results in a more intuitive\n        tree structure when the data are visualized. defaults to False, because\n        this algorithm can be slow, particularly on large datasets. See\n        also :func:`scipy.cluster.hierarchy.linkage`. \n        \n        \n    Returns \n    --------\n    row_clusters: linkage matrix \n        consist of several rows where each rw represents one merge. The first \n        and second columns denotes the most dissimilar members of each cluster \n        and the third columns reports the distance between those members \n        \n        \n    Linkage Methods \n    -----------------\n    The following are methods for calculating the distance between the\n    newly formed cluster :math:`u` and each :math:`v`.\n\n    * method='single' assigns\n\n      .. math::\n         d(u,v) = \\min(dist(u[i],v[j]))\n\n      for all points :math:`i` in cluster :math:`u` and\n      :math:`j` in cluster :math:`v`. This is also known as the\n      Nearest Point Algorithm.\n\n    * method='complete' assigns\n\n      .. math::\n         d(u, v) = \\max(dist(u[i],v[j]))\n\n      for all points :math:`i` in cluster u and :math:`j` in\n      cluster :math:`v`. This is also known by the Farthest Point\n      Algorithm or Voor Hees Algorithm.\n\n    * method='average' assigns\n\n      .. math::\n         d(u,v) = \\sum_{ij} \\\\frac{d(u[i], v[j])}{(|u|*|v|)}\n\n      for all points :math:`i` and :math:`j` where :math:`|u|`\n      and :math:`|v|` are the cardinalities of clusters :math:`u`\n      and :math:`v`, respectively. This is also called the UPGMA\n      algorithm.\n\n    * method='weighted' assigns\n\n      .. math::\n         d(u,v) = (dist(s,v) + dist(t,v))/2\n\n      where cluster u was formed with cluster s and t and v\n      is a remaining cluster in the forest (also called WPGMA).\n\n    *"" method='centroid' assigns\n\n      .. math::\n         dist(s,t) = ||c_s-c_t||_2\n\n      where :math:`c_s` and :math:`c_t` are the centroids of\n      clusters :math:`s` and :math:`t`, respectively. When two\n      clusters :math:`s` and :math:`t` are combined into a new\n      cluster :math:`u`, the new centroid is computed over all the\n      original objects in clusters :math:`s` and :math:`t`. The\n      distance then becomes the Euclidean distance between the\n      centroid of :math:`u` and the centroid of a remaining cluster\n      :math:`v` in the forest. This is also known as the UPGMC\n      algorithm.\n\n    * method='median' assigns :math:`d(s,t)` like the ``centroid``\n      method. When two clusters :math:`s` and :math:`t` are combined\n      into a new cluster :math:`u`, the average of centroids s and t\n      give the new centroid :math:`u`. This is also known as the\n      WPGMC algorithm.\n\n    * method='ward' uses the Ward variance minimization algorithm.\n      The new entry :math:`d(u,v)` is computed as follows,\n\n      .. math::\n\n         d(u,v) = \\sqrt{\\frac{|v|+|s|}{_T}d(v,s)^2 \\\\\n                      + \\frac{|v|+|t|}{_T}d(v,t)^2 \\\\\n                      - \\frac{|v|}{_T}d(s,t)^2}\n\n      where :math:`u` is the newly joined cluster consisting of\n      clusters :math:`s` and :math:`t`, :math:`v` is an unused\n      cluster in the forest, :math:`_T=|v|+|s|+|t|`, and\n      :math:`|*|` is the cardinality of its argument. This is also\n      known as the incremental algorithm.\n\n    Warning: When the minimum distance pair in the forest is chosen, there\n    may be two or more pairs with the same minimum distance. This\n    implementation may choose a different minimum than the MATLAB\n    version.\n    \n    See Also\n    --------\n    scipy.spatial.distance.pdist : pairwise distance metrics\n\n    References\n    ----------\n    .. [1] Daniel Mullner, \"Modern hierarchical, agglomerative clustering\n           algorithms\", :a""rXiv:`1109.2378v1`.\n    .. [2] Ziv Bar-Joseph, David K. Gifford, Tommi S. Jaakkola, \"Fast optimal\n           leaf ordering for hierarchical clustering\", 2001. Bioinformatics\n           :doi:`10.1093/bioinformatics/17.suppl_1.S22`\n\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_87linkage_matrix = {"linkage_matrix", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_87linkage_matrix, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_86linkage_matrix};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_87linkage_matrix(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_df = 0;
  PyObject *__pyx_v_columns = 0;
  PyObject *__pyx_v_kind = 0;
  PyObject *__pyx_v_metric = 0;
  PyObject *__pyx_v_method = 0;
  PyObject *__pyx_v_as_frame = 0;
  PyObject *__pyx_v_optimal_ordering = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("linkage_matrix (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_df,&amp;__pyx_n_s_columns,&amp;__pyx_n_s_kind,&amp;__pyx_n_s_metric,&amp;__pyx_n_s_method,&amp;__pyx_n_s_as_frame,&amp;__pyx_n_s_optimal_ordering,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_86linkage_matrix(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_df, PyObject *__pyx_v_columns, PyObject *__pyx_v_kind, PyObject *__pyx_v_metric, PyObject *__pyx_v_method, PyObject *__pyx_v_as_frame, PyObject *__pyx_v_optimal_ordering) {
  PyObject *__pyx_v_labels = NULL;
  PyObject *__pyx_v_row_dist = NULL;
  PyObject *__pyx_v_row_clusters = NULL;
  Py_ssize_t __pyx_9genexpr11__pyx_v_i;
  PyObject *__pyx_9genexpr12__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__97)
  <span class='trace'>__Pyx_TraceCall</span>("linkage_matrix", __pyx_f[0], 3395, 0, <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_columns);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kind);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.linkage_matrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_labels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row_dist);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_row_clusters);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr12__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_df);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_columns);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kind);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__207 = <span class='py_c_api'>PyTuple_Pack</span>(12, __pyx_n_s_df, __pyx_n_s_columns, __pyx_n_s_kind, __pyx_n_s_metric, __pyx_n_s_method, __pyx_n_s_as_frame, __pyx_n_s_optimal_ordering, __pyx_n_s_labels, __pyx_n_s_row_dist, __pyx_n_s_row_clusters, __pyx_n_s_i, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__207)) __PYX_ERR(0, 3395, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__207);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__207);
  __pyx_codeobj__97 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__207, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_linkage_matrix, 3395, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__97)) __PYX_ERR(0, 3395, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3395,0,<span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3395, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_df, __pyx_n_s_DataFrame) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_columns, __pyx_kp_s_List_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_kind, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_metric, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_method, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_n_s_NDArray) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_87linkage_matrix, 0, __pyx_n_s_linkage_matrix, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__97));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3395, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__208);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_linkage_matrix, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_tuple__208 = <span class='py_c_api'>PyTuple_Pack</span>(6, Py_None, ((PyObject*)__pyx_n_u_design), ((PyObject*)__pyx_n_u_euclidean), ((PyObject*)__pyx_n_u_complete), ((PyObject *)Py_False), ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__208)) __PYX_ERR(0, 3395, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__208);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__208);
</pre><pre class="cython line score-0">&#xA0;<span class="">3396</span>:     df: DataFrame ,</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3397</span>:     columns:List[str] =None,</pre>
<pre class='cython code score-8 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_design)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_euclidean)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_complete)));
</pre><pre class="cython line score-0">&#xA0;<span class="">3398</span>:     kind:str ='design',</pre>
<pre class="cython line score-0">&#xA0;<span class="">3399</span>:     metric:str ='euclidean',</pre>
<pre class="cython line score-0">&#xA0;<span class="">3400</span>:     method:str ='complete',</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3401</span>:     as_frame =False,</pre>
<pre class='cython code score-2 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-109" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3402</span>:     optimal_ordering=False,</pre>
<pre class='cython code score-109 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_df)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_columns);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_kind);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_metric);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_method);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_as_frame);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_optimal_ordering);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "linkage_matrix") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_df = values[0];
    __pyx_v_columns = values[1];
    __pyx_v_kind = ((PyObject*)values[2]);
    __pyx_v_metric = ((PyObject*)values[3]);
    __pyx_v_method = ((PyObject*)values[4]);
    __pyx_v_as_frame = values[5];
    __pyx_v_optimal_ordering = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("linkage_matrix", 0, 1, 7, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3395, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.linkage_matrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_kind), (&amp;PyUnicode_Type), 0, "kind", 1))) <span class='error_goto'>__PYX_ERR(0, 3398, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_metric), (&amp;PyUnicode_Type), 0, "metric", 1))) <span class='error_goto'>__PYX_ERR(0, 3399, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_method), (&amp;PyUnicode_Type), 0, "method", 1))) <span class='error_goto'>__PYX_ERR(0, 3400, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_86linkage_matrix(__pyx_self, __pyx_v_df, __pyx_v_columns, __pyx_v_kind, __pyx_v_metric, __pyx_v_method, __pyx_v_as_frame, __pyx_v_optimal_ordering);
</pre><pre class="cython line score-0">&#xA0;<span class="">3403</span>:  )-&gt;NDArray:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3404</span>:     r""" Compute the distance matrix from the hierachical clustering algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3405</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3406</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">3407</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3408</span>:     df: dataframe or NDArray of (n_samples, n_features)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3409</span>:         dataframe of Ndarray. If array is given , must specify the column names</pre>
<pre class="cython line score-0">&#xA0;<span class="">3410</span>:         to much the array shape 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">3411</span>:     columns: list</pre>
<pre class="cython line score-0">&#xA0;<span class="">3412</span>:         list of labels to name each columns of arrays of (n_samples, n_features)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3413</span>:         If dataframe is given, don't need to specify the columns.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3414</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3415</span>:     kind: str, ['squareform'|'condense'|'design'], default is {'design'}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3416</span>:         kind of approach to summing up the linkage matrix.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3417</span>:         Indeed, a condensed distance matrix is a flat array containing the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3418</span>:         upper triangular of the distance matrix. This is the form that ``pdist``</pre>
<pre class="cython line score-0">&#xA0;<span class="">3419</span>:         returns. Alternatively, a collection of :math:`m` observation vectors</pre>
<pre class="cython line score-0">&#xA0;<span class="">3420</span>:         in :math:`n` dimensions may be passed as  an :math:`m` by :math:`n`</pre>
<pre class="cython line score-0">&#xA0;<span class="">3421</span>:         array. All elements of the condensed distance matrix must be finite,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3422</span>:         i.e., no NaNs or infs.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3423</span>:         Alternatively, we could used the ``squareform`` distance matrix to yield</pre>
<pre class="cython line score-0">&#xA0;<span class="">3424</span>:         different distance values than expected.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3425</span>:         the ``design`` approach uses the complete inpout example matrix  also</pre>
<pre class="cython line score-0">&#xA0;<span class="">3426</span>:         called 'design matrix' to lead correct linkage matrix similar to</pre>
<pre class="cython line score-0">&#xA0;<span class="">3427</span>:         `squareform` and `condense``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3428</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3429</span>:     metric : str or callable, default is {'euclidean'}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3430</span>:         The metric to use when calculating distance between instances in a</pre>
<pre class="cython line score-0">&#xA0;<span class="">3431</span>:         feature array. If metric is a string, it must be one of the options</pre>
<pre class="cython line score-0">&#xA0;<span class="">3432</span>:         allowed by :func:`sklearn.metrics.pairwise.pairwise_distances`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3433</span>:         If ``X`` is the distance array itself, use "precomputed" as the metric.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3434</span>:         Precomputed distance matrices must have 0 along the diagonal.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3435</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3436</span>:     method : str, optional, default is {'complete'}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3437</span>:         The linkage algorithm to use. See the ``Linkage Methods`` section below</pre>
<pre class="cython line score-0">&#xA0;<span class="">3438</span>:         for full descriptions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3439</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3440</span>:     optimal_ordering : bool, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">3441</span>:         If True, the linkage matrix will be reordered so that the distance</pre>
<pre class="cython line score-0">&#xA0;<span class="">3442</span>:         between successive leaves is minimal. This results in a more intuitive</pre>
<pre class="cython line score-0">&#xA0;<span class="">3443</span>:         tree structure when the data are visualized. defaults to False, because</pre>
<pre class="cython line score-0">&#xA0;<span class="">3444</span>:         this algorithm can be slow, particularly on large datasets. See</pre>
<pre class="cython line score-0">&#xA0;<span class="">3445</span>:         also :func:`scipy.cluster.hierarchy.linkage`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3446</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3447</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3448</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3449</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3450</span>:     row_clusters: linkage matrix</pre>
<pre class="cython line score-0">&#xA0;<span class="">3451</span>:         consist of several rows where each rw represents one merge. The first</pre>
<pre class="cython line score-0">&#xA0;<span class="">3452</span>:         and second columns denotes the most dissimilar members of each cluster</pre>
<pre class="cython line score-0">&#xA0;<span class="">3453</span>:         and the third columns reports the distance between those members</pre>
<pre class="cython line score-0">&#xA0;<span class="">3454</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3455</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3456</span>:     Linkage Methods</pre>
<pre class="cython line score-0">&#xA0;<span class="">3457</span>:     -----------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3458</span>:     The following are methods for calculating the distance between the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3459</span>:     newly formed cluster :math:`u` and each :math:`v`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3460</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3461</span>:     * method='single' assigns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3462</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3463</span>:       .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">3464</span>:          d(u,v) = \min(dist(u[i],v[j]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">3465</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3466</span>:       for all points :math:`i` in cluster :math:`u` and</pre>
<pre class="cython line score-0">&#xA0;<span class="">3467</span>:       :math:`j` in cluster :math:`v`. This is also known as the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3468</span>:       Nearest Point Algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3469</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3470</span>:     * method='complete' assigns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3471</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3472</span>:       .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">3473</span>:          d(u, v) = \max(dist(u[i],v[j]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">3474</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3475</span>:       for all points :math:`i` in cluster u and :math:`j` in</pre>
<pre class="cython line score-0">&#xA0;<span class="">3476</span>:       cluster :math:`v`. This is also known by the Farthest Point</pre>
<pre class="cython line score-0">&#xA0;<span class="">3477</span>:       Algorithm or Voor Hees Algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3478</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3479</span>:     * method='average' assigns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3480</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3481</span>:       .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">3482</span>:          d(u,v) = \sum_{ij} \\frac{d(u[i], v[j])}{(|u|*|v|)}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3483</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3484</span>:       for all points :math:`i` and :math:`j` where :math:`|u|`</pre>
<pre class="cython line score-0">&#xA0;<span class="">3485</span>:       and :math:`|v|` are the cardinalities of clusters :math:`u`</pre>
<pre class="cython line score-0">&#xA0;<span class="">3486</span>:       and :math:`v`, respectively. This is also called the UPGMA</pre>
<pre class="cython line score-0">&#xA0;<span class="">3487</span>:       algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3488</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3489</span>:     * method='weighted' assigns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3490</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3491</span>:       .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">3492</span>:          d(u,v) = (dist(s,v) + dist(t,v))/2</pre>
<pre class="cython line score-0">&#xA0;<span class="">3493</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3494</span>:       where cluster u was formed with cluster s and t and v</pre>
<pre class="cython line score-0">&#xA0;<span class="">3495</span>:       is a remaining cluster in the forest (also called WPGMA).</pre>
<pre class="cython line score-0">&#xA0;<span class="">3496</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3497</span>:     * method='centroid' assigns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3498</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3499</span>:       .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">3500</span>:          dist(s,t) = ||c_s-c_t||_2</pre>
<pre class="cython line score-0">&#xA0;<span class="">3501</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3502</span>:       where :math:`c_s` and :math:`c_t` are the centroids of</pre>
<pre class="cython line score-0">&#xA0;<span class="">3503</span>:       clusters :math:`s` and :math:`t`, respectively. When two</pre>
<pre class="cython line score-0">&#xA0;<span class="">3504</span>:       clusters :math:`s` and :math:`t` are combined into a new</pre>
<pre class="cython line score-0">&#xA0;<span class="">3505</span>:       cluster :math:`u`, the new centroid is computed over all the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3506</span>:       original objects in clusters :math:`s` and :math:`t`. The</pre>
<pre class="cython line score-0">&#xA0;<span class="">3507</span>:       distance then becomes the Euclidean distance between the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3508</span>:       centroid of :math:`u` and the centroid of a remaining cluster</pre>
<pre class="cython line score-0">&#xA0;<span class="">3509</span>:       :math:`v` in the forest. This is also known as the UPGMC</pre>
<pre class="cython line score-0">&#xA0;<span class="">3510</span>:       algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3511</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3512</span>:     * method='median' assigns :math:`d(s,t)` like the ``centroid``</pre>
<pre class="cython line score-0">&#xA0;<span class="">3513</span>:       method. When two clusters :math:`s` and :math:`t` are combined</pre>
<pre class="cython line score-0">&#xA0;<span class="">3514</span>:       into a new cluster :math:`u`, the average of centroids s and t</pre>
<pre class="cython line score-0">&#xA0;<span class="">3515</span>:       give the new centroid :math:`u`. This is also known as the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3516</span>:       WPGMC algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3517</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3518</span>:     * method='ward' uses the Ward variance minimization algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3519</span>:       The new entry :math:`d(u,v)` is computed as follows,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3520</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3521</span>:       .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">3522</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3523</span>:          d(u,v) = \sqrt{\frac{|v|+|s|}{_T}d(v,s)^2 \\</pre>
<pre class="cython line score-0">&#xA0;<span class="">3524</span>:                       + \frac{|v|+|t|}{_T}d(v,t)^2 \\</pre>
<pre class="cython line score-0">&#xA0;<span class="">3525</span>:                       - \frac{|v|}{_T}d(s,t)^2}</pre>
<pre class="cython line score-0">&#xA0;<span class="">3526</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3527</span>:       where :math:`u` is the newly joined cluster consisting of</pre>
<pre class="cython line score-0">&#xA0;<span class="">3528</span>:       clusters :math:`s` and :math:`t`, :math:`v` is an unused</pre>
<pre class="cython line score-0">&#xA0;<span class="">3529</span>:       cluster in the forest, :math:`_T=|v|+|s|+|t|`, and</pre>
<pre class="cython line score-0">&#xA0;<span class="">3530</span>:       :math:`|*|` is the cardinality of its argument. This is also</pre>
<pre class="cython line score-0">&#xA0;<span class="">3531</span>:       known as the incremental algorithm.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3532</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3533</span>:     Warning: When the minimum distance pair in the forest is chosen, there</pre>
<pre class="cython line score-0">&#xA0;<span class="">3534</span>:     may be two or more pairs with the same minimum distance. This</pre>
<pre class="cython line score-0">&#xA0;<span class="">3535</span>:     implementation may choose a different minimum than the MATLAB</pre>
<pre class="cython line score-0">&#xA0;<span class="">3536</span>:     version.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3537</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3538</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">3539</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3540</span>:     scipy.spatial.distance.pdist : pairwise distance metrics</pre>
<pre class="cython line score-0">&#xA0;<span class="">3541</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3542</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">3543</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3544</span>:     .. [1] Daniel Mullner, "Modern hierarchical, agglomerative clustering</pre>
<pre class="cython line score-0">&#xA0;<span class="">3545</span>:            algorithms", :arXiv:`1109.2378v1`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3546</span>:     .. [2] Ziv Bar-Joseph, David K. Gifford, Tommi S. Jaakkola, "Fast optimal</pre>
<pre class="cython line score-0">&#xA0;<span class="">3547</span>:            leaf ordering for hierarchical clustering", 2001. Bioinformatics</pre>
<pre class="cython line score-0">&#xA0;<span class="">3548</span>:            :doi:`10.1093/bioinformatics/17.suppl_1.S22`</pre>
<pre class="cython line score-0">&#xA0;<span class="">3549</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3550</span>:     """</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3551</span>:     df = _assert_all_types(df, pd.DataFrame, np.ndarray)</pre>
<pre class='cython code score-29 '>  <span class='trace'>__Pyx_TraceLine</span>(3551,0,<span class='error_goto'>__PYX_ERR(0, 3551, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_assert_all_types);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3551, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3551, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3551, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3551, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3551, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_3, __pyx_v_df, __pyx_t_4, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 3+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3551, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_df, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3552</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3553</span>:     if columns is not None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(3553,0,<span class='error_goto'>__PYX_ERR(0, 3553, __pyx_L1_error)</span>)
  __pyx_t_7 = (__pyx_v_columns != Py_None);
  if (__pyx_t_7) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3554</span>:         if isinstance (columns , str):</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(3554,0,<span class='error_goto'>__PYX_ERR(0, 3554, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_columns); 
    if (__pyx_t_7) {
/* … */
    }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3555</span>:             columns = [columns]</pre>
<pre class='cython code score-9 '>      <span class='trace'>__Pyx_TraceLine</span>(3555,0,<span class='error_goto'>__PYX_ERR(0, 3555, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3555, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_columns);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_columns);
      if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_columns)) <span class='error_goto'>__PYX_ERR(0, 3555, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_columns, __pyx_t_1);
      __pyx_t_1 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3556</span>:         if len(columns)!= df.shape [1]:</pre>
<pre class='cython code score-25 '>    <span class='trace'>__Pyx_TraceLine</span>(3556,0,<span class='error_goto'>__PYX_ERR(0, 3556, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_columns);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3556, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3556, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3556, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3556, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_5, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3556, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3556, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(__pyx_t_7)) {
/* … */
    }
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3557</span>:             raise TypeError("Number of columns must fit the shape of X."</pre>
<pre class='cython code score-16 '>      <span class='trace'>__Pyx_TraceLine</span>(3557,0,<span class='error_goto'>__PYX_ERR(0, 3557, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3557, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_8 = 0;
      __pyx_t_9 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Number_of_columns_must_fit_the_s);
      __pyx_t_8 += 47;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Number_of_columns_must_fit_the_s);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_Number_of_columns_must_fit_the_s);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(3557,0,<span class='error_goto'>__PYX_ERR(0, 3557, __pyx_L1_error)</span>)
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 4, __pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3557, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3557, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 3557, __pyx_L1_error)</span>
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3558</span>:                             f" got {len(columns)} instead of {df.shape [1]}"</pre>
<pre class='cython code score-27 '>      <span class='trace'>__Pyx_TraceLine</span>(3558,0,<span class='error_goto'>__PYX_ERR(0, 3558, __pyx_L1_error)</span>)
      __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_columns);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3558, __pyx_L1_error)</span>
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_10, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3558, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_8 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_5);
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_instead_of);
      __pyx_t_8 += 12;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_instead_of);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_instead_of);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3558, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3558, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3558, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_9) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_9;
      __pyx_t_8 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_t_5);
      __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3559</span>:                             )</pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3560</span>:         df = pd.DataFrame(data = df.values if hasattr(df, 'columns') else df ,</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(3560,0,<span class='error_goto'>__PYX_ERR(0, 3560, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(__pyx_v_df, __pyx_n_u_columns);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 3560, __pyx_L1_error)</span>
    if (__pyx_t_7) {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_values);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3560, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_1 = __pyx_t_4;
      __pyx_t_4 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
      __pyx_t_1 = __pyx_v_df;
    }
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_data, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3560, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3560,0,<span class='error_goto'>__PYX_ERR(0, 3560, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3560, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_df, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3561</span>:                           columns = columns )</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(3561,0,<span class='error_goto'>__PYX_ERR(0, 3561, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_columns, __pyx_v_columns) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3560, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3562</span>: </pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3563</span>:     kind= str(kind).lower().strip()</pre>
<pre class='cython code score-44 '>  <span class='trace'>__Pyx_TraceLine</span>(3563,0,<span class='error_goto'>__PYX_ERR(0, 3563, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_v_kind);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3563, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_strip);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3563, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  if (!(likely(<span class='py_c_api'>PyUnicode_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("unicode", __pyx_t_1))) <span class='error_goto'>__PYX_ERR(0, 3563, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kind, ((PyObject*)__pyx_t_1));
  __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3564</span>:     if kind not in ('squareform', 'condense', 'design'):</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(3564,0,<span class='error_goto'>__PYX_ERR(0, 3564, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kind);
  __pyx_t_11 = __pyx_v_kind;
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_11, __pyx_n_u_squareform, Py_NE)); if (unlikely((__pyx_t_12 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3564, __pyx_L1_error)</span>
  if (__pyx_t_12) {
  } else {
    __pyx_t_7 = __pyx_t_12;
    goto __pyx_L7_bool_binop_done;
  }
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_11, __pyx_n_u_condense, Py_NE)); if (unlikely((__pyx_t_12 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3564, __pyx_L1_error)</span>
  if (__pyx_t_12) {
  } else {
    __pyx_t_7 = __pyx_t_12;
    goto __pyx_L7_bool_binop_done;
  }
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_11, __pyx_n_u_design, Py_NE)); if (unlikely((__pyx_t_12 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3564, __pyx_L1_error)</span>
  __pyx_t_7 = __pyx_t_12;
  __pyx_L7_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  __pyx_t_12 = __pyx_t_7;
  if (unlikely(__pyx_t_12)) {
/* … */
  }
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3565</span>:         raise ValueError(f"Unknown method {method!r}. Expect 'squareform',"</pre>
<pre class='cython code score-32 '>    <span class='trace'>__Pyx_TraceLine</span>(3565,0,<span class='error_goto'>__PYX_ERR(0, 3565, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3565, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = 0;
    __pyx_t_9 = 127;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Unknown_method);
    __pyx_t_8 += 15;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Unknown_method);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_Unknown_method);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Repr</span>(__pyx_v_method), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3565, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_9) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_9;
    __pyx_t_8 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
    __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Expect_squareform_condense_or_d);
    __pyx_t_8 += 46;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Expect_squareform_condense_or_d);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_Expect_squareform_condense_or_d);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 3, __pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3565, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3565, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3565, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3566</span>:                          " 'condense' or 'design'.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">3567</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3568</span>:     labels = [f'ID_{i}' for i in range(len(df))]</pre>
<pre class='cython code score-18 '>  <span class='trace'>__Pyx_TraceLine</span>(3568,0,<span class='error_goto'>__PYX_ERR(0, 3568, __pyx_L1_error)</span>)
  { /* enter inner scope */
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3568, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_df);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3568, __pyx_L1_error)</span>
    __pyx_t_10 = __pyx_t_8;
    for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_10; __pyx_t_13+=1) {
      __pyx_9genexpr11__pyx_v_i = __pyx_t_13;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_9genexpr11__pyx_v_i, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3568, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_n_u_ID, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3568, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_2))) <span class='error_goto'>__PYX_ERR(0, 3568, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
  } /* exit inner scope */
  __pyx_v_labels = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3569</span>:     if kind =='squareform':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3569,0,<span class='error_goto'>__PYX_ERR(0, 3569, __pyx_L1_error)</span>)
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_kind, __pyx_n_u_squareform, Py_EQ)); if (unlikely((__pyx_t_12 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3569, __pyx_L1_error)</span>
  if (__pyx_t_12) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3570</span>:         row_dist = pd.DataFrame (squareform (</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(3570,0,<span class='error_goto'>__PYX_ERR(0, 3570, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3570, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3570, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_squareform);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3570, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3570,0,<span class='error_goto'>__PYX_ERR(0, 3570, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3570, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3570, __pyx_L1_error)</span>;
    __pyx_t_1 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3570,0,<span class='error_goto'>__PYX_ERR(0, 3570, __pyx_L1_error)</span>)
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3570, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_row_dist = __pyx_t_15;
    __pyx_t_15 = 0;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3571</span>:         pdist(df, metric= metric )), columns = labels  ,</pre>
<pre class='cython code score-44 '>    <span class='trace'>__Pyx_TraceLine</span>(3571,0,<span class='error_goto'>__PYX_ERR(0, 3571, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_pdist);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3571, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3571, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_df);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_df)) <span class='error_goto'>__PYX_ERR(0, 3571, __pyx_L1_error)</span>;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 3571, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_14, __pyx_n_s_metric, __pyx_v_metric) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3571, __pyx_L1_error)</span>
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3571, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    __pyx_t_14 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_14)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_14, __pyx_t_15};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3570, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3571,0,<span class='error_goto'>__PYX_ERR(0, 3571, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3571, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_columns, __pyx_v_labels) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3571, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3572</span>:         index = labels)</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(3572,0,<span class='error_goto'>__PYX_ERR(0, 3572, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_index, __pyx_v_labels) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3571, __pyx_L1_error)</span>
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3573</span>:         row_clusters = linkage (row_dist, method =method, metric =metric</pre>
<pre class='cython code score-27 '>    <span class='trace'>__Pyx_TraceLine</span>(3573,0,<span class='error_goto'>__PYX_ERR(0, 3573, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_15, __pyx_n_s_linkage);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3573, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3573, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_row_dist);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_row_dist);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_row_dist)) <span class='error_goto'>__PYX_ERR(0, 3573, __pyx_L1_error)</span>;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3573, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_method, __pyx_v_method) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3573, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_metric, __pyx_v_metric) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3573, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_15, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3573, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_row_clusters = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3574</span>:                                 )</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3575</span>:     if kind =='condens':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3575,0,<span class='error_goto'>__PYX_ERR(0, 3575, __pyx_L1_error)</span>)
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_kind, __pyx_n_u_condens, Py_EQ)); if (unlikely((__pyx_t_12 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3575, __pyx_L1_error)</span>
  if (__pyx_t_12) {
/* … */
  }
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3576</span>:         row_clusters = linkage (pdist(df, metric =metric), method =method</pre>
<pre class='cython code score-44 '>    <span class='trace'>__Pyx_TraceLine</span>(3576,0,<span class='error_goto'>__PYX_ERR(0, 3576, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_linkage);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3576, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_pdist);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3576, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3576, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_df);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_df)) <span class='error_goto'>__PYX_ERR(0, 3576, __pyx_L1_error)</span>;
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3576, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_15, __pyx_n_s_metric, __pyx_v_metric) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3576, __pyx_L1_error)</span>
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 3576, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3576, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_14)) <span class='error_goto'>__PYX_ERR(0, 3576, __pyx_L1_error)</span>;
    __pyx_t_14 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 3576, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_14, __pyx_n_s_method, __pyx_v_method) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3576, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_15, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3576, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row_clusters, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3577</span>:                                 )</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3578</span>:     if kind =='design':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3578,0,<span class='error_goto'>__PYX_ERR(0, 3578, __pyx_L1_error)</span>)
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_kind, __pyx_n_u_design, Py_EQ)); if (unlikely((__pyx_t_12 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3578, __pyx_L1_error)</span>
  if (__pyx_t_12) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3579</span>:         row_clusters = linkage(df.values if hasattr (df, 'columns') else df,</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(3579,0,<span class='error_goto'>__PYX_ERR(0, 3579, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_linkage);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3579, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(__pyx_v_df, __pyx_n_u_columns);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 3579, __pyx_L1_error)</span>
    if (__pyx_t_12) {
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_df, __pyx_n_s_values);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3579, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_14 = __pyx_t_15;
      __pyx_t_15 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_df);
      __pyx_t_14 = __pyx_v_df;
    }
    __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3579, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_14)) <span class='error_goto'>__PYX_ERR(0, 3579, __pyx_L1_error)</span>;
    __pyx_t_14 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3579,0,<span class='error_goto'>__PYX_ERR(0, 3579, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_15, __pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3579, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row_clusters, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3580</span>:                                method = method,</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(3580,0,<span class='error_goto'>__PYX_ERR(0, 3580, __pyx_L1_error)</span>)
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 3580, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_14, __pyx_n_s_method, __pyx_v_method) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3580, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3581</span>:                                optimal_ordering=optimal_ordering )</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(3581,0,<span class='error_goto'>__PYX_ERR(0, 3581, __pyx_L1_error)</span>)
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_14, __pyx_n_s_optimal_ordering, __pyx_v_optimal_ordering) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3580, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3582</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3583</span>:     if as_frame:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3583,0,<span class='error_goto'>__PYX_ERR(0, 3583, __pyx_L1_error)</span>)
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_as_frame); if (unlikely((__pyx_t_12 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3583, __pyx_L1_error)</span>
  if (__pyx_t_12) {
/* … */
  }
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3584</span>:         row_clusters = pd.DataFrame ( row_clusters,</pre>
<pre class='cython code score-21 '>    <span class='trace'>__Pyx_TraceLine</span>(3584,0,<span class='error_goto'>__PYX_ERR(0, 3584, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3584, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 3584, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_v_row_clusters)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("row_clusters"); <span class='error_goto'>__PYX_ERR(0, 3584, __pyx_L1_error)</span> }
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3584, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_row_clusters);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_row_clusters);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_row_clusters)) <span class='error_goto'>__PYX_ERR(0, 3584, __pyx_L1_error)</span>;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3584,0,<span class='error_goto'>__PYX_ERR(0, 3584, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_14, __pyx_t_2, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3584, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_row_clusters, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3585</span>:                                      columns = [ 'row label 1',</pre>
<pre class='cython code score-25 '>    <span class='trace'>__Pyx_TraceLine</span>(3585,0,<span class='error_goto'>__PYX_ERR(0, 3585, __pyx_L1_error)</span>)
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 3585, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3585, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_row_label_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_row_label_1);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_row_label_1)) <span class='error_goto'>__PYX_ERR(0, 3585, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_row_lable_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_row_lable_2);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_kp_u_row_lable_2)) <span class='error_goto'>__PYX_ERR(0, 3585, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_distance);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_distance);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_u_distance)) <span class='error_goto'>__PYX_ERR(0, 3585, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_no_of_items_in_clust);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_no_of_items_in_clust);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_kp_u_no_of_items_in_clust)) <span class='error_goto'>__PYX_ERR(0, 3585, __pyx_L1_error)</span>;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_15, __pyx_n_s_columns, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3585, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    { /* enter inner scope */
</pre><pre class="cython line score-0">&#xA0;<span class="">3586</span>:                                                 'row lable 2',</pre>
<pre class="cython line score-0">&#xA0;<span class="">3587</span>:                                                 'distance',</pre>
<pre class="cython line score-0">&#xA0;<span class="">3588</span>:                                                 'no. of items in clust.'</pre>
<pre class="cython line score-0">&#xA0;<span class="">3589</span>:                                                 ],</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3590</span>:                                      index = ['cluster %d' % (i +1) for i in</pre>
<pre class='cython code score-22 '>      <span class='trace'>__Pyx_TraceLine</span>(3590,0,<span class='error_goto'>__PYX_ERR(0, 3590, __pyx_L18_error)</span>)
      __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3590, __pyx_L18_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
        <span class='trace'>__Pyx_TraceLine</span>(3590,0,<span class='error_goto'>__PYX_ERR(0, 3590, __pyx_L18_error)</span>)
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_9genexpr12__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3590, __pyx_L18_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_cluster_d, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3590, __pyx_L18_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_1, (PyObject*)__pyx_t_5))) <span class='error_goto'>__PYX_ERR(0, 3590, __pyx_L18_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr12__pyx_v_i); __pyx_9genexpr12__pyx_v_i = 0;
      goto __pyx_L22_exit_scope;
      __pyx_L18_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr12__pyx_v_i); __pyx_9genexpr12__pyx_v_i = 0;
      goto __pyx_L1_error;
      __pyx_L22_exit_scope:;
    } /* exit inner scope */
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_15, __pyx_n_s_index, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3585, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3591</span>:                                               range(row_clusters.shape[0])</pre>
<pre class='cython code score-59 '>      <span class='trace'>__Pyx_TraceLine</span>(3591,0,<span class='error_goto'>__PYX_ERR(0, 3591, __pyx_L18_error)</span>)
      if (unlikely(!__pyx_v_row_clusters)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("row_clusters"); <span class='error_goto'>__PYX_ERR(0, 3591, __pyx_L18_error)</span> }
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_row_clusters, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3591, __pyx_L18_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3591, __pyx_L18_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3591, __pyx_L18_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
        __pyx_t_3 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        __pyx_t_8 = 0;
        __pyx_t_16 = NULL;
      } else {
        __pyx_t_8 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3591, __pyx_L18_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 3591, __pyx_L18_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      for (;;) {
        if (likely(!__pyx_t_16)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3591, __pyx_L18_error)</span>
              #endif
              if (__pyx_t_8 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_8++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3591, __pyx_L18_error)</span>
            #else
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3591, __pyx_L18_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            #endif
          } else {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3591, __pyx_L18_error)</span>
              #endif
              if (__pyx_t_8 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_8); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_8++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3591, __pyx_L18_error)</span>
            #else
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_8); __pyx_t_8++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3591, __pyx_L18_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            #endif
          }
        } else {
          __pyx_t_4 = __pyx_t_16(__pyx_t_3);
          if (unlikely(!__pyx_t_4)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 3591, __pyx_L18_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_9genexpr12__pyx_v_i, __pyx_t_4);
        __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3592</span>:                                               ]</pre>
<pre class="cython line score-0">&#xA0;<span class="">3593</span>:                                      )</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3594</span>:     return row_clusters</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(3594,0,<span class='error_goto'>__PYX_ERR(0, 3594, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_row_clusters)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("row_clusters"); <span class='error_goto'>__PYX_ERR(0, 3594, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_row_clusters);
  __pyx_r = __pyx_v_row_clusters;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3595</span>: </pre>
<pre class="cython line score-105" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3596</span>: @AppendDocReferences(refglossary.__doc__)</pre>
<pre class='cython code score-105 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_89scalePosition(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_88scalePosition, " Correct data location or position and return new corrected location \n    \n    Parameters \n    ----------\n    ydata: array_like, series or dataframe\n        The dependent data, a length M array - nominally ``f(xdata, ...)``.\n        \n    xdata: array_like or object\n        The independent variable where the data is measured. Should usually \n        be an M-length sequence or an (k,M)-shaped array for functions with\n        k predictors, but can actually be any object. If ``None``, `xdata` is \n        generated by default using the length of the given `ydata`.\n        \n    func: callable \n        The model function, ``f(x, ...)``. It must take the independent variable \n        as the first argument and the parameters to fit as separate remaining\n        arguments. The default `func` is ``linear`` function i.e  for ``f(x)= ax +b``. \n        where `a` is slope and `b` is the intercept value. Setting your own \n        function for better fitting is recommended. \n        \n    c_order: int or str\n        The index or the column name if ``ydata`` is given as a dataframe to \n        select the right column for scaling.\n    show: bool \n        Quick visualization of data distribution. \n\n    kws: dict \n        Additional keyword argument from  `scipy.optimize_curvefit` parameters. \n        Refer to `scipy.optimize.curve_fit`_.  \n        \n    Returns \n    --------\n    - ydata - array -like - Data scaled \n    - popt - array-like Optimal values for the parameters so that the sum of \n        the squared residuals of ``f(xdata, *popt) - ydata`` is minimized.\n    - pcov - array like The estimated covariance of popt. The diagonals provide\n        the variance of the parameter estimate. To compute one standard deviation \n        errors on the parameters use ``perr = np.sqrt(np.diag(pcov))``. How the\n        sigma parameter affects the estimated covariance depends on absolute_sigma \n        argument, as described above. If the Jacobian matrix at ""the solution\n        doesn\342\200\231t have a full rank, then \342\200\230lm\342\200\231 method returns a matrix filled with\n        np.inf, on the other hand 'trf' and 'dogbox' methods use Moore-Penrose\n        pseudoinverse to compute the covariance matrix.\n        \n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools import erpSelector, scalePosition \n    &gt;&gt;&gt; df = erpSelector('data/erp/l10_gbalo.xlsx') \n    &gt;&gt;&gt; df.columns \n    ... Index(['station', 'resistivity', 'longitude', 'latitude', 'easting',\n           'northing'],\n          dtype='object')\n    &gt;&gt;&gt; # correcting northing coordinates from easting data \n    &gt;&gt;&gt; northing_corrected, popt, pcov = scalePosition(ydata =df.northing , \n                                               xdata = df.easting, show=True)\n    &gt;&gt;&gt; len(df.northing.values) , len(northing_corrected)\n    ... (20, 20)\n    &gt;&gt;&gt; popt  # by default popt =(slope:a ,intercept: b)\n    ...  array([1.01151734e+00, 2.93731377e+05])\n    &gt;&gt;&gt; # corrected easting coordinates using the default x.\n    &gt;&gt;&gt; easting_corrected, *_= scalePosition(ydata =df.easting , show=True)\n    &gt;&gt;&gt; df.easting.values \n    ... array([790284, 790281, 790277, 790270, 790265, 790260, 790254, 790248,\n    ...       790243, 790237, 790231, 790224, 790218, 790211, 790206, 790200,\n    ...       790194, 790187, 790181, 790175], dtype=int64)\n    &gt;&gt;&gt; easting_corrected\n    ... array([790288.18571705, 790282.30300999, 790276.42030293, 790270.53759587,\n    ...       790264.6548888 , 790258.77218174, 790252.88947468, 790247.00676762,\n    ...       790241.12406056, 790235.2413535 , 790229.35864644, 790223.47593938,\n    ...       790217.59323232, 790211.71052526, 790205.8278182 , 790199.94511114,\n    ...       790194.06240407, 790188.17969701, 790182.29698995, 790176.41428289])\n    \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_89scalePosition = {"scalePosition", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_89scalePosition, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_88scalePosition};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_89scalePosition(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_ydata = 0;
  PyObject *__pyx_v_xdata = 0;
  PyObject *__pyx_v_func = 0;
  PyObject *__pyx_v_c_order = 0;
  PyObject *__pyx_v_show = 0;
  PyObject *__pyx_v_kws = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scalePosition (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kws = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kws)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kws);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_ydata,&amp;__pyx_n_s_xdata,&amp;__pyx_n_s_func,&amp;__pyx_n_s_c_order,&amp;__pyx_n_s_show,0};
  PyObject* values[5] = {0,0,0,0,0};
/* … */
  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kws);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_6gofast_5tools_6mathex_88scalePosition(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ydata, PyObject *__pyx_v_xdata, PyObject *__pyx_v_func, PyObject *__pyx_v_c_order, PyObject *__pyx_v_show, PyObject *__pyx_v_kws) {
  PyObject *__pyx_v_linfunc = 0;
  PyObject *__pyx_v_ix_c = NULL;
  PyObject *__pyx_v_popt = NULL;
  PyObject *__pyx_v_pcov = NULL;
  PyObject *__pyx_v_ydata_new = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__98)
  <span class='trace'>__Pyx_TraceCall</span>("scalePosition", __pyx_f[0], 3596, 0, <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ydata);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xdata);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_func);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_c_order);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.scalePosition", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_linfunc);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ix_c);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_popt);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pcov);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ydata_new);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ydata);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xdata);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_func);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_c_order);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3596,0,<span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_AppendDocReferences);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_refglossary);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_doc);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_tuple__209 = <span class='py_c_api'>PyTuple_Pack</span>(12, __pyx_n_s_ydata, __pyx_n_s_xdata, __pyx_n_s_func, __pyx_n_s_c_order, __pyx_n_s_show, __pyx_n_s_kws, __pyx_n_s_linfunc, __pyx_n_s_linfunc, __pyx_n_s_ix_c, __pyx_n_s_popt, __pyx_n_s_pcov, __pyx_n_s_ydata_new);<span class='error_goto'> if (unlikely(!__pyx_tuple__209)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__209);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__209);
  __pyx_codeobj__98 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__209, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_scalePosition, 3596, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__98)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3600,0,<span class='error_goto'>__PYX_ERR(0, 3600, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_ydata, __pyx_kp_s_Union_ArrayLike__SP_Series_DataF) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_xdata, __pyx_kp_s_Union_ArrayLike_Series) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_func, __pyx_kp_s_Optional__F) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_c_order, __pyx_kp_s_Optional_Union_int_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_show, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3596,0,<span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_89scalePosition, 0, __pyx_n_s_scalePosition, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__98));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__210);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_scalePosition, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__210 = <span class='py_c_api'>PyTuple_Pack</span>(4, Py_None, Py_None, ((PyObject *)__pyx_int_0), ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__210)) __PYX_ERR(0, 3596, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__210);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__210);
</pre><pre class="cython line score-0">&#xA0;<span class="">3597</span>: def scalePosition(</pre>
<pre class="cython line score-0">&#xA0;<span class="">3598</span>:         ydata: Union[ArrayLike, _SP, Series, DataFrame],</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3599</span>:         xdata: Union[ArrayLike, Series] = None,</pre>
<pre class='cython code score-2 '>    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3600</span>:         func: Optional[_F] = None,</pre>
<pre class='cython code score-4 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_0)));
</pre><pre class="cython line score-0">&#xA0;<span class="">3601</span>:         c_order: Optional[Union[int, str]] = 0,</pre>
<pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3602</span>:         show: bool = False,</pre>
<pre class='cython code score-78 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ydata)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_xdata);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_func);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_c_order);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_show);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kws, values + 0, kwd_pos_args, "scalePosition") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_ydata = values[0];
    __pyx_v_xdata = values[1];
    __pyx_v_func = values[2];
    __pyx_v_c_order = values[3];
    __pyx_v_show = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scalePosition", 0, 1, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3596, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kws); __pyx_v_kws = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.scalePosition", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_88scalePosition(__pyx_self, __pyx_v_ydata, __pyx_v_xdata, __pyx_v_func, __pyx_v_c_order, __pyx_v_show, __pyx_v_kws);
</pre><pre class="cython line score-0">&#xA0;<span class="">3603</span>:         **kws):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3604</span>:     """ Correct data location or position and return new corrected location</pre>
<pre class="cython line score-0">&#xA0;<span class="">3605</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3606</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">3607</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3608</span>:     ydata: array_like, series or dataframe</pre>
<pre class="cython line score-0">&#xA0;<span class="">3609</span>:         The dependent data, a length M array - nominally ``f(xdata, ...)``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3610</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3611</span>:     xdata: array_like or object</pre>
<pre class="cython line score-0">&#xA0;<span class="">3612</span>:         The independent variable where the data is measured. Should usually</pre>
<pre class="cython line score-0">&#xA0;<span class="">3613</span>:         be an M-length sequence or an (k,M)-shaped array for functions with</pre>
<pre class="cython line score-0">&#xA0;<span class="">3614</span>:         k predictors, but can actually be any object. If ``None``, `xdata` is</pre>
<pre class="cython line score-0">&#xA0;<span class="">3615</span>:         generated by default using the length of the given `ydata`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3616</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3617</span>:     func: callable</pre>
<pre class="cython line score-0">&#xA0;<span class="">3618</span>:         The model function, ``f(x, ...)``. It must take the independent variable</pre>
<pre class="cython line score-0">&#xA0;<span class="">3619</span>:         as the first argument and the parameters to fit as separate remaining</pre>
<pre class="cython line score-0">&#xA0;<span class="">3620</span>:         arguments. The default `func` is ``linear`` function i.e  for ``f(x)= ax +b``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3621</span>:         where `a` is slope and `b` is the intercept value. Setting your own</pre>
<pre class="cython line score-0">&#xA0;<span class="">3622</span>:         function for better fitting is recommended.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3623</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3624</span>:     c_order: int or str</pre>
<pre class="cython line score-0">&#xA0;<span class="">3625</span>:         The index or the column name if ``ydata`` is given as a dataframe to</pre>
<pre class="cython line score-0">&#xA0;<span class="">3626</span>:         select the right column for scaling.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3627</span>:     show: bool</pre>
<pre class="cython line score-0">&#xA0;<span class="">3628</span>:         Quick visualization of data distribution.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3629</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3630</span>:     kws: dict</pre>
<pre class="cython line score-0">&#xA0;<span class="">3631</span>:         Additional keyword argument from  `scipy.optimize_curvefit` parameters.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3632</span>:         Refer to `scipy.optimize.curve_fit`_.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3633</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3634</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3635</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3636</span>:     - ydata - array -like - Data scaled</pre>
<pre class="cython line score-0">&#xA0;<span class="">3637</span>:     - popt - array-like Optimal values for the parameters so that the sum of</pre>
<pre class="cython line score-0">&#xA0;<span class="">3638</span>:         the squared residuals of ``f(xdata, *popt) - ydata`` is minimized.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3639</span>:     - pcov - array like The estimated covariance of popt. The diagonals provide</pre>
<pre class="cython line score-0">&#xA0;<span class="">3640</span>:         the variance of the parameter estimate. To compute one standard deviation</pre>
<pre class="cython line score-0">&#xA0;<span class="">3641</span>:         errors on the parameters use ``perr = np.sqrt(np.diag(pcov))``. How the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3642</span>:         sigma parameter affects the estimated covariance depends on absolute_sigma</pre>
<pre class="cython line score-0">&#xA0;<span class="">3643</span>:         argument, as described above. If the Jacobian matrix at the solution</pre>
<pre class="cython line score-0">&#xA0;<span class="">3644</span>:         doesn’t have a full rank, then ‘lm’ method returns a matrix filled with</pre>
<pre class="cython line score-0">&#xA0;<span class="">3645</span>:         np.inf, on the other hand 'trf' and 'dogbox' methods use Moore-Penrose</pre>
<pre class="cython line score-0">&#xA0;<span class="">3646</span>:         pseudoinverse to compute the covariance matrix.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3647</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3648</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">3649</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3650</span>:     &gt;&gt;&gt; from gofast.tools import erpSelector, scalePosition</pre>
<pre class="cython line score-0">&#xA0;<span class="">3651</span>:     &gt;&gt;&gt; df = erpSelector('data/erp/l10_gbalo.xlsx')</pre>
<pre class="cython line score-0">&#xA0;<span class="">3652</span>:     &gt;&gt;&gt; df.columns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3653</span>:     ... Index(['station', 'resistivity', 'longitude', 'latitude', 'easting',</pre>
<pre class="cython line score-0">&#xA0;<span class="">3654</span>:            'northing'],</pre>
<pre class="cython line score-0">&#xA0;<span class="">3655</span>:           dtype='object')</pre>
<pre class="cython line score-0">&#xA0;<span class="">3656</span>:     &gt;&gt;&gt; # correcting northing coordinates from easting data</pre>
<pre class="cython line score-0">&#xA0;<span class="">3657</span>:     &gt;&gt;&gt; northing_corrected, popt, pcov = scalePosition(ydata =df.northing ,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3658</span>:                                                xdata = df.easting, show=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3659</span>:     &gt;&gt;&gt; len(df.northing.values) , len(northing_corrected)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3660</span>:     ... (20, 20)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3661</span>:     &gt;&gt;&gt; popt  # by default popt =(slope:a ,intercept: b)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3662</span>:     ...  array([1.01151734e+00, 2.93731377e+05])</pre>
<pre class="cython line score-0">&#xA0;<span class="">3663</span>:     &gt;&gt;&gt; # corrected easting coordinates using the default x.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3664</span>:     &gt;&gt;&gt; easting_corrected, *_= scalePosition(ydata =df.easting , show=True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3665</span>:     &gt;&gt;&gt; df.easting.values</pre>
<pre class="cython line score-0">&#xA0;<span class="">3666</span>:     ... array([790284, 790281, 790277, 790270, 790265, 790260, 790254, 790248,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3667</span>:     ...       790243, 790237, 790231, 790224, 790218, 790211, 790206, 790200,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3668</span>:     ...       790194, 790187, 790181, 790175], dtype=int64)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3669</span>:     &gt;&gt;&gt; easting_corrected</pre>
<pre class="cython line score-0">&#xA0;<span class="">3670</span>:     ... array([790288.18571705, 790282.30300999, 790276.42030293, 790270.53759587,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3671</span>:     ...       790264.6548888 , 790258.77218174, 790252.88947468, 790247.00676762,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3672</span>:     ...       790241.12406056, 790235.2413535 , 790229.35864644, 790223.47593938,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3673</span>:     ...       790217.59323232, 790211.71052526, 790205.8278182 , 790199.94511114,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3674</span>:     ...       790194.06240407, 790188.17969701, 790182.29698995, 790176.41428289])</pre>
<pre class="cython line score-0">&#xA0;<span class="">3675</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3676</span>:     """</pre>
<pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3677</span>:     def linfunc (x, a, b):</pre>
<pre class='cython code score-77 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_13scalePosition_1linfunc(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_13scalePosition_linfunc, " Set the simple linear function");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_13scalePosition_1linfunc = {"linfunc", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_13scalePosition_1linfunc, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_13scalePosition_linfunc};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_13scalePosition_1linfunc(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_a = 0;
  PyObject *__pyx_v_b = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("linfunc (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_a,&amp;__pyx_n_s_b,0};
  PyObject* values[3] = {0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_a)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("linfunc", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_b)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("linfunc", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "linfunc") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
    }
    __pyx_v_x = values[0];
    __pyx_v_a = values[1];
    __pyx_v_b = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("linfunc", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.scalePosition.linfunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_13scalePosition_linfunc(__pyx_self, __pyx_v_x, __pyx_v_a, __pyx_v_b);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_13scalePosition_linfunc(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_a, PyObject *__pyx_v_b) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("linfunc", __pyx_f[0], 3677, 0, <span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.scalePosition.linfunc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__99 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_x, __pyx_n_s_a, __pyx_n_s_b);<span class='error_goto'> if (unlikely(!__pyx_tuple__99)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__99);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__99);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3677,0,<span class='error_goto'>__PYX_ERR(0, 3677, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_13scalePosition_1linfunc, 0, __pyx_n_s_scalePosition_locals_linfunc, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__100));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_linfunc = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__100 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__99, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_linfunc, 3677, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__100)) __PYX_ERR(0, 3677, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3678</span>:         """ Set the simple linear function"""</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3679</span>:         return a * x + b</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(3679,0,<span class='error_goto'>__PYX_ERR(0, 3679, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_a, __pyx_v_x);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3679, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_b);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3679, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3680</span>: </pre>
<pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3681</span>:     if str(func).lower() in ('none' , 'linear'):</pre>
<pre class='cython code score-24 '>  <span class='trace'>__Pyx_TraceLine</span>(3681,0,<span class='error_goto'>__PYX_ERR(0, 3681, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_v_func);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3681, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3681, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_1, __pyx_n_u_none, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3681, __pyx_L1_error)</span>
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_1, __pyx_n_u_linear, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3681, __pyx_L1_error)</span>
  __pyx_t_5 = __pyx_t_6;
  __pyx_L4_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = __pyx_t_5;
  if (__pyx_t_6) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3682</span>:         func = linfunc</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3682,0,<span class='error_goto'>__PYX_ERR(0, 3682, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_linfunc);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_func, __pyx_v_linfunc);
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3683</span>:     elif not hasattr(func, '__call__') or not inspect.isfunction (func):</pre>
<pre class='cython code score-24 '>  <span class='trace'>__Pyx_TraceLine</span>(3683,0,<span class='error_goto'>__PYX_ERR(0, 3683, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(__pyx_v_func, __pyx_n_u_call);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 3683, __pyx_L1_error)</span>
  __pyx_t_7 = (!__pyx_t_5);
  if (!__pyx_t_7) {
  } else {
    __pyx_t_6 = __pyx_t_7;
    goto __pyx_L6_bool_binop_done;
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_inspect);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3683, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_isfunction);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3683, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_func};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3683, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3683, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = (!__pyx_t_7);
  __pyx_t_6 = __pyx_t_5;
  __pyx_L6_bool_binop_done:;
  if (unlikely(__pyx_t_6)) {
/* … */
  }
  __pyx_L3:;
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3684</span>:         raise TypeError(</pre>
<pre class='cython code score-6 '>    <span class='trace'>__Pyx_TraceLine</span>(3684,0,<span class='error_goto'>__PYX_ERR(0, 3684, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3684, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3684, __pyx_L1_error)</span>
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3685</span>:             f'`func` argument is a callable not {type(func).__name__!r}')</pre>
<pre class='cython code score-13 '>    <span class='trace'>__Pyx_TraceLine</span>(3685,0,<span class='error_goto'>__PYX_ERR(0, 3685, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)Py_TYPE(__pyx_v_func)), __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3685, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Repr</span>(__pyx_t_1), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3685, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_func_argument_is_a_callable_not, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3685, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3686</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3687</span>:     ydata = _assert_all_types(ydata, list, tuple, np.ndarray,</pre>
<pre class='cython code score-7 '>  <span class='trace'>__Pyx_TraceLine</span>(3687,0,<span class='error_goto'>__PYX_ERR(0, 3687, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_assert_all_types);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_ndarray);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3688</span>:                               pd.Series, pd.DataFrame  )</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(3688,0,<span class='error_goto'>__PYX_ERR(0, 3688, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_Series);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[7] = {__pyx_t_3, __pyx_v_ydata, ((PyObject *)(&amp;PyList_Type)), ((PyObject *)(&amp;PyTuple_Type)), __pyx_t_8, __pyx_t_9, __pyx_t_10};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 6+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3687, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ydata, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3689</span>:     c_order = _assert_all_types(c_order, int, float, str)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(3689,0,<span class='error_goto'>__PYX_ERR(0, 3689, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_assert_all_types);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[5] = {__pyx_t_10, __pyx_v_c_order, ((PyObject *)(&amp;PyInt_Type)), ((PyObject *)(&amp;PyFloat_Type)), ((PyObject *)(&amp;PyUnicode_Type))};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 4+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3689, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_c_order, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3690</span>:     try : c_order = int(c_order)</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(3690,0,<span class='error_goto'>__PYX_ERR(0, 3690, __pyx_L1_error)</span>)
  {
    /*try:*/ {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_c_order);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3690, __pyx_L8_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_c_order, __pyx_t_2);
      __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    goto __pyx_L13_try_end;
    __pyx_L8_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
    __pyx_L10_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_11, __pyx_t_12, __pyx_t_13);
    goto __pyx_L1_error;
    __pyx_L9_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_11, __pyx_t_12, __pyx_t_13);
    __pyx_L13_try_end:;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3691</span>:     except: pass</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3691,0,<span class='error_goto'>__PYX_ERR(0, 3691, __pyx_L10_except_error)</span>)
    /*except:*/ {
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(0,0,0);
      goto __pyx_L9_exception_handled;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3692</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3693</span>:     if isinstance(ydata, pd.DataFrame):</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(3693,0,<span class='error_goto'>__PYX_ERR(0, 3693, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_pd);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3693, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_DataFrame);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3693, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyObject_IsInstance</span>(__pyx_v_ydata, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 3693, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3694</span>:         if c_order ==0:</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(3694,0,<span class='error_goto'>__PYX_ERR(0, 3694, __pyx_L1_error)</span>)
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_v_c_order, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3694, __pyx_L1_error)</span>
    if (__pyx_t_6) {
/* … */
    }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3695</span>:             warnings.warn("The first column of the data should be considered"</pre>
<pre class='cython code score-20 '>      <span class='trace'>__Pyx_TraceLine</span>(3695,0,<span class='error_goto'>__PYX_ERR(0, 3695, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3695, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3695, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_kp_u_The_first_column_of_the_data_sho};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3695, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3696</span>:                           " as the `y` target.")</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3697</span>:         if c_order is None:</pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(3697,0,<span class='error_goto'>__PYX_ERR(0, 3697, __pyx_L1_error)</span>)
    __pyx_t_6 = (__pyx_v_c_order == Py_None);
    if (unlikely(__pyx_t_6)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3698</span>:             raise TypeError('Dataframe is given. The `c_order` argument should '</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(3698,0,<span class='error_goto'>__PYX_ERR(0, 3698, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__101, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3698, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 3698, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__101 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Dataframe_is_given_The_c_order_a);<span class='error_goto'> if (unlikely(!__pyx_tuple__101)) __PYX_ERR(0, 3698, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__101);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__101);
</pre><pre class="cython line score-0">&#xA0;<span class="">3699</span>:                             'be defined for column selection. Use column name'</pre>
<pre class="cython line score-0">&#xA0;<span class="">3700</span>:                             ' instead')</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3701</span>:         if isinstance(c_order, str):</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(3701,0,<span class='error_goto'>__PYX_ERR(0, 3701, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_c_order); 
    if (__pyx_t_6) {
/* … */
      goto __pyx_L17;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3702</span>:             # check whether the value is on the column name</pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3703</span>:             if c_order.lower() not in list(map(</pre>
<pre class='cython code score-35 '>      <span class='trace'>__Pyx_TraceLine</span>(3703,0,<span class='error_goto'>__PYX_ERR(0, 3703, __pyx_L1_error)</span>)
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_c_order, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3703, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_2 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3703, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(3703,0,<span class='error_goto'>__PYX_ERR(0, 3703, __pyx_L1_error)</span>)
      __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3703, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3703, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3703, __pyx_L1_error)</span>;
      __pyx_t_10 = 0;
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_map, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3703, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3703, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_t_1, __pyx_t_9, Py_NE)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3703, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(__pyx_t_6)) {
/* … */
      }
</pre><pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3704</span>:                     lambda x :x.lower(), ydata.columns)):</pre>
<pre class='cython code score-59 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_13scalePosition_2lambda4(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_13scalePosition_2lambda4 = {"lambda4", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_13scalePosition_2lambda4, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_13scalePosition_2lambda4(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda4 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3704, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "lambda4") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3704, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_x = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lambda4", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3704, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.scalePosition.lambda4", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_lambda_funcdef_lambda4(__pyx_self, __pyx_v_x);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda4(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("lambda4", __pyx_f[0], 3704, 0, <span class='error_goto'>__PYX_ERR(0, 3704, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3704, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3704, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.scalePosition.lambda4", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(3704,0,<span class='error_goto'>__PYX_ERR(0, 3704, __pyx_L1_error)</span>)
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_13scalePosition_2lambda4, 0, __pyx_n_s_scalePosition_locals_lambda, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3704, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ydata, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3704, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3705</span>:                 raise ValueError (</pre>
<pre class='cython code score-6 '>        <span class='trace'>__Pyx_TraceLine</span>(3705,0,<span class='error_goto'>__PYX_ERR(0, 3705, __pyx_L1_error)</span>)
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3705, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_9, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='error_goto'>__PYX_ERR(0, 3705, __pyx_L1_error)</span>
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3706</span>:                     f'c_order {c_order!r} not found in {list(ydata.columns)}'</pre>
<pre class='cython code score-43 '>        <span class='trace'>__Pyx_TraceLine</span>(3706,0,<span class='error_goto'>__PYX_ERR(0, 3706, __pyx_L1_error)</span>)
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        __pyx_t_14 = 0;
        __pyx_t_15 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_c_order_2);
        __pyx_t_14 += 8;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_c_order_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_kp_u_c_order_2);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Repr</span>(__pyx_v_c_order), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_15 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_15) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_15;
        __pyx_t_14 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_1);
        __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_not_found_in);
        __pyx_t_14 += 14;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_not_found_in);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_kp_u_not_found_in);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ydata, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_2, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_15 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_15) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_15;
        __pyx_t_14 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 3, __pyx_t_1);
        __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Use_the_index_instead);
        __pyx_t_14 += 23;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Use_the_index_instead);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 4, __pyx_kp_u_Use_the_index_instead);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_9, 5, __pyx_t_14, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3706, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3707</span>:                     ' Use the index instead.')</pre>
<pre class="cython line score-0">&#xA0;<span class="">3708</span>:                 # if c_order exists find the index and get the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3709</span>:                 # right column name</pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3710</span>:             ix_c = list(map( lambda x :x.lower(), ydata.columns)</pre>
<pre class='cython code score-74 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_13scalePosition_3lambda5(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_13scalePosition_3lambda5 = {"lambda5", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_13scalePosition_3lambda5, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_13scalePosition_3lambda5(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("lambda5 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,0};
  PyObject* values[1] = {0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3710, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "lambda5") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3710, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
    }
    __pyx_v_x = values[0];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("lambda5", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3710, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.scalePosition.lambda5", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_lambda_funcdef_lambda5(__pyx_self, __pyx_v_x);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_lambda_funcdef_lambda5(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("lambda5", __pyx_f[0], 3710, 0, <span class='error_goto'>__PYX_ERR(0, 3710, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3710, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3710, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.scalePosition.lambda5", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(3710,0,<span class='error_goto'>__PYX_ERR(0, 3710, __pyx_L1_error)</span>)
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_13scalePosition_3lambda5, 0, __pyx_n_s_scalePosition_locals_lambda, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3710, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ydata, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3710, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3710, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3710, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3710, __pyx_L1_error)</span>;
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_map, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3710, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3710, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3711</span>:                         ).index(c_order.lower())</pre>
<pre class='cython code score-34 '>      <span class='trace'>__Pyx_TraceLine</span>(3711,0,<span class='error_goto'>__PYX_ERR(0, 3711, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3711, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_c_order, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3711, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_8 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_8)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_8, NULL};
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3711, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      __pyx_t_1 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_10};
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 3711, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      __pyx_v_ix_c = __pyx_t_9;
      __pyx_t_9 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3712</span>:             ydata = ydata.iloc [:, ix_c] # series</pre>
<pre class='cython code score-18 '>      <span class='trace'>__Pyx_TraceLine</span>(3712,0,<span class='error_goto'>__PYX_ERR(0, 3712, __pyx_L1_error)</span>)
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ydata, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3712, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3712, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 3712, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ix_c);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ix_c);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_ix_c)) <span class='error_goto'>__PYX_ERR(0, 3712, __pyx_L1_error)</span>;
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_9, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3712, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ydata, __pyx_t_10);
      __pyx_t_10 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3713</span>:         elif isinstance (c_order, (int, float)):</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(3713,0,<span class='error_goto'>__PYX_ERR(0, 3713, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='py_c_api'>PyInt_Check</span>(__pyx_v_c_order); 
    if (!__pyx_t_5) {
    } else {
      __pyx_t_6 = __pyx_t_5;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_t_5 = <span class='py_c_api'>PyFloat_Check</span>(__pyx_v_c_order); 
    __pyx_t_6 = __pyx_t_5;
    __pyx_L19_bool_binop_done:;
    if (__pyx_t_6) {
/* … */
    }
    __pyx_L17:;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3714</span>:             c_order =int(c_order)</pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(3714,0,<span class='error_goto'>__PYX_ERR(0, 3714, __pyx_L1_error)</span>)
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_c_order);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3714, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_c_order, __pyx_t_10);
      __pyx_t_10 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3715</span>:             if c_order &gt;= len(ydata.columns):</pre>
<pre class='cython code score-22 '>      <span class='trace'>__Pyx_TraceLine</span>(3715,0,<span class='error_goto'>__PYX_ERR(0, 3715, __pyx_L1_error)</span>)
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ydata, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3715, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_14 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3715, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_10 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3715, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_c_order, __pyx_t_10, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3715, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3715, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(__pyx_t_6)) {
/* … */
      }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3716</span>:                 raise ValueError(</pre>
<pre class='cython code score-6 '>        <span class='trace'>__Pyx_TraceLine</span>(3716,0,<span class='error_goto'>__PYX_ERR(0, 3716, __pyx_L1_error)</span>)
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3716, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='error_goto'>__PYX_ERR(0, 3716, __pyx_L1_error)</span>
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3717</span>:                     f"`c_order`'{c_order}' should be less than the number of "</pre>
<pre class='cython code score-21 '>        <span class='trace'>__Pyx_TraceLine</span>(3717,0,<span class='error_goto'>__PYX_ERR(0, 3717, __pyx_L1_error)</span>)
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3717, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_14 = 0;
        __pyx_t_15 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_c_order_3);
        __pyx_t_14 += 10;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_c_order_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_c_order_3);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_c_order, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3717, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_15 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_10) &gt; __pyx_t_15) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_10) : __pyx_t_15;
        __pyx_t_14 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_10);
        __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_should_be_less_than_the_number);
        __pyx_t_14 += 51;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_should_be_less_than_the_number);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_should_be_less_than_the_number);
/* … */
        <span class='trace'>__Pyx_TraceLine</span>(3717,0,<span class='error_goto'>__PYX_ERR(0, 3717, __pyx_L1_error)</span>)
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 5, __pyx_t_14, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3717, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3718</span>:                     f"given columns '{len(ydata.columns)}'. Use column name instead.")</pre>
<pre class='cython code score-15 '>        <span class='trace'>__Pyx_TraceLine</span>(3718,0,<span class='error_goto'>__PYX_ERR(0, 3718, __pyx_L1_error)</span>)
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ydata, __pyx_n_s_columns);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3718, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_16 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(__pyx_t_16 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3718, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_16, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3718, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_14 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_t_10);
        __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Use_column_name_instead);
        __pyx_t_14 += 27;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Use_column_name_instead);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4, __pyx_kp_u_Use_column_name_instead);
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3719</span>:             ydata= ydata.iloc[:, c_order]</pre>
<pre class='cython code score-18 '>      <span class='trace'>__Pyx_TraceLine</span>(3719,0,<span class='error_goto'>__PYX_ERR(0, 3719, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ydata, __pyx_n_s_iloc);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3719, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3719, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 3719, __pyx_L1_error)</span>;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_c_order);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_c_order);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_c_order)) <span class='error_goto'>__PYX_ERR(0, 3719, __pyx_L1_error)</span>;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_2, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3719, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ydata, __pyx_t_9);
      __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3720</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3721</span>:     ydata = check_y (np.array(ydata)  , input_name= "ydata")</pre>
<pre class='cython code score-41 '>  <span class='trace'>__Pyx_TraceLine</span>(3721,0,<span class='error_goto'>__PYX_ERR(0, 3721, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_check_y);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_ydata};
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3721, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3721, __pyx_L1_error)</span>;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_input_name, __pyx_n_u_ydata) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3721, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_1, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3721, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_ydata, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3722</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3723</span>:     if xdata is None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(3723,0,<span class='error_goto'>__PYX_ERR(0, 3723, __pyx_L1_error)</span>)
  __pyx_t_6 = (__pyx_v_xdata == Py_None);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3724</span>:         xdata = np.linspace(0, 4, len(ydata))</pre>
<pre class='cython code score-31 '>    <span class='trace'>__Pyx_TraceLine</span>(3724,0,<span class='error_goto'>__PYX_ERR(0, 3724, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3724, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_linspace);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3724, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_14 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_ydata);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3724, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_14);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3724, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_9 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_9, __pyx_int_0, __pyx_int_4, __pyx_t_10};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 3+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3724, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_xdata, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3725</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3726</span>:     xdata = check_y (xdata , input_name= "Xdata")</pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(3726,0,<span class='error_goto'>__PYX_ERR(0, 3726, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_check_y);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xdata);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xdata);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_xdata)) <span class='error_goto'>__PYX_ERR(0, 3726, __pyx_L1_error)</span>;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_input_name, __pyx_n_u_Xdata) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3726, __pyx_L1_error)</span>
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_xdata, __pyx_t_9);
  __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3727</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3728</span>:     if len(xdata) != len(ydata):</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(3728,0,<span class='error_goto'>__PYX_ERR(0, 3728, __pyx_L1_error)</span>)
  __pyx_t_14 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_xdata);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3728, __pyx_L1_error)</span>
  __pyx_t_16 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_ydata);<span class='error_goto'> if (unlikely(__pyx_t_16 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3728, __pyx_L1_error)</span>
  __pyx_t_6 = (__pyx_t_14 != __pyx_t_16);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3729</span>:         raise ValueError(" `x` and `y` arrays must have the same length."</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(3729,0,<span class='error_goto'>__PYX_ERR(0, 3729, __pyx_L1_error)</span>)
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__102, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3729, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_9, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3729, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__102 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_x_and_y_arrays_must_have_the_sa);<span class='error_goto'> if (unlikely(!__pyx_tuple__102)) __PYX_ERR(0, 3729, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__102);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__102);
</pre><pre class="cython line score-0">&#xA0;<span class="">3730</span>:                         "'{len(xdata)}' and '{len(ydata)}' are given.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">3731</span>: </pre>
<pre class="cython line score-72" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3732</span>:     popt, pcov = curve_fit(func, xdata, ydata, **kws)</pre>
<pre class='cython code score-72 '>  <span class='trace'>__Pyx_TraceLine</span>(3732,0,<span class='error_goto'>__PYX_ERR(0, 3732, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_curve_fit);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_func);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_func);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_v_func)) <span class='error_goto'>__PYX_ERR(0, 3732, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xdata);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xdata);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_xdata)) <span class='error_goto'>__PYX_ERR(0, 3732, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ydata);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ydata);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_v_ydata)) <span class='error_goto'>__PYX_ERR(0, 3732, __pyx_L1_error)</span>;
  __pyx_t_1 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kws);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_10, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3732, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
    PyObject* sequence = __pyx_t_2;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 3732, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_10 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_10 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
    #else
    __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3732, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_10 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3732, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3732, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_17 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_9);
    index = 0; __pyx_t_1 = __pyx_t_17(__pyx_t_9); if (unlikely(!__pyx_t_1)) goto __pyx_L24_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    index = 1; __pyx_t_10 = __pyx_t_17(__pyx_t_9); if (unlikely(!__pyx_t_10)) goto __pyx_L24_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_17(__pyx_t_9), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3732, __pyx_L1_error)</span>
    __pyx_t_17 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    goto __pyx_L25_unpacking_done;
    __pyx_L24_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_17 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 3732, __pyx_L1_error)</span>
    __pyx_L25_unpacking_done:;
  }
  __pyx_v_popt = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_v_pcov = __pyx_t_10;
  __pyx_t_10 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3733</span>:     ydata_new = func(xdata, *popt)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(3733,0,<span class='error_goto'>__PYX_ERR(0, 3733, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3733, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xdata);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xdata);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_xdata)) <span class='error_goto'>__PYX_ERR(0, 3733, __pyx_L1_error)</span>;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_popt);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3733, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_2, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3733, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_func, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3733, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ydata_new = __pyx_t_10;
  __pyx_t_10 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3734</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3735</span>:     if show:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3735,0,<span class='error_goto'>__PYX_ERR(0, 3735, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_show); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3735, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3736</span>:         plt.plot(xdata, ydata, 'b-', label='data')</pre>
<pre class='cython code score-32 '>    <span class='trace'>__Pyx_TraceLine</span>(3736,0,<span class='error_goto'>__PYX_ERR(0, 3736, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_plot);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xdata);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xdata);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_v_xdata)) <span class='error_goto'>__PYX_ERR(0, 3736, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ydata);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ydata);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_v_ydata)) <span class='error_goto'>__PYX_ERR(0, 3736, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_b_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_b_2);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_kp_u_b_2)) <span class='error_goto'>__PYX_ERR(0, 3736, __pyx_L1_error)</span>;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_label, __pyx_n_u_data) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3736, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_10, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3736, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3737</span>:         plt.plot(xdata, func(xdata, *popt), 'r-',</pre>
<pre class='cython code score-44 '>    <span class='trace'>__Pyx_TraceLine</span>(3737,0,<span class='error_goto'>__PYX_ERR(0, 3737, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_plot);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xdata);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xdata);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_xdata)) <span class='error_goto'>__PYX_ERR(0, 3737, __pyx_L1_error)</span>;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_popt);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_func, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xdata);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xdata);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_xdata)) <span class='error_goto'>__PYX_ERR(0, 3737, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3737, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_r);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_r);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_r)) <span class='error_goto'>__PYX_ERR(0, 3737, __pyx_L1_error)</span>;
    __pyx_t_10 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3737,0,<span class='error_goto'>__PYX_ERR(0, 3737, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3737, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3738</span>:              label='fit: a=%5.3f, b=%5.3f' % tuple(popt))</pre>
<pre class='cython code score-16 '>    <span class='trace'>__Pyx_TraceLine</span>(3738,0,<span class='error_goto'>__PYX_ERR(0, 3738, __pyx_L1_error)</span>)
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3738, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_popt);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3738, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='py_c_api'>PyUnicode_Format</span>(__pyx_kp_u_fit_a_5_3f_b_5_3f, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3738, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_10, __pyx_n_s_label, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3738, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3739</span>:         plt.xlabel('x')</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(3739,0,<span class='error_goto'>__PYX_ERR(0, 3739, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3739, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_xlabel);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3739, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_n_u_x};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3739, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3740</span>:         plt.ylabel('y')</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(3740,0,<span class='error_goto'>__PYX_ERR(0, 3740, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3740, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ylabel);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3740, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_n_u_y};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3740, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3741</span>:         plt.legend()</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(3741,0,<span class='error_goto'>__PYX_ERR(0, 3741, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_legend);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3741, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_10, NULL};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3741, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3742</span>:         plt.show()</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(3742,0,<span class='error_goto'>__PYX_ERR(0, 3742, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_show);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3742, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3742, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3743</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3744</span>:     return ydata_new, popt, pcov</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(3744,0,<span class='error_goto'>__PYX_ERR(0, 3744, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3744, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ydata_new);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ydata_new);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_ydata_new)) <span class='error_goto'>__PYX_ERR(0, 3744, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_popt);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_popt);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_popt)) <span class='error_goto'>__PYX_ERR(0, 3744, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pcov);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_pcov);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_v_pcov)) <span class='error_goto'>__PYX_ERR(0, 3744, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_8;
  __pyx_t_8 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3745</span>: </pre>
<pre class="cython line score-98" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3746</span>: def detect_station_position (</pre>
<pre class='cython code score-98 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_91detect_station_position(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_90detect_station_position, " Detect station position and return the index in positions\n    \n    :param s: str, int - Station location  in the position array. It should \n        be the positionning of the drilling location. If the value given\n        is type string. It should be match the exact position to \n        locate the drilling. Otherwise, if the value given is in float or \n        integer type, it should be match the index of the position array. \n         \n    :param p: Array-like - Should be the  conductive zone as array of \n        station location values. \n            \n    :returns: \n        - `s_index`- the position index location in the conductive zone.  \n        - `s`- the station position in distance. \n        \n    :Example: \n        \n        &gt;&gt;&gt; import numpy as np \n        &gt;&gt;&gt; from gofast.tools.mathex  import detect_station_position \n        &gt;&gt;&gt; pos = np.arange(0 , 50 , 10 )\n        &gt;&gt;&gt; detect_station_position (s ='S30', p = pos)\n        ... (3, 30.0)\n        &gt;&gt;&gt; detect_station_position (s ='40', p = pos)\n        ... (4, 40.0)\n        &gt;&gt;&gt; detect_station_position (s =2, p = pos)\n        ... (2, 20)\n        &gt;&gt;&gt; detect_station_position (s ='sta200', p = pos)\n        ... WATexError_station: Station sta200             is out of the range; max position = 40\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_91detect_station_position = {"detect_station_position", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_91detect_station_position, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_90detect_station_position};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_91detect_station_position(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_s = 0;
  PyObject *__pyx_v_p = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("detect_station_position (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_s,&amp;__pyx_n_s_p,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3746, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_p)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3746, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("detect_station_position", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 3746, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "detect_station_position") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3746, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_s = values[0];
    __pyx_v_p = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("detect_station_position", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3746, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.detect_station_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_90detect_station_position(__pyx_self, __pyx_v_s, __pyx_v_p);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_90detect_station_position(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_s, PyObject *__pyx_v_p) {
  PyObject *__pyx_v_S = NULL;
  PyObject *__pyx_v_dl = NULL;
  PyObject *__pyx_v_s_index = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__103)
  <span class='trace'>__Pyx_TraceCall</span>("detect_station_position", __pyx_f[0], 3746, 0, <span class='error_goto'>__PYX_ERR(0, 3746, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_s);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_p);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.detect_station_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_S);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dl);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_p);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__211 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_s, __pyx_n_s_p, __pyx_n_s_S, __pyx_n_s_dl, __pyx_n_s_s_index);<span class='error_goto'> if (unlikely(!__pyx_tuple__211)) __PYX_ERR(0, 3746, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__211);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__211);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3746,0,<span class='error_goto'>__PYX_ERR(0, 3746, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3746, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_s, __pyx_kp_s_Union_str_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3746, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_p, __pyx_n_s_SP) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3746, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_return, __pyx_kp_s_Tuple_int_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3746, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_91detect_station_position, 0, __pyx_n_s_detect_station_position, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__103));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3746, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_detect_station_position, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3746, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__103 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__211, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_detect_station_position, 3746, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__103)) __PYX_ERR(0, 3746, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3747</span>:         s : Union[str, int] ,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3748</span>:         p: _SP,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3749</span>: ) -&gt; Tuple [int, float]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3750</span>:     """ Detect station position and return the index in positions</pre>
<pre class="cython line score-0">&#xA0;<span class="">3751</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3752</span>:     :param s: str, int - Station location  in the position array. It should</pre>
<pre class="cython line score-0">&#xA0;<span class="">3753</span>:         be the positionning of the drilling location. If the value given</pre>
<pre class="cython line score-0">&#xA0;<span class="">3754</span>:         is type string. It should be match the exact position to</pre>
<pre class="cython line score-0">&#xA0;<span class="">3755</span>:         locate the drilling. Otherwise, if the value given is in float or</pre>
<pre class="cython line score-0">&#xA0;<span class="">3756</span>:         integer type, it should be match the index of the position array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3757</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3758</span>:     :param p: Array-like - Should be the  conductive zone as array of</pre>
<pre class="cython line score-0">&#xA0;<span class="">3759</span>:         station location values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3760</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3761</span>:     :returns:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3762</span>:         - `s_index`- the position index location in the conductive zone.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3763</span>:         - `s`- the station position in distance.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3764</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3765</span>:     :Example:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3766</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3767</span>:         &gt;&gt;&gt; import numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">3768</span>:         &gt;&gt;&gt; from gofast.tools.mathex  import detect_station_position</pre>
<pre class="cython line score-0">&#xA0;<span class="">3769</span>:         &gt;&gt;&gt; pos = np.arange(0 , 50 , 10 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">3770</span>:         &gt;&gt;&gt; detect_station_position (s ='S30', p = pos)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3771</span>:         ... (3, 30.0)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3772</span>:         &gt;&gt;&gt; detect_station_position (s ='40', p = pos)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3773</span>:         ... (4, 40.0)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3774</span>:         &gt;&gt;&gt; detect_station_position (s =2, p = pos)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3775</span>:         ... (2, 20)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3776</span>:         &gt;&gt;&gt; detect_station_position (s ='sta200', p = pos)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3777</span>:         ... WATexError_station: Station sta200 \</pre>
<pre class="cython line score-0">&#xA0;<span class="">3778</span>:             is out of the range; max position = 40</pre>
<pre class="cython line score-0">&#xA0;<span class="">3779</span>:     """</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3780</span>:     s = _assert_all_types( s, float, int, str)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(3780,0,<span class='error_goto'>__PYX_ERR(0, 3780, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_assert_all_types);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3780, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[5] = {__pyx_t_3, __pyx_v_s, ((PyObject *)(&amp;PyFloat_Type)), ((PyObject *)(&amp;PyInt_Type)), ((PyObject *)(&amp;PyUnicode_Type))};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 4+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3780, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3781</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3782</span>:     p = check_y (p, input_name ="Position array 'p'", to_frame =True )</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(3782,0,<span class='error_goto'>__PYX_ERR(0, 3782, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_check_y);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3782, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3782, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_p);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_p);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_p)) <span class='error_goto'>__PYX_ERR(0, 3782, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3782, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_input_name, __pyx_kp_u_Position_array_p) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3782, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_to_frame, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3782, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3782, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_p, __pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3783</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3784</span>:     S=copy.deepcopy(s)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(3784,0,<span class='error_goto'>__PYX_ERR(0, 3784, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3784, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_deepcopy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3784, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_s};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3784, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_S = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3785</span>:     if isinstance(s, str):</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(3785,0,<span class='error_goto'>__PYX_ERR(0, 3785, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_s); 
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3786</span>:         s =s.lower().replace('s', '').replace('pk', '').replace('ta', '')</pre>
<pre class='cython code score-50 '>    <span class='trace'>__Pyx_TraceLine</span>(3786,0,<span class='error_goto'>__PYX_ERR(0, 3786, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_s, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3786, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_replace);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__104, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_replace);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_tuple__104 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_u_s, __pyx_kp_u__65);<span class='error_goto'> if (unlikely(!__pyx_tuple__104)) __PYX_ERR(0, 3786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__104);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__104);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__105, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_replace);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_tuple__105 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_u_pk, __pyx_kp_u__65);<span class='error_goto'> if (unlikely(!__pyx_tuple__105)) __PYX_ERR(0, 3786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__105);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__105);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__106, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3786, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_5);
    __pyx_t_5 = 0;
  __pyx_tuple__106 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_u_ta, __pyx_kp_u__65);<span class='error_goto'> if (unlikely(!__pyx_tuple__106)) __PYX_ERR(0, 3786, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__106);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__106);
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3787</span>:         try :</pre>
<pre class='cython code score-9 '>    <span class='trace'>__Pyx_TraceLine</span>(3787,0,<span class='error_goto'>__PYX_ERR(0, 3787, __pyx_L1_error)</span>)
    {
      /*try:*/ {
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      goto __pyx_L9_try_end;
      __pyx_L4_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
      __pyx_L6_except_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
      goto __pyx_L1_error;
      __pyx_L9_try_end:;
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3788</span>:             s=int(s)</pre>
<pre class='cython code score-3 '>        <span class='trace'>__Pyx_TraceLine</span>(3788,0,<span class='error_goto'>__PYX_ERR(0, 3788, __pyx_L4_error)</span>)
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3788, __pyx_L4_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_5);
        __pyx_t_5 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3789</span>:         except :</pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(3789,0,<span class='error_goto'>__PYX_ERR(0, 3789, __pyx_L6_except_error)</span>)
      /*except:*/ {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.detect_station_position", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_5, &amp;__pyx_t_2, &amp;__pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3789, __pyx_L6_except_error)</span>
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3790</span>:             raise ValueError (f'could not convert string to float: {S}')</pre>
<pre class='cython code score-11 '>        <span class='trace'>__Pyx_TraceLine</span>(3790,0,<span class='error_goto'>__PYX_ERR(0, 3790, __pyx_L6_except_error)</span>)
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_S, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3790, __pyx_L6_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_could_not_convert_string_to_floa, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3790, __pyx_L6_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3790, __pyx_L6_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='error_goto'>__PYX_ERR(0, 3790, __pyx_L6_except_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">3791</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3792</span>:     p = np.array(p, dtype = np.int32)</pre>
<pre class='cython code score-32 '>  <span class='trace'>__Pyx_TraceLine</span>(3792,0,<span class='error_goto'>__PYX_ERR(0, 3792, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_p);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_p);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_p)) <span class='error_goto'>__PYX_ERR(0, 3792, __pyx_L1_error)</span>;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3792, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3792, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_p, __pyx_t_10);
  __pyx_t_10 = 0;
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3793</span>:     dl = (p.max() - p.min() ) / (len(p) -1)</pre>
<pre class='cython code score-53 '>  <span class='trace'>__Pyx_TraceLine</span>(3793,0,<span class='error_goto'>__PYX_ERR(0, 3793, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_p, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3793, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_p, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3793, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_10, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_11 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_p);<span class='error_goto'> if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3793, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_t_11 - 1));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3793, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_dl = __pyx_t_10;
  __pyx_t_10 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3794</span>:     if isinstance(s, (int, float)):</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(3794,0,<span class='error_goto'>__PYX_ERR(0, 3794, __pyx_L1_error)</span>)
  __pyx_t_12 = <span class='py_c_api'>PyInt_Check</span>(__pyx_v_s); 
  if (!__pyx_t_12) {
  } else {
    __pyx_t_6 = __pyx_t_12;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_12 = <span class='py_c_api'>PyFloat_Check</span>(__pyx_v_s); 
  __pyx_t_6 = __pyx_t_12;
  __pyx_L13_bool_binop_done:;
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3795</span>:         if s &gt; len(p): # consider this as the dipole length position:</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(3795,0,<span class='error_goto'>__PYX_ERR(0, 3795, __pyx_L1_error)</span>)
    __pyx_t_11 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_p);<span class='error_goto'> if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3795, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3795, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_s, __pyx_t_10, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3795, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3795, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_6) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3796</span>:             # now let check whether the given value is module of the station</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3797</span>:             if s % dl !=0 :</pre>
<pre class='cython code score-8 '>      <span class='trace'>__Pyx_TraceLine</span>(3797,0,<span class='error_goto'>__PYX_ERR(0, 3797, __pyx_L1_error)</span>)
      __pyx_t_5 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_v_s, __pyx_v_dl);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3797, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolNeObjC</span>(__pyx_t_5, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3797, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(__pyx_t_6)) {
/* … */
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3798</span>:                 raise SiteError  (</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(3798,0,<span class='error_goto'>__PYX_ERR(0, 3798, __pyx_L1_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_SiteError);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3798, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3799</span>:                     f'Unable to detect the station position {S}')</pre>
<pre class='cython code score-23 '>        <span class='trace'>__Pyx_TraceLine</span>(3799,0,<span class='error_goto'>__PYX_ERR(0, 3799, __pyx_L1_error)</span>)
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_S, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3799, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_Unable_to_detect_the_station_pos, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3799, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_3 = NULL;
        __pyx_t_4 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
          __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
          if (likely(__pyx_t_3)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
            __pyx_t_4 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_2};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3798, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        }
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='error_goto'>__PYX_ERR(0, 3798, __pyx_L1_error)</span>
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3800</span>:             elif s % dl == 0 and s &lt;= p.max():</pre>
<pre class='cython code score-33 '>      <span class='trace'>__Pyx_TraceLine</span>(3800,0,<span class='error_goto'>__PYX_ERR(0, 3800, __pyx_L1_error)</span>)
      __pyx_t_5 = <span class='py_c_api'>PyNumber_Remainder</span>(__pyx_v_s, __pyx_v_dl);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3800, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_5, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_12 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3800, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (__pyx_t_12) {
      } else {
        __pyx_t_6 = __pyx_t_12;
        goto __pyx_L17_bool_binop_done;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_p, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3800, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_2 = NULL;
      __pyx_t_4 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
        __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
        if (likely(__pyx_t_2)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
          __pyx_t_4 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3800, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      }
      __pyx_t_10 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_s, __pyx_t_5, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3800, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_10); if (unlikely((__pyx_t_12 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3800, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_6 = __pyx_t_12;
      __pyx_L17_bool_binop_done:;
      if (likely(__pyx_t_6)) {
/* … */
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">3801</span>:                 # take the index</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3802</span>:                 s_index = s//dl</pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(3802,0,<span class='error_goto'>__PYX_ERR(0, 3802, __pyx_L1_error)</span>)
        __pyx_t_10 = <span class='py_c_api'>PyNumber_FloorDivide</span>(__pyx_v_s, __pyx_v_dl);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3802, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_v_s_index = __pyx_t_10;
        __pyx_t_10 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3803</span>:                 return int(s_index), s_index * dl</pre>
<pre class='cython code score-17 '>        <span class='trace'>__Pyx_TraceLine</span>(3803,0,<span class='error_goto'>__PYX_ERR(0, 3803, __pyx_L1_error)</span>)
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3803, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_s_index, __pyx_v_dl);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3803, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3803, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
        if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 3803, __pyx_L1_error)</span>;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3803, __pyx_L1_error)</span>;
        __pyx_t_10 = 0;
        __pyx_t_5 = 0;
        __pyx_r = __pyx_t_2;
        __pyx_t_2 = 0;
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3804</span>:             else :</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3805</span>:                 raise SiteError (</pre>
<pre class='cython code score-2 '>      <span class='trace'>__Pyx_TraceLine</span>(3805,0,<span class='error_goto'>__PYX_ERR(0, 3805, __pyx_L1_error)</span>)
      /*else*/ {
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_SiteError);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3805, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3806</span>:                     f'Station {S} is out of the range; max position = {max(p)}'</pre>
<pre class='cython code score-51 '>        <span class='trace'>__Pyx_TraceLine</span>(3806,0,<span class='error_goto'>__PYX_ERR(0, 3806, __pyx_L1_error)</span>)
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3806, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_11 = 0;
        __pyx_t_13 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Station);
        __pyx_t_11 += 8;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Station);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_kp_u_Station);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_S, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3806, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_13) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_13;
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_3);
        __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_is_out_of_the_range_max_positio);
        __pyx_t_11 += 37;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_is_out_of_the_range_max_positio);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_kp_u_is_out_of_the_range_max_positio);
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_max, __pyx_v_p);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3806, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_3, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3806, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_13) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_13;
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 3, __pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_10, 4, __pyx_t_11, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3806, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = NULL;
        __pyx_t_4 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
          __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
          if (likely(__pyx_t_10)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
            __pyx_t_4 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_1};
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3805, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        }
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='error_goto'>__PYX_ERR(0, 3805, __pyx_L1_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">3807</span>:                 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">3808</span>:         else :</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3809</span>:             if s &gt;= len(p):</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(3809,0,<span class='error_goto'>__PYX_ERR(0, 3809, __pyx_L1_error)</span>)
    /*else*/ {
      __pyx_t_11 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_p);<span class='error_goto'> if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3809, __pyx_L1_error)</span>
      __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3809, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_s, __pyx_t_2, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3809, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3809, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(__pyx_t_6)) {
/* … */
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3810</span>:                 raise SiteError (</pre>
<pre class='cython code score-2 '>        <span class='trace'>__Pyx_TraceLine</span>(3810,0,<span class='error_goto'>__PYX_ERR(0, 3810, __pyx_L1_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_SiteError);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3810, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3811</span>:                     'Location index must be less than the number of'</pre>
<pre class='cython code score-28 '>        <span class='trace'>__Pyx_TraceLine</span>(3811,0,<span class='error_goto'>__PYX_ERR(0, 3811, __pyx_L1_error)</span>)
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3811, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_11 = 0;
        __pyx_t_13 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Location_index_must_be_less_than);
        __pyx_t_11 += 58;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Location_index_must_be_less_than);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_Location_index_must_be_less_than);
/* … */
        <span class='trace'>__Pyx_TraceLine</span>(3811,0,<span class='error_goto'>__PYX_ERR(0, 3811, __pyx_L1_error)</span>)
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 5, __pyx_t_11, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3811, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        __pyx_t_1 = NULL;
        __pyx_t_4 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
          __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
          if (likely(__pyx_t_1)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
            __pyx_t_4 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_10};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3810, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        }
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='error_goto'>__PYX_ERR(0, 3810, __pyx_L1_error)</span>
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3812</span>:                     f' stations = {len(p)}. {s} is gotten.')</pre>
<pre class='cython code score-23 '>        <span class='trace'>__Pyx_TraceLine</span>(3812,0,<span class='error_goto'>__PYX_ERR(0, 3812, __pyx_L1_error)</span>)
        __pyx_t_14 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_p);<span class='error_goto'> if (unlikely(__pyx_t_14 == ((Py_ssize_t)-1))) __PYX_ERR(0, 3812, __pyx_L1_error)</span>
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_t_14, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3812, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_10);
        __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__107);
        __pyx_t_11 += 2;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__107);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u__107);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_s, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3812, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_10) &gt; __pyx_t_13) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_10) : __pyx_t_13;
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_10);
        __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_is_gotten);
        __pyx_t_11 += 11;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_is_gotten);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_kp_u_is_gotten);
</pre><pre class="cython line score-0">&#xA0;<span class="">3813</span>:             # consider it as integer index</pre>
<pre class="cython line score-0">&#xA0;<span class="">3814</span>:             # erase the last variable</pre>
<pre class="cython line score-0">&#xA0;<span class="">3815</span>:             # s_index = s</pre>
<pre class="cython line score-0">&#xA0;<span class="">3816</span>:             # s = S * dl   # find</pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3817</span>:             return s , p[s ]</pre>
<pre class='cython code score-13 '>      <span class='trace'>__Pyx_TraceLine</span>(3817,0,<span class='error_goto'>__PYX_ERR(0, 3817, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_p, __pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3817, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3817, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_s);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_s);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_s)) <span class='error_goto'>__PYX_ERR(0, 3817, __pyx_L1_error)</span>;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 3817, __pyx_L1_error)</span>;
      __pyx_t_5 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3818</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3819</span>:     # check whether the s value is in the p</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3820</span>:     if True in np.isin (p, s):</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(3820,0,<span class='error_goto'>__PYX_ERR(0, 3820, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3820, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_isin);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3820, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_v_p, __pyx_v_s};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_4, 2+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3820, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  }
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(Py_True, __pyx_t_2, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3820, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-67" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3821</span>:         s_index ,  = np.where (p ==s )</pre>
<pre class='cython code score-67 '>    <span class='trace'>__Pyx_TraceLine</span>(3821,0,<span class='error_goto'>__PYX_ERR(0, 3821, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_10, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3821, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_10, __pyx_n_s_where);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3821, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_10 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_p, __pyx_v_s, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3821, __pyx_L1_error)</span>
    __pyx_t_1 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_10};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3821, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 1)) {
        if (size &gt; 1) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(1);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 3821, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      } else {
        __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      #else
      __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3821, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 3821, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_10);
      index = 0; __pyx_t_5 = __pyx_t_15(__pyx_t_10); if (unlikely(!__pyx_t_5)) goto __pyx_L21_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_15(__pyx_t_10), 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3821, __pyx_L1_error)</span>
      __pyx_t_15 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      goto __pyx_L22_unpacking_done;
      __pyx_L21_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_t_15 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 3821, __pyx_L1_error)</span>
      __pyx_L22_unpacking_done:;
    }
    __pyx_v_s_index = __pyx_t_5;
    __pyx_t_5 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3822</span>:         s = p [s_index]</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(3822,0,<span class='error_goto'>__PYX_ERR(0, 3822, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_p, __pyx_v_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3822, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3823</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3824</span>:     return int(s_index) , s</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(3824,0,<span class='error_goto'>__PYX_ERR(0, 3824, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_s_index)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("s_index"); <span class='error_goto'>__PYX_ERR(0, 3824, __pyx_L1_error)</span> }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3824, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 3824, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3824, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_s);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_s);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_s)) <span class='error_goto'>__PYX_ERR(0, 3824, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3825</span>: </pre>
<pre class="cython line score-121" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3826</span>: def _manage_colors (c, default = ['ok', 'ob-', 'r-']):</pre>
<pre class='cython code score-121 '>static PyObject *__pyx_pf_6gofast_5tools_6mathex_138__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("__defaults__", __pyx_f[0], 3826, 0, <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self)-&gt;__pyx_arg_default);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self)-&gt;__pyx_arg_default);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self)-&gt;__pyx_arg_default)) <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_93_manage_colors(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_92_manage_colors, " Manage the ohmic-area plot colors ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_93_manage_colors = {"_manage_colors", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_93_manage_colors, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_92_manage_colors};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_93_manage_colors(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_c = 0;
  PyObject *__pyx_v_default = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_manage_colors (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_c,&amp;__pyx_n_s_default,0};
  PyObject* values[2] = {0,0};
    __pyx_defaults2 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_self);
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_default);
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_c)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_default);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_manage_colors") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_c = values[0];
    __pyx_v_default = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_manage_colors", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._manage_colors", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_92_manage_colors(__pyx_self, __pyx_v_c, __pyx_v_default);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_92_manage_colors(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_c, PyObject *__pyx_v_default) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__108)
  <span class='trace'>__Pyx_TraceCall</span>("_manage_colors", __pyx_f[0], 3826, 0, <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_c);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._manage_colors", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_c);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__212 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_c, __pyx_n_s_default);<span class='error_goto'> if (unlikely(!__pyx_tuple__212)) __PYX_ERR(0, 3826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__212);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__212);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3826,0,<span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_93_manage_colors, 0, __pyx_n_s_manage_colors, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__108));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_3, sizeof(__pyx_defaults2), 1)) <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_ok_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_ok_2);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_n_u_ok_2)) <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_ob);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_ob);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 1, __pyx_kp_u_ob)) <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_r);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_r);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 2, __pyx_kp_u_r)) <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L1_error)</span>;
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults2, __pyx_t_3)-&gt;__pyx_arg_default = __pyx_t_4;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_3, __pyx_pf_6gofast_5tools_6mathex_138__defaults__);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_manage_colors, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3826, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__108 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__212, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_manage_colors, 3826, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__108)) __PYX_ERR(0, 3826, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3827</span>:     """ Manage the ohmic-area plot colors """</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3828</span>:     c = c or default</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(3828,0,<span class='error_goto'>__PYX_ERR(0, 3828, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_c); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3828, __pyx_L1_error)</span>
  if (!__pyx_t_2) {
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_c);
    __pyx_t_1 = __pyx_v_c;
    goto __pyx_L3_bool_binop_done;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_default);
  __pyx_t_1 = __pyx_v_default;
  __pyx_L3_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_c, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3829</span>:     if isinstance(c, str):</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(3829,0,<span class='error_goto'>__PYX_ERR(0, 3829, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_c); 
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3830</span>:         c= [c]</pre>
<pre class='cython code score-9 '>    <span class='trace'>__Pyx_TraceLine</span>(3830,0,<span class='error_goto'>__PYX_ERR(0, 3830, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3830, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_c);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_c);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_c)) <span class='error_goto'>__PYX_ERR(0, 3830, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_c, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3831</span>:     c = list(c) +  default</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(3831,0,<span class='error_goto'>__PYX_ERR(0, 3831, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PySequence_List</span>(__pyx_v_c);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3831, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_v_default);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3831, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_c, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3832</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3833</span>:     return c [:3] # return 3colors</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(3833,0,<span class='error_goto'>__PYX_ERR(0, 3833, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_c, 0, 3, NULL, NULL, &amp;__pyx_slice__109, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
/* … */
  __pyx_slice__109 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_3, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__109)) __PYX_ERR(0, 3833, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__109);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__109);
</pre><pre class="cython line score-0">&#xA0;<span class="">3834</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3835</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3836</span>: </pre>
<pre class="cython line score-136" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3837</span>: def convert_distance_to_m(</pre>
<pre class='cython code score-136 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_95convert_distance_to_m(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_94convert_distance_to_m, " Convert distance from `km` to `m` or vice versa even a string \n    value is given.\n    \n    :param value: value to convert. \n    :paramm converter: Equivalent if given in ``km`` rather than ``m``.\n    :param unit: unit to convert to.\n    \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_95convert_distance_to_m = {"convert_distance_to_m", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_95convert_distance_to_m, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_94convert_distance_to_m};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_95convert_distance_to_m(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_value = 0;
  double __pyx_v_converter;
  PyObject *__pyx_v_unit = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("convert_distance_to_m (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_value,&amp;__pyx_n_s_converter,&amp;__pyx_n_s_unit,0};
  PyObject* values[3] = {0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_km)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_value)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_converter);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_unit);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "convert_distance_to_m") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_value = values[0];
    if (values[1]) {
      __pyx_v_converter = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_converter == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3839, __pyx_L3_error)</span>
    } else {
      __pyx_v_converter = ((double)((double)1e3));
    }
    __pyx_v_unit = ((PyObject*)values[2]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("convert_distance_to_m", 0, 1, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.convert_distance_to_m", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_unit), (&amp;PyUnicode_Type), 0, "unit", 1))) <span class='error_goto'>__PYX_ERR(0, 3840, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_94convert_distance_to_m(__pyx_self, __pyx_v_value, __pyx_v_converter, __pyx_v_unit);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_94convert_distance_to_m(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_value, double __pyx_v_converter, PyObject *__pyx_v_unit) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__110)
  <span class='trace'>__Pyx_TraceCall</span>("convert_distance_to_m", __pyx_f[0], 3837, 0, <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.convert_distance_to_m", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__213 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_value, __pyx_n_s_converter, __pyx_n_s_unit);<span class='error_goto'> if (unlikely(!__pyx_tuple__213)) __PYX_ERR(0, 3837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__213);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__213);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3837,0,<span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_km));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_km));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, ((PyObject*)__pyx_n_u_km))) <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_value, __pyx_n_s_T) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_converter, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_unit, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_return, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_95convert_distance_to_m, 0, __pyx_n_s_convert_distance_to_m, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__110));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3837, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_convert_distance_to_m, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3837, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__110 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__213, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_convert_distance_to_m, 3837, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__110)) __PYX_ERR(0, 3837, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3838</span>:         value:_T ,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3839</span>:         converter:float =1e3,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(3839,0,<span class='error_goto'>__PYX_ERR(0, 3839, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)1e3));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3839, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-0">&#xA0;<span class="">3840</span>:         unit:str ='km'</pre>
<pre class="cython line score-0">&#xA0;<span class="">3841</span>: )-&gt; float:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3842</span>:     """ Convert distance from `km` to `m` or vice versa even a string</pre>
<pre class="cython line score-0">&#xA0;<span class="">3843</span>:     value is given.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3844</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3845</span>:     :param value: value to convert.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3846</span>:     :paramm converter: Equivalent if given in ``km`` rather than ``m``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3847</span>:     :param unit: unit to convert to.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3848</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3849</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">3850</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3851</span>:     if isinstance(value, str):</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(3851,0,<span class='error_goto'>__PYX_ERR(0, 3851, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyUnicode_Check</span>(__pyx_v_value); 
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3852</span>:         try:</pre>
<pre class='cython code score-9 '>    <span class='trace'>__Pyx_TraceLine</span>(3852,0,<span class='error_goto'>__PYX_ERR(0, 3852, __pyx_L1_error)</span>)
    {
      /*try:*/ {
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L9_try_end;
      __pyx_L4_error:;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
      __pyx_L6_except_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);
      goto __pyx_L1_error;
      __pyx_L9_try_end:;
    }
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3853</span>:             value = float(value.replace(unit, '')</pre>
<pre class='cython code score-24 '>          <span class='trace'>__Pyx_TraceLine</span>(3853,0,<span class='error_goto'>__PYX_ERR(0, 3853, __pyx_L4_error)</span>)
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_value, __pyx_n_s_replace);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3853, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          __pyx_t_8 = NULL;
          __pyx_t_9 = 0;
          #if CYTHON_UNPACK_METHODS
          if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
            __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
            if (likely(__pyx_t_8)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
              __pyx_t_9 = 1;
            }
          }
          #endif
          {
            PyObject *__pyx_callargs[3] = {__pyx_t_8, __pyx_v_unit, __pyx_kp_u__65};
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_9, 2+__pyx_t_9);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 3853, __pyx_L4_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          }
          __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_AsDouble</span>(__pyx_t_7); if (unlikely(__pyx_t_10 == ((double)((double)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3853, __pyx_L4_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3854</span>:                               )*converter if value.find(</pre>
<pre class='cython code score-27 '>        <span class='trace'>__Pyx_TraceLine</span>(3854,0,<span class='error_goto'>__PYX_ERR(0, 3854, __pyx_L4_error)</span>)
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_value, __pyx_n_s_find);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3854, __pyx_L4_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_8 = NULL;
        __pyx_t_9 = 0;
        #if CYTHON_UNPACK_METHODS
        if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
          __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
          if (likely(__pyx_t_8)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
            __pyx_t_9 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_n_u_km};
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_9, 1+__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 3854, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        }
        __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_int_0, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3855, __pyx_L4_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
/* … */
          <span class='trace'>__Pyx_TraceLine</span>(3854,0,<span class='error_goto'>__PYX_ERR(0, 3854, __pyx_L4_error)</span>)
          __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_10 * __pyx_v_converter));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3854, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          __pyx_t_5 = __pyx_t_7;
          __pyx_t_7 = 0;
        } else {
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3855</span>:                 'km')&gt;=0 else float(value.replace('m', ''))</pre>
<pre class='cython code score-17 '>        <span class='trace'>__Pyx_TraceLine</span>(3855,0,<span class='error_goto'>__PYX_ERR(0, 3855, __pyx_L4_error)</span>)
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3855, __pyx_L4_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (__pyx_t_1) {
/* … */
          <span class='trace'>__Pyx_TraceLine</span>(3855,0,<span class='error_goto'>__PYX_ERR(0, 3855, __pyx_L4_error)</span>)
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_value, __pyx_n_s_replace);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3855, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_tuple__111, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 3855, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyNumber_Float</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3855, __pyx_L4_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          __pyx_t_5 = __pyx_t_7;
          __pyx_t_7 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_value, __pyx_t_5);
        __pyx_t_5 = 0;
/* … */
  __pyx_tuple__111 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_u_m, __pyx_kp_u__65);<span class='error_goto'> if (unlikely(!__pyx_tuple__111)) __PYX_ERR(0, 3855, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__111);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__111);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3856</span>:         except:</pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(3856,0,<span class='error_goto'>__PYX_ERR(0, 3856, __pyx_L6_except_error)</span>)
      /*except:*/ {
        <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.convert_distance_to_m", __pyx_clineno, __pyx_lineno, __pyx_filename);
        if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_5, &amp;__pyx_t_7, &amp;__pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3856, __pyx_L6_except_error)</span>
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);
        <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3857</span>:             raise TypeError(f"Expected float not {type(value)!r}."</pre>
<pre class='cython code score-32 '>        <span class='trace'>__Pyx_TraceLine</span>(3857,0,<span class='error_goto'>__PYX_ERR(0, 3857, __pyx_L6_except_error)</span>)
        __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3857, __pyx_L6_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_11 = 0;
        __pyx_t_12 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Expected_float_not);
        __pyx_t_11 += 19;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Expected_float_not);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_kp_u_Expected_float_not);
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Repr</span>(((PyObject *)Py_TYPE(__pyx_v_value))), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 3857, __pyx_L6_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_13) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_13) : __pyx_t_12;
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_13);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_13);
        __pyx_t_13 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__39);
        __pyx_t_11 += 1;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__39);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_kp_u__39);
        __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_8, 3, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 3857, __pyx_L6_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3857, __pyx_L6_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='error_goto'>__PYX_ERR(0, 3857, __pyx_L6_except_error)</span>
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">3858</span>:                )</pre>
<pre class="cython line score-0">&#xA0;<span class="">3859</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3860</span>:     return value</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3860,0,<span class='error_goto'>__PYX_ERR(0, 3860, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  __pyx_r = __pyx_v_value;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3861</span>: </pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3862</span>: def get_station_number (</pre>
<pre class='cython code score-65 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_97get_station_number(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_96get_station_number, " Get the station number from dipole length and \n    the distance to the station.\n    \n    :param distance: Is the distance from the first station to `s` in \n        meter (m). If value is given, please specify the dipole length in \n        the same unit as `distance`.\n    :param dipole: Is the distance of the dipole measurement. \n        By default the dipole length is in meter.\n    :param kws: :func:`convert_distance_to_m` additional arguments\n    \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_97get_station_number = {"get_station_number", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_97get_station_number, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_96get_station_number};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_97get_station_number(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  double __pyx_v_dipole;
  double __pyx_v_distance;
  PyObject *__pyx_v_from0 = 0;
  PyObject *__pyx_v_kws = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_station_number (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kws = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kws)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kws);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dipole,&amp;__pyx_n_s_distance,&amp;__pyx_n_s_from0,0};
  PyObject* values[3] = {0,0,0};
/* … */
  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kws);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_96get_station_number(CYTHON_UNUSED PyObject *__pyx_self, double __pyx_v_dipole, double __pyx_v_distance, PyObject *__pyx_v_from0, PyObject *__pyx_v_kws) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__112)
  <span class='trace'>__Pyx_TraceCall</span>("get_station_number", __pyx_f[0], 3862, 0, <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_station_number", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__214 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_dipole, __pyx_n_s_distance, __pyx_n_s_from0, __pyx_n_s_kws);<span class='error_goto'> if (unlikely(!__pyx_tuple__214)) __PYX_ERR(0, 3862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__214);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__214);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3862,0,<span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dipole, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_distance, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_from0, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_97get_station_number, 0, __pyx_n_s_get_station_number, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__112));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3862, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_3, __pyx_tuple__196);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_station_number, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__112 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__214, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_get_station_number, 3862, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__112)) __PYX_ERR(0, 3862, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">3863</span>:         dipole:float,</pre>
<pre class="cython line score-0">&#xA0;<span class="">3864</span>:         distance:float ,</pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3865</span>:         from0:bool = False,</pre>
<pre class='cython code score-74 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_dipole)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_distance)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_station_number", 0, 2, 3, 1); <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_from0);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kws, values + 0, kwd_pos_args, "get_station_number") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_dipole = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[0]); if (unlikely((__pyx_v_dipole == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3863, __pyx_L3_error)</span>
    __pyx_v_distance = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_distance == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3864, __pyx_L3_error)</span>
    __pyx_v_from0 = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_station_number", 0, 2, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3862, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kws); __pyx_v_kws = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_station_number", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_96get_station_number(__pyx_self, __pyx_v_dipole, __pyx_v_distance, __pyx_v_from0, __pyx_v_kws);
</pre><pre class="cython line score-0">&#xA0;<span class="">3866</span>:         **kws</pre>
<pre class="cython line score-0">&#xA0;<span class="">3867</span>: )-&gt; float:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3868</span>:     """ Get the station number from dipole length and</pre>
<pre class="cython line score-0">&#xA0;<span class="">3869</span>:     the distance to the station.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3870</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3871</span>:     :param distance: Is the distance from the first station to `s` in</pre>
<pre class="cython line score-0">&#xA0;<span class="">3872</span>:         meter (m). If value is given, please specify the dipole length in</pre>
<pre class="cython line score-0">&#xA0;<span class="">3873</span>:         the same unit as `distance`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3874</span>:     :param dipole: Is the distance of the dipole measurement.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3875</span>:         By default the dipole length is in meter.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3876</span>:     :param kws: :func:`convert_distance_to_m` additional arguments</pre>
<pre class="cython line score-0">&#xA0;<span class="">3877</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3878</span>:     """</pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3879</span>:     dipole=convert_distance_to_m(dipole, **kws)</pre>
<pre class='cython code score-35 '>  <span class='trace'>__Pyx_TraceLine</span>(3879,0,<span class='error_goto'>__PYX_ERR(0, 3879, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_convert_distance_to_m);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3879, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dipole);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3879, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3879, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3879, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kws);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3879, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3879, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3879, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_dipole = __pyx_t_5;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3880</span>:     distance =convert_distance_to_m(distance, **kws)</pre>
<pre class='cython code score-35 '>  <span class='trace'>__Pyx_TraceLine</span>(3880,0,<span class='error_goto'>__PYX_ERR(0, 3880, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_convert_distance_to_m);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 3880, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_distance);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3880, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3880, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 3880, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kws);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3880, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 3880, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3880, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_distance = __pyx_t_5;
</pre><pre class="cython line score-0">&#xA0;<span class="">3881</span>: </pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3882</span>:     return  distance/dipole  if from0 else distance/dipole + 1</pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(3882,0,<span class='error_goto'>__PYX_ERR(0, 3882, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_from0); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3882, __pyx_L1_error)</span>
  if (__pyx_t_6) {
    if (unlikely(__pyx_v_dipole == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 3882, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_distance / __pyx_v_dipole));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3882, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = __pyx_t_2;
    __pyx_t_2 = 0;
  } else {
    if (unlikely(__pyx_v_dipole == 0)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      <span class='error_goto'>__PYX_ERR(0, 3882, __pyx_L1_error)</span>
    }
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_distance / __pyx_v_dipole) + 1.0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3882, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = __pyx_t_2;
    __pyx_t_2 = 0;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3883</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3884</span>: #FR0: #CED9EF # (206, 217, 239)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3885</span>: #FR1: #9EB3DD # (158, 179, 221)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3886</span>: #FR2: #3B70F2 # (59, 112, 242) #repl rgb(52, 54, 99)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3887</span>: #FR3: #0A4CEE # (10, 76, 238)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3888</span>: </pre>
<pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3889</span>: def get_profile_angle (</pre>
<pre class='cython code score-71 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_99get_profile_angle(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_98get_profile_angle, "\n    compute geoprofile angle. \n    Parameters \n    -----------\n    * easting : array_like \n            easting coordiantes values \n    * northing : array_like \n            northing coordinates values\n    * msg: output a little message if msg is set to \"raises\"\n    \n    Returns \n    ---------\n    float\n         profile_angle \n    float \n        geo_electric_strike \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_99get_profile_angle = {"get_profile_angle", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_99get_profile_angle, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_98get_profile_angle};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_99get_profile_angle(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_easting = 0;
  PyObject *__pyx_v_northing = 0;
  PyObject *__pyx_v_msg = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_profile_angle (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_easting,&amp;__pyx_n_s_northing,&amp;__pyx_n_s_msg,0};
  PyObject* values[3] = {0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_98get_profile_angle(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_easting, PyObject *__pyx_v_northing, PyObject *__pyx_v_msg) {
  PyObject *__pyx_v_profile1 = NULL;
  PyObject *__pyx_v_profile2 = NULL;
  PyObject *__pyx_v_profile_line = NULL;
  PyObject *__pyx_v_profile_angle = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__113)
  <span class='trace'>__Pyx_TraceCall</span>("get_profile_angle", __pyx_f[0], 3889, 0, <span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_easting);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_northing);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_msg);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_profile_angle", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_profile1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_profile2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_profile_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_profile_angle);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_easting);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_northing);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_msg);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__215 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_easting, __pyx_n_s_northing, __pyx_n_s_msg, __pyx_n_s_profile1, __pyx_n_s_profile2, __pyx_n_s_profile_line, __pyx_n_s_profile_angle);<span class='error_goto'> if (unlikely(!__pyx_tuple__215)) __PYX_ERR(0, 3889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__215);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__215);
  __pyx_codeobj__113 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__215, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_get_profile_angle, 3889, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__113)) __PYX_ERR(0, 3889, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3889,0,<span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_easting, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_northing, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_msg, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_99get_profile_angle, 0, __pyx_n_s_get_profile_angle, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__113));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__216);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_profile_angle, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__216 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, ((PyObject*)__pyx_n_u_ignore));<span class='error_goto'> if (unlikely(!__pyx_tuple__216)) __PYX_ERR(0, 3889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__216);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__216);
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3890</span>:         easting: float =None, northing: float =None, msg:str ="ignore" ):</pre>
<pre class='cython code score-61 '>    values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)Py_None));
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)Py_None));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_ignore)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_easting);
          if (value) { values[0] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_northing);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_msg);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "get_profile_angle") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_easting = ((PyObject*)values[0]);
    __pyx_v_northing = ((PyObject*)values[1]);
    __pyx_v_msg = ((PyObject*)values[2]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_profile_angle", 0, 0, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3889, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_profile_angle", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_easting), (&amp;PyFloat_Type), 1, "easting", 1))) <span class='error_goto'>__PYX_ERR(0, 3890, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_northing), (&amp;PyFloat_Type), 1, "northing", 1))) <span class='error_goto'>__PYX_ERR(0, 3890, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_msg), (&amp;PyUnicode_Type), 0, "msg", 1))) <span class='error_goto'>__PYX_ERR(0, 3890, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_98get_profile_angle(__pyx_self, __pyx_v_easting, __pyx_v_northing, __pyx_v_msg);
</pre><pre class="cython line score-0">&#xA0;<span class="">3891</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">3892</span>:     compute geoprofile angle.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3893</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">3894</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3895</span>:     * easting : array_like</pre>
<pre class="cython line score-0">&#xA0;<span class="">3896</span>:             easting coordiantes values</pre>
<pre class="cython line score-0">&#xA0;<span class="">3897</span>:     * northing : array_like</pre>
<pre class="cython line score-0">&#xA0;<span class="">3898</span>:             northing coordinates values</pre>
<pre class="cython line score-0">&#xA0;<span class="">3899</span>:     * msg: output a little message if msg is set to "raises"</pre>
<pre class="cython line score-0">&#xA0;<span class="">3900</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3901</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3902</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3903</span>:     float</pre>
<pre class="cython line score-0">&#xA0;<span class="">3904</span>:          profile_angle</pre>
<pre class="cython line score-0">&#xA0;<span class="">3905</span>:     float</pre>
<pre class="cython line score-0">&#xA0;<span class="">3906</span>:         geo_electric_strike</pre>
<pre class="cython line score-0">&#xA0;<span class="">3907</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">3908</span>:     msg = (</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3909</span>:         "Need to import scipy.stats as a single module. Sometimes import scipy "</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3909,0,<span class='error_goto'>__PYX_ERR(0, 3909, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Need_to_import_scipy_stats_as_a);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_msg, __pyx_kp_u_Need_to_import_scipy_stats_as_a);
</pre><pre class="cython line score-0">&#xA0;<span class="">3910</span>:         "differently  with stats may not work. Use either `import scipy.stats`"</pre>
<pre class="cython line score-0">&#xA0;<span class="">3911</span>:         " rather than `import scipy as sp`"</pre>
<pre class="cython line score-0">&#xA0;<span class="">3912</span>:         )</pre>
<pre class="cython line score-0">&#xA0;<span class="">3913</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3914</span>:     if easting is None or northing is None :</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(3914,0,<span class='error_goto'>__PYX_ERR(0, 3914, __pyx_L1_error)</span>)
  __pyx_t_2 = (__pyx_v_easting == ((PyObject*)Py_None));
  if (!__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = (__pyx_v_northing == ((PyObject*)Py_None));
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (unlikely(__pyx_t_1)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3915</span>:         raise TypeError('NoneType can not be computed !')</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(3915,0,<span class='error_goto'>__PYX_ERR(0, 3915, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__114, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3915, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 3915, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__114 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_NoneType_can_not_be_computed);<span class='error_goto'> if (unlikely(!__pyx_tuple__114)) __PYX_ERR(0, 3915, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__114);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__114);
</pre><pre class="cython line score-0">&#xA0;<span class="">3916</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3917</span>:         # use the one with the lower standard deviation</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3918</span>:     try :</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(3918,0,<span class='error_goto'>__PYX_ERR(0, 3918, __pyx_L1_error)</span>)
  {
    /*try:*/ {
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L11_try_end;
    __pyx_L6_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
/* … */
    __pyx_L8_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_4, __pyx_t_5, __pyx_t_6);
    goto __pyx_L1_error;
    __pyx_L11_try_end:;
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3919</span>:         easting = easting.astype('float')</pre>
<pre class='cython code score-8 '>      <span class='trace'>__Pyx_TraceLine</span>(3919,0,<span class='error_goto'>__PYX_ERR(0, 3919, __pyx_L6_error)</span>)
      __pyx_t_3 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PyFloat_Type_astype, __pyx_v_easting, __pyx_n_u_float);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3919, __pyx_L6_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (!(likely(<span class='py_c_api'>PyFloat_CheckExact</span>(__pyx_t_3))||((__pyx_t_3) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("float", __pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 3919, __pyx_L6_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_easting, ((PyObject*)__pyx_t_3));
      __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3920</span>:         northing = northing.astype('float')</pre>
<pre class='cython code score-8 '>      <span class='trace'>__Pyx_TraceLine</span>(3920,0,<span class='error_goto'>__PYX_ERR(0, 3920, __pyx_L6_error)</span>)
      __pyx_t_3 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PyFloat_Type_astype, __pyx_v_northing, __pyx_n_u_float);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3920, __pyx_L6_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (!(likely(<span class='py_c_api'>PyFloat_CheckExact</span>(__pyx_t_3))||((__pyx_t_3) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("float", __pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 3920, __pyx_L6_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_northing, ((PyObject*)__pyx_t_3));
      __pyx_t_3 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3921</span>:     except :</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(3921,0,<span class='error_goto'>__PYX_ERR(0, 3921, __pyx_L8_except_error)</span>)
    /*except:*/ {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_profile_angle", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_3, &amp;__pyx_t_7, &amp;__pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3921, __pyx_L8_except_error)</span>
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3922</span>:         raise ValueError('Could not convert input argument to float!')</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(3922,0,<span class='error_goto'>__PYX_ERR(0, 3922, __pyx_L8_except_error)</span>)
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__115, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3922, __pyx_L8_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_9, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='error_goto'>__PYX_ERR(0, 3922, __pyx_L8_except_error)</span>
    }
/* … */
  __pyx_tuple__115 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Could_not_convert_input_argument);<span class='error_goto'> if (unlikely(!__pyx_tuple__115)) __PYX_ERR(0, 3922, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__115);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__115);
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3923</span>:     try :</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(3923,0,<span class='error_goto'>__PYX_ERR(0, 3923, __pyx_L1_error)</span>)
  {
    /*try:*/ {
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L19_try_end;
    __pyx_L14_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
/* … */
    __pyx_L16_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_6, __pyx_t_5, __pyx_t_4);
    goto __pyx_L1_error;
    __pyx_L15_exception_handled:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_4);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_6, __pyx_t_5, __pyx_t_4);
    __pyx_L19_try_end:;
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3924</span>:         profile1 = spstats.linregress(easting, northing)</pre>
<pre class='cython code score-19 '>      <span class='trace'>__Pyx_TraceLine</span>(3924,0,<span class='error_goto'>__PYX_ERR(0, 3924, __pyx_L14_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_spstats);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3924, __pyx_L14_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_linregress);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3924, __pyx_L14_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = NULL;
      __pyx_t_10 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
          __pyx_t_10 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_7, __pyx_v_easting, __pyx_v_northing};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_10, 2+__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3924, __pyx_L14_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      }
      __pyx_v_profile1 = __pyx_t_8;
      __pyx_t_8 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3925</span>:         profile2 =spstats.linregress(northing, easting)</pre>
<pre class='cython code score-19 '>      <span class='trace'>__Pyx_TraceLine</span>(3925,0,<span class='error_goto'>__PYX_ERR(0, 3925, __pyx_L14_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_spstats);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3925, __pyx_L14_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_linregress);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3925, __pyx_L14_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_10 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
          __pyx_t_10 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_northing, __pyx_v_easting};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_10, 2+__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3925, __pyx_L14_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      }
      __pyx_v_profile2 = __pyx_t_8;
      __pyx_t_8 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3926</span>:     except:</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(3926,0,<span class='error_goto'>__PYX_ERR(0, 3926, __pyx_L16_except_error)</span>)
    /*except:*/ {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_profile_angle", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_8, &amp;__pyx_t_7, &amp;__pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3926, __pyx_L16_except_error)</span>
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3927</span>:         warnings.warn(msg)</pre>
<pre class='cython code score-23 '>      <span class='trace'>__Pyx_TraceLine</span>(3927,0,<span class='error_goto'>__PYX_ERR(0, 3927, __pyx_L16_except_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 3927, __pyx_L16_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_11, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 3927, __pyx_L16_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      __pyx_t_11 = NULL;
      __pyx_t_10 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
          __pyx_t_10 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_v_msg};
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_12, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 3927, __pyx_L16_except_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L15_exception_handled;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3928</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3929</span>:     profile_line = profile1[:2]</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(3929,0,<span class='error_goto'>__PYX_ERR(0, 3929, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_v_profile1)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("profile1"); <span class='error_goto'>__PYX_ERR(0, 3929, __pyx_L1_error)</span> }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_profile1, 0, 2, NULL, NULL, &amp;__pyx_slice__116, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3929, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_v_profile_line = __pyx_t_3;
  __pyx_t_3 = 0;
/* … */
  __pyx_slice__116 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__116)) __PYX_ERR(0, 3929, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__116);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__116);
</pre><pre class="cython line score-0">&#xA0;<span class="">3930</span>:     # if the profile is rather E=E(N),</pre>
<pre class="cython line score-0">&#xA0;<span class="">3931</span>:     # the parameters have to converted  into N=N(E) form:</pre>
<pre class="cython line score-0">&#xA0;<span class="">3932</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3933</span>:     if profile2[4] &lt; profile1[4]:</pre>
<pre class='cython code score-18 '>  <span class='trace'>__Pyx_TraceLine</span>(3933,0,<span class='error_goto'>__PYX_ERR(0, 3933, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_v_profile2)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("profile2"); <span class='error_goto'>__PYX_ERR(0, 3933, __pyx_L1_error)</span> }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_profile2, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3933, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (unlikely(!__pyx_v_profile1)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("profile1"); <span class='error_goto'>__PYX_ERR(0, 3933, __pyx_L1_error)</span> }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_profile1, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3933, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_7, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3933, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_8); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3933, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3934</span>:         profile_line = (1. / profile2[0], -profile2[1] / profile2[0])</pre>
<pre class='cython code score-35 '>    <span class='trace'>__Pyx_TraceLine</span>(3934,0,<span class='error_goto'>__PYX_ERR(0, 3934, __pyx_L1_error)</span>)
    if (unlikely(!__pyx_v_profile2)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("profile2"); <span class='error_goto'>__PYX_ERR(0, 3934, __pyx_L1_error)</span> }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_profile2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3934, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyFloat_TrueDivideCObj</span>(__pyx_float_1_, __pyx_t_8, 1., 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3934, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_profile2)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("profile2"); <span class='error_goto'>__PYX_ERR(0, 3934, __pyx_L1_error)</span> }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_profile2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3934, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 3934, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_v_profile2)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("profile2"); <span class='error_goto'>__PYX_ERR(0, 3934, __pyx_L1_error)</span> }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_profile2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3934, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3934, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3934, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 3934, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 3934, __pyx_L1_error)</span>;
    __pyx_t_7 = 0;
    __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_profile_line, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3935</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3936</span>:     # if self.profile_angle is None:</pre>
<pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3937</span>:     profile_angle = (90 - (np.arctan(profile_line[0]) * 180 / np.pi)) % 180</pre>
<pre class='cython code score-40 '>  <span class='trace'>__Pyx_TraceLine</span>(3937,0,<span class='error_goto'>__PYX_ERR(0, 3937, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_arctan);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_profile_line, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_3 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_9};
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3937, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_MultiplyObjC</span>(__pyx_t_8, __pyx_int_180, 0xB4, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_pi);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_7, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_90, __pyx_t_8, 90, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_RemainderObjC</span>(__pyx_t_9, __pyx_int_180, 0xB4, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_v_profile_angle = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3938</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3939</span>:     # otherwise: # have 90 degree ambiguity in</pre>
<pre class="cython line score-0">&#xA0;<span class="">3940</span>:     #strike determination# choose strike which offers larger</pre>
<pre class="cython line score-0">&#xA0;<span class="">3941</span>:     #  angle with profile if profile azimuth is in [0,90].</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3942</span>:     if msg=="raises":</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(3942,0,<span class='error_goto'>__PYX_ERR(0, 3942, __pyx_L1_error)</span>)
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_msg, __pyx_n_u_raises, Py_EQ)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 3942, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3943</span>:         print("+++ -&gt; Profile angle is {0:+.2f} degrees E of N".format(</pre>
<pre class='cython code score-6 '>    <span class='trace'>__Pyx_TraceLine</span>(3943,0,<span class='error_goto'>__PYX_ERR(0, 3943, __pyx_L1_error)</span>)
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_u_Profile_angle_is_0_2f_degrees_E, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3943, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(3943,0,<span class='error_goto'>__PYX_ERR(0, 3943, __pyx_L1_error)</span>)
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_print, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 3943, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3944</span>:                 profile_angle</pre>
<pre class='cython code score-14 '>    <span class='trace'>__Pyx_TraceLine</span>(3944,0,<span class='error_goto'>__PYX_ERR(0, 3944, __pyx_L1_error)</span>)
    __pyx_t_7 = NULL;
    __pyx_t_10 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_7)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_10 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_profile_angle};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 3943, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">3945</span>:                 ) )</pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3946</span>:     return np.around( profile_angle,2)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(3946,0,<span class='error_goto'>__PYX_ERR(0, 3946, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 3946, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_around);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 3946, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_8, __pyx_v_profile_angle, __pyx_int_2};
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_10, 2+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 3946, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  __pyx_r = __pyx_t_9;
  __pyx_t_9 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">3947</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3948</span>: </pre>
<pre class="cython line score-149" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">3949</span>: def savgol_coeffs(window_length, polyorder, deriv=0, delta=1.0, pos=None,</pre>
<pre class='cython code score-149 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_101savgol_coeffs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_100savgol_coeffs, "Compute the coefficients for a 1-D Savitzky-Golay FIR filter.\n\n    Parameters\n    ----------\n    window_length : int\n        The length of the filter window (i.e., the number of coefficients).\n        `window_length` must be an odd positive integer.\n    polyorder : int\n        The order of the polynomial used to fit the samples.\n        `polyorder` must be less than `window_length`.\n    deriv : int, optional\n        The order of the derivative to compute. This must be a\n        nonnegative integer. The default is 0, which means to filter\n        the data without differentiating.\n    delta : float, optional\n        The spacing of the samples to which the filter will be applied.\n        This is only used if deriv &gt; 0.\n    pos : int or None, optional\n        If pos is not None, it specifies evaluation position within the\n        window. The default is the middle of the window.\n    use : str, optional\n        Either 'conv' or 'dot'. This argument chooses the order of the\n        coefficients. The default is 'conv', which means that the\n        coefficients are ordered to be used in a convolution. With\n        use='dot', the order is reversed, so the filter is applied by\n        dotting the coefficients with the data set.\n\n    Returns\n    -------\n    coeffs : 1-D ndarray\n        The filter coefficients.\n\n    References\n    ----------\n    A. Savitzky, M. J. E. Golay, Smoothing and Differentiation of Data by\n    Simplified Least Squares Procedures. Analytical Chemistry, 1964, 36 (8),\n    pp 1627-1639.\n\n    See Also\n    --------\n    savgol_filter\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.exmath.signal import savgol_coeffs\n    &gt;&gt;&gt; savgol_coeffs(5, 2)\n    array([-0.08571429,  0.34285714,  0.48571429,  0.34285714, -0.08571429])\n    &gt;&gt;&gt; savgol_coeffs(5, 2, deriv=1)\n    array([ 2.00000000e-01,  1.00000000e-01,  2.07548111e-16, -1.00000000e-01,\n           -2.00000000e-01])\n\n    Note that use='dot' simply reverses the coeffic""ients.\n\n    &gt;&gt;&gt; savgol_coeffs(5, 2, pos=3)\n    array([ 0.25714286,  0.37142857,  0.34285714,  0.17142857, -0.14285714])\n    &gt;&gt;&gt; savgol_coeffs(5, 2, pos=3, use='dot')\n    array([-0.14285714,  0.17142857,  0.34285714,  0.37142857,  0.25714286])\n\n    `x` contains data from the parabola x = t**2, sampled at\n    t = -1, 0, 1, 2, 3.  `c` holds the coefficients that will compute the\n    derivative at the last position.  When dotted with `x` the result should\n    be 6.\n\n    &gt;&gt;&gt; x = np.array([1, 0, 1, 4, 9])\n    &gt;&gt;&gt; c = savgol_coeffs(5, 2, pos=4, deriv=1, use='dot')\n    &gt;&gt;&gt; c.dot(x)\n    6.0\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_101savgol_coeffs = {"savgol_coeffs", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_101savgol_coeffs, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_100savgol_coeffs};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_101savgol_coeffs(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_window_length = 0;
  PyObject *__pyx_v_polyorder = 0;
  PyObject *__pyx_v_deriv = 0;
  PyObject *__pyx_v_delta = 0;
  PyObject *__pyx_v_pos = 0;
  PyObject *__pyx_v_use = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("savgol_coeffs (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_window_length,&amp;__pyx_n_s_polyorder,&amp;__pyx_n_s_deriv,&amp;__pyx_n_s_delta,&amp;__pyx_n_s_pos,&amp;__pyx_n_s_use,0};
  PyObject* values[6] = {0,0,0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_0)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1_0)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)Py_None));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_conv)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_window_length)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_polyorder)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("savgol_coeffs", 0, 2, 6, 1); <span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deriv);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_pos);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_use);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "savgol_coeffs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_window_length = values[0];
    __pyx_v_polyorder = values[1];
    __pyx_v_deriv = values[2];
    __pyx_v_delta = values[3];
    __pyx_v_pos = values[4];
    __pyx_v_use = values[5];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("savgol_coeffs", 0, 2, 6, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.savgol_coeffs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_100savgol_coeffs(__pyx_self, __pyx_v_window_length, __pyx_v_polyorder, __pyx_v_deriv, __pyx_v_delta, __pyx_v_pos, __pyx_v_use);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_100savgol_coeffs(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_window_length, PyObject *__pyx_v_polyorder, PyObject *__pyx_v_deriv, PyObject *__pyx_v_delta, PyObject *__pyx_v_pos, PyObject *__pyx_v_use) {
  PyObject *__pyx_v_halflen = NULL;
  PyObject *__pyx_v_rem = NULL;
  PyObject *__pyx_v_coeffs = NULL;
  PyObject *__pyx_v_x = NULL;
  PyObject *__pyx_v_order = NULL;
  PyObject *__pyx_v_A = NULL;
  PyObject *__pyx_v_y = NULL;
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__117)
  <span class='trace'>__Pyx_TraceCall</span>("savgol_coeffs", __pyx_f[0], 3949, 0, <span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pos);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.savgol_coeffs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_halflen);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rem);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_coeffs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_order);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_A);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pos);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__217 = <span class='py_c_api'>PyTuple_Pack</span>(14, __pyx_n_s_window_length, __pyx_n_s_polyorder, __pyx_n_s_deriv, __pyx_n_s_delta, __pyx_n_s_pos, __pyx_n_s_use, __pyx_n_s_halflen, __pyx_n_s_rem, __pyx_n_s_coeffs, __pyx_n_s_x, __pyx_n_s_order, __pyx_n_s_A, __pyx_n_s_y, __pyx_n_s__177);<span class='error_goto'> if (unlikely(!__pyx_tuple__217)) __PYX_ERR(0, 3949, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__217);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__217);
  __pyx_codeobj__117 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__217, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_savgol_coeffs, 3949, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__117)) __PYX_ERR(0, 3949, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(3949,0,<span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_101savgol_coeffs, 0, __pyx_n_s_savgol_coeffs, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__117));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 3949, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__218);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_savgol_coeffs, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 3949, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__218 = <span class='py_c_api'>PyTuple_Pack</span>(4, ((PyObject *)__pyx_int_0), ((PyObject*)__pyx_float_1_0), Py_None, ((PyObject*)__pyx_n_u_conv));<span class='error_goto'> if (unlikely(!__pyx_tuple__218)) __PYX_ERR(0, 3949, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__218);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__218);
</pre><pre class="cython line score-0">&#xA0;<span class="">3950</span>:                   use="conv"):</pre>
<pre class="cython line score-0">&#xA0;<span class="">3951</span>:     """Compute the coefficients for a 1-D Savitzky-Golay FIR filter.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3952</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3953</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">3954</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3955</span>:     window_length : int</pre>
<pre class="cython line score-0">&#xA0;<span class="">3956</span>:         The length of the filter window (i.e., the number of coefficients).</pre>
<pre class="cython line score-0">&#xA0;<span class="">3957</span>:         `window_length` must be an odd positive integer.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3958</span>:     polyorder : int</pre>
<pre class="cython line score-0">&#xA0;<span class="">3959</span>:         The order of the polynomial used to fit the samples.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3960</span>:         `polyorder` must be less than `window_length`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3961</span>:     deriv : int, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">3962</span>:         The order of the derivative to compute. This must be a</pre>
<pre class="cython line score-0">&#xA0;<span class="">3963</span>:         nonnegative integer. The default is 0, which means to filter</pre>
<pre class="cython line score-0">&#xA0;<span class="">3964</span>:         the data without differentiating.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3965</span>:     delta : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">3966</span>:         The spacing of the samples to which the filter will be applied.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3967</span>:         This is only used if deriv &gt; 0.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3968</span>:     pos : int or None, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">3969</span>:         If pos is not None, it specifies evaluation position within the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3970</span>:         window. The default is the middle of the window.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3971</span>:     use : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">3972</span>:         Either 'conv' or 'dot'. This argument chooses the order of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3973</span>:         coefficients. The default is 'conv', which means that the</pre>
<pre class="cython line score-0">&#xA0;<span class="">3974</span>:         coefficients are ordered to be used in a convolution. With</pre>
<pre class="cython line score-0">&#xA0;<span class="">3975</span>:         use='dot', the order is reversed, so the filter is applied by</pre>
<pre class="cython line score-0">&#xA0;<span class="">3976</span>:         dotting the coefficients with the data set.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3977</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3978</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">3979</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3980</span>:     coeffs : 1-D ndarray</pre>
<pre class="cython line score-0">&#xA0;<span class="">3981</span>:         The filter coefficients.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3982</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3983</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">3984</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3985</span>:     A. Savitzky, M. J. E. Golay, Smoothing and Differentiation of Data by</pre>
<pre class="cython line score-0">&#xA0;<span class="">3986</span>:     Simplified Least Squares Procedures. Analytical Chemistry, 1964, 36 (8),</pre>
<pre class="cython line score-0">&#xA0;<span class="">3987</span>:     pp 1627-1639.</pre>
<pre class="cython line score-0">&#xA0;<span class="">3988</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3989</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">3990</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3991</span>:     savgol_filter</pre>
<pre class="cython line score-0">&#xA0;<span class="">3992</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">3993</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">3994</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">3995</span>:     &gt;&gt;&gt; from gofast.exmath.signal import savgol_coeffs</pre>
<pre class="cython line score-0">&#xA0;<span class="">3996</span>:     &gt;&gt;&gt; savgol_coeffs(5, 2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3997</span>:     array([-0.08571429,  0.34285714,  0.48571429,  0.34285714, -0.08571429])</pre>
<pre class="cython line score-0">&#xA0;<span class="">3998</span>:     &gt;&gt;&gt; savgol_coeffs(5, 2, deriv=1)</pre>
<pre class="cython line score-0">&#xA0;<span class="">3999</span>:     array([ 2.00000000e-01,  1.00000000e-01,  2.07548111e-16, -1.00000000e-01,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4000</span>:            -2.00000000e-01])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4001</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4002</span>:     Note that use='dot' simply reverses the coefficients.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4003</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4004</span>:     &gt;&gt;&gt; savgol_coeffs(5, 2, pos=3)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4005</span>:     array([ 0.25714286,  0.37142857,  0.34285714,  0.17142857, -0.14285714])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4006</span>:     &gt;&gt;&gt; savgol_coeffs(5, 2, pos=3, use='dot')</pre>
<pre class="cython line score-0">&#xA0;<span class="">4007</span>:     array([-0.14285714,  0.17142857,  0.34285714,  0.37142857,  0.25714286])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4009</span>:     `x` contains data from the parabola x = t**2, sampled at</pre>
<pre class="cython line score-0">&#xA0;<span class="">4010</span>:     t = -1, 0, 1, 2, 3.  `c` holds the coefficients that will compute the</pre>
<pre class="cython line score-0">&#xA0;<span class="">4011</span>:     derivative at the last position.  When dotted with `x` the result should</pre>
<pre class="cython line score-0">&#xA0;<span class="">4012</span>:     be 6.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4013</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4014</span>:     &gt;&gt;&gt; x = np.array([1, 0, 1, 4, 9])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4015</span>:     &gt;&gt;&gt; c = savgol_coeffs(5, 2, pos=4, deriv=1, use='dot')</pre>
<pre class="cython line score-0">&#xA0;<span class="">4016</span>:     &gt;&gt;&gt; c.dot(x)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4017</span>:     6.0</pre>
<pre class="cython line score-0">&#xA0;<span class="">4018</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4019</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4020</span>:     # An alternative method for finding the coefficients when deriv=0 is</pre>
<pre class="cython line score-0">&#xA0;<span class="">4021</span>:     #    t = np.arange(window_length)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4022</span>:     #    unit = (t == pos).astype(int)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4023</span>:     #    coeffs = np.polyval(np.polyfit(t, unit, polyorder), t)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4024</span>:     # The method implemented here is faster.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4025</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4026</span>:     # To recreate the table of sample coefficients shown in the chapter on</pre>
<pre class="cython line score-0">&#xA0;<span class="">4027</span>:     # the Savitzy-Golay filter in the Numerical Recipes book, use</pre>
<pre class="cython line score-0">&#xA0;<span class="">4028</span>:     #    window_length = nL + nR + 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4029</span>:     #    pos = nL + 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4030</span>:     #    c = savgol_coeffs(window_length, M, pos=pos, use='dot')</pre>
<pre class="cython line score-0">&#xA0;<span class="">4031</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4032</span>:     if polyorder &gt;= window_length:</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(4032,0,<span class='error_goto'>__PYX_ERR(0, 4032, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_polyorder, __pyx_v_window_length, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4032, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4032, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4033</span>:         raise ValueError("polyorder must be less than window_length.")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(4033,0,<span class='error_goto'>__PYX_ERR(0, 4033, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__118, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4033, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 4033, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__118 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_polyorder_must_be_less_than_wind);<span class='error_goto'> if (unlikely(!__pyx_tuple__118)) __PYX_ERR(0, 4033, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__118);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__118);
</pre><pre class="cython line score-0">&#xA0;<span class="">4034</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4035</span>:     halflen, rem = divmod(window_length, 2)</pre>
<pre class='cython code score-51 '>  <span class='trace'>__Pyx_TraceLine</span>(4035,0,<span class='error_goto'>__PYX_ERR(0, 4035, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Divmod</span>(__pyx_v_window_length, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4035, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 4035, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4035, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4035, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4035, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);
    index = 0; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L4_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_4 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_4)) goto __pyx_L4_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_5), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4035, __pyx_L1_error)</span>
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L5_unpacking_done;
    __pyx_L4_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 4035, __pyx_L1_error)</span>
    __pyx_L5_unpacking_done:;
  }
  __pyx_v_halflen = __pyx_t_3;
  __pyx_t_3 = 0;
  __pyx_v_rem = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4036</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4037</span>:     if rem == 0:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4037,0,<span class='error_goto'>__PYX_ERR(0, 4037, __pyx_L1_error)</span>)
  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_v_rem, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4037, __pyx_L1_error)</span>
  if (unlikely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4038</span>:         raise ValueError("window_length must be odd.")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(4038,0,<span class='error_goto'>__PYX_ERR(0, 4038, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__119, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4038, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 4038, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__119 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_window_length_must_be_odd);<span class='error_goto'> if (unlikely(!__pyx_tuple__119)) __PYX_ERR(0, 4038, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__119);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__119);
</pre><pre class="cython line score-0">&#xA0;<span class="">4039</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4040</span>:     if pos is None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(4040,0,<span class='error_goto'>__PYX_ERR(0, 4040, __pyx_L1_error)</span>)
  __pyx_t_2 = (__pyx_v_pos == Py_None);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4041</span>:         pos = halflen</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(4041,0,<span class='error_goto'>__PYX_ERR(0, 4041, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_halflen);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_pos, __pyx_v_halflen);
</pre><pre class="cython line score-0">&#xA0;<span class="">4042</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4043</span>:     if not (0 &lt;= pos &lt; window_length):</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(4043,0,<span class='error_goto'>__PYX_ERR(0, 4043, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_int_0, __pyx_v_pos, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4043, __pyx_L1_error)</span>
  if (<span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1)) {
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_pos, __pyx_v_window_length, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4043, __pyx_L1_error)</span>
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4043, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_7 = (!__pyx_t_2);
  if (unlikely(__pyx_t_7)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4044</span>:         raise ValueError("pos must be nonnegative and less than "</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(4044,0,<span class='error_goto'>__PYX_ERR(0, 4044, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__120, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4044, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 4044, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__120 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_pos_must_be_nonnegative_and_less);<span class='error_goto'> if (unlikely(!__pyx_tuple__120)) __PYX_ERR(0, 4044, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__120);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__120);
</pre><pre class="cython line score-0">&#xA0;<span class="">4045</span>:                          "window_length.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">4046</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4047</span>:     if use not in ['conv', 'dot']:</pre>
<pre class='cython code score-6 '>  <span class='trace'>__Pyx_TraceLine</span>(4047,0,<span class='error_goto'>__PYX_ERR(0, 4047, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_use);
  __pyx_t_1 = __pyx_v_use;
  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_1, __pyx_n_u_conv, Py_NE)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4047, __pyx_L1_error)</span>
  if (__pyx_t_2) {
  } else {
    __pyx_t_7 = __pyx_t_2;
    goto __pyx_L10_bool_binop_done;
  }
  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_1, __pyx_n_u_dot, Py_NE)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4047, __pyx_L1_error)</span>
  __pyx_t_7 = __pyx_t_2;
  __pyx_L10_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_2 = __pyx_t_7;
  if (unlikely(__pyx_t_2)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4048</span>:         raise ValueError("`use` must be 'conv' or 'dot'")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(4048,0,<span class='error_goto'>__PYX_ERR(0, 4048, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__121, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4048, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 4048, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__121 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_use_must_be_conv_or_dot);<span class='error_goto'> if (unlikely(!__pyx_tuple__121)) __PYX_ERR(0, 4048, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__121);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__121);
</pre><pre class="cython line score-0">&#xA0;<span class="">4049</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4050</span>:     if deriv &gt; polyorder:</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(4050,0,<span class='error_goto'>__PYX_ERR(0, 4050, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_deriv, __pyx_v_polyorder, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4050, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4050, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4051</span>:         coeffs = np.zeros(window_length)</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(4051,0,<span class='error_goto'>__PYX_ERR(0, 4051, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4051, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4051, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_8 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_8 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_window_length};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4051, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_v_coeffs = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4052</span>:         return coeffs</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(4052,0,<span class='error_goto'>__PYX_ERR(0, 4052, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coeffs);
    __pyx_r = __pyx_v_coeffs;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4053</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4054</span>:     # Form the design matrix A. The columns of A are powers of the integers</pre>
<pre class="cython line score-0">&#xA0;<span class="">4055</span>:     # from -pos to window_length - pos - 1. The powers (i.e., rows) range</pre>
<pre class="cython line score-0">&#xA0;<span class="">4056</span>:     # from 0 to polyorder. (That is, A is a vandermonde matrix, but not</pre>
<pre class="cython line score-0">&#xA0;<span class="">4057</span>:     # necessarily square.)</pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4058</span>:     x = np.arange(-pos, window_length - pos, dtype=float)</pre>
<pre class='cython code score-36 '>  <span class='trace'>__Pyx_TraceLine</span>(4058,0,<span class='error_goto'>__PYX_ERR(0, 4058, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_v_pos);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_window_length, __pyx_v_pos);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4058, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4058, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, ((PyObject *)(&amp;PyFloat_Type))) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4058, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4058, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_x = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4059</span>:     if use == "conv":</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4059,0,<span class='error_goto'>__PYX_ERR(0, 4059, __pyx_L1_error)</span>)
  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_use, __pyx_n_u_conv, Py_EQ)); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4059, __pyx_L1_error)</span>
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">4060</span>:         # Reverse so that result can be used in a convolution.</pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4061</span>:         x = x[::-1]</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(4061,0,<span class='error_goto'>__PYX_ERR(0, 4061, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_x, __pyx_slice__69);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4061, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4062</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4063</span>:     order = np.arange(polyorder + 1).reshape(-1, 1)</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(4063,0,<span class='error_goto'>__PYX_ERR(0, 4063, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4063, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4063, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_polyorder, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4063, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4063, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4063, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__41, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4063, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_order = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4064</span>:     A = x ** order</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4064,0,<span class='error_goto'>__PYX_ERR(0, 4064, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_x, __pyx_v_order, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_A = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4065</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4066</span>:     # y determines which order derivative is returned.</pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4067</span>:     y = np.zeros(polyorder + 1)</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(4067,0,<span class='error_goto'>__PYX_ERR(0, 4067, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4067, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4067, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_polyorder, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4067, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_5};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4067, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_v_y = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4068</span>:     # The coefficient assigned to y[deriv] scales the result to take into</pre>
<pre class="cython line score-0">&#xA0;<span class="">4069</span>:     # account the order of the derivative and the sample spacing.</pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4070</span>:     y[deriv] = float_factorial(deriv) / (delta ** deriv)</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(4070,0,<span class='error_goto'>__PYX_ERR(0, 4070, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_float_factorial);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4070, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_deriv};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4070, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_delta, __pyx_v_deriv, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4070, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4070, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_y, __pyx_v_deriv, __pyx_t_5) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4070, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4071</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4072</span>:     # Find the least-squares solution of A*c = y</pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4073</span>:     coeffs, _, _, _ = lstsq(A, y)</pre>
<pre class='cython code score-69 '>  <span class='trace'>__Pyx_TraceLine</span>(4073,0,<span class='error_goto'>__PYX_ERR(0, 4073, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_lstsq);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4073, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_v_A, __pyx_v_y};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 4073, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
    PyObject* sequence = __pyx_t_5;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 4)) {
      if (size &gt; 4) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(4);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 4073, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
      __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 3); 
    } else {
      __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
      __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 3); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
    #else
    {
      Py_ssize_t i;
      PyObject** temps[4] = {&amp;__pyx_t_4,&amp;__pyx_t_1,&amp;__pyx_t_3,&amp;__pyx_t_9};
      for (i=0; i &lt; 4; i++) {
        PyObject* item = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, i);<span class='error_goto'> if (unlikely(!item)) __PYX_ERR(0, 4073, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[i]) = item;
      }
    }
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    Py_ssize_t index = -1;
    PyObject** temps[4] = {&amp;__pyx_t_4,&amp;__pyx_t_1,&amp;__pyx_t_3,&amp;__pyx_t_9};
    __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 4073, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_10);
    for (index=0; index &lt; 4; index++) {
      PyObject* item = __pyx_t_6(__pyx_t_10); if (unlikely(!item)) goto __pyx_L14_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(item);
      *(temps[index]) = item;
    }
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_6(__pyx_t_10), 4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4073, __pyx_L1_error)</span>
    __pyx_t_6 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    goto __pyx_L15_unpacking_done;
    __pyx_L14_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_6 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 4073, __pyx_L1_error)</span>
    __pyx_L15_unpacking_done:;
  }
  __pyx_v_coeffs = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_v__ = __pyx_t_1;
  __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, __pyx_t_9);
  __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4074</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4075</span>:     return coeffs</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4075,0,<span class='error_goto'>__PYX_ERR(0, 4075, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coeffs);
  __pyx_r = __pyx_v_coeffs;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4076</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4077</span>: </pre>
<pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4078</span>: def _polyder(p, m):</pre>
<pre class='cython code score-77 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_103_polyder(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_102_polyder, "Differentiate polynomials represented with coefficients.\n\n    p must be a 1-D or 2-D array.  In the 2-D case, each column gives\n    the coefficients of a polynomial; the first row holds the coefficients\n    associated with the highest power. m must be a nonnegative integer.\n    (numpy.polyder doesn't handle the 2-D case.)\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_103_polyder = {"_polyder", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_103_polyder, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_102_polyder};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_103_polyder(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_p = 0;
  PyObject *__pyx_v_m = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_polyder (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_p,&amp;__pyx_n_s_m,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_p)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4078, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_m)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4078, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_polyder", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 4078, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_polyder") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4078, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_p = values[0];
    __pyx_v_m = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_polyder", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4078, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._polyder", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_102_polyder(__pyx_self, __pyx_v_p, __pyx_v_m);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_102_polyder(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_p, PyObject *__pyx_v_m) {
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_n = NULL;
  PyObject *__pyx_v_dp = NULL;
  PyObject *__pyx_v_k = NULL;
  PyObject *__pyx_v_rng = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__122)
  <span class='trace'>__Pyx_TraceCall</span>("_polyder", __pyx_f[0], 4078, 0, <span class='error_goto'>__PYX_ERR(0, 4078, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._polyder", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_dp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_k);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rng);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__219 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_result, __pyx_n_s_n, __pyx_n_s_dp, __pyx_n_s_k, __pyx_n_s_rng);<span class='error_goto'> if (unlikely(!__pyx_tuple__219)) __PYX_ERR(0, 4078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__219);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__219);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4078,0,<span class='error_goto'>__PYX_ERR(0, 4078, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_103_polyder, 0, __pyx_n_s_polyder, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__122));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4078, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_polyder, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4078, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__122 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__219, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_polyder, 4078, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__122)) __PYX_ERR(0, 4078, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4079</span>:     """Differentiate polynomials represented with coefficients.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4080</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4081</span>:     p must be a 1-D or 2-D array.  In the 2-D case, each column gives</pre>
<pre class="cython line score-0">&#xA0;<span class="">4082</span>:     the coefficients of a polynomial; the first row holds the coefficients</pre>
<pre class="cython line score-0">&#xA0;<span class="">4083</span>:     associated with the highest power. m must be a nonnegative integer.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4084</span>:     (numpy.polyder doesn't handle the 2-D case.)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4085</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4086</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4087</span>:     if m == 0:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4087,0,<span class='error_goto'>__PYX_ERR(0, 4087, __pyx_L1_error)</span>)
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_v_m, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4087, __pyx_L1_error)</span>
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4088</span>:         result = p</pre>
<pre class='cython code score-1 '>    <span class='trace'>__Pyx_TraceLine</span>(4088,0,<span class='error_goto'>__PYX_ERR(0, 4088, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_p);
    __pyx_v_result = __pyx_v_p;
</pre><pre class="cython line score-0">&#xA0;<span class="">4089</span>:     else:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4090</span>:         n = len(p)</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(4090,0,<span class='error_goto'>__PYX_ERR(0, 4090, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_2 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_p);<span class='error_goto'> if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 4090, __pyx_L1_error)</span>
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4090, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_v_n = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4091</span>:         if n &lt;= m:</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(4091,0,<span class='error_goto'>__PYX_ERR(0, 4091, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_n, __pyx_v_m, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4091, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_1 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4091, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_1) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4092</span>:             result = np.zeros_like(p[:1, ...])</pre>
<pre class='cython code score-32 '>      <span class='trace'>__Pyx_TraceLine</span>(4092,0,<span class='error_goto'>__PYX_ERR(0, 4092, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4092, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4092, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_slice__123 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_int_1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__123)) __PYX_ERR(0, 4092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__123);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__123);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_p, __pyx_tuple__124);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4092, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_6 = NULL;
      __pyx_t_7 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_7 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_4};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4092, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_v_result = __pyx_t_3;
      __pyx_t_3 = 0;
  __pyx_tuple__124 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_slice__123, Py_Ellipsis);<span class='error_goto'> if (unlikely(!__pyx_tuple__124)) __PYX_ERR(0, 4092, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__124);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__124);
</pre><pre class="cython line score-0">&#xA0;<span class="">4093</span>:         else:</pre>
<pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4094</span>:             dp = p[:-m].copy()</pre>
<pre class='cython code score-25 '>    <span class='trace'>__Pyx_TraceLine</span>(4094,0,<span class='error_goto'>__PYX_ERR(0, 4094, __pyx_L1_error)</span>)
    /*else*/ {
      __pyx_t_5 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_v_m);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4094, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_p, 0, 0, NULL, &amp;__pyx_t_5, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4094, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4094, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_7 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_7 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4094, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      __pyx_v_dp = __pyx_t_3;
      __pyx_t_3 = 0;
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4095</span>:             for k in range(m):</pre>
<pre class='cython code score-52 '>      <span class='trace'>__Pyx_TraceLine</span>(4095,0,<span class='error_goto'>__PYX_ERR(0, 4095, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_v_m);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4095, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
        __pyx_t_5 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        __pyx_t_2 = 0;
        __pyx_t_8 = NULL;
      } else {
        __pyx_t_2 = -1; __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4095, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4095, __pyx_L1_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      for (;;) {
        if (likely(!__pyx_t_8)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5))) {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_5);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4095, __pyx_L1_error)</span>
              #endif
              if (__pyx_t_2 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_5, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4095, __pyx_L1_error)</span>
            #else
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_5, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4095, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            #endif
          } else {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_5);
              #if !CYTHON_ASSUME_SAFE_MACROS
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4095, __pyx_L1_error)</span>
              #endif
              if (__pyx_t_2 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_5, __pyx_t_2); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_2++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4095, __pyx_L1_error)</span>
            #else
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_5, __pyx_t_2); __pyx_t_2++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4095, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            #endif
          }
        } else {
          __pyx_t_3 = __pyx_t_8(__pyx_t_5);
          if (unlikely(!__pyx_t_3)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
              else <span class='error_goto'>__PYX_ERR(0, 4095, __pyx_L1_error)</span>
            }
            break;
          }
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_k, __pyx_t_3);
        __pyx_t_3 = 0;
/* … */
        <span class='trace'>__Pyx_TraceLine</span>(4095,0,<span class='error_goto'>__PYX_ERR(0, 4095, __pyx_L1_error)</span>)
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4096</span>:                 rng = np.arange(n - k - 1, m - k - 1, -1)</pre>
<pre class='cython code score-38 '>        <span class='trace'>__Pyx_TraceLine</span>(4096,0,<span class='error_goto'>__PYX_ERR(0, 4096, __pyx_L1_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 4096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_m, __pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_4, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 4096, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = NULL;
        __pyx_t_7 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
            __pyx_t_7 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[4] = {__pyx_t_4, __pyx_t_9, __pyx_t_10, __pyx_int_neg_1};
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 3+__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4096, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_rng, __pyx_t_3);
        __pyx_t_3 = 0;
</pre><pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4097</span>:                 dp *= rng.reshape((n - m,) + (1,) * (p.ndim - 1))</pre>
<pre class='cython code score-62 '>        <span class='trace'>__Pyx_TraceLine</span>(4097,0,<span class='error_goto'>__PYX_ERR(0, 4097, __pyx_L1_error)</span>)
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_rng, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4097, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_10 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_m);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 4097, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 4097, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
        if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 4097, __pyx_L1_error)</span>;
        __pyx_t_10 = 0;
        __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_p, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 4097, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_10, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4097, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_tuple__125, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 4097, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4097, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_10 = NULL;
        __pyx_t_7 = 0;
        #if CYTHON_UNPACK_METHODS
        if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
          __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
          if (likely(__pyx_t_10)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
            __pyx_t_7 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_4};
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4097, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        }
        __pyx_t_6 = <span class='py_c_api'>PyNumber_InPlaceMultiply</span>(__pyx_v_dp, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4097, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_dp, __pyx_t_6);
        __pyx_t_6 = 0;
/* … */
  __pyx_tuple__125 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_tuple__125)) __PYX_ERR(0, 4097, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__125);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_tuple__125, 0, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 4097, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__125);
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4098</span>:             result = dp</pre>
<pre class='cython code score-1 '>      <span class='trace'>__Pyx_TraceLine</span>(4098,0,<span class='error_goto'>__PYX_ERR(0, 4098, __pyx_L1_error)</span>)
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_dp);
      __pyx_v_result = __pyx_v_dp;
    }
    __pyx_L4:;
  }
  __pyx_L3:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4099</span>:     return result</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4099,0,<span class='error_goto'>__PYX_ERR(0, 4099, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4100</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4101</span>: </pre>
<pre class="cython line score-200" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4102</span>: def _fit_edge(x, window_start, window_stop, interp_start, interp_stop,</pre>
<pre class='cython code score-200 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_105_fit_edge(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_104_fit_edge, "\n    Given an N-d array `x` and the specification of a slice of `x` from\n    `window_start` to `window_stop` along `axis`, create an interpolating\n    polynomial of each 1-D slice, and evaluate that polynomial in the slice\n    from `interp_start` to `interp_stop`. Put the result into the\n    corresponding slice of `y`.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_105_fit_edge = {"_fit_edge", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_105_fit_edge, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_104_fit_edge};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_105_fit_edge(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_window_start = 0;
  PyObject *__pyx_v_window_stop = 0;
  PyObject *__pyx_v_interp_start = 0;
  PyObject *__pyx_v_interp_stop = 0;
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_polyorder = 0;
  PyObject *__pyx_v_deriv = 0;
  PyObject *__pyx_v_delta = 0;
  PyObject *__pyx_v_y = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_fit_edge (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_window_start,&amp;__pyx_n_s_window_stop,&amp;__pyx_n_s_interp_start,&amp;__pyx_n_s_interp_stop,&amp;__pyx_n_s_axis,&amp;__pyx_n_s_polyorder,&amp;__pyx_n_s_deriv,&amp;__pyx_n_s_delta,&amp;__pyx_n_s_y,0};
  PyObject* values[10] = {0,0,0,0,0,0,0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case 10: values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
        CYTHON_FALLTHROUGH;
        case  9: values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
        CYTHON_FALLTHROUGH;
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_window_start)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edge", 1, 10, 10, 1); <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_window_stop)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edge", 1, 10, 10, 2); <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_interp_start)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edge", 1, 10, 10, 3); <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_interp_stop)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edge", 1, 10, 10, 4); <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_axis)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edge", 1, 10, 10, 5); <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_polyorder)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edge", 1, 10, 10, 6); <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (likely((values[7] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deriv)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[7]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edge", 1, 10, 10, 7); <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  8:
        if (likely((values[8] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[8]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edge", 1, 10, 10, 8); <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  9:
        if (likely((values[9] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[9]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edge", 1, 10, 10, 9); <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_fit_edge") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 10)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
      values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
      values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
      values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
      values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
      values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
      values[8] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 8);
      values[9] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 9);
    }
    __pyx_v_x = values[0];
    __pyx_v_window_start = values[1];
    __pyx_v_window_stop = values[2];
    __pyx_v_interp_start = values[3];
    __pyx_v_interp_stop = values[4];
    __pyx_v_axis = values[5];
    __pyx_v_polyorder = values[6];
    __pyx_v_deriv = values[7];
    __pyx_v_delta = values[8];
    __pyx_v_y = values[9];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edge", 1, 10, 10, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._fit_edge", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_104_fit_edge(__pyx_self, __pyx_v_x, __pyx_v_window_start, __pyx_v_window_stop, __pyx_v_interp_start, __pyx_v_interp_stop, __pyx_v_axis, __pyx_v_polyorder, __pyx_v_deriv, __pyx_v_delta, __pyx_v_y);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_104_fit_edge(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_window_start, PyObject *__pyx_v_window_stop, PyObject *__pyx_v_interp_start, PyObject *__pyx_v_interp_stop, PyObject *__pyx_v_axis, PyObject *__pyx_v_polyorder, PyObject *__pyx_v_deriv, PyObject *__pyx_v_delta, PyObject *__pyx_v_y) {
  PyObject *__pyx_v_x_edge = NULL;
  PyObject *__pyx_v_xx_edge = NULL;
  int __pyx_v_swapped;
  PyObject *__pyx_v_poly_coeffs = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_values = NULL;
  PyObject *__pyx_v_shp = NULL;
  PyObject *__pyx_v_y_edge = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__126)
  <span class='trace'>__Pyx_TraceCall</span>("_fit_edge", __pyx_f[0], 4102, 0, <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._fit_edge", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x_edge);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xx_edge);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_poly_coeffs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_values);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_shp);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y_edge);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__220 = <span class='py_c_api'>PyTuple_Pack</span>(18, __pyx_n_s_x, __pyx_n_s_window_start, __pyx_n_s_window_stop, __pyx_n_s_interp_start, __pyx_n_s_interp_stop, __pyx_n_s_axis, __pyx_n_s_polyorder, __pyx_n_s_deriv, __pyx_n_s_delta, __pyx_n_s_y, __pyx_n_s_x_edge, __pyx_n_s_xx_edge, __pyx_n_s_swapped, __pyx_n_s_poly_coeffs, __pyx_n_s_i, __pyx_n_s_values, __pyx_n_s_shp, __pyx_n_s_y_edge);<span class='error_goto'> if (unlikely(!__pyx_tuple__220)) __PYX_ERR(0, 4102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__220);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__220);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4102,0,<span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_105_fit_edge, 0, __pyx_n_s_fit_edge, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__126));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_fit_edge, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4102, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__126 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(10, 0, 0, 18, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__220, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_fit_edge, 4102, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__126)) __PYX_ERR(0, 4102, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4103</span>:               axis, polyorder, deriv, delta, y):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4104</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4105</span>:     Given an N-d array `x` and the specification of a slice of `x` from</pre>
<pre class="cython line score-0">&#xA0;<span class="">4106</span>:     `window_start` to `window_stop` along `axis`, create an interpolating</pre>
<pre class="cython line score-0">&#xA0;<span class="">4107</span>:     polynomial of each 1-D slice, and evaluate that polynomial in the slice</pre>
<pre class="cython line score-0">&#xA0;<span class="">4108</span>:     from `interp_start` to `interp_stop`. Put the result into the</pre>
<pre class="cython line score-0">&#xA0;<span class="">4109</span>:     corresponding slice of `y`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4110</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4111</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4112</span>:     # Get the edge into a (window_length, -1) array.</pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4113</span>:     x_edge = axis_slice(x, start=window_start, stop=window_stop, axis=axis)</pre>
<pre class='cython code score-32 '>  <span class='trace'>__Pyx_TraceLine</span>(4113,0,<span class='error_goto'>__PYX_ERR(0, 4113, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_axis_slice);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4113, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_start, __pyx_v_window_start) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4113, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_stop, __pyx_v_window_stop) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4113, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_v_axis) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4113, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_x_edge = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4114</span>:     if axis == 0 or axis == -x.ndim:</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(4114,0,<span class='error_goto'>__PYX_ERR(0, 4114, __pyx_L1_error)</span>)
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_v_axis, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4114, __pyx_L1_error)</span>
  if (!__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4114, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_axis, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4114, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4114, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = __pyx_t_6;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_5) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4115</span>:         xx_edge = x_edge</pre>
<pre class='cython code score-1 '>    <span class='trace'>__Pyx_TraceLine</span>(4115,0,<span class='error_goto'>__PYX_ERR(0, 4115, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x_edge);
    __pyx_v_xx_edge = __pyx_v_x_edge;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4116</span>:         swapped = False</pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(4116,0,<span class='error_goto'>__PYX_ERR(0, 4116, __pyx_L1_error)</span>)
    __pyx_v_swapped = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4117</span>:     else:</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4118</span>:         xx_edge = x_edge.swapaxes(axis, 0)</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(4118,0,<span class='error_goto'>__PYX_ERR(0, 4118, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x_edge, __pyx_n_s_swapaxes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4118, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_axis, __pyx_int_0};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4118, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_v_xx_edge = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4119</span>:         swapped = True</pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(4119,0,<span class='error_goto'>__PYX_ERR(0, 4119, __pyx_L1_error)</span>)
    __pyx_v_swapped = 1;
  }
  __pyx_L3:;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4120</span>:     xx_edge = xx_edge.reshape(xx_edge.shape[0], -1)</pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(4120,0,<span class='error_goto'>__PYX_ERR(0, 4120, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_xx_edge, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_xx_edge, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4120, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_t_1, __pyx_int_neg_1};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4120, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_xx_edge, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4121</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4122</span>:     # Fit the edges.  poly_coeffs has shape (polyorder + 1, -1),</pre>
<pre class="cython line score-0">&#xA0;<span class="">4123</span>:     # where '-1' is the same as in xx_edge.</pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4124</span>:     poly_coeffs = np.polyfit(np.arange(0, window_stop - window_start),</pre>
<pre class='cython code score-30 '>  <span class='trace'>__Pyx_TraceLine</span>(4124,0,<span class='error_goto'>__PYX_ERR(0, 4124, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_polyfit);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_window_stop, __pyx_v_window_start);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4124, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_9, __pyx_int_0, __pyx_t_2};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4124, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4125</span>:                              xx_edge, polyorder)</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(4125,0,<span class='error_goto'>__PYX_ERR(0, 4125, __pyx_L1_error)</span>)
  __pyx_t_8 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[4] = {__pyx_t_8, __pyx_t_3, __pyx_v_xx_edge, __pyx_v_polyorder};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 3+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4124, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_v_poly_coeffs = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4126</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4127</span>:     if deriv &gt; 0:</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(4127,0,<span class='error_goto'>__PYX_ERR(0, 4127, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_deriv, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4127, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4127, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4128</span>:         poly_coeffs = _polyder(poly_coeffs, deriv)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(4128,0,<span class='error_goto'>__PYX_ERR(0, 4128, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_polyder);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4128, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_poly_coeffs, __pyx_v_deriv};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4128, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_poly_coeffs, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4129</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4130</span>:     # Compute the interpolated values for the edge.</pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4131</span>:     i = np.arange(interp_start - window_start, interp_stop - window_start)</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(4131,0,<span class='error_goto'>__PYX_ERR(0, 4131, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_arange);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_interp_start, __pyx_v_window_start);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_interp_stop, __pyx_v_window_start);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4131, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_2 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_t_1, __pyx_t_8};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4131, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_i = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4132</span>:     values = np.polyval(poly_coeffs, i.reshape(-1, 1)) / (delta ** deriv)</pre>
<pre class='cython code score-34 '>  <span class='trace'>__Pyx_TraceLine</span>(4132,0,<span class='error_goto'>__PYX_ERR(0, 4132, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_polyval);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_i, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__41, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_poly_coeffs, __pyx_t_1};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4132, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_delta, __pyx_v_deriv, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_4, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_values = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4133</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4134</span>:     # Now put the values into the appropriate slice of y.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4135</span>:     # First reshape values to match y.</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4136</span>:     shp = list(y.shape)</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4136,0,<span class='error_goto'>__PYX_ERR(0, 4136, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PySequence_ListKeepNew</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_shp = ((PyObject*)__pyx_t_8);
  __pyx_t_8 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4137</span>:     shp[0], shp[axis] = shp[axis], shp[0]</pre>
<pre class='cython code score-13 '>  <span class='trace'>__Pyx_TraceLine</span>(4137,0,<span class='error_goto'>__PYX_ERR(0, 4137, __pyx_L1_error)</span>)
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_shp, __pyx_v_axis);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4137, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_shp, 0, long, 1, __Pyx_PyInt_From_long, 1, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4137, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_shp, 0, __pyx_t_8, long, 1, __Pyx_PyInt_From_long, 1, 0, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4137, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_shp, __pyx_v_axis, __pyx_t_1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4137, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4138</span>:     values = values.reshape(interp_stop - interp_start, *shp[1:])</pre>
<pre class='cython code score-34 '>  <span class='trace'>__Pyx_TraceLine</span>(4138,0,<span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_values, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_interp_stop, __pyx_v_interp_start);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 4138, __pyx_L1_error)</span>;
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_GetSlice</span>(__pyx_v_shp, 1, PY_SSIZE_T_MAX);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_3 = <span class='py_c_api'>PySequence_Tuple</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_values, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4139</span>:     if swapped:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(4139,0,<span class='error_goto'>__PYX_ERR(0, 4139, __pyx_L1_error)</span>)
  if (__pyx_v_swapped) {
/* … */
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4140</span>:         values = values.swapaxes(0, axis)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(4140,0,<span class='error_goto'>__PYX_ERR(0, 4140, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_values, __pyx_n_s_swapaxes);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4140, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_1 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_1, __pyx_int_0, __pyx_v_axis};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 2+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4140, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_values, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4141</span>:     # Get a view of the data to be replaced by values.</pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4142</span>:     y_edge = axis_slice(y, start=interp_start, stop=interp_stop, axis=axis)</pre>
<pre class='cython code score-32 '>  <span class='trace'>__Pyx_TraceLine</span>(4142,0,<span class='error_goto'>__PYX_ERR(0, 4142, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_axis_slice);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 4142, __pyx_L1_error)</span>;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_start, __pyx_v_interp_start) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4142, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_stop, __pyx_v_interp_stop) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4142, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_axis, __pyx_v_axis) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4142, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_8, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_y_edge = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4143</span>:     y_edge[...] = values</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4143,0,<span class='error_goto'>__PYX_ERR(0, 4143, __pyx_L1_error)</span>)
  if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_y_edge, Py_Ellipsis, __pyx_v_values) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4143, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4144</span>: </pre>
<pre class="cython line score-149" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4145</span>: def _fit_edges_polyfit(x, window_length, polyorder, deriv, delta, axis, y):</pre>
<pre class='cython code score-149 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_107_fit_edges_polyfit(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_106_fit_edges_polyfit, "\n    Use polynomial interpolation of x at the low and high ends of the axis\n    to fill in the halflen values in y.\n\n    This function just calls _fit_edge twice, once for each end of the axis.\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_107_fit_edges_polyfit = {"_fit_edges_polyfit", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_107_fit_edges_polyfit, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_106_fit_edges_polyfit};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_107_fit_edges_polyfit(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_window_length = 0;
  PyObject *__pyx_v_polyorder = 0;
  PyObject *__pyx_v_deriv = 0;
  PyObject *__pyx_v_delta = 0;
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_y = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_fit_edges_polyfit (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_window_length,&amp;__pyx_n_s_polyorder,&amp;__pyx_n_s_deriv,&amp;__pyx_n_s_delta,&amp;__pyx_n_s_axis,&amp;__pyx_n_s_y,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_window_length)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edges_polyfit", 1, 7, 7, 1); <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_polyorder)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edges_polyfit", 1, 7, 7, 2); <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deriv)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[3]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edges_polyfit", 1, 7, 7, 3); <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[4]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edges_polyfit", 1, 7, 7, 4); <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_axis)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[5]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edges_polyfit", 1, 7, 7, 5); <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (likely((values[6] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[6]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edges_polyfit", 1, 7, 7, 6); <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_fit_edges_polyfit") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 7)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
      values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
      values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
      values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
      values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
    }
    __pyx_v_x = values[0];
    __pyx_v_window_length = values[1];
    __pyx_v_polyorder = values[2];
    __pyx_v_deriv = values[3];
    __pyx_v_delta = values[4];
    __pyx_v_axis = values[5];
    __pyx_v_y = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_fit_edges_polyfit", 1, 7, 7, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._fit_edges_polyfit", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_106_fit_edges_polyfit(__pyx_self, __pyx_v_x, __pyx_v_window_length, __pyx_v_polyorder, __pyx_v_deriv, __pyx_v_delta, __pyx_v_axis, __pyx_v_y);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_106_fit_edges_polyfit(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_window_length, PyObject *__pyx_v_polyorder, PyObject *__pyx_v_deriv, PyObject *__pyx_v_delta, PyObject *__pyx_v_axis, PyObject *__pyx_v_y) {
  PyObject *__pyx_v_halflen = NULL;
  PyObject *__pyx_v_n = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__127)
  <span class='trace'>__Pyx_TraceCall</span>("_fit_edges_polyfit", __pyx_f[0], 4145, 0, <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._fit_edges_polyfit", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_halflen);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_n);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__221 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_x, __pyx_n_s_window_length, __pyx_n_s_polyorder, __pyx_n_s_deriv, __pyx_n_s_delta, __pyx_n_s_axis, __pyx_n_s_y, __pyx_n_s_halflen, __pyx_n_s_n);<span class='error_goto'> if (unlikely(!__pyx_tuple__221)) __PYX_ERR(0, 4145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__221);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__221);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4145,0,<span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_107_fit_edges_polyfit, 0, __pyx_n_s_fit_edges_polyfit, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__127));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_fit_edges_polyfit, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4145, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__127 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__221, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_fit_edges_polyfit, 4145, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__127)) __PYX_ERR(0, 4145, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4146</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4147</span>:     Use polynomial interpolation of x at the low and high ends of the axis</pre>
<pre class="cython line score-0">&#xA0;<span class="">4148</span>:     to fill in the halflen values in y.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4149</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4150</span>:     This function just calls _fit_edge twice, once for each end of the axis.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4151</span>:     """</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4152</span>:     halflen = window_length // 2</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4152,0,<span class='error_goto'>__PYX_ERR(0, 4152, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FloorDivideObjC</span>(__pyx_v_window_length, __pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_halflen = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4153</span>:     _fit_edge(x, 0, window_length, 0, halflen, axis,</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4153,0,<span class='error_goto'>__PYX_ERR(0, 4153, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_fit_edge);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4153, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4154</span>:               polyorder, deriv, delta, y)</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(4154,0,<span class='error_goto'>__PYX_ERR(0, 4154, __pyx_L1_error)</span>)
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[11] = {__pyx_t_3, __pyx_v_x, __pyx_int_0, __pyx_v_window_length, __pyx_int_0, __pyx_v_halflen, __pyx_v_axis, __pyx_v_polyorder, __pyx_v_deriv, __pyx_v_delta, __pyx_v_y};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 10+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4153, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4155</span>:     n = x.shape[axis]</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4155,0,<span class='error_goto'>__PYX_ERR(0, 4155, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_v_axis);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4155, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4156</span>:     _fit_edge(x, n - window_length, n, n - halflen, n, axis,</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(4156,0,<span class='error_goto'>__PYX_ERR(0, 4156, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_fit_edge);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_window_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_n, __pyx_v_halflen);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4157</span>:               polyorder, deriv, delta, y)</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(4157,0,<span class='error_goto'>__PYX_ERR(0, 4157, __pyx_L1_error)</span>)
  __pyx_t_6 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[11] = {__pyx_t_6, __pyx_v_x, __pyx_t_3, __pyx_v_n, __pyx_t_5, __pyx_v_n, __pyx_v_axis, __pyx_v_polyorder, __pyx_v_deriv, __pyx_v_delta, __pyx_v_y};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 10+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4156, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4158</span>: </pre>
<pre class="cython line score-171" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4159</span>: def savgol_filter(x, window_length, polyorder, deriv=0, delta=1.0,</pre>
<pre class='cython code score-171 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_109savgol_filter(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_108savgol_filter, " Apply a Savitzky-Golay filter to an array.\n\n    This is a 1-D filter. If `x`  has dimension greater than 1, `axis`\n    determines the axis along which the filter is applied.\n\n    Parameters\n    ----------\n    x : array_like\n        The data to be filtered. If `x` is not a single or double precision\n        floating point array, it will be converted to type ``numpy.float64``\n        before filtering.\n    window_length : int\n        The length of the filter window (i.e., the number of coefficients).\n        `window_length` must be a positive odd integer. If `mode` is 'interp',\n        `window_length` must be less than or equal to the size of `x`.\n    polyorder : int\n        The order of the polynomial used to fit the samples.\n        `polyorder` must be less than `window_length`.\n    deriv : int, optional\n        The order of the derivative to compute. This must be a\n        nonnegative integer. The default is 0, which means to filter\n        the data without differentiating.\n    delta : float, optional\n        The spacing of the samples to which the filter will be applied.\n        This is only used if deriv &gt; 0. Default is 1.0.\n    axis : int, optional\n        The axis of the array `x` along which the filter is to be applied.\n        Default is -1.\n    mode : str, optional\n        Must be 'mirror', 'constant', 'nearest', 'wrap' or 'interp'. This\n        determines the type of extension to use for the padded signal to\n        which the filter is applied.  When `mode` is 'constant', the padding\n        value is given by `cval`.  See the Notes for more details on 'mirror',\n        'constant', 'wrap', and 'nearest'.\n        When the 'interp' mode is selected (the default), no extension\n        is used.  Instead, a degree `polyorder` polynomial is fit to the\n        last `window_length` values of the edges, and this polynomial is\n        used to evaluate the last `window_length // 2` output values.\n    cval : scalar, optional\n      ""  Value to fill past the edges of the input if `mode` is 'constant'.\n        Default is 0.0.\n\n    Returns\n    -------\n    y : ndarray, same shape as `x`\n        The filtered data.\n\n    See Also\n    --------\n    savgol_coeffs\n\n    Notes\n    -----\n    Details on the `mode` options:\n\n        'mirror':\n            Repeats the values at the edges in reverse order. The value\n            closest to the edge is not included.\n        'nearest':\n            The extension contains the nearest input value.\n        'constant':\n            The extension contains the value given by the `cval` argument.\n        'wrap':\n            The extension contains the values from the other end of the array.\n\n    For example, if the input is [1, 2, 3, 4, 5, 6, 7, 8], and\n    `window_length` is 7, the following shows the extended data for\n    the various `mode` options (assuming `cval` is 0)::\n\n        mode       |   Ext   |         Input          |   Ext\n        -----------+---------+------------------------+---------\n        'mirror'   | 4  3  2 | 1  2  3  4  5  6  7  8 | 7  6  5\n        'nearest'  | 1  1  1 | 1  2  3  4  5  6  7  8 | 8  8  8\n        'constant' | 0  0  0 | 1  2  3  4  5  6  7  8 | 0  0  0\n        'wrap'     | 6  7  8 | 1  2  3  4  5  6  7  8 | 1  2  3\n\n    .. versionadded:: 0.14.0\n\n    Examples\n    --------\n    &gt;&gt;&gt; from gofast.tools.mathex  import savgol_filter\n    &gt;&gt;&gt; np.set_printoptions(precision=2)  # For compact display.\n    &gt;&gt;&gt; x = np.array([2, 2, 5, 2, 1, 0, 1, 4, 9])\n\n    Filter with a window length of 5 and a degree 2 polynomial.  Use\n    the defaults for all other parameters.\n\n    &gt;&gt;&gt; savgol_filter(x, 5, 2)\n    array([1.66, 3.17, 3.54, 2.86, 0.66, 0.17, 1.  , 4.  , 9.  ])\n\n    Note that the last five values in x are samples of a parabola, so\n    when mode='interp' (the default) is used with polyorder=2, the last\n    three values are unchanged. Compare that to, for example,\n    `mode='nearest'`:\n\n    &gt;&gt;&gt; savgol_f""ilter(x, 5, 2, mode='nearest')\n    array([1.74, 3.03, 3.54, 2.86, 0.66, 0.17, 1.  , 4.6 , 7.97])\n\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_109savgol_filter = {"savgol_filter", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_109savgol_filter, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_108savgol_filter};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_109savgol_filter(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_window_length = 0;
  PyObject *__pyx_v_polyorder = 0;
  PyObject *__pyx_v_deriv = 0;
  PyObject *__pyx_v_delta = 0;
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_mode = 0;
  PyObject *__pyx_v_cval = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("savgol_filter (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_window_length,&amp;__pyx_n_s_polyorder,&amp;__pyx_n_s_deriv,&amp;__pyx_n_s_delta,&amp;__pyx_n_s_axis,&amp;__pyx_n_s_mode,&amp;__pyx_n_s_cval,0};
  PyObject* values[8] = {0,0,0,0,0,0,0,0};
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_0)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_1_0)));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_neg_1)));
    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_interp)));
    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_0)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_window_length)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("savgol_filter", 0, 3, 8, 1); <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_polyorder)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("savgol_filter", 0, 3, 8, 2); <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_deriv);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_delta);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_axis);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_mode);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  7:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_cval);
          if (value) { values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "savgol_filter") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  8: values[7] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 7);
        CYTHON_FALLTHROUGH;
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_x = values[0];
    __pyx_v_window_length = values[1];
    __pyx_v_polyorder = values[2];
    __pyx_v_deriv = values[3];
    __pyx_v_delta = values[4];
    __pyx_v_axis = values[5];
    __pyx_v_mode = values[6];
    __pyx_v_cval = values[7];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("savgol_filter", 0, 3, 8, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.savgol_filter", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_108savgol_filter(__pyx_self, __pyx_v_x, __pyx_v_window_length, __pyx_v_polyorder, __pyx_v_deriv, __pyx_v_delta, __pyx_v_axis, __pyx_v_mode, __pyx_v_cval);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_108savgol_filter(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_window_length, PyObject *__pyx_v_polyorder, PyObject *__pyx_v_deriv, PyObject *__pyx_v_delta, PyObject *__pyx_v_axis, PyObject *__pyx_v_mode, PyObject *__pyx_v_cval) {
  PyObject *__pyx_v_coeffs = NULL;
  PyObject *__pyx_v_y = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__128)
  <span class='trace'>__Pyx_TraceCall</span>("savgol_filter", __pyx_f[0], 4159, 0, <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.savgol_filter", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_coeffs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__222 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_x, __pyx_n_s_window_length, __pyx_n_s_polyorder, __pyx_n_s_deriv, __pyx_n_s_delta, __pyx_n_s_axis, __pyx_n_s_mode, __pyx_n_s_cval, __pyx_n_s_coeffs, __pyx_n_s_y);<span class='error_goto'> if (unlikely(!__pyx_tuple__222)) __PYX_ERR(0, 4159, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__222);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__222);
  __pyx_codeobj__128 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(8, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__222, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_savgol_filter, 4159, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__128)) __PYX_ERR(0, 4159, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4159,0,<span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_109savgol_filter, 0, __pyx_n_s_savgol_filter, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__128));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4159, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__223);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_savgol_filter, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4159, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__223 = <span class='py_c_api'>PyTuple_Pack</span>(5, ((PyObject *)__pyx_int_0), ((PyObject*)__pyx_float_1_0), ((PyObject *)__pyx_int_neg_1), ((PyObject*)__pyx_n_u_interp), ((PyObject*)__pyx_float_0_0));<span class='error_goto'> if (unlikely(!__pyx_tuple__223)) __PYX_ERR(0, 4159, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__223);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__223);
</pre><pre class="cython line score-0">&#xA0;<span class="">4160</span>:                   axis=-1, mode='interp', cval=0.0):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4161</span>:     """ Apply a Savitzky-Golay filter to an array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4162</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4163</span>:     This is a 1-D filter. If `x`  has dimension greater than 1, `axis`</pre>
<pre class="cython line score-0">&#xA0;<span class="">4164</span>:     determines the axis along which the filter is applied.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4165</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4166</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">4167</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4168</span>:     x : array_like</pre>
<pre class="cython line score-0">&#xA0;<span class="">4169</span>:         The data to be filtered. If `x` is not a single or double precision</pre>
<pre class="cython line score-0">&#xA0;<span class="">4170</span>:         floating point array, it will be converted to type ``numpy.float64``</pre>
<pre class="cython line score-0">&#xA0;<span class="">4171</span>:         before filtering.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4172</span>:     window_length : int</pre>
<pre class="cython line score-0">&#xA0;<span class="">4173</span>:         The length of the filter window (i.e., the number of coefficients).</pre>
<pre class="cython line score-0">&#xA0;<span class="">4174</span>:         `window_length` must be a positive odd integer. If `mode` is 'interp',</pre>
<pre class="cython line score-0">&#xA0;<span class="">4175</span>:         `window_length` must be less than or equal to the size of `x`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4176</span>:     polyorder : int</pre>
<pre class="cython line score-0">&#xA0;<span class="">4177</span>:         The order of the polynomial used to fit the samples.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4178</span>:         `polyorder` must be less than `window_length`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4179</span>:     deriv : int, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">4180</span>:         The order of the derivative to compute. This must be a</pre>
<pre class="cython line score-0">&#xA0;<span class="">4181</span>:         nonnegative integer. The default is 0, which means to filter</pre>
<pre class="cython line score-0">&#xA0;<span class="">4182</span>:         the data without differentiating.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4183</span>:     delta : float, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">4184</span>:         The spacing of the samples to which the filter will be applied.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4185</span>:         This is only used if deriv &gt; 0. Default is 1.0.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4186</span>:     axis : int, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">4187</span>:         The axis of the array `x` along which the filter is to be applied.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4188</span>:         Default is -1.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4189</span>:     mode : str, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">4190</span>:         Must be 'mirror', 'constant', 'nearest', 'wrap' or 'interp'. This</pre>
<pre class="cython line score-0">&#xA0;<span class="">4191</span>:         determines the type of extension to use for the padded signal to</pre>
<pre class="cython line score-0">&#xA0;<span class="">4192</span>:         which the filter is applied.  When `mode` is 'constant', the padding</pre>
<pre class="cython line score-0">&#xA0;<span class="">4193</span>:         value is given by `cval`.  See the Notes for more details on 'mirror',</pre>
<pre class="cython line score-0">&#xA0;<span class="">4194</span>:         'constant', 'wrap', and 'nearest'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4195</span>:         When the 'interp' mode is selected (the default), no extension</pre>
<pre class="cython line score-0">&#xA0;<span class="">4196</span>:         is used.  Instead, a degree `polyorder` polynomial is fit to the</pre>
<pre class="cython line score-0">&#xA0;<span class="">4197</span>:         last `window_length` values of the edges, and this polynomial is</pre>
<pre class="cython line score-0">&#xA0;<span class="">4198</span>:         used to evaluate the last `window_length // 2` output values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4199</span>:     cval : scalar, optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">4200</span>:         Value to fill past the edges of the input if `mode` is 'constant'.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4201</span>:         Default is 0.0.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4202</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4203</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">4204</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4205</span>:     y : ndarray, same shape as `x`</pre>
<pre class="cython line score-0">&#xA0;<span class="">4206</span>:         The filtered data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4207</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4208</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">4209</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4210</span>:     savgol_coeffs</pre>
<pre class="cython line score-0">&#xA0;<span class="">4211</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4212</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">4213</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">4214</span>:     Details on the `mode` options:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4215</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4216</span>:         'mirror':</pre>
<pre class="cython line score-0">&#xA0;<span class="">4217</span>:             Repeats the values at the edges in reverse order. The value</pre>
<pre class="cython line score-0">&#xA0;<span class="">4218</span>:             closest to the edge is not included.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4219</span>:         'nearest':</pre>
<pre class="cython line score-0">&#xA0;<span class="">4220</span>:             The extension contains the nearest input value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4221</span>:         'constant':</pre>
<pre class="cython line score-0">&#xA0;<span class="">4222</span>:             The extension contains the value given by the `cval` argument.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4223</span>:         'wrap':</pre>
<pre class="cython line score-0">&#xA0;<span class="">4224</span>:             The extension contains the values from the other end of the array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4225</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4226</span>:     For example, if the input is [1, 2, 3, 4, 5, 6, 7, 8], and</pre>
<pre class="cython line score-0">&#xA0;<span class="">4227</span>:     `window_length` is 7, the following shows the extended data for</pre>
<pre class="cython line score-0">&#xA0;<span class="">4228</span>:     the various `mode` options (assuming `cval` is 0)::</pre>
<pre class="cython line score-0">&#xA0;<span class="">4229</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4230</span>:         mode       |   Ext   |         Input          |   Ext</pre>
<pre class="cython line score-0">&#xA0;<span class="">4231</span>:         -----------+---------+------------------------+---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4232</span>:         'mirror'   | 4  3  2 | 1  2  3  4  5  6  7  8 | 7  6  5</pre>
<pre class="cython line score-0">&#xA0;<span class="">4233</span>:         'nearest'  | 1  1  1 | 1  2  3  4  5  6  7  8 | 8  8  8</pre>
<pre class="cython line score-0">&#xA0;<span class="">4234</span>:         'constant' | 0  0  0 | 1  2  3  4  5  6  7  8 | 0  0  0</pre>
<pre class="cython line score-0">&#xA0;<span class="">4235</span>:         'wrap'     | 6  7  8 | 1  2  3  4  5  6  7  8 | 1  2  3</pre>
<pre class="cython line score-0">&#xA0;<span class="">4236</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4237</span>:     .. versionadded:: 0.14.0</pre>
<pre class="cython line score-0">&#xA0;<span class="">4238</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4239</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">4240</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4241</span>:     &gt;&gt;&gt; from gofast.tools.mathex  import savgol_filter</pre>
<pre class="cython line score-0">&#xA0;<span class="">4242</span>:     &gt;&gt;&gt; np.set_printoptions(precision=2)  # For compact display.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4243</span>:     &gt;&gt;&gt; x = np.array([2, 2, 5, 2, 1, 0, 1, 4, 9])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4244</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4245</span>:     Filter with a window length of 5 and a degree 2 polynomial.  Use</pre>
<pre class="cython line score-0">&#xA0;<span class="">4246</span>:     the defaults for all other parameters.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4247</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4248</span>:     &gt;&gt;&gt; savgol_filter(x, 5, 2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4249</span>:     array([1.66, 3.17, 3.54, 2.86, 0.66, 0.17, 1.  , 4.  , 9.  ])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4250</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4251</span>:     Note that the last five values in x are samples of a parabola, so</pre>
<pre class="cython line score-0">&#xA0;<span class="">4252</span>:     when mode='interp' (the default) is used with polyorder=2, the last</pre>
<pre class="cython line score-0">&#xA0;<span class="">4253</span>:     three values are unchanged. Compare that to, for example,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4254</span>:     `mode='nearest'`:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4255</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4256</span>:     &gt;&gt;&gt; savgol_filter(x, 5, 2, mode='nearest')</pre>
<pre class="cython line score-0">&#xA0;<span class="">4257</span>:     array([1.74, 3.03, 3.54, 2.86, 0.66, 0.17, 1.  , 4.6 , 7.97])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4258</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4259</span>:     """</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4260</span>:     if mode not in ["mirror", "constant", "nearest", "interp", "wrap"]:</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(4260,0,<span class='error_goto'>__PYX_ERR(0, 4260, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_mode);
  __pyx_t_1 = __pyx_v_mode;
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_1, __pyx_n_u_mirror, Py_NE)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4260, __pyx_L1_error)</span>
  if (__pyx_t_3) {
  } else {
    __pyx_t_2 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_1, __pyx_n_u_constant, Py_NE)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4260, __pyx_L1_error)</span>
  if (__pyx_t_3) {
  } else {
    __pyx_t_2 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_1, __pyx_n_u_nearest, Py_NE)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4260, __pyx_L1_error)</span>
  if (__pyx_t_3) {
  } else {
    __pyx_t_2 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_1, __pyx_n_u_interp, Py_NE)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4260, __pyx_L1_error)</span>
  if (__pyx_t_3) {
  } else {
    __pyx_t_2 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_1, __pyx_n_u_wrap, Py_NE)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4260, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_t_3;
  __pyx_L4_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_t_2;
  if (unlikely(__pyx_t_3)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4261</span>:         raise ValueError("mode must be 'mirror', 'constant', 'nearest' "</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(4261,0,<span class='error_goto'>__PYX_ERR(0, 4261, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__129, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4261, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 4261, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__129 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_mode_must_be_mirror_constant_nea);<span class='error_goto'> if (unlikely(!__pyx_tuple__129)) __PYX_ERR(0, 4261, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__129);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__129);
</pre><pre class="cython line score-0">&#xA0;<span class="">4262</span>:                          "'wrap' or 'interp'.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">4263</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4264</span>:     x = np.asarray(x)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(4264,0,<span class='error_goto'>__PYX_ERR(0, 4264, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4264, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4264, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_x};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4264, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_x, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4265</span>:     # Ensure that x is either single or double precision floating point.</pre>
<pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4266</span>:     if x.dtype != np.float64 and x.dtype != np.float32:</pre>
<pre class='cython code score-34 '>  <span class='trace'>__Pyx_TraceLine</span>(4266,0,<span class='error_goto'>__PYX_ERR(0, 4266, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_4, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4266, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4266, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (__pyx_t_2) {
  } else {
    __pyx_t_3 = __pyx_t_2;
    goto __pyx_L10_bool_binop_done;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4266, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_1, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4266, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4266, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = __pyx_t_2;
  __pyx_L10_bool_binop_done:;
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4267</span>:         x = x.astype(np.float64)</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(4267,0,<span class='error_goto'>__PYX_ERR(0, 4267, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4267, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4267, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4267, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_7};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4267, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_x, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4268</span>: </pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4269</span>:     coeffs = savgol_coeffs(window_length, polyorder, deriv=deriv, delta=delta)</pre>
<pre class='cython code score-30 '>  <span class='trace'>__Pyx_TraceLine</span>(4269,0,<span class='error_goto'>__PYX_ERR(0, 4269, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_savgol_coeffs);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_window_length);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_window_length);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_window_length)) <span class='error_goto'>__PYX_ERR(0, 4269, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_polyorder);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_polyorder);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_polyorder)) <span class='error_goto'>__PYX_ERR(0, 4269, __pyx_L1_error)</span>;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_deriv, __pyx_v_deriv) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4269, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_7, __pyx_n_s_delta, __pyx_v_delta) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4269, __pyx_L1_error)</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4269, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_coeffs = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4270</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4271</span>:     if mode == "interp":</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4271,0,<span class='error_goto'>__PYX_ERR(0, 4271, __pyx_L1_error)</span>)
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_mode, __pyx_n_u_interp, Py_EQ)); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4271, __pyx_L1_error)</span>
  if (__pyx_t_3) {
/* … */
    goto __pyx_L12;
  }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4272</span>:         if window_length &gt; x.size:</pre>
<pre class='cython code score-11 '>    <span class='trace'>__Pyx_TraceLine</span>(4272,0,<span class='error_goto'>__PYX_ERR(0, 4272, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_size);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4272, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_window_length, __pyx_t_5, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4272, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4272, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(__pyx_t_3)) {
/* … */
    }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4273</span>:             raise ValueError("If mode is 'interp', window_length must be less "</pre>
<pre class='cython code score-10 '>      <span class='trace'>__Pyx_TraceLine</span>(4273,0,<span class='error_goto'>__PYX_ERR(0, 4273, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__130, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4273, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='error_goto'>__PYX_ERR(0, 4273, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__130 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_If_mode_is_interp_window_length);<span class='error_goto'> if (unlikely(!__pyx_tuple__130)) __PYX_ERR(0, 4273, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__130);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__130);
</pre><pre class="cython line score-0">&#xA0;<span class="">4274</span>:                              "than or equal to the size of x.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">4275</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4276</span>:         # Do not pad. Instead, for the elements within `window_length // 2`</pre>
<pre class="cython line score-0">&#xA0;<span class="">4277</span>:         # of the ends of the sequence, use the polynomial that is fitted to</pre>
<pre class="cython line score-0">&#xA0;<span class="">4278</span>:         # the last `window_length` elements.</pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4279</span>:         y = convolve1d(x, coeffs, axis=axis, mode="constant")</pre>
<pre class='cython code score-30 '>    <span class='trace'>__Pyx_TraceLine</span>(4279,0,<span class='error_goto'>__PYX_ERR(0, 4279, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_convolve1d);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4279, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4279, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4279, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coeffs);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_coeffs);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_v_coeffs)) <span class='error_goto'>__PYX_ERR(0, 4279, __pyx_L1_error)</span>;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4279, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_axis, __pyx_v_axis) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4279, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_mode, __pyx_n_u_constant) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4279, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_5, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4279, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_y = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4280</span>:         _fit_edges_polyfit(x, window_length, polyorder, deriv, delta, axis, y)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(4280,0,<span class='error_goto'>__PYX_ERR(0, 4280, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_fit_edges_polyfit);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4280, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[8] = {__pyx_t_5, __pyx_v_x, __pyx_v_window_length, __pyx_v_polyorder, __pyx_v_deriv, __pyx_v_delta, __pyx_v_axis, __pyx_v_y};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 7+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4280, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4281</span>:     else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4282</span>:         # Any mode other than 'interp' is passed on to ndimage.convolve1d.</pre>
<pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4283</span>:         y = convolve1d(x, coeffs, axis=axis, mode=mode, cval=cval)</pre>
<pre class='cython code score-35 '>  <span class='trace'>__Pyx_TraceLine</span>(4283,0,<span class='error_goto'>__PYX_ERR(0, 4283, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_convolve1d);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4283, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4283, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4283, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_coeffs);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_coeffs);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_coeffs)) <span class='error_goto'>__PYX_ERR(0, 4283, __pyx_L1_error)</span>;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4283, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_axis, __pyx_v_axis) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4283, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_mode, __pyx_v_mode) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4283, __pyx_L1_error)</span>
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_cval, __pyx_v_cval) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4283, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_1, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4283, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_y = __pyx_t_7;
    __pyx_t_7 = 0;
  }
  __pyx_L12:;
</pre><pre class="cython line score-0">&#xA0;<span class="">4284</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4285</span>:     return y</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4285,0,<span class='error_goto'>__PYX_ERR(0, 4285, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
  __pyx_r = __pyx_v_y;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4286</span>: </pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4287</span>: def compute_errors (</pre>
<pre class='cython code score-52 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_111compute_errors(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_110compute_errors, " Compute Errors ( Standard Deviation ) and standard errors. \n    \n    Standard error and standard deviation are both measures of variability:\n    - The standard deviation describes variability within a single sample. Its\n      formula is given as: \n          \n      .. math:: \n          \n          SD = \\sqrt{ \\sum |x -\\mu|^2}{N}\n          \n      where :math:`\\sum` means the \"sum of\", :math:`x` is the value in the data \n      set,:math:`\\mu` is the mean of the data set and :math:`N` is the number \n      of the data points in the population. :math:`SD` is the quantity \n      expressing by how much the members of a group differ from the mean \n      value for the group.\n      \n    - The standard error estimates the variability across multiple \n      samples of a population. Different formulas are used depending on \n      whether the population standard deviation is known.\n      \n      - when the population standard deviation is known: \n      \n        .. math:: \n          \n            SE = \014rac{SD}{\\sqrt{N}} \n            \n      - When the population parameter is unknwon \n      \n        .. math:: \n            \n            SE = \014rac{s}{\\sqrt{N}} \n            \n       where :math:`SE` is the standard error, : math:`s` is the sample\n       standard deviation. When the population standard is knwon the \n       :math:`SE` is more accurate. \n    \n    Note that the :math:`SD` is  a descriptive statistic that can be \n    calculated from sample data. In contrast, the standard error is an \n    inferential statistic that can only be estimated \n    (unless the real population parameter is known). \n    \n    Parameters\n    ----------\n    arr : array_like , 1D or 2D \n      Array for computing the standard deviation \n      \n    error: str, default='std'\n      Name of error to compute. By default compute the standard deviation. \n      Can also compute the the standard error estimation if the  argument \n      is passed to ``ste``"". \n    return_confidence: bool, default=False, \n      If ``True``, returns the confidence interval with 95% of sample means \n      \n    Returns \n    --------\n    err: arraylike 1D or 2D \n       Error array. \n       \n    Examples\n    ---------\n    &gt;&gt;&gt; from gofast.tools.mathex  import compute_errors\n    &gt;&gt;&gt; from gofast.datasets import make_mining_ops \n    &gt;&gt;&gt; mdata = make_mining_ops ( samples =20, as_frame=True, noises=\"20%\", return_X_y=False)\n    &gt;&gt;&gt; compute_errors (mdata)\n    Easting_m                    301.216454\n    Northing_m                   301.284073\n    Depth_m                      145.343063\n    OreConcentration_Percent       5.908375\n    DrillDiameter_mm              50.019249\n    BlastHoleDepth_m               3.568771\n    ExplosiveAmount_kg           142.908481\n    EquipmentAge_years             4.537603\n    DailyProduction_tonnes      2464.819019\n    dtype: float64\n    &gt;&gt;&gt; compute_errors ( mdata, return_confidence= True)\n    (Easting_m                   -100.015509\n     Northing_m                  -181.088446\n     Depth_m                      -67.948155\n     OreConcentration_Percent      -3.316211\n     DrillDiameter_mm              25.820805\n     BlastHoleDepth_m               1.733541\n     ExplosiveAmount_kg             3.505198\n     EquipmentAge_years            -1.581202\n     DailyProduction_tonnes      1058.839261\n     dtype: float64,\n     Easting_m                    1080.752992\n     Northing_m                    999.945119\n     Depth_m                       501.796651\n     OreConcentration_Percent       19.844618\n     DrillDiameter_mm              221.896260\n     BlastHoleDepth_m               15.723123\n     ExplosiveAmount_kg            563.706443\n     EquipmentAge_years             16.206202\n     DailyProduction_tonnes      10720.929814\n     dtype: float64)\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_111compute_errors = {"compute_errors", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_111compute_errors, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_110compute_errors};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_111compute_errors(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_arr = 0;
  PyObject *__pyx_v_error = 0;
  PyObject *__pyx_v_axis = 0;
  PyObject *__pyx_v_return_confidence = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_errors (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_arr,&amp;__pyx_n_s_error,&amp;__pyx_n_s_axis,&amp;__pyx_n_s_return_confidence,0};
  PyObject* values[4] = {0,0,0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_n_u_std)));
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_0)));
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_110compute_errors(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_arr, PyObject *__pyx_v_error, PyObject *__pyx_v_axis, PyObject *__pyx_v_return_confidence) {
  PyObject *__pyx_v_err = NULL;
  PyObject *__pyx_v_err_lower = NULL;
  PyObject *__pyx_v_err_upper = NULL;
  PyObject *__pyx_v_N = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__131)
  <span class='trace'>__Pyx_TraceCall</span>("compute_errors", __pyx_f[0], 4287, 0, <span class='error_goto'>__PYX_ERR(0, 4287, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_error);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_errors", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_err);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_err_lower);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_err_upper);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_N);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_error);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__224 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_arr, __pyx_n_s_error, __pyx_n_s_axis, __pyx_n_s_return_confidence, __pyx_n_s_err, __pyx_n_s_err_lower, __pyx_n_s_err_upper, __pyx_n_s_N);<span class='error_goto'> if (unlikely(!__pyx_tuple__224)) __PYX_ERR(0, 4287, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__224);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__224);
  __pyx_codeobj__131 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__224, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_compute_errors, 4287, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__131)) __PYX_ERR(0, 4287, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4287,0,<span class='error_goto'>__PYX_ERR(0, 4287, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_111compute_errors, 0, __pyx_n_s_compute_errors, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__131));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4287, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__225);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_errors, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4287, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__225 = <span class='py_c_api'>PyTuple_Pack</span>(3, ((PyObject*)__pyx_n_u_std), ((PyObject *)__pyx_int_0), ((PyObject *)Py_False));<span class='error_goto'> if (unlikely(!__pyx_tuple__225)) __PYX_ERR(0, 4287, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__225);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__225);
</pre><pre class="cython line score-0">&#xA0;<span class="">4288</span>:     arr,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4289</span>:     error ='std',</pre>
<pre class="cython line score-0">&#xA0;<span class="">4290</span>:     axis = 0,</pre>
<pre class="cython line score-64" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4291</span>:     return_confidence=False</pre>
<pre class='cython code score-64 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_arr)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4287, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_error);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4287, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_axis);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4287, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_confidence);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4287, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "compute_errors") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4287, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_arr = values[0];
    __pyx_v_error = values[1];
    __pyx_v_axis = values[2];
    __pyx_v_return_confidence = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_errors", 0, 1, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4287, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.compute_errors", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_110compute_errors(__pyx_self, __pyx_v_arr, __pyx_v_error, __pyx_v_axis, __pyx_v_return_confidence);
</pre><pre class="cython line score-0">&#xA0;<span class="">4292</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4293</span>:     """ Compute Errors ( Standard Deviation ) and standard errors.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4294</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4295</span>:     Standard error and standard deviation are both measures of variability:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4296</span>:     - The standard deviation describes variability within a single sample. Its</pre>
<pre class="cython line score-0">&#xA0;<span class="">4297</span>:       formula is given as:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4298</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4299</span>:       .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">4300</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4301</span>:           SD = \sqrt{ \sum |x -\mu|^2}{N}</pre>
<pre class="cython line score-0">&#xA0;<span class="">4302</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4303</span>:       where :math:`\sum` means the "sum of", :math:`x` is the value in the data</pre>
<pre class="cython line score-0">&#xA0;<span class="">4304</span>:       set,:math:`\mu` is the mean of the data set and :math:`N` is the number</pre>
<pre class="cython line score-0">&#xA0;<span class="">4305</span>:       of the data points in the population. :math:`SD` is the quantity</pre>
<pre class="cython line score-0">&#xA0;<span class="">4306</span>:       expressing by how much the members of a group differ from the mean</pre>
<pre class="cython line score-0">&#xA0;<span class="">4307</span>:       value for the group.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4308</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4309</span>:     - The standard error estimates the variability across multiple</pre>
<pre class="cython line score-0">&#xA0;<span class="">4310</span>:       samples of a population. Different formulas are used depending on</pre>
<pre class="cython line score-0">&#xA0;<span class="">4311</span>:       whether the population standard deviation is known.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4312</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4313</span>:       - when the population standard deviation is known:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4314</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4315</span>:         .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">4316</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4317</span>:             SE = \frac{SD}{\sqrt{N}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">4318</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4319</span>:       - When the population parameter is unknwon</pre>
<pre class="cython line score-0">&#xA0;<span class="">4320</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4321</span>:         .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">4322</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4323</span>:             SE = \frac{s}{\sqrt{N}}</pre>
<pre class="cython line score-0">&#xA0;<span class="">4324</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4325</span>:        where :math:`SE` is the standard error, : math:`s` is the sample</pre>
<pre class="cython line score-0">&#xA0;<span class="">4326</span>:        standard deviation. When the population standard is knwon the</pre>
<pre class="cython line score-0">&#xA0;<span class="">4327</span>:        :math:`SE` is more accurate.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4328</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4329</span>:     Note that the :math:`SD` is  a descriptive statistic that can be</pre>
<pre class="cython line score-0">&#xA0;<span class="">4330</span>:     calculated from sample data. In contrast, the standard error is an</pre>
<pre class="cython line score-0">&#xA0;<span class="">4331</span>:     inferential statistic that can only be estimated</pre>
<pre class="cython line score-0">&#xA0;<span class="">4332</span>:     (unless the real population parameter is known).</pre>
<pre class="cython line score-0">&#xA0;<span class="">4333</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4334</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">4335</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4336</span>:     arr : array_like , 1D or 2D</pre>
<pre class="cython line score-0">&#xA0;<span class="">4337</span>:       Array for computing the standard deviation</pre>
<pre class="cython line score-0">&#xA0;<span class="">4338</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4339</span>:     error: str, default='std'</pre>
<pre class="cython line score-0">&#xA0;<span class="">4340</span>:       Name of error to compute. By default compute the standard deviation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4341</span>:       Can also compute the the standard error estimation if the  argument</pre>
<pre class="cython line score-0">&#xA0;<span class="">4342</span>:       is passed to ``ste``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4343</span>:     return_confidence: bool, default=False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4344</span>:       If ``True``, returns the confidence interval with 95% of sample means</pre>
<pre class="cython line score-0">&#xA0;<span class="">4345</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4346</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">4347</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4348</span>:     err: arraylike 1D or 2D</pre>
<pre class="cython line score-0">&#xA0;<span class="">4349</span>:        Error array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4350</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4351</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">4352</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4353</span>:     &gt;&gt;&gt; from gofast.tools.mathex  import compute_errors</pre>
<pre class="cython line score-0">&#xA0;<span class="">4354</span>:     &gt;&gt;&gt; from gofast.datasets import make_mining_ops</pre>
<pre class="cython line score-0">&#xA0;<span class="">4355</span>:     &gt;&gt;&gt; mdata = make_mining_ops ( samples =20, as_frame=True, noises="20%", return_X_y=False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4356</span>:     &gt;&gt;&gt; compute_errors (mdata)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4357</span>:     Easting_m                    301.216454</pre>
<pre class="cython line score-0">&#xA0;<span class="">4358</span>:     Northing_m                   301.284073</pre>
<pre class="cython line score-0">&#xA0;<span class="">4359</span>:     Depth_m                      145.343063</pre>
<pre class="cython line score-0">&#xA0;<span class="">4360</span>:     OreConcentration_Percent       5.908375</pre>
<pre class="cython line score-0">&#xA0;<span class="">4361</span>:     DrillDiameter_mm              50.019249</pre>
<pre class="cython line score-0">&#xA0;<span class="">4362</span>:     BlastHoleDepth_m               3.568771</pre>
<pre class="cython line score-0">&#xA0;<span class="">4363</span>:     ExplosiveAmount_kg           142.908481</pre>
<pre class="cython line score-0">&#xA0;<span class="">4364</span>:     EquipmentAge_years             4.537603</pre>
<pre class="cython line score-0">&#xA0;<span class="">4365</span>:     DailyProduction_tonnes      2464.819019</pre>
<pre class="cython line score-0">&#xA0;<span class="">4366</span>:     dtype: float64</pre>
<pre class="cython line score-0">&#xA0;<span class="">4367</span>:     &gt;&gt;&gt; compute_errors ( mdata, return_confidence= True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4368</span>:     (Easting_m                   -100.015509</pre>
<pre class="cython line score-0">&#xA0;<span class="">4369</span>:      Northing_m                  -181.088446</pre>
<pre class="cython line score-0">&#xA0;<span class="">4370</span>:      Depth_m                      -67.948155</pre>
<pre class="cython line score-0">&#xA0;<span class="">4371</span>:      OreConcentration_Percent      -3.316211</pre>
<pre class="cython line score-0">&#xA0;<span class="">4372</span>:      DrillDiameter_mm              25.820805</pre>
<pre class="cython line score-0">&#xA0;<span class="">4373</span>:      BlastHoleDepth_m               1.733541</pre>
<pre class="cython line score-0">&#xA0;<span class="">4374</span>:      ExplosiveAmount_kg             3.505198</pre>
<pre class="cython line score-0">&#xA0;<span class="">4375</span>:      EquipmentAge_years            -1.581202</pre>
<pre class="cython line score-0">&#xA0;<span class="">4376</span>:      DailyProduction_tonnes      1058.839261</pre>
<pre class="cython line score-0">&#xA0;<span class="">4377</span>:      dtype: float64,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4378</span>:      Easting_m                    1080.752992</pre>
<pre class="cython line score-0">&#xA0;<span class="">4379</span>:      Northing_m                    999.945119</pre>
<pre class="cython line score-0">&#xA0;<span class="">4380</span>:      Depth_m                       501.796651</pre>
<pre class="cython line score-0">&#xA0;<span class="">4381</span>:      OreConcentration_Percent       19.844618</pre>
<pre class="cython line score-0">&#xA0;<span class="">4382</span>:      DrillDiameter_mm              221.896260</pre>
<pre class="cython line score-0">&#xA0;<span class="">4383</span>:      BlastHoleDepth_m               15.723123</pre>
<pre class="cython line score-0">&#xA0;<span class="">4384</span>:      ExplosiveAmount_kg            563.706443</pre>
<pre class="cython line score-0">&#xA0;<span class="">4385</span>:      EquipmentAge_years             16.206202</pre>
<pre class="cython line score-0">&#xA0;<span class="">4386</span>:      DailyProduction_tonnes      10720.929814</pre>
<pre class="cython line score-0">&#xA0;<span class="">4387</span>:      dtype: float64)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4388</span>:     """</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4389</span>:     error = _validate_name_in(error , defaults =('error', 'se'),</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(4389,0,<span class='error_goto'>__PYX_ERR(0, 4389, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_validate_name_in);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4389, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4389, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_error);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_error);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_error)) <span class='error_goto'>__PYX_ERR(0, 4389, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4389, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_defaults, __pyx_tuple__132) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4389, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4389,0,<span class='error_goto'>__PYX_ERR(0, 4389, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4389, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_error, __pyx_t_4);
  __pyx_t_4 = 0;
/* … */
  __pyx_tuple__132 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_u_error, __pyx_n_u_se);<span class='error_goto'> if (unlikely(!__pyx_tuple__132)) __PYX_ERR(0, 4389, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__132);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__132);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4390</span>:                               deep =True, expect_name ='se')</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(4390,0,<span class='error_goto'>__PYX_ERR(0, 4390, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_deep, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4389, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_expect_name, __pyx_n_u_se) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4389, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4391</span>:     # keep only the numeric values.</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4392</span>:     if hasattr (arr, '__array__') and hasattr(arr, 'columns'):</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(4392,0,<span class='error_goto'>__PYX_ERR(0, 4392, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(__pyx_v_arr, __pyx_n_u_array);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 4392, __pyx_L1_error)</span>
  if (__pyx_t_6) {
  } else {
    __pyx_t_5 = __pyx_t_6;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_HasAttr</span>(__pyx_v_arr, __pyx_n_u_columns);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((int)-1))) __PYX_ERR(0, 4392, __pyx_L1_error)</span>
  __pyx_t_5 = __pyx_t_6;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4393</span>:         arr = to_numeric_dtypes ( arr, pop_cat_features =True )</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(4393,0,<span class='error_goto'>__PYX_ERR(0, 4393, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_to_numeric_dtypes);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4393, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4393, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_arr);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_arr)) <span class='error_goto'>__PYX_ERR(0, 4393, __pyx_L1_error)</span>;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4393, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_pop_cat_features, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4393, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4393, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4394</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4395</span>:     if not _is_numeric_dtype(arr):</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(4395,0,<span class='error_goto'>__PYX_ERR(0, 4395, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_is_numeric_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4395, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_arr};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4395, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4395, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_6 = (!__pyx_t_5);
  if (unlikely(__pyx_t_6)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4396</span>:         raise TypeError("Numeric array is expected for operations.")</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(4396,0,<span class='error_goto'>__PYX_ERR(0, 4396, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_tuple__133, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 4396, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__133 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Numeric_array_is_expected_for_op);<span class='error_goto'> if (unlikely(!__pyx_tuple__133)) __PYX_ERR(0, 4396, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__133);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__133);
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4397</span>:     err= np.std (arr) if arr.ndim ==1 else np.std (arr, axis= axis )</pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(4397,0,<span class='error_goto'>__PYX_ERR(0, 4397, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arr, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4397, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_2, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4397, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_6) {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_std);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_arr};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4397, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    __pyx_t_1 = __pyx_t_2;
    __pyx_t_2 = 0;
  } else {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_std);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_arr);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_arr)) <span class='error_goto'>__PYX_ERR(0, 4397, __pyx_L1_error)</span>;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_v_axis) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4397, __pyx_L1_error)</span>
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_1 = __pyx_t_8;
    __pyx_t_8 = 0;
  }
  __pyx_v_err = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4398</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4399</span>:     err_lower =  err_upper = None</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4399,0,<span class='error_goto'>__PYX_ERR(0, 4399, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_err_lower = Py_None;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_err_upper = Py_None;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4400</span>:     if error =='se':</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4400,0,<span class='error_goto'>__PYX_ERR(0, 4400, __pyx_L1_error)</span>)
  __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_error, __pyx_n_u_se, Py_EQ)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4400, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4401</span>:         N = len(arr) if arr.ndim ==1 else arr.shape [axis ]</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(4401,0,<span class='error_goto'>__PYX_ERR(0, 4401, __pyx_L1_error)</span>)
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arr, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4401, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_t_8, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4401, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (__pyx_t_6) {
      __pyx_t_9 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_arr);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 4401, __pyx_L1_error)</span>
      __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4401, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_1 = __pyx_t_8;
      __pyx_t_8 = 0;
    } else {
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arr, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4401, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_8, __pyx_v_axis);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4401, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_1 = __pyx_t_3;
      __pyx_t_3 = 0;
    }
    __pyx_v_N = __pyx_t_1;
    __pyx_t_1 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4402</span>:         err =  err / np.sqrt(N)</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(4402,0,<span class='error_goto'>__PYX_ERR(0, 4402, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4402, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4402, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_N};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4402, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_err, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4402, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_err, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4403</span>:     if return_confidence:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4403,0,<span class='error_goto'>__PYX_ERR(0, 4403, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_confidence); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4403, __pyx_L1_error)</span>
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4404</span>:         err_lower = arr.mean() - ( 1.96 * err )</pre>
<pre class='cython code score-29 '>    <span class='trace'>__Pyx_TraceLine</span>(4404,0,<span class='error_goto'>__PYX_ERR(0, 4404, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arr, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4404, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 4404, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_1_96, __pyx_v_err);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4404, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_8, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4404, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_err_lower, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4405</span>:         err_upper = arr.mean() + ( 1.96 * err )</pre>
<pre class='cython code score-29 '>    <span class='trace'>__Pyx_TraceLine</span>(4405,0,<span class='error_goto'>__PYX_ERR(0, 4405, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arr, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4405, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_8, NULL};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4405, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_float_1_96, __pyx_v_err);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4405, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4405, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_err_upper, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4406</span>:     return err if not return_confidence else ( err_lower, err_upper)</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(4406,0,<span class='error_goto'>__PYX_ERR(0, 4406, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_confidence); if (unlikely((__pyx_t_6 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4406, __pyx_L1_error)</span>
  __pyx_t_5 = (!__pyx_t_6);
  if (__pyx_t_5) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_err);
    __pyx_t_8 = __pyx_v_err;
  } else {
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4406, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_err_lower);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_err_lower);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_err_lower)) <span class='error_goto'>__PYX_ERR(0, 4406, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_err_upper);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_err_upper);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_err_upper)) <span class='error_goto'>__PYX_ERR(0, 4406, __pyx_L1_error)</span>;
    __pyx_t_8 = __pyx_t_1;
    __pyx_t_1 = 0;
  }
  __pyx_r = __pyx_t_8;
  __pyx_t_8 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4407</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4408</span>: </pre>
<pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4409</span>: def quality_control2(</pre>
<pre class='cython code score-86 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_113quality_control2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_112quality_control2, "\n    Check the quality control in the collection of Z or EDI objects. \n    \n    Analyse the data in the EDI collection and return the quality control value.\n    It indicates how percentage are the data to be representative.\n   \n    Parameters \n    ----------\n    \n    ar: Arraylike of (m_samples, n_features)\n       Arraylike  two dimensional data.\n        \n    tol: float, default=.5 \n        the tolerance parameter. The value indicates the rate from which the \n        data can be consider as meaningful. Preferably it should be less than\n        1 and greater than 0.  Default is ``.5`` means 50 %. Analysis becomes \n        soft with higher `tol` values and severe otherwise. \n        \n    return_data: bool, default= False, \n        returns the valid data from up to ``1-tol%`` goodness. \n        \n    return qco: bool, default=False, \n       retuns quality control object that wraps all usefull informations after \n       control. The following attributes can be fetched as: \n           \n       - rate_: the rate of the quality of the data  \n       - component_: The selected component where data is selected for analysis \n         By default used either ``xy`` or ``yx``. \n       - mode_: The :term:`EM` mode. Either the ['TE'|'TM'] modes \n       - freqs_: The valid frequency in the data selected according to the \n         `tol` parameters. Note that if ``interpolate_freq`` is ``True``, it \n         is used instead. \n       - invalid_freqs_: Useless frequency dropped in the data during control \n       - data_: Valid tensor data either in TE or TM mode. \n       \n    Returns \n    -------\n    Tuple (float  )  or (float, array-like, shape (N, )) or QCo\n        - return the quality control value and interpolated frequency if  \n         `return_freq`  is set to ``True`` otherwise return the\n         only the quality control ratio.\n        - return the the quality control object. \n        \n    Examples \n    -----------\n    &gt;&gt;&gt; import gofast"" as gf \n    &gt;&gt;&gt; data = gf.fetch_data ('huayuan', samples =20, return_data =True ,\n                              key='raw')\n    &gt;&gt;&gt; r,= gf.qc (data)\n    r\n    Out[61]: 0.75\n    &gt;&gt;&gt; r, = gf.qc (data, tol=.2 )\n    0.75\n    &gt;&gt;&gt; r, = gf.qc (data, tol=.1 )\n    \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_113quality_control2 = {"quality_control2", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_113quality_control2, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_112quality_control2};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_113quality_control2(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_ar = 0;
  double __pyx_v_tol;
  PyObject *__pyx_v_return_data = 0;
  CYTHON_UNUSED PyObject *__pyx_v_to_log10 = 0;
  PyObject *__pyx_v_return_qco = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("quality_control2 (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_ar,&amp;__pyx_n_s_tol,&amp;__pyx_n_s_return_data,&amp;__pyx_n_s_to_log10,&amp;__pyx_n_s_return_qco,0};
  PyObject* values[5] = {0,0,0,0,0};
/* … */
  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_112quality_control2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_ar, double __pyx_v_tol, PyObject *__pyx_v_return_data, CYTHON_UNUSED PyObject *__pyx_v_to_log10, PyObject *__pyx_v_return_qco) {
  PyObject *__pyx_v_nan_sum = NULL;
  PyObject *__pyx_v_rr = NULL;
  PyObject *__pyx_v_ck = NULL;
  PyObject *__pyx_v_index = NULL;
  PyObject *__pyx_v_data = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__134)
  <span class='trace'>__Pyx_TraceCall</span>("quality_control2", __pyx_f[0], 4409, 0, <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_return_data);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.quality_control2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_nan_sum);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_rr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ck);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_index);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_data);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_return_data);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__226 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_ar, __pyx_n_s_tol, __pyx_n_s_return_data, __pyx_n_s_to_log10, __pyx_n_s_return_qco, __pyx_n_s_nan_sum, __pyx_n_s_rr, __pyx_n_s_ck, __pyx_n_s_index, __pyx_n_s_data);<span class='error_goto'> if (unlikely(!__pyx_tuple__226)) __PYX_ERR(0, 4409, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__226);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__226);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4409,0,<span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4409, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 3, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4409, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_tol, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_to_log10, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return_qco, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return, __pyx_kp_s_Tuple_float_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_113quality_control2, 0, __pyx_n_s_quality_control2, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__134));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4409, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_quality_control2, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__134 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__226, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_quality_control2, 4409, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__134)) __PYX_ERR(0, 4409, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4410</span>:     ar,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4411</span>:     tol: float= .5 ,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4411,0,<span class='error_goto'>__PYX_ERR(0, 4411, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double).5));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4411, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4412</span>:     return_data=False,</pre>
<pre class='cython code score-2 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4413</span>:     to_log10: bool =False,</pre>
<pre class='cython code score-2 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4414</span>:     return_qco:bool=False</pre>
<pre class='cython code score-87 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ar)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_tol);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_data);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_to_log10);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_return_qco);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "quality_control2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_ar = values[0];
    if (values[1]) {
      __pyx_v_tol = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_tol == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4411, __pyx_L3_error)</span>
    } else {
      __pyx_v_tol = ((double)((double).5));
    }
    __pyx_v_return_data = values[2];
    __pyx_v_to_log10 = values[3];
    __pyx_v_return_qco = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("quality_control2", 0, 1, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4409, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.quality_control2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_112quality_control2(__pyx_self, __pyx_v_ar, __pyx_v_tol, __pyx_v_return_data, __pyx_v_to_log10, __pyx_v_return_qco);
</pre><pre class="cython line score-0">&#xA0;<span class="">4415</span>:     )-&gt;Tuple[float, ArrayLike]:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4416</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4417</span>:     Check the quality control in the collection of Z or EDI objects.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4418</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4419</span>:     Analyse the data in the EDI collection and return the quality control value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4420</span>:     It indicates how percentage are the data to be representative.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4421</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4422</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">4423</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4424</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4425</span>:     ar: Arraylike of (m_samples, n_features)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4426</span>:        Arraylike  two dimensional data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4427</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4428</span>:     tol: float, default=.5</pre>
<pre class="cython line score-0">&#xA0;<span class="">4429</span>:         the tolerance parameter. The value indicates the rate from which the</pre>
<pre class="cython line score-0">&#xA0;<span class="">4430</span>:         data can be consider as meaningful. Preferably it should be less than</pre>
<pre class="cython line score-0">&#xA0;<span class="">4431</span>:         1 and greater than 0.  Default is ``.5`` means 50 %. Analysis becomes</pre>
<pre class="cython line score-0">&#xA0;<span class="">4432</span>:         soft with higher `tol` values and severe otherwise.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4433</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4434</span>:     return_data: bool, default= False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4435</span>:         returns the valid data from up to ``1-tol%`` goodness.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4436</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4437</span>:     return qco: bool, default=False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4438</span>:        retuns quality control object that wraps all usefull informations after</pre>
<pre class="cython line score-0">&#xA0;<span class="">4439</span>:        control. The following attributes can be fetched as:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4440</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4441</span>:        - rate_: the rate of the quality of the data</pre>
<pre class="cython line score-0">&#xA0;<span class="">4442</span>:        - component_: The selected component where data is selected for analysis</pre>
<pre class="cython line score-0">&#xA0;<span class="">4443</span>:          By default used either ``xy`` or ``yx``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4444</span>:        - mode_: The :term:`EM` mode. Either the ['TE'|'TM'] modes</pre>
<pre class="cython line score-0">&#xA0;<span class="">4445</span>:        - freqs_: The valid frequency in the data selected according to the</pre>
<pre class="cython line score-0">&#xA0;<span class="">4446</span>:          `tol` parameters. Note that if ``interpolate_freq`` is ``True``, it</pre>
<pre class="cython line score-0">&#xA0;<span class="">4447</span>:          is used instead.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4448</span>:        - invalid_freqs_: Useless frequency dropped in the data during control</pre>
<pre class="cython line score-0">&#xA0;<span class="">4449</span>:        - data_: Valid tensor data either in TE or TM mode.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4450</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4451</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">4452</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4453</span>:     Tuple (float  )  or (float, array-like, shape (N, )) or QCo</pre>
<pre class="cython line score-0">&#xA0;<span class="">4454</span>:         - return the quality control value and interpolated frequency if</pre>
<pre class="cython line score-0">&#xA0;<span class="">4455</span>:          `return_freq`  is set to ``True`` otherwise return the</pre>
<pre class="cython line score-0">&#xA0;<span class="">4456</span>:          only the quality control ratio.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4457</span>:         - return the the quality control object.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4458</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4459</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">4460</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4461</span>:     &gt;&gt;&gt; import gofast as gf</pre>
<pre class="cython line score-0">&#xA0;<span class="">4462</span>:     &gt;&gt;&gt; data = gf.fetch_data ('huayuan', samples =20, return_data =True ,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4463</span>:                               key='raw')</pre>
<pre class="cython line score-0">&#xA0;<span class="">4464</span>:     &gt;&gt;&gt; r,= gf.qc (data)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4465</span>:     r</pre>
<pre class="cython line score-0">&#xA0;<span class="">4466</span>:     Out[61]: 0.75</pre>
<pre class="cython line score-0">&#xA0;<span class="">4467</span>:     &gt;&gt;&gt; r, = gf.qc (data, tol=.2 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">4468</span>:     0.75</pre>
<pre class="cython line score-0">&#xA0;<span class="">4469</span>:     &gt;&gt;&gt; r, = gf.qc (data, tol=.1 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">4470</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4471</span>:     """</pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4472</span>:     tol = assert_ratio(tol , bounds =(0, 1), exclude_value ='use lower bound',</pre>
<pre class='cython code score-47 '>  <span class='trace'>__Pyx_TraceLine</span>(4472,0,<span class='error_goto'>__PYX_ERR(0, 4472, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_assert_ratio);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_tol);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4472, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_bounds, __pyx_tuple__13) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4472, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_exclude_value, __pyx_kp_u_use_lower_bound) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4472, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_name_2, __pyx_n_u_tolerance) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4472, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4472,0,<span class='error_goto'>__PYX_ERR(0, 4472, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4472, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_4); if (unlikely((__pyx_t_5 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4472, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_tol = __pyx_t_5;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4473</span>:                          name ='tolerance', in_percent =True )</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4473,0,<span class='error_goto'>__PYX_ERR(0, 4473, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_in_percent, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4472, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4474</span>:     # by default , we used the resistivity tensor and error at TE mode.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4475</span>:     # force using the error when resistivity or phase tensors are supplied</pre>
<pre class="cython line score-0">&#xA0;<span class="">4476</span>:     # compute the ratio of NaN in axis =0</pre>
<pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4477</span>:     nan_sum  =np.nansum(np.isnan(ar), axis =1)</pre>
<pre class='cython code score-43 '>  <span class='trace'>__Pyx_TraceLine</span>(4477,0,<span class='error_goto'>__PYX_ERR(0, 4477, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_nansum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_isnan);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_ar};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4477, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4477, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4477, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_nan_sum = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4478</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4479</span>:     rr= np.around ( nan_sum / ar.shape[1] , 2)</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(4479,0,<span class='error_goto'>__PYX_ERR(0, 4479, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_around);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ar, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_4, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_v_nan_sum, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4479, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_t_4, __pyx_int_2};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4479, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
  __pyx_v_rr = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4480</span>:     # print(rr); print(nan_sum)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4481</span>:     # print(rr[0])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4482</span>:     # print(nan_sum[rr[0]].sum())</pre>
<pre class="cython line score-0">&#xA0;<span class="">4483</span>:     # compute the ratio ck</pre>
<pre class="cython line score-0">&#xA0;<span class="">4484</span>:     # ck = 1. -    rr[np.nonzero(rr)[0]].sum() / (</pre>
<pre class="cython line score-0">&#xA0;<span class="">4485</span>:     #     1 if len(np.nonzero(rr)[0])== 0 else len(np.nonzero(rr)[0]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">4486</span>:     # ck =  (1. * len(rr) - len(rr[np.nonzero(rr)[0]]) )  / len(rr)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4487</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4488</span>:     # using np.nonzero(rr) seems deprecated</pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4489</span>:     ck = 1 - nan_sum[np.nonzero(rr)[0]].sum() / (</pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(4489,0,<span class='error_goto'>__PYX_ERR(0, 4489, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_nonzero);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_rr};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4489, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_nan_sum, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4489, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4489,0,<span class='error_goto'>__PYX_ERR(0, 4489, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_t_4, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_ck = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4490</span>:         ar.shape [0] * ar.shape [1])</pre>
<pre class='cython code score-17 '>  <span class='trace'>__Pyx_TraceLine</span>(4490,0,<span class='error_goto'>__PYX_ERR(0, 4490, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ar, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ar, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4491</span>:     # ck = 1 - nan_sum[rr[0]].sum() / (</pre>
<pre class="cython line score-0">&#xA0;<span class="">4492</span>:     #     ar.shape [0] * ar.shape [1])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4493</span>:     # now consider dirty data where the value is higher</pre>
<pre class="cython line score-0">&#xA0;<span class="">4494</span>:     # than the tol parameter and safe otherwise.</pre>
<pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4495</span>:     index = reshape (np.argwhere (rr &gt; tol))</pre>
<pre class='cython code score-48 '>  <span class='trace'>__Pyx_TraceLine</span>(4495,0,<span class='error_goto'>__PYX_ERR(0, 4495, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_argwhere);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_tol);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4495, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_rr, __pyx_t_1, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4495, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_8};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4495, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  __pyx_t_7 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_3};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4495, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_v_index = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4496</span>:     # ar_new = np.delete (rr , index , axis = 0 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">4497</span>:     # if return QCobj then block all returns  to True</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4498</span>:     if return_qco:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4498,0,<span class='error_goto'>__PYX_ERR(0, 4498, __pyx_L1_error)</span>)
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_qco); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4498, __pyx_L1_error)</span>
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4499</span>:         return_data = True</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(4499,0,<span class='error_goto'>__PYX_ERR(0, 4499, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_return_data, Py_True);
</pre><pre class="cython line score-0">&#xA0;<span class="">4500</span>: </pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4501</span>:     data =[ np.around (ck, 2) ]</pre>
<pre class='cython code score-26 '>  <span class='trace'>__Pyx_TraceLine</span>(4501,0,<span class='error_goto'>__PYX_ERR(0, 4501, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4501, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_around);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4501, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_4, __pyx_v_ck, __pyx_int_2};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4501, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4501, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4501, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_v_data = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4502</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4503</span>:     if return_data :</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4503,0,<span class='error_goto'>__PYX_ERR(0, 4503, __pyx_L1_error)</span>)
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_data); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4503, __pyx_L1_error)</span>
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4504</span>:         data += [ np.delete ( ar, index , axis =0 )]</pre>
<pre class='cython code score-42 '>    <span class='trace'>__Pyx_TraceLine</span>(4504,0,<span class='error_goto'>__PYX_ERR(0, 4504, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4504, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_delete);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4504, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4504, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ar);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ar);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_ar)) <span class='error_goto'>__PYX_ERR(0, 4504, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_index);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_index);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_index)) <span class='error_goto'>__PYX_ERR(0, 4504, __pyx_L1_error)</span>;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4504, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4504, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4504, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4504, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 4504, __pyx_L1_error)</span>;
    __pyx_t_7 = 0;
    __pyx_t_7 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_data, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4504, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4505</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4506</span>:     data = tuple (data )</pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(4506,0,<span class='error_goto'>__PYX_ERR(0, 4506, __pyx_L1_error)</span>)
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PySequence_Tuple</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4506, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4507</span>:     # make QCO object</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4508</span>:     if return_qco:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4508,0,<span class='error_goto'>__PYX_ERR(0, 4508, __pyx_L1_error)</span>)
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_qco); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4508, __pyx_L1_error)</span>
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4509</span>:         data = KeyBox( **dict (</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(4509,0,<span class='error_goto'>__PYX_ERR(0, 4509, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_KeyBox);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4509, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(4509,0,<span class='error_goto'>__PYX_ERR(0, 4509, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4509, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_data, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4510</span>:             tol=tol,</pre>
<pre class='cython code score-13 '>    <span class='trace'>__Pyx_TraceLine</span>(4510,0,<span class='error_goto'>__PYX_ERR(0, 4510, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4510, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_tol);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4510, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_tol, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4510, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4511</span>:             rate_= float(np.around (ck, 2)),</pre>
<pre class='cython code score-28 '>    <span class='trace'>__Pyx_TraceLine</span>(4511,0,<span class='error_goto'>__PYX_ERR(0, 4511, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4511, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_around);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4511, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_8, __pyx_v_ck, __pyx_int_2};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4511, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Float</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4511, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_rate, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4510, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4512</span>:             data_=  np.delete ( ar, index , axis =0 )</pre>
<pre class='cython code score-34 '>    <span class='trace'>__Pyx_TraceLine</span>(4512,0,<span class='error_goto'>__PYX_ERR(0, 4512, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_delete);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ar);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_ar);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_ar)) <span class='error_goto'>__PYX_ERR(0, 4512, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_index);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_index);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_index)) <span class='error_goto'>__PYX_ERR(0, 4512, __pyx_L1_error)</span>;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_axis, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4512, __pyx_L1_error)</span>
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 4512, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_data_2, __pyx_t_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4510, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_4 = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4513</span>:             )</pre>
<pre class="cython line score-0">&#xA0;<span class="">4514</span>:         )</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4515</span>:     return data</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4515,0,<span class='error_goto'>__PYX_ERR(0, 4515, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_data);
  __pyx_r = __pyx_v_data;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4516</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4517</span>: </pre>
<pre class="cython line score-80" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4518</span>: def get_distance(</pre>
<pre class='cython code score-80 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_115get_distance(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_114get_distance, "\n    Compute distance between points.\n    \n    Parameters\n    ------------\n    x, y: ArrayLike 1d, \n       One dimensional arrays. `x` can be consider as the abscissa of the  \n       landmark and `y` as ordinates array. \n       \n    return_mean_dist: bool, default =False, \n       Returns the average value of the distance between different points. \n       \n    is_latlon: bool, default=False, \n        Convert `x` and `y` latitude  and longitude coordinates values \n        into UTM before computing the distance. `x`, `y` should be considered \n        as ``easting`` and ``northing`` respectively. \n        \n    kws: dict, \n       Keyword arguments passed to :meth:`gofast.site.Location.to_utm_in`\n       \n    Returns \n    ---------\n    d: Arraylike of shape (N-1) \n      Is the distance between points. \n      \n    Examples \n    --------- \n    &gt;&gt;&gt; import numpy as np \n    &gt;&gt;&gt; from gofast.tools.mathex  import get_distance \n    &gt;&gt;&gt; x = np.random.rand (7) *10 \n    &gt;&gt;&gt; y = np.abs ( np.random.randn (7) * 12 ) \n    &gt;&gt;&gt; get_distance (x, y) \n    array([ 8.7665511 , 12.47545656,  8.53730212, 13.54998351, 14.0419387 ,\n           20.12086781])\n    &gt;&gt;&gt; get_distance (x, y, return_mean_dist= True) \n    12.91534996818084\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_115get_distance = {"get_distance", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_115get_distance, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_114get_distance};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_115get_distance(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_v_return_mean_dist = 0;
  PyObject *__pyx_v_is_latlon = 0;
  PyObject *__pyx_v_kws = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_distance (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kws = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kws)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kws);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_return_mean_dist,&amp;__pyx_n_s_is_latlon,0};
  PyObject* values[4] = {0,0,0,0};
/* … */
  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kws);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_114get_distance(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_return_mean_dist, PyObject *__pyx_v_is_latlon, PyObject *__pyx_v_kws) {
  PyObject *__pyx_v_d = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__135)
  <span class='trace'>__Pyx_TraceCall</span>("get_distance", __pyx_f[0], 4518, 0, <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_distance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_d);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__227 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_return_mean_dist, __pyx_n_s_is_latlon, __pyx_n_s_kws, __pyx_n_s_d);<span class='error_goto'> if (unlikely(!__pyx_tuple__227)) __PYX_ERR(0, 4518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__227);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__227);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4518,0,<span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_return_mean_dist, ((PyObject *)Py_False)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_is_latlon, ((PyObject *)Py_False)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_x, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_y, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_return_mean_dist, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_115get_distance, 0, __pyx_n_s_get_distance, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__135));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4518, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_3, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_distance, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_codeobj__135 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 2, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__227, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_get_distance, 4518, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__135)) __PYX_ERR(0, 4518, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4519</span>:     x: ArrayLike,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4520</span>:     y:ArrayLike , *,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4521</span>:     return_mean_dist:bool =False,</pre>
<pre class='cython code score-2 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4522</span>:     is_latlon= False ,</pre>
<pre class='cython code score-50 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_distance", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; (kw_args &lt;= 2)) {
        Py_ssize_t index;
        for (index = 2; index &lt; 4 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kws, values + 0, kwd_pos_args, "get_distance") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_x = values[0];
    __pyx_v_y = values[1];
    __pyx_v_return_mean_dist = values[2];
    __pyx_v_is_latlon = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_distance", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4518, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kws); __pyx_v_kws = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_distance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_114get_distance(__pyx_self, __pyx_v_x, __pyx_v_y, __pyx_v_return_mean_dist, __pyx_v_is_latlon, __pyx_v_kws);
</pre><pre class="cython line score-0">&#xA0;<span class="">4523</span>:     **kws</pre>
<pre class="cython line score-0">&#xA0;<span class="">4524</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4525</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4526</span>:     Compute distance between points.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4527</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4528</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">4529</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4530</span>:     x, y: ArrayLike 1d,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4531</span>:        One dimensional arrays. `x` can be consider as the abscissa of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">4532</span>:        landmark and `y` as ordinates array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4533</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4534</span>:     return_mean_dist: bool, default =False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4535</span>:        Returns the average value of the distance between different points.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4536</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4537</span>:     is_latlon: bool, default=False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4538</span>:         Convert `x` and `y` latitude  and longitude coordinates values</pre>
<pre class="cython line score-0">&#xA0;<span class="">4539</span>:         into UTM before computing the distance. `x`, `y` should be considered</pre>
<pre class="cython line score-0">&#xA0;<span class="">4540</span>:         as ``easting`` and ``northing`` respectively.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4541</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4542</span>:     kws: dict,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4543</span>:        Keyword arguments passed to :meth:`gofast.site.Location.to_utm_in`</pre>
<pre class="cython line score-0">&#xA0;<span class="">4544</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4545</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">4546</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4547</span>:     d: Arraylike of shape (N-1)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4548</span>:       Is the distance between points.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4549</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4550</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">4551</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4552</span>:     &gt;&gt;&gt; import numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">4553</span>:     &gt;&gt;&gt; from gofast.tools.mathex  import get_distance</pre>
<pre class="cython line score-0">&#xA0;<span class="">4554</span>:     &gt;&gt;&gt; x = np.random.rand (7) *10</pre>
<pre class="cython line score-0">&#xA0;<span class="">4555</span>:     &gt;&gt;&gt; y = np.abs ( np.random.randn (7) * 12 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">4556</span>:     &gt;&gt;&gt; get_distance (x, y)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4557</span>:     array([ 8.7665511 , 12.47545656,  8.53730212, 13.54998351, 14.0419387 ,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4558</span>:            20.12086781])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4559</span>:     &gt;&gt;&gt; get_distance (x, y, return_mean_dist= True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4560</span>:     12.91534996818084</pre>
<pre class="cython line score-0">&#xA0;<span class="">4561</span>:     """</pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4562</span>:     x, y = _assert_x_y_positions (x, y, is_latlon , **kws  )</pre>
<pre class='cython code score-74 '>  <span class='trace'>__Pyx_TraceLine</span>(4562,0,<span class='error_goto'>__PYX_ERR(0, 4562, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_assert_x_y_positions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4562, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 4562, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_is_latlon);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_is_latlon);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_v_is_latlon)) <span class='error_goto'>__PYX_ERR(0, 4562, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kws);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4562, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
    PyObject* sequence = __pyx_t_4;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 4562, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4562, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4562, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4562, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
    index = 0; __pyx_t_3 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    index = 1; __pyx_t_2 = __pyx_t_5(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_5(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4562, __pyx_L1_error)</span>
    __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 4562, __pyx_L1_error)</span>
    __pyx_L4_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_x, __pyx_t_3);
  __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4563</span>:     d = np.sqrt( np.diff (x) **2 + np.diff (y)**2 )</pre>
<pre class='cython code score-77 '>  <span class='trace'>__Pyx_TraceLine</span>(4563,0,<span class='error_goto'>__PYX_ERR(0, 4563, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_diff);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_x};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4563, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_t_6 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_2, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_diff);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_v_y};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4563, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_2, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_6, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4563, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_t_2};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4563, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_d = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4564</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4565</span>:     return d.mean()  if return_mean_dist else d</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(4565,0,<span class='error_goto'>__PYX_ERR(0, 4565, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_return_mean_dist); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4565, __pyx_L1_error)</span>
  if (__pyx_t_9) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_d, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4565, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_8 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_8, NULL};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4565, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_4 = __pyx_t_3;
    __pyx_t_3 = 0;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_d);
    __pyx_t_4 = __pyx_v_d;
  }
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4566</span>: </pre>
<pre class="cython line score-113" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4567</span>: def scale_positions (</pre>
<pre class='cython code score-113 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_117scale_positions(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_116scale_positions, "\n    Correct the position coordinates. \n     \n    By default, it consider `x` and `y` as easting/latitude and \n    northing/longitude coordinates respectively. It latitude and longitude \n    are given, specify the parameter `is_latlon` to ``True``. \n    \n    Parameters\n    ----------\n    x, y: ArrayLike 1d, \n       One dimensional arrays. `x` can be consider as the abscissa of the  \n       landmark and `y` as ordinates array. \n       \n    is_latlon: bool, default=False, \n       Convert `x` and `y` latitude  and longitude coordinates values \n       into UTM before computing the distance. `x`, `y` should be considered \n       as ``easting`` and ``northing`` respectively. \n           \n    step: float, Optional \n       The positions separation. If not given, the average distance between \n       all positions should be used instead. \n    use_average_dist: bool, default=False, \n       Use the distance computed between positions for the correction. \n    utm_zone: str,  Optional (##N or ##S)\n       UTM zone in the form of number and North or South hemisphere. For\n       instance '10S' or '03N'. Note that if `x` and `y` are UTM coordinates,\n       the `utm_zone` must be provide to accurately correct the positions, \n       otherwise the default value ``49R`` should be used which may lead to \n       less accuracy. \n       \n    shift: bool, default=True,\n       Shift the coordinates from the units of `step`. This is the default \n       behavor. If ``False``, the positions are just scaled. \n    \n    view: bool, default=True \n       Visualize the scaled positions \n       \n    kws: dict, \n       Keyword arguments passed to :func:`~.get_distance` \n    Returns \n    --------\n    xx, yy: Arraylike 1d, \n       The arrays of position correction from `x` and `y` using the \n       bearing. \n       \n    See Also \n    ---------\n    gofast.tools.mathex .get_bearing: \n        Compute the  direction of one point relative to another point. \n     "" \n    Examples\n    ---------\n    &gt;&gt;&gt; from gofast.tools.mathex  import scale_positions \n    &gt;&gt;&gt; east = [336698.731, 336714.574, 336730.305] \n    &gt;&gt;&gt; north = [3143970.128, 3143957.934, 3143945.76]\n    &gt;&gt;&gt; east_c , north_c= scale_positions (east, north, step =20, view =True  ) \n    &gt;&gt;&gt; east_c , north_c\n    (array([336686.69198337, 336702.53498337, 336718.26598337]),\n     array([3143986.09866306, 3143973.90466306, 3143961.73066306]))\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_117scale_positions = {"scale_positions", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_117scale_positions, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_116scale_positions};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_117scale_positions(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_v_is_latlon = 0;
  PyObject *__pyx_v_step = 0;
  PyObject *__pyx_v_use_average_dist = 0;
  PyObject *__pyx_v_utm_zone = 0;
  PyObject *__pyx_v_shift = 0;
  PyObject *__pyx_v_view = 0;
  PyObject *__pyx_v_kws = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("scale_positions (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kws = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kws)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kws);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_is_latlon,&amp;__pyx_n_s_step,&amp;__pyx_n_s_use_average_dist,&amp;__pyx_n_s_utm_zone,&amp;__pyx_n_s_shift,&amp;__pyx_n_s_view,0};
  PyObject* values[8] = {0,0,0,0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kws);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_116scale_positions(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_is_latlon, PyObject *__pyx_v_step, PyObject *__pyx_v_use_average_dist, PyObject *__pyx_v_utm_zone, PyObject *__pyx_v_shift, PyObject *__pyx_v_view, PyObject *__pyx_v_kws) {
  PyObject *__pyx_v_Location = NULL;
  PyObject *__pyx_v_msg = NULL;
  PyObject *__pyx_v_xs = NULL;
  PyObject *__pyx_v_ys = NULL;
  PyObject *__pyx_v_d = NULL;
  PyObject *__pyx_v_b = NULL;
  PyObject *__pyx_v_xx = NULL;
  PyObject *__pyx_v_yy = NULL;
  CYTHON_UNUSED PyObject *__pyx_v__ = NULL;
  PyObject *__pyx_v_state = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__136)
  <span class='trace'>__Pyx_TraceCall</span>("scale_positions", __pyx_f[0], 4567, 0, <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_use_average_dist);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_utm_zone);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.scale_positions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Location);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_msg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ys);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_d);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_b);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_yy);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_state);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_use_average_dist);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_utm_zone);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__228 = <span class='py_c_api'>PyTuple_Pack</span>(19, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_is_latlon, __pyx_n_s_step, __pyx_n_s_use_average_dist, __pyx_n_s_utm_zone, __pyx_n_s_shift, __pyx_n_s_view, __pyx_n_s_kws, __pyx_n_s_Location, __pyx_n_s_msg, __pyx_n_s_xs, __pyx_n_s_ys, __pyx_n_s_d, __pyx_n_s_b, __pyx_n_s_xx, __pyx_n_s_yy, __pyx_n_s__177, __pyx_n_s_state);<span class='error_goto'> if (unlikely(!__pyx_tuple__228)) __PYX_ERR(0, 4567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__228);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__228);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4567,0,<span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_is_latlon, ((PyObject *)Py_False)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4567,0,<span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_x, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_y, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_is_latlon, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_step, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_use_average_dist, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_utm_zone, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_shift, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_view, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_117scale_positions, 0, __pyx_n_s_scale_positions, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__136));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsKwDict</span>(__pyx_t_4, __pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_4, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_scale_positions, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__136 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 6, 19, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__228, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_scale_positions, 4567, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__136)) __PYX_ERR(0, 4567, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4568</span>:     x: ArrayLike,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4569</span>:     y:ArrayLike,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4570</span>:     *,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4571</span>:     is_latlon:bool=False,</pre>
<pre class='cython code score-2 '>    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4572</span>:     step:float= None,</pre>
<pre class='cython code score-12 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)Py_None));
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4572,0,<span class='error_goto'>__PYX_ERR(0, 4572, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_step, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_use_average_dist, ((PyObject *)Py_False)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4573</span>:     use_average_dist:bool=False,</pre>
<pre class='cython code score-2 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4574</span>:     utm_zone:str= None,</pre>
<pre class='cython code score-17 '>    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)Py_None));
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4574,0,<span class='error_goto'>__PYX_ERR(0, 4574, __pyx_L1_error)</span>)
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_utm_zone, Py_None) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_shift, ((PyObject *)Py_True)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_view, ((PyObject *)Py_False)) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4575</span>:     shift: bool=True,</pre>
<pre class='cython code score-2 '>    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
</pre><pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4576</span>:     view:bool = False,</pre>
<pre class='cython code score-54 '>    values[7] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scale_positions", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L3_error)</span>
        }
      }
      if (kw_args &gt; 0 &amp;&amp; (kw_args &lt;= 6)) {
        Py_ssize_t index;
        for (index = 2; index &lt; 8 &amp;&amp; kw_args &gt; 0; index++) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, *__pyx_pyargnames[index]);
          if (value) { values[index] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kws, values + 0, kwd_pos_args, "scale_positions") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_x = values[0];
    __pyx_v_y = values[1];
    __pyx_v_is_latlon = values[2];
    __pyx_v_step = ((PyObject*)values[3]);
    __pyx_v_use_average_dist = values[4];
    __pyx_v_utm_zone = ((PyObject*)values[5]);
    __pyx_v_shift = values[6];
    __pyx_v_view = values[7];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("scale_positions", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4567, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kws); __pyx_v_kws = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.scale_positions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_step), (&amp;PyFloat_Type), 1, "step", 1))) <span class='error_goto'>__PYX_ERR(0, 4572, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_utm_zone), (&amp;PyUnicode_Type), 1, "utm_zone", 1))) <span class='error_goto'>__PYX_ERR(0, 4574, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_116scale_positions(__pyx_self, __pyx_v_x, __pyx_v_y, __pyx_v_is_latlon, __pyx_v_step, __pyx_v_use_average_dist, __pyx_v_utm_zone, __pyx_v_shift, __pyx_v_view, __pyx_v_kws);
</pre><pre class="cython line score-0">&#xA0;<span class="">4577</span>:     **kws</pre>
<pre class="cython line score-0">&#xA0;<span class="">4578</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4579</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4580</span>:     Correct the position coordinates.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4581</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4582</span>:     By default, it consider `x` and `y` as easting/latitude and</pre>
<pre class="cython line score-0">&#xA0;<span class="">4583</span>:     northing/longitude coordinates respectively. It latitude and longitude</pre>
<pre class="cython line score-0">&#xA0;<span class="">4584</span>:     are given, specify the parameter `is_latlon` to ``True``.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4585</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4586</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">4587</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4588</span>:     x, y: ArrayLike 1d,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4589</span>:        One dimensional arrays. `x` can be consider as the abscissa of the</pre>
<pre class="cython line score-0">&#xA0;<span class="">4590</span>:        landmark and `y` as ordinates array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4591</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4592</span>:     is_latlon: bool, default=False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4593</span>:        Convert `x` and `y` latitude  and longitude coordinates values</pre>
<pre class="cython line score-0">&#xA0;<span class="">4594</span>:        into UTM before computing the distance. `x`, `y` should be considered</pre>
<pre class="cython line score-0">&#xA0;<span class="">4595</span>:        as ``easting`` and ``northing`` respectively.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4596</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4597</span>:     step: float, Optional</pre>
<pre class="cython line score-0">&#xA0;<span class="">4598</span>:        The positions separation. If not given, the average distance between</pre>
<pre class="cython line score-0">&#xA0;<span class="">4599</span>:        all positions should be used instead.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4600</span>:     use_average_dist: bool, default=False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4601</span>:        Use the distance computed between positions for the correction.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4602</span>:     utm_zone: str,  Optional (##N or ##S)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4603</span>:        UTM zone in the form of number and North or South hemisphere. For</pre>
<pre class="cython line score-0">&#xA0;<span class="">4604</span>:        instance '10S' or '03N'. Note that if `x` and `y` are UTM coordinates,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4605</span>:        the `utm_zone` must be provide to accurately correct the positions,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4606</span>:        otherwise the default value ``49R`` should be used which may lead to</pre>
<pre class="cython line score-0">&#xA0;<span class="">4607</span>:        less accuracy.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4608</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4609</span>:     shift: bool, default=True,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4610</span>:        Shift the coordinates from the units of `step`. This is the default</pre>
<pre class="cython line score-0">&#xA0;<span class="">4611</span>:        behavor. If ``False``, the positions are just scaled.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4612</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4613</span>:     view: bool, default=True</pre>
<pre class="cython line score-0">&#xA0;<span class="">4614</span>:        Visualize the scaled positions</pre>
<pre class="cython line score-0">&#xA0;<span class="">4615</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4616</span>:     kws: dict,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4617</span>:        Keyword arguments passed to :func:`~.get_distance`</pre>
<pre class="cython line score-0">&#xA0;<span class="">4618</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">4619</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4620</span>:     xx, yy: Arraylike 1d,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4621</span>:        The arrays of position correction from `x` and `y` using the</pre>
<pre class="cython line score-0">&#xA0;<span class="">4622</span>:        bearing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4623</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4624</span>:     See Also</pre>
<pre class="cython line score-0">&#xA0;<span class="">4625</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4626</span>:     gofast.tools.mathex .get_bearing:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4627</span>:         Compute the  direction of one point relative to another point.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4628</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4629</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">4630</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4631</span>:     &gt;&gt;&gt; from gofast.tools.mathex  import scale_positions</pre>
<pre class="cython line score-0">&#xA0;<span class="">4632</span>:     &gt;&gt;&gt; east = [336698.731, 336714.574, 336730.305]</pre>
<pre class="cython line score-0">&#xA0;<span class="">4633</span>:     &gt;&gt;&gt; north = [3143970.128, 3143957.934, 3143945.76]</pre>
<pre class="cython line score-0">&#xA0;<span class="">4634</span>:     &gt;&gt;&gt; east_c , north_c= scale_positions (east, north, step =20, view =True  )</pre>
<pre class="cython line score-0">&#xA0;<span class="">4635</span>:     &gt;&gt;&gt; east_c , north_c</pre>
<pre class="cython line score-0">&#xA0;<span class="">4636</span>:     (array([336686.69198337, 336702.53498337, 336718.26598337]),</pre>
<pre class="cython line score-0">&#xA0;<span class="">4637</span>:      array([3143986.09866306, 3143973.90466306, 3143961.73066306]))</pre>
<pre class="cython line score-0">&#xA0;<span class="">4638</span>:     """</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4639</span>:     from ..site import Location</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(4639,0,<span class='error_goto'>__PYX_ERR(0, 4639, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Location);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Location);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_Location)) <span class='error_goto'>__PYX_ERR(0, 4639, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_site, __pyx_t_1, 2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Location);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4639, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_Location = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4640</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4641</span>:     msg =("x, y are not in longitude/latitude format  while 'utm_zone' is not"</pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(4641,0,<span class='error_goto'>__PYX_ERR(0, 4641, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_x_y_are_not_in_longitude_latitud);
  __pyx_v_msg = __pyx_kp_u_x_y_are_not_in_longitude_latitud;
</pre><pre class="cython line score-0">&#xA0;<span class="">4642</span>:           " supplied. Correction should be less accurate. Provide the UTM"</pre>
<pre class="cython line score-0">&#xA0;<span class="">4643</span>:           " zone to improve the accuracy.")</pre>
<pre class="cython line score-0">&#xA0;<span class="">4644</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4645</span>:     if is_latlon:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4645,0,<span class='error_goto'>__PYX_ERR(0, 4645, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_is_latlon); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4645, __pyx_L1_error)</span>
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4646</span>:         xs , ys = np.array(copy.deepcopy(x)) , np.array(copy.deepcopy(y))</pre>
<pre class='cython code score-78 '>    <span class='trace'>__Pyx_TraceLine</span>(4646,0,<span class='error_goto'>__PYX_ERR(0, 4646, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_deepcopy);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_x};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4646, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_1};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4646, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_copy);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_deepcopy);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4646, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_y};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4646, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    __pyx_t_8 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_t_1};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4646, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    __pyx_v_xs = __pyx_t_2;
    __pyx_t_2 = 0;
    __pyx_v_ys = __pyx_t_4;
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4647</span>: </pre>
<pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4648</span>:     x, y = _assert_x_y_positions( x, y, islatlon = is_latlon , **kws )</pre>
<pre class='cython code score-75 '>  <span class='trace'>__Pyx_TraceLine</span>(4648,0,<span class='error_goto'>__PYX_ERR(0, 4648, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_assert_x_y_positions);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4648, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4648, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4648, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 4648, __pyx_L1_error)</span>;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4648, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_islatlon, __pyx_v_is_latlon) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4648, __pyx_L1_error)</span>
  __pyx_t_6 = __pyx_t_1;
  __pyx_t_1 = 0;
  if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_6, __pyx_v_kws) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4648, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4648, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
    PyObject* sequence = __pyx_t_1;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 4648, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    #else
    __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4648, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4648, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4648, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_4);
    index = 0; __pyx_t_6 = __pyx_t_9(__pyx_t_4); if (unlikely(!__pyx_t_6)) goto __pyx_L4_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    index = 1; __pyx_t_2 = __pyx_t_9(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L4_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_4), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4648, __pyx_L1_error)</span>
    __pyx_t_9 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L5_unpacking_done;
    __pyx_L4_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_9 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 4648, __pyx_L1_error)</span>
    __pyx_L5_unpacking_done:;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_x, __pyx_t_6);
  __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4649</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4650</span>:     if step is None:</pre>
<pre class='cython code score-0 '>  <span class='trace'>__Pyx_TraceLine</span>(4650,0,<span class='error_goto'>__PYX_ERR(0, 4650, __pyx_L1_error)</span>)
  __pyx_t_3 = (__pyx_v_step == ((PyObject*)Py_None));
  if (__pyx_t_3) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4651</span>:         warnings.warn("Step is not given. Average distance between points"</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(4651,0,<span class='error_goto'>__PYX_ERR(0, 4651, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4651, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_kp_u_Step_is_not_given_Average_distan};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4651, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4652</span>:                       " should be used instead.")</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4653</span>:         use_average_dist =True</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(4653,0,<span class='error_goto'>__PYX_ERR(0, 4653, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_use_average_dist, Py_True);
</pre><pre class="cython line score-0">&#xA0;<span class="">4654</span>:     else:</pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4655</span>:         d = float (_assert_all_types(step, float, int , objname ='Step (m)'))</pre>
<pre class='cython code score-31 '>  <span class='trace'>__Pyx_TraceLine</span>(4655,0,<span class='error_goto'>__PYX_ERR(0, 4655, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_assert_all_types);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_step);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_step);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_step)) <span class='error_goto'>__PYX_ERR(0, 4655, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)(&amp;PyFloat_Type));
    <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)(&amp;PyFloat_Type));
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, ((PyObject *)(&amp;PyFloat_Type)))) <span class='error_goto'>__PYX_ERR(0, 4655, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)(&amp;PyInt_Type));
    <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)(&amp;PyInt_Type));
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, ((PyObject *)(&amp;PyInt_Type)))) <span class='error_goto'>__PYX_ERR(0, 4655, __pyx_L1_error)</span>;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_objname, __pyx_kp_u_Step_m) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4655, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyNumber_Float</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4655, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_d = __pyx_t_2;
    __pyx_t_2 = 0;
  }
  __pyx_L6:;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4656</span>:     if use_average_dist:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4656,0,<span class='error_goto'>__PYX_ERR(0, 4656, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_use_average_dist); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4656, __pyx_L1_error)</span>
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4657</span>:         d = get_distance(x, y, return_mean_dist=use_average_dist,  **kws)</pre>
<pre class='cython code score-28 '>    <span class='trace'>__Pyx_TraceLine</span>(4657,0,<span class='error_goto'>__PYX_ERR(0, 4657, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_get_distance);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4657, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4657, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4657, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 4657, __pyx_L1_error)</span>;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4657, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_return_mean_dist, __pyx_v_use_average_dist) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4657, __pyx_L1_error)</span>
    __pyx_t_6 = __pyx_t_1;
    __pyx_t_1 = 0;
    if (<span class='pyx_c_api'>__Pyx_MergeKeywords</span>(__pyx_t_6, __pyx_v_kws) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4657, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4657, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_d, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4658</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4659</span>:     # compute bearing.</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4660</span>:     utm_zone = utm_zone or '49R'</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4660,0,<span class='error_goto'>__PYX_ERR(0, 4660, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_utm_zone); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4660, __pyx_L1_error)</span>
  if (!__pyx_t_3) {
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_utm_zone);
    __pyx_t_1 = __pyx_v_utm_zone;
    goto __pyx_L8_bool_binop_done;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_49R);
  __pyx_t_1 = __pyx_kp_u_49R;
  __pyx_L8_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_utm_zone, ((PyObject*)__pyx_t_1));
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4661</span>:     if not is_latlon and utm_zone is None:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4661,0,<span class='error_goto'>__PYX_ERR(0, 4661, __pyx_L1_error)</span>)
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_is_latlon); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4661, __pyx_L1_error)</span>
  __pyx_t_11 = (!__pyx_t_10);
  if (__pyx_t_11) {
  } else {
    __pyx_t_3 = __pyx_t_11;
    goto __pyx_L11_bool_binop_done;
  }
  __pyx_t_11 = (__pyx_v_utm_zone == ((PyObject*)Py_None));
  __pyx_t_3 = __pyx_t_11;
  __pyx_L11_bool_binop_done:;
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4662</span>:         warnings.warn(msg )</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(4662,0,<span class='error_goto'>__PYX_ERR(0, 4662, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4662, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4662, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_v_msg};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4662, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4663</span>:     if not is_latlon:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4663,0,<span class='error_goto'>__PYX_ERR(0, 4663, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_is_latlon); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4663, __pyx_L1_error)</span>
  __pyx_t_11 = (!__pyx_t_3);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4664</span>:         xs , ys = Location.to_latlon_in(x, y, utm_zone= utm_zone)</pre>
<pre class='cython code score-73 '>    <span class='trace'>__Pyx_TraceLine</span>(4664,0,<span class='error_goto'>__PYX_ERR(0, 4664, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_Location, __pyx_n_s_to_latlon_in);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4664, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 4664, __pyx_L1_error)</span>;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_utm_zone, __pyx_v_utm_zone) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4664, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4664, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 4664, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      #else
      __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4664, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4664, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4664, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);
      index = 0; __pyx_t_6 = __pyx_t_9(__pyx_t_1); if (unlikely(!__pyx_t_6)) goto __pyx_L14_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      index = 1; __pyx_t_4 = __pyx_t_9(__pyx_t_1); if (unlikely(!__pyx_t_4)) goto __pyx_L14_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_1), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4664, __pyx_L1_error)</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L15_unpacking_done;
      __pyx_L14_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 4664, __pyx_L1_error)</span>
      __pyx_L15_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_xs, __pyx_t_6);
    __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ys, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4665</span>: </pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4666</span>:     b = get_bearing((xs[0] , ys[0]) , (xs[-1], ys[-1]),</pre>
<pre class='cython code score-50 '>  <span class='trace'>__Pyx_TraceLine</span>(4666,0,<span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_get_bearing);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (unlikely(!__pyx_v_xs)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("xs"); <span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span> }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_xs, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (unlikely(!__pyx_v_ys)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("ys"); <span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span> }
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ys, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_6 = 0;
  if (unlikely(!__pyx_v_xs)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("xs"); <span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span> }
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_xs, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (unlikely(!__pyx_v_ys)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("ys"); <span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span> }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ys, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span>;
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_8 = 0;
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4666,0,<span class='error_goto'>__PYX_ERR(0, 4666, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4666, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_b = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4667</span>:                     to_deg =False ) # return bearing in rad.</pre>
<pre class='cython code score-7 '>  <span class='trace'>__Pyx_TraceLine</span>(4667,0,<span class='error_goto'>__PYX_ERR(0, 4667, __pyx_L1_error)</span>)
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4667, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_to_deg, Py_False) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4667, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4668</span>: </pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4669</span>:     xx = x + ( d * np.cos (b))</pre>
<pre class='cython code score-33 '>  <span class='trace'>__Pyx_TraceLine</span>(4669,0,<span class='error_goto'>__PYX_ERR(0, 4669, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_v_d)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("d"); <span class='error_goto'>__PYX_ERR(0, 4669, __pyx_L1_error)</span> }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_8)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_b};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4669, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_d, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_x, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4669, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_xx = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4670</span>:     yy = y +  (d * np.sin(b))</pre>
<pre class='cython code score-33 '>  <span class='trace'>__Pyx_TraceLine</span>(4670,0,<span class='error_goto'>__PYX_ERR(0, 4670, __pyx_L1_error)</span>)
  if (unlikely(!__pyx_v_d)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("d"); <span class='error_goto'>__PYX_ERR(0, 4670, __pyx_L1_error)</span> }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_7 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      __pyx_t_7 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_b};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4670, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_d, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_y, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4670, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_v_yy = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4671</span>:     if not shift:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4671,0,<span class='error_goto'>__PYX_ERR(0, 4671, __pyx_L1_error)</span>)
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_shift); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4671, __pyx_L1_error)</span>
  __pyx_t_3 = (!__pyx_t_11);
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4672</span>:         xx, *_ = scalePosition(x )</pre>
<pre class='cython code score-36 '>    <span class='trace'>__Pyx_TraceLine</span>(4672,0,<span class='error_goto'>__PYX_ERR(0, 4672, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_scalePosition);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_4 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_x};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4672, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    {
      Py_ssize_t index = -1;
      PyObject** temps[2] = {&amp;__pyx_t_8};
      __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4672, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_4);
      for (index=0; index &lt; 1; index++) {
        PyObject* item = __pyx_t_9(__pyx_t_4); if (unlikely(!item)) goto __pyx_L17_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      goto __pyx_L18_unpacking_done;
      __pyx_L17_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 4672, __pyx_L1_error)</span>
      __pyx_L18_unpacking_done:;
    }
    __pyx_t_2 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4672, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_xx, __pyx_t_8);
    __pyx_t_8 = 0;
    __pyx_v__ = ((PyObject*)__pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4673</span>:         yy, *_ = scalePosition(y)</pre>
<pre class='cython code score-37 '>    <span class='trace'>__Pyx_TraceLine</span>(4673,0,<span class='error_goto'>__PYX_ERR(0, 4673, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_scalePosition);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_8 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_v_y};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4673, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    {
      Py_ssize_t index = -1;
      PyObject** temps[2] = {&amp;__pyx_t_2};
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4673, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_8);
      for (index=0; index &lt; 1; index++) {
        PyObject* item = __pyx_t_9(__pyx_t_8); if (unlikely(!item)) goto __pyx_L19_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(item);
        *(temps[index]) = item;
      }
      goto __pyx_L20_unpacking_done;
      __pyx_L19_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 4673, __pyx_L1_error)</span>
      __pyx_L20_unpacking_done:;
    }
    __pyx_t_4 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4673, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_yy, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v__, ((PyObject*)__pyx_t_4));
    __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4674</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4675</span>:     if view:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4675,0,<span class='error_goto'>__PYX_ERR(0, 4675, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_view); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4675, __pyx_L1_error)</span>
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4676</span>:         state = f"{'scaled' if not shift else 'shifted'}"</pre>
<pre class='cython code score-7 '>    <span class='trace'>__Pyx_TraceLine</span>(4676,0,<span class='error_goto'>__PYX_ERR(0, 4676, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_shift); if (unlikely((__pyx_t_3 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4676, __pyx_L1_error)</span>
    __pyx_t_11 = (!__pyx_t_3);
    if (__pyx_t_11) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_scaled);
      __pyx_t_1 = __pyx_n_u_scaled;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_shifted);
      __pyx_t_1 = __pyx_n_u_shifted;
    }
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Unicode</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4676, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_state = ((PyObject*)__pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4677</span>:         plt.plot (x, y , 'ok-', label =f"Un{state} positions")</pre>
<pre class='cython code score-53 '>    <span class='trace'>__Pyx_TraceLine</span>(4677,0,<span class='error_goto'>__PYX_ERR(0, 4677, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4677, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_plot);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4677, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4677, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4677, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 4677, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_ok);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_ok);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_kp_u_ok)) <span class='error_goto'>__PYX_ERR(0, 4677, __pyx_L1_error)</span>;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4677, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4677, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_12 = 0;
    __pyx_t_13 = 127;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_Un);
    __pyx_t_12 += 2;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_Un);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_n_u_Un);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_state);
    __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_v_state) &gt; __pyx_t_13) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_v_state) : __pyx_t_13;
    __pyx_t_12 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_v_state);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_state);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_v_state);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_positions);
    __pyx_t_12 += 10;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_positions);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_kp_u_positions);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_8, 3, __pyx_t_12, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4677, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_label, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4677, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4677, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4678</span>:         plt.plot (xx , yy , 'or:', label =f"{state.title()} positions")</pre>
<pre class='cython code score-39 '>    <span class='trace'>__Pyx_TraceLine</span>(4678,0,<span class='error_goto'>__PYX_ERR(0, 4678, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_plot);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xx);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xx);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_xx)) <span class='error_goto'>__PYX_ERR(0, 4678, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_yy);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_yy);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_yy)) <span class='error_goto'>__PYX_ERR(0, 4678, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_or_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_or_2);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_kp_u_or_2)) <span class='error_goto'>__PYX_ERR(0, 4678, __pyx_L1_error)</span>;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = __Pyx_CallUnboundCMethod0(&amp;__pyx_umethod_PyUnicode_Type_title, __pyx_v_state);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_ConcatInPlace</span>(__pyx_t_8, __pyx_kp_u_positions);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_label, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4678, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4678, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-40" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4679</span>:         plt.xlabel ('x') ; plt.ylabel ('y')</pre>
<pre class='cython code score-40 '>    <span class='trace'>__Pyx_TraceLine</span>(4679,0,<span class='error_goto'>__PYX_ERR(0, 4679, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_xlabel);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_n_u_x};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4679, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_ylabel);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4679, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_n_u_y};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 1+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4679, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4680</span>:         plt.legend()</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(4680,0,<span class='error_goto'>__PYX_ERR(0, 4680, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4680, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_legend);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4680, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4680, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4681</span>:         plt.show ()</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(4681,0,<span class='error_goto'>__PYX_ERR(0, 4681, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_plt);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4681, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_show);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4681, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    __pyx_t_7 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
        __pyx_t_7 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_7, 0+__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4681, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4682</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4683</span>:     return xx, yy</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(4683,0,<span class='error_goto'>__PYX_ERR(0, 4683, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4683, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_xx);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_xx);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_xx)) <span class='error_goto'>__PYX_ERR(0, 4683, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_yy);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_yy);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_yy)) <span class='error_goto'>__PYX_ERR(0, 4683, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4684</span>: </pre>
<pre class="cython line score-122" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4685</span>: def _assert_x_y_positions (x, y , islatlon = False, is_utm=True,  **kws):</pre>
<pre class='cython code score-122 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_119_assert_x_y_positions(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_118_assert_x_y_positions, " Assert the position x and y and return array of x and y  ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_119_assert_x_y_positions = {"_assert_x_y_positions", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_119_assert_x_y_positions, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_118_assert_x_y_positions};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_119_assert_x_y_positions(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_v_islatlon = 0;
  CYTHON_UNUSED PyObject *__pyx_v_is_utm = 0;
  PyObject *__pyx_v_kws = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_assert_x_y_positions (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  __pyx_v_kws = <span class='py_c_api'>PyDict_New</span>(); if (unlikely(!__pyx_v_kws)) return NULL;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_kws);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,&amp;__pyx_n_s_islatlon,&amp;__pyx_n_s_is_utm,0};
  PyObject* values[4] = {0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4685, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4685, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_assert_x_y_positions", 0, 2, 4, 1); <span class='error_goto'>__PYX_ERR(0, 4685, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_islatlon);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4685, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_is_utm);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4685, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, __pyx_v_kws, values + 0, kwd_pos_args, "_assert_x_y_positions") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4685, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_x = values[0];
    __pyx_v_y = values[1];
    __pyx_v_islatlon = values[2];
    __pyx_v_is_utm = values[3];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_assert_x_y_positions", 0, 2, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4685, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kws); __pyx_v_kws = 0;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._assert_x_y_positions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_118_assert_x_y_positions(__pyx_self, __pyx_v_x, __pyx_v_y, __pyx_v_islatlon, __pyx_v_is_utm, __pyx_v_kws);

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_kws);
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_118_assert_x_y_positions(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y, PyObject *__pyx_v_islatlon, CYTHON_UNUSED PyObject *__pyx_v_is_utm, PyObject *__pyx_v_kws) {
  PyObject *__pyx_v_Location = NULL;
  PyObject *__pyx_v_ii = NULL;
  PyObject *__pyx_v_ar = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__137)
  <span class='trace'>__Pyx_TraceCall</span>("_assert_x_y_positions", __pyx_f[0], 4685, 0, <span class='error_goto'>__PYX_ERR(0, 4685, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._assert_x_y_positions", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Location);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ii);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ar);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__229 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_islatlon, __pyx_n_s_is_utm, __pyx_n_s_kws, __pyx_n_s_Location, __pyx_n_s_ii, __pyx_n_s_ar);<span class='error_goto'> if (unlikely(!__pyx_tuple__229)) __PYX_ERR(0, 4685, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__229);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__229);
  __pyx_codeobj__137 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS|CO_VARKEYWORDS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__229, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_assert_x_y_positions, 4685, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__137)) __PYX_ERR(0, 4685, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4685,0,<span class='error_goto'>__PYX_ERR(0, 4685, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_119_assert_x_y_positions, 0, __pyx_n_s_assert_x_y_positions, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__137));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4685, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_tuple__230);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_assert_x_y_positions, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4685, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_tuple__230 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject *)Py_False), ((PyObject *)Py_True));<span class='error_goto'> if (unlikely(!__pyx_tuple__230)) __PYX_ERR(0, 4685, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__230);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__230);
</pre><pre class="cython line score-0">&#xA0;<span class="">4686</span>:     """ Assert the position x and y and return array of x and y  """</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4687</span>:     from ..site import Location</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(4687,0,<span class='error_goto'>__PYX_ERR(0, 4687, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Location);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Location);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_Location)) <span class='error_goto'>__PYX_ERR(0, 4687, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_site, __pyx_t_1, 2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Location);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4687, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_Location = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4688</span>:     x = np.array(x, dtype = np.float64)</pre>
<pre class='cython code score-32 '>  <span class='trace'>__Pyx_TraceLine</span>(4688,0,<span class='error_goto'>__PYX_ERR(0, 4688, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4688, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4688, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4688, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_x, __pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4689</span>:     y = np.array(y, np.float64)</pre>
<pre class='cython code score-26 '>  <span class='trace'>__Pyx_TraceLine</span>(4689,0,<span class='error_goto'>__PYX_ERR(0, 4689, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4689, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_v_y, __pyx_t_1};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 4689, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y, __pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4690</span>:     for ii, ar in enumerate ([x, y]):</pre>
<pre class='cython code score-26 '>  <span class='trace'>__Pyx_TraceLine</span>(4690,0,<span class='error_goto'>__PYX_ERR(0, 4690, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_5 = __pyx_int_0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4690, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4690, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 4690, __pyx_L1_error)</span>;
  __pyx_t_1 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_7 &gt;= 2) break;
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_7++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4690, __pyx_L1_error)</span>
    #else
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4690, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    #endif
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ar, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ii, __pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_5, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4690, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5);
    __pyx_t_5 = __pyx_t_2;
    __pyx_t_2 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(4690,0,<span class='error_goto'>__PYX_ERR(0, 4690, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4691</span>:         if not _is_arraylike_1d(ar):</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(4691,0,<span class='error_goto'>__PYX_ERR(0, 4691, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_is_arraylike_1d);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4691, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_v_ar};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4691, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_8 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4691, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_9 = (!__pyx_t_8);
    if (unlikely(__pyx_t_9)) {
/* … */
    }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4692</span>:             raise TypeError (</pre>
<pre class='cython code score-6 '>      <span class='trace'>__Pyx_TraceLine</span>(4692,0,<span class='error_goto'>__PYX_ERR(0, 4692, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4692, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 4692, __pyx_L1_error)</span>
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4693</span>:                 f"Expect one-dimensional array for {'x' if ii==0 else 'y'!r}."</pre>
<pre class='cython code score-31 '>      <span class='trace'>__Pyx_TraceLine</span>(4693,0,<span class='error_goto'>__PYX_ERR(0, 4693, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4693, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_10 = 0;
      __pyx_t_11 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Expect_one_dimensional_array_for);
      __pyx_t_10 += 33;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Expect_one_dimensional_array_for);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_Expect_one_dimensional_array_for);
      __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_v_ii, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4693, __pyx_L1_error)</span>
      if (__pyx_t_9) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_x);
        __pyx_t_3 = __pyx_n_u_x;
      } else {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_y);
        __pyx_t_3 = __pyx_n_u_y;
      }
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Repr</span>(__pyx_t_3), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4693, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_11) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_11;
      __pyx_t_10 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_4);
      __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Got_x_ndim_d);
      __pyx_t_10 += 16;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Got_x_ndim_d);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_Got_x_ndim_d);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 3, __pyx_t_10, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4693, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4694</span>:                 " Got {x.ndim}d.")</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4695</span>:         if len(ar) &lt;= 1:</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(4695,0,<span class='error_goto'>__PYX_ERR(0, 4695, __pyx_L1_error)</span>)
    __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_ar);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 4695, __pyx_L1_error)</span>
    __pyx_t_9 = (__pyx_t_10 &lt;= 1);
    if (unlikely(__pyx_t_9)) {
/* … */
    }
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4696</span>:             raise ValueError (f"A singleton array {'x' if ii==0 else 'y'!r} is"</pre>
<pre class='cython code score-37 '>      <span class='trace'>__Pyx_TraceLine</span>(4696,0,<span class='error_goto'>__PYX_ERR(0, 4696, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4696, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_10 = 0;
      __pyx_t_11 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_A_singleton_array);
      __pyx_t_10 += 18;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_A_singleton_array);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_A_singleton_array);
      __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolEqObjC</span>(__pyx_v_ii, __pyx_int_0, 0, 0)); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4696, __pyx_L1_error)</span>
      if (__pyx_t_9) {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_x);
        __pyx_t_4 = __pyx_n_u_x;
      } else {
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_y);
        __pyx_t_4 = __pyx_n_u_y;
      }
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Repr</span>(__pyx_t_4), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4696, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_11) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_11;
      __pyx_t_10 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_is_not_admitted_Expect_at_least);
      __pyx_t_10 += 68;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_is_not_admitted_Expect_at_least);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_is_not_admitted_Expect_at_least);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 3, __pyx_t_10, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4696, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_ValueError, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4696, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 4696, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4697</span>:                               " not admitted. Expect at least two points"</pre>
<pre class="cython line score-0">&#xA0;<span class="">4698</span>:                               " A(x1, y1) and B(x2, y2)")</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4699</span>:     if islatlon:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4699,0,<span class='error_goto'>__PYX_ERR(0, 4699, __pyx_L1_error)</span>)
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_islatlon); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4699, __pyx_L1_error)</span>
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4700</span>:         x , y = Location.to_utm_in(x, y, **kws)</pre>
<pre class='cython code score-71 '>    <span class='trace'>__Pyx_TraceLine</span>(4700,0,<span class='error_goto'>__PYX_ERR(0, 4700, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_Location, __pyx_n_s_to_utm_in);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4700, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4700, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4700, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 4700, __pyx_L1_error)</span>;
    __pyx_t_2 = <span class='py_c_api'>PyDict_Copy</span>(__pyx_v_kws);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4700, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4700, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
      PyObject* sequence = __pyx_t_3;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 4700, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      #else
      __pyx_t_2 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4700, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4700, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_5 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4700, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_5);
      index = 0; __pyx_t_2 = __pyx_t_12(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L9_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      index = 1; __pyx_t_1 = __pyx_t_12(__pyx_t_5); if (unlikely(!__pyx_t_1)) goto __pyx_L9_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_12(__pyx_t_5), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4700, __pyx_L1_error)</span>
      __pyx_t_12 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L10_unpacking_done;
      __pyx_L9_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_12 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 4700, __pyx_L1_error)</span>
      __pyx_L10_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_y, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4701</span>:     return x, y</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(4701,0,<span class='error_goto'>__PYX_ERR(0, 4701, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4701, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4701, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_y);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_y);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_v_y)) <span class='error_goto'>__PYX_ERR(0, 4701, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4702</span>: </pre>
<pre class="cython line score-101" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4703</span>: def get_bearing (latlon1, latlon2,  to_deg = True ):</pre>
<pre class='cython code score-101 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_121get_bearing(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_120get_bearing, "\n    Calculate the bearing between two points. \n     \n    A bearing can be defined as  a direction of one point relative \n    to another point, usually given as an angle measured clockwise \n    from north.\n    The formula of the bearing :math:`\010eta` between two points 1(lat1 , lon1)\n    and 2(lat2, lon2) is expressed as below: \n        \n    .. math:: \n        \010eta = atan2(sin(y_2-y_1)*cos(x_2), cos(x_1)*sin(x_2) \342\200\223                       sin(x_1)*cos(x_2)*cos(y_2-y_1))\n     \n    where: \n       \n       - :math:`x_1`(lat1): the latitude of the first coordinate\n       - :math:`y_1`(lon1): the longitude of the first coordinate\n       - :math:`x_2`(lat2) : the latitude of the second coordinate\n       - :math:`y_2`(lon2): the longitude of the second coordinate\n    \n    Parameters \n    ----------- \n    latlon: Tuple ( latitude, longitude) \n       A latitude and longitude coordinates of the first point in degree. \n    latlon2: Tuple ( latitude, longitude) \n       A latitude and longitude of coordinates of the second point in degree.  \n       \n    to_deg: bool, default=True \n       Convert the bearing from radians to degree. \n      \n    Returns \n    ---------\n    b: Value of bearing in degree ( default). \n    \n    See More \n    ----------\n    See more details by clicking in the link below: \n        https://mapscaping.com/how-to-calculate-bearing-between-two-coordinates/\n        \n    Examples \n    ---------\n    &gt;&gt;&gt; from gofast.tools import get_bearing \n    &gt;&gt;&gt; latlon1 = (28.41196763902007, 109.3328724432221) # (lat, lon) point 1\n    &gt;&gt;&gt; latlon2= (28.38756530909265, 109.36931920880758) # (lat, lon) point 2\n    &gt;&gt;&gt; get_bearing (latlon1, latlon2 )\n    127.26739270447973 # in degree \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_121get_bearing = {"get_bearing", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_121get_bearing, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_120get_bearing};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_121get_bearing(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_latlon1 = 0;
  PyObject *__pyx_v_latlon2 = 0;
  PyObject *__pyx_v_to_deg = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_bearing (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_latlon1,&amp;__pyx_n_s_latlon2,&amp;__pyx_n_s_to_deg,0};
  PyObject* values[3] = {0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_True)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_latlon1)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4703, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_latlon2)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4703, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_bearing", 0, 2, 3, 1); <span class='error_goto'>__PYX_ERR(0, 4703, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_to_deg);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4703, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "get_bearing") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4703, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_latlon1 = values[0];
    __pyx_v_latlon2 = values[1];
    __pyx_v_to_deg = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_bearing", 0, 2, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4703, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_bearing", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_120get_bearing(__pyx_self, __pyx_v_latlon1, __pyx_v_latlon2, __pyx_v_to_deg);

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_120get_bearing(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_latlon1, PyObject *__pyx_v_latlon2, PyObject *__pyx_v_to_deg) {
  PyObject *__pyx_v_lat1 = NULL;
  PyObject *__pyx_v_lon1 = NULL;
  PyObject *__pyx_v_lat2 = NULL;
  PyObject *__pyx_v_lon2 = NULL;
  PyObject *__pyx_v_b = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__138)
  <span class='trace'>__Pyx_TraceCall</span>("get_bearing", __pyx_f[0], 4703, 0, <span class='error_goto'>__PYX_ERR(0, 4703, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_latlon1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_latlon2);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.get_bearing", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lat1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lon1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lat2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_lon2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_b);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_latlon1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_latlon2);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__231 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_latlon1, __pyx_n_s_latlon2, __pyx_n_s_to_deg, __pyx_n_s_lat1, __pyx_n_s_lon1, __pyx_n_s_lat2, __pyx_n_s_lon2, __pyx_n_s_b);<span class='error_goto'> if (unlikely(!__pyx_tuple__231)) __PYX_ERR(0, 4703, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__231);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__231);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4703,0,<span class='error_goto'>__PYX_ERR(0, 4703, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_121get_bearing, 0, __pyx_n_s_get_bearing, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__138));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4703, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_tuple__169);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_bearing, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4703, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__138 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__231, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_get_bearing, 4703, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__138)) __PYX_ERR(0, 4703, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4704</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4705</span>:     Calculate the bearing between two points.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4706</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4707</span>:     A bearing can be defined as  a direction of one point relative</pre>
<pre class="cython line score-0">&#xA0;<span class="">4708</span>:     to another point, usually given as an angle measured clockwise</pre>
<pre class="cython line score-0">&#xA0;<span class="">4709</span>:     from north.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4710</span>:     The formula of the bearing :math:`\beta` between two points 1(lat1 , lon1)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4711</span>:     and 2(lat2, lon2) is expressed as below:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4712</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4713</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">4714</span>:         \beta = atan2(sin(y_2-y_1)*cos(x_2), cos(x_1)*sin(x_2) – \</pre>
<pre class="cython line score-0">&#xA0;<span class="">4715</span>:                       sin(x_1)*cos(x_2)*cos(y_2-y_1))</pre>
<pre class="cython line score-0">&#xA0;<span class="">4716</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4717</span>:     where:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4718</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4719</span>:        - :math:`x_1`(lat1): the latitude of the first coordinate</pre>
<pre class="cython line score-0">&#xA0;<span class="">4720</span>:        - :math:`y_1`(lon1): the longitude of the first coordinate</pre>
<pre class="cython line score-0">&#xA0;<span class="">4721</span>:        - :math:`x_2`(lat2) : the latitude of the second coordinate</pre>
<pre class="cython line score-0">&#xA0;<span class="">4722</span>:        - :math:`y_2`(lon2): the longitude of the second coordinate</pre>
<pre class="cython line score-0">&#xA0;<span class="">4723</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4724</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">4725</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4726</span>:     latlon: Tuple ( latitude, longitude)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4727</span>:        A latitude and longitude coordinates of the first point in degree.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4728</span>:     latlon2: Tuple ( latitude, longitude)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4729</span>:        A latitude and longitude of coordinates of the second point in degree.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4730</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4731</span>:     to_deg: bool, default=True</pre>
<pre class="cython line score-0">&#xA0;<span class="">4732</span>:        Convert the bearing from radians to degree.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4733</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4734</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">4735</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4736</span>:     b: Value of bearing in degree ( default).</pre>
<pre class="cython line score-0">&#xA0;<span class="">4737</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4738</span>:     See More</pre>
<pre class="cython line score-0">&#xA0;<span class="">4739</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4740</span>:     See more details by clicking in the link below:</pre>
<pre class="cython line score-0">&#xA0;<span class="">4741</span>:         https://mapscaping.com/how-to-calculate-bearing-between-two-coordinates/</pre>
<pre class="cython line score-0">&#xA0;<span class="">4742</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4743</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">4744</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4745</span>:     &gt;&gt;&gt; from gofast.tools import get_bearing</pre>
<pre class="cython line score-0">&#xA0;<span class="">4746</span>:     &gt;&gt;&gt; latlon1 = (28.41196763902007, 109.3328724432221) # (lat, lon) point 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4747</span>:     &gt;&gt;&gt; latlon2= (28.38756530909265, 109.36931920880758) # (lat, lon) point 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">4748</span>:     &gt;&gt;&gt; get_bearing (latlon1, latlon2 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">4749</span>:     127.26739270447973 # in degree</pre>
<pre class="cython line score-0">&#xA0;<span class="">4750</span>:     """</pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4751</span>:     latlon1 = reshape ( np.array ( latlon1, dtype = np.float64))</pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(4751,0,<span class='error_goto'>__PYX_ERR(0, 4751, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4751, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4751, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4751, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4751, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_latlon1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_latlon1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_latlon1)) <span class='error_goto'>__PYX_ERR(0, 4751, __pyx_L1_error)</span>;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4751, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4751, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4751, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4751, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4751, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_7};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4751, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_latlon1, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4752</span>:     latlon2 = reshape ( np.array ( latlon2, dtype = np.float64))</pre>
<pre class='cython code score-49 '>  <span class='trace'>__Pyx_TraceLine</span>(4752,0,<span class='error_goto'>__PYX_ERR(0, 4752, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_latlon2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_latlon2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_v_latlon2)) <span class='error_goto'>__PYX_ERR(0, 4752, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4752, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_7, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4752, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4752, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_latlon2, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4753</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4754</span>:     if len(latlon1) &lt;2 or len(latlon2) &lt;2 :</pre>
<pre class='cython code score-10 '>  <span class='trace'>__Pyx_TraceLine</span>(4754,0,<span class='error_goto'>__PYX_ERR(0, 4754, __pyx_L1_error)</span>)
  __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_latlon1);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 4754, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 &lt; 2);
  if (!__pyx_t_11) {
  } else {
    __pyx_t_9 = __pyx_t_11;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_latlon2);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((Py_ssize_t)-1))) __PYX_ERR(0, 4754, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_10 &lt; 2);
  __pyx_t_9 = __pyx_t_11;
  __pyx_L4_bool_binop_done:;
  if (unlikely(__pyx_t_9)) {
/* … */
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4755</span>:         raise ValueError("Wrong coordinates values. Need two coordinates"</pre>
<pre class='cython code score-10 '>    <span class='trace'>__Pyx_TraceLine</span>(4755,0,<span class='error_goto'>__PYX_ERR(0, 4755, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_ValueError, __pyx_tuple__139, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4755, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='error_goto'>__PYX_ERR(0, 4755, __pyx_L1_error)</span>
/* … */
  __pyx_tuple__139 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_kp_u_Wrong_coordinates_values_Need_tw);<span class='error_goto'> if (unlikely(!__pyx_tuple__139)) __PYX_ERR(0, 4755, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__139);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__139);
</pre><pre class="cython line score-0">&#xA0;<span class="">4756</span>:                          " (latitude and longitude) of points 1 and 2.")</pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4757</span>:     lat1 = np.deg2rad (latlon1[0]) ; lon1 = np.deg2rad(latlon1[1])</pre>
<pre class='cython code score-44 '>  <span class='trace'>__Pyx_TraceLine</span>(4757,0,<span class='error_goto'>__PYX_ERR(0, 4757, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_deg2rad);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_latlon1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_v_lat1 = __pyx_t_1;
  __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_deg2rad);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_latlon1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4757, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_lon1 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4758</span>:     lat2 = np.deg2rad (latlon2[0]) ; lon2 = np.deg2rad(latlon2[1])</pre>
<pre class='cython code score-44 '>  <span class='trace'>__Pyx_TraceLine</span>(4758,0,<span class='error_goto'>__PYX_ERR(0, 4758, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4758, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_deg2rad);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4758, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_latlon2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4758, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4758, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_v_lat2 = __pyx_t_1;
  __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4758, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_deg2rad);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4758, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_latlon2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4758, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4758, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_v_lon2 = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4759</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4760</span>:     b = np.arctan2 (</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4760,0,<span class='error_goto'>__PYX_ERR(0, 4760, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_arctan2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4761</span>:         np.sin(lon2 - lon1 )* np.cos (lat2),</pre>
<pre class='cython code score-51 '>  <span class='trace'>__Pyx_TraceLine</span>(4761,0,<span class='error_goto'>__PYX_ERR(0, 4761, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_lon2, __pyx_v_lon1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_3};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4761, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_lat2};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 4761, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_2, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4761, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-145" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4762</span>:         np.cos (lat1) * np.sin(lat2) - np.sin (lat1) * np.cos (lat2) * np.cos (lon2 - lon1)</pre>
<pre class='cython code score-145 '>  <span class='trace'>__Pyx_TraceLine</span>(4762,0,<span class='error_goto'>__PYX_ERR(0, 4762, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_lat1};
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 4762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_lat2};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_sin);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_lat1};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_v_lat2};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_12, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  }
  __pyx_t_12 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_cos);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_lon2, __pyx_v_lon1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_13 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_13)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_13, __pyx_t_3};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_12, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4762, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  __pyx_t_8 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_8 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_7, __pyx_t_5, __pyx_t_2};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_8, 2+__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4760, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_v_b = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4763</span>:                     )</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4764</span>:     if to_deg:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4764,0,<span class='error_goto'>__PYX_ERR(0, 4764, __pyx_L1_error)</span>)
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_to_deg); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4764, __pyx_L1_error)</span>
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">4765</span>:         # convert bearing to degree and make sure it</pre>
<pre class="cython line score-0">&#xA0;<span class="">4766</span>:         # is positive between 360 degree</pre>
<pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4767</span>:         b = ( np.rad2deg ( b) + 360 )% 360</pre>
<pre class='cython code score-26 '>    <span class='trace'>__Pyx_TraceLine</span>(4767,0,<span class='error_goto'>__PYX_ERR(0, 4767, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4767, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_rad2deg);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4767, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = NULL;
    __pyx_t_8 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_8 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_v_b};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_8, 1+__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4767, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_360, 0x168, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4767, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_RemainderObjC</span>(__pyx_t_2, __pyx_int_360, 0x168, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4767, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_b, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4768</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4769</span>:     return b</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4769,0,<span class='error_goto'>__PYX_ERR(0, 4769, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_b);
  __pyx_r = __pyx_v_b;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4770</span>: </pre>
<pre class="cython line score-82" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4771</span>: def find_closest( arr, values ):</pre>
<pre class='cython code score-82 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_123find_closest(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_122find_closest, "Get the closest value in array  from given values.\n    \n    Parameters \n    -----------\n    arr : Arraylike  \n       Array to find the values \n       \n    values: float, arraylike \n    \n    Returns\n    --------\n    closest values in float or array containing in the given array.\n    \n    Examples\n    -----------\n    &gt;&gt;&gt; import numpy as np \n    &gt;&gt;&gt; from gofast.tools.mathex  import find_closest\n    &gt;&gt;&gt; find_closest (  [ 2 , 3, 4, 5] , ( 2.6 , 5.6 )  )\n    array([3., 5.])\n    &gt;&gt;&gt; find_closest (  np.array ([[2 , 3], [ 4, 5]]), ( 2.6 , 5.6 ) )\n    array([3., 5.])\n    array([3., 5.])\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_123find_closest = {"find_closest", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_123find_closest, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_122find_closest};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_123find_closest(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_arr = 0;
  PyObject *__pyx_v_values = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find_closest (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_arr,&amp;__pyx_n_s_values,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_arr)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4771, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_values)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4771, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_closest", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 4771, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "find_closest") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4771, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_arr = values[0];
    __pyx_v_values = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find_closest", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4771, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.find_closest", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_122find_closest(__pyx_self, __pyx_v_arr, __pyx_v_values);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_122find_closest(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_arr, PyObject *__pyx_v_values) {
  CYTHON_UNUSED PyObject *__pyx_v_ar = NULL;
  PyObject *__pyx_v_v = NULL;
  PyObject *__pyx_9genexpr13__pyx_v_v = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__140)
  <span class='trace'>__Pyx_TraceCall</span>("find_closest", __pyx_f[0], 4771, 0, <span class='error_goto'>__PYX_ERR(0, 4771, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.find_closest", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ar);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr13__pyx_v_v);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_values);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__232 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_arr, __pyx_n_s_values, __pyx_n_s_ar, __pyx_n_s_v, __pyx_n_s_v);<span class='error_goto'> if (unlikely(!__pyx_tuple__232)) __PYX_ERR(0, 4771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__232);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__232);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4771,0,<span class='error_goto'>__PYX_ERR(0, 4771, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_123find_closest, 0, __pyx_n_s_find_closest, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__140));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4771, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_find_closest, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4771, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_codeobj__140 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__232, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_find_closest, 4771, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__140)) __PYX_ERR(0, 4771, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4772</span>:     """Get the closest value in array  from given values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4773</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4774</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">4775</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4776</span>:     arr : Arraylike</pre>
<pre class="cython line score-0">&#xA0;<span class="">4777</span>:        Array to find the values</pre>
<pre class="cython line score-0">&#xA0;<span class="">4778</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4779</span>:     values: float, arraylike</pre>
<pre class="cython line score-0">&#xA0;<span class="">4780</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4781</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">4782</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4783</span>:     closest values in float or array containing in the given array.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4784</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4785</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">4786</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4787</span>:     &gt;&gt;&gt; import numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">4788</span>:     &gt;&gt;&gt; from gofast.tools.mathex  import find_closest</pre>
<pre class="cython line score-0">&#xA0;<span class="">4789</span>:     &gt;&gt;&gt; find_closest (  [ 2 , 3, 4, 5] , ( 2.6 , 5.6 )  )</pre>
<pre class="cython line score-0">&#xA0;<span class="">4790</span>:     array([3., 5.])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4791</span>:     &gt;&gt;&gt; find_closest (  np.array ([[2 , 3], [ 4, 5]]), ( 2.6 , 5.6 ) )</pre>
<pre class="cython line score-0">&#xA0;<span class="">4792</span>:     array([3., 5.])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4793</span>:     array([3., 5.])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4794</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4795</span>: </pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4796</span>:     arr = is_iterable(arr, exclude_string=True , transform =True  )</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(4796,0,<span class='error_goto'>__PYX_ERR(0, 4796, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_is_iterable);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4796, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4796, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_arr);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_arr)) <span class='error_goto'>__PYX_ERR(0, 4796, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4796, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_exclude_string, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4796, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_transform, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4796, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4796, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4797</span>:     values = is_iterable(values , exclude_string=True  , transform =True )</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(4797,0,<span class='error_goto'>__PYX_ERR(0, 4797, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_is_iterable);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_values);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_values)) <span class='error_goto'>__PYX_ERR(0, 4797, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_exclude_string, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4797, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_transform, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4797, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_values, __pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4798</span>: </pre>
<pre class="cython line score-131" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4799</span>:     for ar, v in zip ( [ arr, values ], ['array', 'values']):</pre>
<pre class='cython code score-131 '>  <span class='trace'>__Pyx_TraceLine</span>(4799,0,<span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_arr);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_arr)) <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_values);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_values)) <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_array_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_array_2);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_u_array_2)) <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_values);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_values);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_2, 1, __pyx_n_u_values)) <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_zip, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4799, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4799, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_5 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4799, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_5 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4799, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_6(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
      PyObject* sequence = __pyx_t_2;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      #else
      __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4799, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_4 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4799, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      #endif
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    } else {
      Py_ssize_t index = -1;
      __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4799, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_7);
      index = 0; __pyx_t_1 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_1)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      index = 1; __pyx_t_4 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_4)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_8(__pyx_t_7), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>
      __pyx_t_8 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_8 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ar, __pyx_t_1);
    __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_v, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(4799,0,<span class='error_goto'>__PYX_ERR(0, 4799, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4800</span>:         if not _is_numeric_dtype(arr, to_array= True ) :</pre>
<pre class='cython code score-25 '>    <span class='trace'>__Pyx_TraceLine</span>(4800,0,<span class='error_goto'>__PYX_ERR(0, 4800, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_is_numeric_dtype);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4800, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4800, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_arr);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_v_arr)) <span class='error_goto'>__PYX_ERR(0, 4800, __pyx_L1_error)</span>;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4800, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_to_array, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4800, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_4, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4800, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4800, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_10 = (!__pyx_t_9);
    if (unlikely(__pyx_t_10)) {
/* … */
    }
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4801</span>:             raise TypeError(f"Non-numerical {v} are not allowed.")</pre>
<pre class='cython code score-27 '>      <span class='trace'>__Pyx_TraceLine</span>(4801,0,<span class='error_goto'>__PYX_ERR(0, 4801, __pyx_L1_error)</span>)
      __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4801, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_11 = 0;
      __pyx_t_12 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Non_numerical);
      __pyx_t_11 += 14;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Non_numerical);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_kp_u_Non_numerical);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_v_v, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4801, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_12;
      __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_t_1);
      __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_are_not_allowed);
      __pyx_t_11 += 17;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_are_not_allowed);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_kp_u_are_not_allowed);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_7, 3, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4801, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4801, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_7, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='error_goto'>__PYX_ERR(0, 4801, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4802</span>: </pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4803</span>:     arr = np.array (arr, dtype = np.float64 )</pre>
<pre class='cython code score-32 '>  <span class='trace'>__Pyx_TraceLine</span>(4803,0,<span class='error_goto'>__PYX_ERR(0, 4803, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4803, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4803, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4803, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_arr);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_arr)) <span class='error_goto'>__PYX_ERR(0, 4803, __pyx_L1_error)</span>;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4803, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4803, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4803, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4803, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4803, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4804</span>:     values = np.array (values, dtype = np.float64 )</pre>
<pre class='cython code score-32 '>  <span class='trace'>__Pyx_TraceLine</span>(4804,0,<span class='error_goto'>__PYX_ERR(0, 4804, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_values);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_values);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_values)) <span class='error_goto'>__PYX_ERR(0, 4804, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4804, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4804, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_values, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4805</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4806</span>:     # ravel arr if ndim is not one-dimensional</pre>
<pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4807</span>:     arr  = arr.ravel() if arr.ndim !=1 else arr</pre>
<pre class='cython code score-23 '>  <span class='trace'>__Pyx_TraceLine</span>(4807,0,<span class='error_goto'>__PYX_ERR(0, 4807, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arr, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4807, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_10 = (<span class='pyx_c_api'>__Pyx_PyInt_BoolNeObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0)); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4807, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_10) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arr, __pyx_n_s_ravel);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4807, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    __pyx_t_13 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_13 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, NULL};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_13, 0+__pyx_t_13);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4807, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_4 = __pyx_t_3;
    __pyx_t_3 = 0;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
    __pyx_t_4 = __pyx_v_arr;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4808</span>:     # Could Find the absolute difference with each value</pre>
<pre class="cython line score-0">&#xA0;<span class="">4809</span>:     # Get the index of the smallest absolute difference.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4810</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4811</span>:     # --&gt; Using map is less faster than list comprehension</pre>
<pre class="cython line score-0">&#xA0;<span class="">4812</span>:     # close = np.array ( list(</pre>
<pre class="cython line score-0">&#xA0;<span class="">4813</span>:     #     map (lambda v: np.abs ( arr - v).argmin(), values )</pre>
<pre class="cython line score-0">&#xA0;<span class="">4814</span>:     #                   ), dtype = np.float64</pre>
<pre class="cython line score-0">&#xA0;<span class="">4815</span>:     #     )</pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4816</span>:     return np.array ( [</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(4816,0,<span class='error_goto'>__PYX_ERR(0, 4816, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4816, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  { /* enter inner scope */
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4816, __pyx_L11_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-114" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4817</span>:         arr [ np.abs ( arr - v).argmin()] for v in values ]</pre>
<pre class='cython code score-114 '>    <span class='trace'>__Pyx_TraceLine</span>(4817,0,<span class='error_goto'>__PYX_ERR(0, 4817, __pyx_L11_error)</span>)
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_values)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_values)) {
      __pyx_t_1 = __pyx_v_values; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4817, __pyx_L11_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4817, __pyx_L11_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4817, __pyx_L11_error)</span>
            #endif
            if (__pyx_t_5 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4817, __pyx_L11_error)</span>
          #else
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4817, __pyx_L11_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          #endif
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_MACROS
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4817, __pyx_L11_error)</span>
            #endif
            if (__pyx_t_5 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4817, __pyx_L11_error)</span>
          #else
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4817, __pyx_L11_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          #endif
        }
      } else {
        __pyx_t_7 = __pyx_t_6(__pyx_t_1);
        if (unlikely(!__pyx_t_7)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>__PYX_ERR(0, 4817, __pyx_L11_error)</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_9genexpr13__pyx_v_v, __pyx_t_7);
      __pyx_t_7 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_15, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 4817, __pyx_L11_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_15, __pyx_n_s_abs);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 4817, __pyx_L11_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_15 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_arr, __pyx_9genexpr13__pyx_v_v);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 4817, __pyx_L11_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
      __pyx_t_17 = NULL;
      __pyx_t_13 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
        __pyx_t_17 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
        if (likely(__pyx_t_17)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
          __pyx_t_13 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_17, __pyx_t_15};
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_16, __pyx_callargs+1-__pyx_t_13, 1+__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
        if (unlikely(!__pyx_t_14)) <span class='error_goto'>__PYX_ERR(0, 4817, __pyx_L11_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
      }
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_n_s_argmin);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 4817, __pyx_L11_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
      __pyx_t_14 = NULL;
      __pyx_t_13 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
          __pyx_t_13 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_14, NULL};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_16, __pyx_callargs+1-__pyx_t_13, 0+__pyx_t_13);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 4817, __pyx_L11_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
      }
      __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_arr, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 4817, __pyx_L11_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(<span class='pyx_c_api'>__Pyx_ListComp_Append</span>(__pyx_t_3, (PyObject*)__pyx_t_16))) <span class='error_goto'>__PYX_ERR(0, 4816, __pyx_L11_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr13__pyx_v_v); __pyx_9genexpr13__pyx_v_v = 0;
    goto __pyx_L15_exit_scope;
    __pyx_L11_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_9genexpr13__pyx_v_v); __pyx_9genexpr13__pyx_v_v = 0;
    goto __pyx_L1_error;
    __pyx_L15_exit_scope:;
  } /* exit inner scope */
  __pyx_t_1 = NULL;
  __pyx_t_13 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_13 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_1, __pyx_t_3};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_13, 1+__pyx_t_13);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4816, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4818</span>:         )</pre>
<pre class="cython line score-0">&#xA0;<span class="">4819</span>: </pre>
<pre class="cython line score-254" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4820</span>: def gradient_descent(</pre>
<pre class='cython code score-254 '>static PyObject *__pyx_pf_6gofast_5tools_6mathex_140__defaults__(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceCall</span>("__defaults__", __pyx_f[0], 4820, 0, <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4820,0,<span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4820, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_n_epochs);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_n_epochs);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 1, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_n_epochs)) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject*)__pyx_n_u_linear));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject*)__pyx_n_u_linear));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 2, ((PyObject*)__pyx_n_u_linear))) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_degree);
  <span class='refnanny'>__Pyx_GIVEREF</span>(<span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_degree);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 3, <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self)-&gt;__pyx_arg_degree)) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 4, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>;
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4820, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, Py_None)) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.__defaults__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_125gradient_descent(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_124gradient_descent, " Gradient descent algorithm to  fit the best model parameter.\n    \n    Model can be changed to polynomial if degree is greater than 1. \n    \n    Parameters \n    -----------\n    z: arraylike, \n       vertical nodes containing the values of depth V\n    s: Arraylike, \n       vertical vector containin the resistivity values \n    alpha: float,\n       step descent parameter or learning rate. *Default* is ``0.01`\n    n_epochs: int, \n       number of iterations. *Default* is ``100``. Can be changed to other values\n    kind: str, {\"linear\", \"poly\"}, default= 'linear'\n      Type of model to fit. Linear model is selected as the default. \n    degree: int, default=1 \n       As the linear model is selected as the default since the degree is set \n       to ``1``\n    Returns \n    ---------\n    - `_F`: New model values with the best `W` parameters found.\n    - `W`: vector containing the parameters fits \n    - `cost_history`: Containing the error at each Itiretaions. \n        \n    Examples \n    -----------\n    &gt;&gt;&gt; import numpy as np \n    &gt;&gt;&gt; from gofast.tools.mathex  import gradient_descent\n    &gt;&gt;&gt; z= np.array([0, 6, 13, 20, 29 ,39, 49, 59, 69, 89, 109, 129, \n                     149, 179])\n    &gt;&gt;&gt; res= np.array( [1.59268,1.59268,2.64917,3.30592,3.76168,\n                        4.09031,4.33606, 4.53951,4.71819,4.90838,\n          5.01096,5.0536,5.0655,5.06767])\n    &gt;&gt;&gt; fz, weights, cost_history = gradient_descent(\n        z=z, s=res,n_epochs=10,alpha=1e-8,degree=2)\n    &gt;&gt;&gt; import matplotlib.pyplot as plt \n    &gt;&gt;&gt; plt.scatter (z, res)\n    &gt;&gt;&gt; plt.plot(z, fz)\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_125gradient_descent = {"gradient_descent", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_125gradient_descent, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_124gradient_descent};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_125gradient_descent(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_z = 0;
  PyObject *__pyx_v_s = 0;
  double __pyx_v_alpha;
  PyObject *__pyx_v_n_epochs = 0;
  PyObject *__pyx_v_kind = 0;
  PyObject *__pyx_v_degree = 0;
  PyObject *__pyx_v_raise_warn = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gradient_descent (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_z,&amp;__pyx_n_s_s,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_n_epochs,&amp;__pyx_n_s_kind,&amp;__pyx_n_s_degree,&amp;__pyx_n_s_raise_warn,0};
  PyObject* values[7] = {0,0,0,0,0,0,0};
    __pyx_defaults3 *__pyx_dynamic_args = <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_self);
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_n_epochs);
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)((PyObject*)__pyx_n_u_linear)));
    values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(__pyx_dynamic_args-&gt;__pyx_arg_degree);
    values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_z)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_s)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gradient_descent", 0, 2, 7, 1); <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_alpha);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_epochs);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_kind);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_degree);
          if (value) { values[5] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_raise_warn);
          if (value) { values[6] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "gradient_descent") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  7: values[6] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_z = values[0];
    __pyx_v_s = values[1];
    if (values[2]) {
      __pyx_v_alpha = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_alpha == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4823, __pyx_L3_error)</span>
    } else {
      __pyx_v_alpha = ((double)((double).01));
    }
    __pyx_v_n_epochs = ((PyObject*)values[3]);
    __pyx_v_kind = ((PyObject*)values[4]);
    __pyx_v_degree = ((PyObject*)values[5]);
    __pyx_v_raise_warn = values[6];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gradient_descent", 0, 2, 7, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.gradient_descent", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_n_epochs), (&amp;PyInt_Type), 0, "n_epochs", 1))) <span class='error_goto'>__PYX_ERR(0, 4824, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_kind), (&amp;PyUnicode_Type), 0, "kind", 1))) <span class='error_goto'>__PYX_ERR(0, 4825, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_degree), (&amp;PyInt_Type), 0, "degree", 1))) <span class='error_goto'>__PYX_ERR(0, 4826, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_124gradient_descent(__pyx_self, __pyx_v_z, __pyx_v_s, __pyx_v_alpha, __pyx_v_n_epochs, __pyx_v_kind, __pyx_v_degree, __pyx_v_raise_warn);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_124gradient_descent(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_z, PyObject *__pyx_v_s, double __pyx_v_alpha, PyObject *__pyx_v_n_epochs, PyObject *__pyx_v_kind, PyObject *__pyx_v_degree, PyObject *__pyx_v_raise_warn) {
  PyObject *__pyx_v_Z = NULL;
  PyObject *__pyx_v_W = NULL;
  PyObject *__pyx_v_cost_history = NULL;
  PyObject *__pyx_v_ii = NULL;
  PyObject *__pyx_v__F = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__141)
  <span class='trace'>__Pyx_TraceCall</span>("gradient_descent", __pyx_f[0], 4820, 0, <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_s);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_kind);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_degree);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.gradient_descent", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_Z);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_W);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cost_history);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ii);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__F);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_s);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_kind);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_degree);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__233 = <span class='py_c_api'>PyTuple_Pack</span>(12, __pyx_n_s_z, __pyx_n_s_s, __pyx_n_s_alpha, __pyx_n_s_n_epochs, __pyx_n_s_kind, __pyx_n_s_degree, __pyx_n_s_raise_warn, __pyx_n_s_Z, __pyx_n_s_W, __pyx_n_s_cost_history, __pyx_n_s_ii, __pyx_n_s_F);<span class='error_goto'> if (unlikely(!__pyx_tuple__233)) __PYX_ERR(0, 4820, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__233);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__233);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4820,0,<span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4820, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_z, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_s, __pyx_n_s_ArrayLike) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_alpha, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_n_epochs, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_kind, __pyx_n_s_str) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_degree, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_raise_warn, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_125gradient_descent, 0, __pyx_n_s_gradient_descent, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__141));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4820, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (!<span class='pyx_c_api'>__Pyx_CyFunction_InitDefaults</span>(__pyx_t_2, sizeof(__pyx_defaults3), 2)) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>
  __pyx_codeobj__141 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__233, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_gradient_descent, 4820, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__141)) __PYX_ERR(0, 4820, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4821</span>:     z: ArrayLike,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4822</span>:     s:ArrayLike,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4823</span>:     alpha:float=.01,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4823,0,<span class='error_goto'>__PYX_ERR(0, 4823, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double).01));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4823, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4824</span>:     n_epochs:int= 100,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4824,0,<span class='error_goto'>__PYX_ERR(0, 4824, __pyx_L1_error)</span>)
  if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_100)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_100))) <span class='error_goto'>__PYX_ERR(0, 4824, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_100);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_t_2)-&gt;__pyx_arg_n_epochs = ((PyObject*)__pyx_int_100);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_100);
</pre><pre class="cython line score-0">&#xA0;<span class="">4825</span>:     kind:str="linear",</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4826</span>:     degree:int=1,</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(4826,0,<span class='error_goto'>__PYX_ERR(0, 4826, __pyx_L1_error)</span>)
  if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_1)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_1))) <span class='error_goto'>__PYX_ERR(0, 4826, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='pyx_c_api'>__Pyx_CyFunction_Defaults</span>(__pyx_defaults3, __pyx_t_2)-&gt;__pyx_arg_degree = ((PyObject*)__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsGetter</span>(__pyx_t_2, __pyx_pf_6gofast_5tools_6mathex_140__defaults__);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gradient_descent, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4820, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4827</span>:     raise_warn:bool=False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4828</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">4829</span>:     """ Gradient descent algorithm to  fit the best model parameter.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4830</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4831</span>:     Model can be changed to polynomial if degree is greater than 1.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4832</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4833</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">4834</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4835</span>:     z: arraylike,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4836</span>:        vertical nodes containing the values of depth V</pre>
<pre class="cython line score-0">&#xA0;<span class="">4837</span>:     s: Arraylike,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4838</span>:        vertical vector containin the resistivity values</pre>
<pre class="cython line score-0">&#xA0;<span class="">4839</span>:     alpha: float,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4840</span>:        step descent parameter or learning rate. *Default* is ``0.01`</pre>
<pre class="cython line score-0">&#xA0;<span class="">4841</span>:     n_epochs: int,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4842</span>:        number of iterations. *Default* is ``100``. Can be changed to other values</pre>
<pre class="cython line score-0">&#xA0;<span class="">4843</span>:     kind: str, {"linear", "poly"}, default= 'linear'</pre>
<pre class="cython line score-0">&#xA0;<span class="">4844</span>:       Type of model to fit. Linear model is selected as the default.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4845</span>:     degree: int, default=1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4846</span>:        As the linear model is selected as the default since the degree is set</pre>
<pre class="cython line score-0">&#xA0;<span class="">4847</span>:        to ``1``</pre>
<pre class="cython line score-0">&#xA0;<span class="">4848</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">4849</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4850</span>:     - `_F`: New model values with the best `W` parameters found.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4851</span>:     - `W`: vector containing the parameters fits</pre>
<pre class="cython line score-0">&#xA0;<span class="">4852</span>:     - `cost_history`: Containing the error at each Itiretaions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4853</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4854</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">4855</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4856</span>:     &gt;&gt;&gt; import numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">4857</span>:     &gt;&gt;&gt; from gofast.tools.mathex  import gradient_descent</pre>
<pre class="cython line score-0">&#xA0;<span class="">4858</span>:     &gt;&gt;&gt; z= np.array([0, 6, 13, 20, 29 ,39, 49, 59, 69, 89, 109, 129,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4859</span>:                      149, 179])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4860</span>:     &gt;&gt;&gt; res= np.array( [1.59268,1.59268,2.64917,3.30592,3.76168,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4861</span>:                         4.09031,4.33606, 4.53951,4.71819,4.90838,</pre>
<pre class="cython line score-0">&#xA0;<span class="">4862</span>:           5.01096,5.0536,5.0655,5.06767])</pre>
<pre class="cython line score-0">&#xA0;<span class="">4863</span>:     &gt;&gt;&gt; fz, weights, cost_history = gradient_descent(</pre>
<pre class="cython line score-0">&#xA0;<span class="">4864</span>:         z=z, s=res,n_epochs=10,alpha=1e-8,degree=2)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4865</span>:     &gt;&gt;&gt; import matplotlib.pyplot as plt</pre>
<pre class="cython line score-0">&#xA0;<span class="">4866</span>:     &gt;&gt;&gt; plt.scatter (z, res)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4867</span>:     &gt;&gt;&gt; plt.plot(z, fz)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4868</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4869</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4870</span>:     #Assert degree</pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4871</span>:     try :degree= abs(int(degree))</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(4871,0,<span class='error_goto'>__PYX_ERR(0, 4871, __pyx_L1_error)</span>)
  {
    /*try:*/ {
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_degree);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4871, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Absolute</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4871, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_t_5))||((__pyx_t_5) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_t_5))) <span class='error_goto'>__PYX_ERR(0, 4871, __pyx_L3_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_degree, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L8_try_end;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
    __pyx_L5_except_error:;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);
    goto __pyx_L1_error;
    __pyx_L8_try_end:;
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4872</span>:     except:raise TypeError(f"Degree is integer. Got {type(degree).__name__!r}")</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(4872,0,<span class='error_goto'>__PYX_ERR(0, 4872, __pyx_L5_except_error)</span>)
    /*except:*/ {
      <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.gradient_descent", __pyx_clineno, __pyx_lineno, __pyx_filename);
      if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_5, &amp;__pyx_t_4, &amp;__pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4872, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)Py_TYPE(__pyx_v_degree)), __pyx_n_s_name);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4872, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Repr</span>(__pyx_t_7), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4872, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_Degree_is_integer_Got, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4872, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_TypeError, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4872, __pyx_L5_except_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_8, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='error_goto'>__PYX_ERR(0, 4872, __pyx_L5_except_error)</span>
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">4873</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4874</span>:     if degree &gt;1 :</pre>
<pre class='cython code score-8 '>  <span class='trace'>__Pyx_TraceLine</span>(4874,0,<span class='error_goto'>__PYX_ERR(0, 4874, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_degree, __pyx_int_1, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4874, __pyx_L1_error)</span>
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_6); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4874, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4875</span>:         kind='poly'</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(4875,0,<span class='error_goto'>__PYX_ERR(0, 4875, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_poly);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kind, __pyx_n_u_poly);
</pre><pre class="cython line score-0">&#xA0;<span class="">4876</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4877</span>:     kind = str(kind).lower()</pre>
<pre class='cython code score-27 '>  <span class='trace'>__Pyx_TraceLine</span>(4877,0,<span class='error_goto'>__PYX_ERR(0, 4877, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Str</span>(__pyx_v_kind);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4877, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_lower);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4877, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 0+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 4877, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  if (!(likely(<span class='py_c_api'>PyUnicode_CheckExact</span>(__pyx_t_6))||((__pyx_t_6) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("unicode", __pyx_t_6))) <span class='error_goto'>__PYX_ERR(0, 4877, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_kind, ((PyObject*)__pyx_t_6));
  __pyx_t_6 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4878</span>:     if kind.lower() =='linear':</pre>
<pre class='cython code score-3 '>  <span class='trace'>__Pyx_TraceLine</span>(4878,0,<span class='error_goto'>__PYX_ERR(0, 4878, __pyx_L1_error)</span>)
  __pyx_t_6 = __Pyx_CallUnboundCMethod0(&amp;__pyx_umethod_PyUnicode_Type_lower, __pyx_v_kind);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4878, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_6, __pyx_n_u_linear, Py_EQ)); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4878, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (__pyx_t_9) {
/* … */
    goto __pyx_L12;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">4879</span>:         # block degree to one.</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4880</span>:         degree = 1</pre>
<pre class='cython code score-4 '>    <span class='trace'>__Pyx_TraceLine</span>(4880,0,<span class='error_goto'>__PYX_ERR(0, 4880, __pyx_L1_error)</span>)
    if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_1)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_1))) <span class='error_goto'>__PYX_ERR(0, 4880, __pyx_L1_error)</span>
    __pyx_t_6 = __pyx_int_1;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_degree, ((PyObject*)__pyx_t_6));
    __pyx_t_6 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4881</span>:     elif kind.find('poly')&gt;=0 :</pre>
<pre class='cython code score-24 '>  <span class='trace'>__Pyx_TraceLine</span>(4881,0,<span class='error_goto'>__PYX_ERR(0, 4881, __pyx_L1_error)</span>)
  if (unlikely(__pyx_v_kind == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "find");
    <span class='error_goto'>__PYX_ERR(0, 4881, __pyx_L1_error)</span>
  }
  __pyx_t_11 = <span class='py_c_api'>PyUnicode_Find</span>(__pyx_v_kind, __pyx_n_u_poly, 0, PY_SSIZE_T_MAX, 1);<span class='error_goto'> if (unlikely(__pyx_t_11 == ((Py_ssize_t)-2))) __PYX_ERR(0, 4881, __pyx_L1_error)</span>
  __pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4881, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_int_0, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4881, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4881, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (__pyx_t_9) {
/* … */
  }
  __pyx_L12:;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4882</span>:         if degree &lt;=1 :</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(4882,0,<span class='error_goto'>__PYX_ERR(0, 4882, __pyx_L1_error)</span>)
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_degree, __pyx_int_1, Py_LE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4882, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4882, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (__pyx_t_9) {
/* … */
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4883</span>:             warnings.warn(</pre>
<pre class='cython code score-5 '>        <span class='trace'>__Pyx_TraceLine</span>(4883,0,<span class='error_goto'>__PYX_ERR(0, 4883, __pyx_L1_error)</span>)
        <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4883, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4883, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4884</span>:                 "Polynomial function expects degree greater than 1."</pre>
<pre class='cython code score-25 '>        <span class='trace'>__Pyx_TraceLine</span>(4884,0,<span class='error_goto'>__PYX_ERR(0, 4884, __pyx_L1_error)</span>)
        __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4884, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_11 = 0;
        __pyx_t_12 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Polynomial_function_expects_degr);
        __pyx_t_11 += 55;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Polynomial_function_expects_degr);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_kp_u_Polynomial_function_expects_degr);
/* … */
        <span class='trace'>__Pyx_TraceLine</span>(4884,0,<span class='error_goto'>__PYX_ERR(0, 4884, __pyx_L1_error)</span>)
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_4, 3, __pyx_t_11, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4884, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_t_4 = NULL;
        __pyx_t_10 = 0;
        #if CYTHON_UNPACK_METHODS
        if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
          __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
          if (likely(__pyx_t_4)) {
            PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
            __pyx_t_10 = 1;
          }
        }
        #endif
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_7};
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 4883, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        }
        __pyx_t_5 = __pyx_t_6;
        __pyx_t_6 = 0;
      } else {
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4885</span>:                 f" Got {degree!r}. Value is resetting to minimum equal 2."</pre>
<pre class='cython code score-16 '>        <span class='trace'>__Pyx_TraceLine</span>(4885,0,<span class='error_goto'>__PYX_ERR(0, 4885, __pyx_L1_error)</span>)
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Repr</span>(__pyx_v_degree), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4885, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_7) &gt; __pyx_t_12) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_7) : __pyx_t_12;
        __pyx_t_11 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_7);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_7);
        __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Value_is_resetting_to_minimum_e);
        __pyx_t_11 += 40;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Value_is_resetting_to_minimum_e);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_kp_u_Value_is_resetting_to_minimum_e);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4886</span>:                       ) if raise_warn else None</pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(4886,0,<span class='error_goto'>__PYX_ERR(0, 4886, __pyx_L1_error)</span>)
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_raise_warn); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4886, __pyx_L1_error)</span>
      if (__pyx_t_9) {
/* … */
        <span class='trace'>__Pyx_TraceLine</span>(4886,0,<span class='error_goto'>__PYX_ERR(0, 4886, __pyx_L1_error)</span>)
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
        __pyx_t_5 = Py_None;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4887</span>:             degree = 2</pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(4887,0,<span class='error_goto'>__PYX_ERR(0, 4887, __pyx_L1_error)</span>)
      if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_2)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_2))) <span class='error_goto'>__PYX_ERR(0, 4887, __pyx_L1_error)</span>
      __pyx_t_5 = __pyx_int_2;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_degree, ((PyObject*)__pyx_t_5));
      __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4888</span>:     # generate function with degree</pre>
<pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4889</span>:     Z, W = _kind_of_model(degree=degree,  x=z, y=s)</pre>
<pre class='cython code score-69 '>  <span class='trace'>__Pyx_TraceLine</span>(4889,0,<span class='error_goto'>__PYX_ERR(0, 4889, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_kind_of_model);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_degree, __pyx_v_degree) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4889, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_x, __pyx_v_z) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4889, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_y, __pyx_v_s) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4889, __pyx_L1_error)</span>
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_empty_tuple, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8))) {
    PyObject* sequence = __pyx_t_8;
    Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
    if (unlikely(size != 2)) {
      if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
      else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
      <span class='error_goto'>__PYX_ERR(0, 4889, __pyx_L1_error)</span>
    }
    #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
    if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
      __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
      __pyx_t_5 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
    } else {
      __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
      __pyx_t_5 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
    #else
    __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4889, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4889, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    #endif
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_7 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4889, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_7);
    index = 0; __pyx_t_6 = __pyx_t_13(__pyx_t_7); if (unlikely(!__pyx_t_6)) goto __pyx_L14_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    index = 1; __pyx_t_5 = __pyx_t_13(__pyx_t_7); if (unlikely(!__pyx_t_5)) goto __pyx_L14_unpacking_failed;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_13(__pyx_t_7), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4889, __pyx_L1_error)</span>
    __pyx_t_13 = NULL;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    goto __pyx_L15_unpacking_done;
    __pyx_L14_unpacking_failed:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_13 = NULL;
    if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
    <span class='error_goto'>__PYX_ERR(0, 4889, __pyx_L1_error)</span>
    __pyx_L15_unpacking_done:;
  }
  __pyx_v_Z = __pyx_t_6;
  __pyx_t_6 = 0;
  __pyx_v_W = __pyx_t_5;
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4890</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4891</span>:     # Compute the gradient descent</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4892</span>:     cost_history = np.zeros(n_epochs)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(4892,0,<span class='error_goto'>__PYX_ERR(0, 4892, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_n_epochs};
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 4892, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_v_cost_history = __pyx_t_8;
  __pyx_t_8 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4893</span>:     s=s.reshape((s.shape[0], 1))</pre>
<pre class='cython code score-33 '>  <span class='trace'>__Pyx_TraceLine</span>(4893,0,<span class='error_goto'>__PYX_ERR(0, 4893, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_s, __pyx_n_s_reshape);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4893, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_s, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4893, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4893, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4893, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 4893, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 4893, __pyx_L1_error)</span>;
  __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_5};
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 4893, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_s, __pyx_t_8);
  __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4894</span>: </pre>
<pre class="cython line score-54" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4895</span>:     for ii in range(n_epochs):</pre>
<pre class='cython code score-54 '>  <span class='trace'>__Pyx_TraceLine</span>(4895,0,<span class='error_goto'>__PYX_ERR(0, 4895, __pyx_L1_error)</span>)
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_v_n_epochs);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4895, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_8)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_8)) {
    __pyx_t_6 = __pyx_t_8; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    __pyx_t_11 = 0;
    __pyx_t_14 = NULL;
  } else {
    __pyx_t_11 = -1; __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4895, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 4895, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  for (;;) {
    if (likely(!__pyx_t_14)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_6);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4895, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_11 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_6, __pyx_t_11); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_11++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4895, __pyx_L1_error)</span>
        #else
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_6, __pyx_t_11); __pyx_t_11++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4895, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_6);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4895, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_11 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_6, __pyx_t_11); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8); __pyx_t_11++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4895, __pyx_L1_error)</span>
        #else
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_6, __pyx_t_11); __pyx_t_11++;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4895, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        #endif
      }
    } else {
      __pyx_t_8 = __pyx_t_14(__pyx_t_6);
      if (unlikely(!__pyx_t_8)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 4895, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    }
    if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_t_8))||((__pyx_t_8) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_t_8))) <span class='error_goto'>__PYX_ERR(0, 4895, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ii, ((PyObject*)__pyx_t_8));
    __pyx_t_8 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(4895,0,<span class='error_goto'>__PYX_ERR(0, 4895, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-75" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4896</span>:         with np.errstate(all='ignore'): # rather than divide='warn'</pre>
<pre class='cython code score-75 '>    <span class='trace'>__Pyx_TraceLine</span>(4896,0,<span class='error_goto'>__PYX_ERR(0, 4896, __pyx_L1_error)</span>)
    /*with:*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4896, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_errstate);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4896, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4896, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_all, __pyx_n_u_ignore) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4896, __pyx_L1_error)</span>
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_empty_tuple, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4896, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_7, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4896, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_7, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4896, __pyx_L18_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = NULL;
      __pyx_t_10 = 0;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_10 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 0+__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 4896, __pyx_L18_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      /*try:*/ {
        {
          /*try:*/ {
/* … */
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          goto __pyx_L31_try_end;
          __pyx_L24_error:;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
          /*except:*/ {
            <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.gradient_descent", __pyx_clineno, __pyx_lineno, __pyx_filename);
            if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_8, &amp;__pyx_t_5, &amp;__pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4896, __pyx_L26_except_error)</span>
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);
            __pyx_t_4 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_8, __pyx_t_5, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4896, __pyx_L26_except_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_18 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_4, NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            if (unlikely(!__pyx_t_18)) <span class='error_goto'>__PYX_ERR(0, 4896, __pyx_L26_except_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_18);
            __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_18);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
            if (__pyx_t_9 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4896, __pyx_L26_except_error)</span>
            __pyx_t_19 = (!__pyx_t_9);
            if (unlikely(__pyx_t_19)) {
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
              <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_8, __pyx_t_5, __pyx_t_7);
              __pyx_t_8 = 0; __pyx_t_5 = 0; __pyx_t_7 = 0; 
              <span class='error_goto'>__PYX_ERR(0, 4896, __pyx_L26_except_error)</span>
            }
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
            goto __pyx_L25_exception_handled;
          }
          __pyx_L26_except_error:;
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_15);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_1, __pyx_t_15);
          goto __pyx_L1_error;
          __pyx_L25_exception_handled:;
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_15);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_2, __pyx_t_1, __pyx_t_15);
          __pyx_L31_try_end:;
        }
      }
      /*finally:*/ {
        /*normal exit:*/{
          if (__pyx_t_3) {
            __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__95, NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            if (unlikely(!__pyx_t_15)) <span class='error_goto'>__PYX_ERR(0, 4896, __pyx_L1_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          }
          goto __pyx_L23;
        }
        __pyx_L23:;
      }
      goto __pyx_L35;
      __pyx_L18_error:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L1_error;
      __pyx_L35:;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">4897</span>:             #https://numpy.org/devdocs/reference/generated/numpy.errstate.html</pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4898</span>:             W= W - (Z._T.dot(Z.dot(W)-s)/ Z.shape[0]) * alpha</pre>
<pre class='cython code score-70 '>            <span class='trace'>__Pyx_TraceLine</span>(4898,0,<span class='error_goto'>__PYX_ERR(0, 4898, __pyx_L24_error)</span>)
            __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_Z, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4898, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4898, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_Z, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4898, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_16 = NULL;
            __pyx_t_10 = 0;
            #if CYTHON_UNPACK_METHODS
            if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
              __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
              if (likely(__pyx_t_16)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
                __pyx_t_10 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_16, __pyx_v_W};
              __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
              if (unlikely(!__pyx_t_8)) <span class='error_goto'>__PYX_ERR(0, 4898, __pyx_L24_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            }
            __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_8, __pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4898, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            __pyx_t_8 = NULL;
            __pyx_t_10 = 0;
            #if CYTHON_UNPACK_METHODS
            if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
              __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
              if (likely(__pyx_t_8)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
                __pyx_t_10 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_8, __pyx_t_4};
              __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
              if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 4898, __pyx_L24_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            }
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_Z, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4898, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_5, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4898, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_7, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4898, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_alpha);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4898, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_5, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4898, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_W, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4898, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_W, __pyx_t_4);
            __pyx_t_4 = 0;
</pre><pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4899</span>:             cost_history[ii]= (1/ 2* Z.shape[0]) * np.sum((Z.dot(W) -s)**2)</pre>
<pre class='cython code score-78 '>            <span class='trace'>__Pyx_TraceLine</span>(4899,0,<span class='error_goto'>__PYX_ERR(0, 4899, __pyx_L24_error)</span>)
            __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>((1.0 / 2.0));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4899, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_Z, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4899, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4899, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
            __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4899, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4899, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_sum);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4899, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_Z, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 4899, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
            __pyx_t_17 = NULL;
            __pyx_t_10 = 0;
            #if CYTHON_UNPACK_METHODS
            if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_16))) {
              __pyx_t_17 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_16);
              if (likely(__pyx_t_17)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_16);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_17);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_16, function);
                __pyx_t_10 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_17, __pyx_v_W};
              __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_16, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
              if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4899, __pyx_L24_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
            }
            __pyx_t_16 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_v_s);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 4899, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
            __pyx_t_4 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_t_16, __pyx_int_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4899, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
            __pyx_t_16 = NULL;
            __pyx_t_10 = 0;
            #if CYTHON_UNPACK_METHODS
            if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
              __pyx_t_16 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
              if (likely(__pyx_t_16)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_16);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
                __pyx_t_10 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_16, __pyx_t_4};
              __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
              if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 4899, __pyx_L24_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
            }
            __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4899, __pyx_L24_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_cost_history, __pyx_v_ii, __pyx_t_8) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4899, __pyx_L24_error)</span>
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4900</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4901</span>:     # Model function _F= Z.W where `Z` id composed of vertical nodes</pre>
<pre class="cython line score-0">&#xA0;<span class="">4902</span>:     # values and `bias` columns and `W` is weights numbers.</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4903</span>:     _F= Z.dot(W) # model(Z=Z, W=W)     # generate the new model with the best weights</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(4903,0,<span class='error_goto'>__PYX_ERR(0, 4903, __pyx_L1_error)</span>)
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_Z, __pyx_n_s_dot);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4903, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_5 = NULL;
  __pyx_t_10 = 0;
  #if CYTHON_UNPACK_METHODS
  if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      __pyx_t_10 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_W};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+1-__pyx_t_10, 1+__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 4903, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  __pyx_v__F = __pyx_t_6;
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4904</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4905</span>:     return _F,W, cost_history</pre>
<pre class='cython code score-15 '>  <span class='trace'>__Pyx_TraceLine</span>(4905,0,<span class='error_goto'>__PYX_ERR(0, 4905, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4905, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v__F);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v__F);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v__F)) <span class='error_goto'>__PYX_ERR(0, 4905, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_W);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_W);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_W)) <span class='error_goto'>__PYX_ERR(0, 4905, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cost_history);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cost_history);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_v_cost_history)) <span class='error_goto'>__PYX_ERR(0, 4905, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4906</span>: </pre>
<pre class="cython line score-95" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4907</span>: def _kind_of_model(degree, x, y) :</pre>
<pre class='cython code score-95 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_127_kind_of_model(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_126_kind_of_model, " \n    An isolated part of gradient descent computing. \n    Generate kind of model. If degree is``1`` The linear subset \n    function will use. If `degree` is greater than 2,  Matrix will \n    generate using the polynomail function.\n     \n    :param x: X values must be the vertical nodes values \n    :param y: S values must be the resistivity of subblocks at node x \n    \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_127_kind_of_model = {"_kind_of_model", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_127_kind_of_model, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_126_kind_of_model};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_127_kind_of_model(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_degree = 0;
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_y = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_kind_of_model (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_degree,&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,0};
  PyObject* values[3] = {0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_degree)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4907, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4907, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_kind_of_model", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 4907, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4907, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_kind_of_model", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 4907, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_kind_of_model") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4907, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
    }
    __pyx_v_degree = values[0];
    __pyx_v_x = values[1];
    __pyx_v_y = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_kind_of_model", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4907, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._kind_of_model", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_126_kind_of_model(__pyx_self, __pyx_v_degree, __pyx_v_x, __pyx_v_y);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_6gofast_5tools_6mathex_126_kind_of_model(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_degree, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_2__kind_of_model *__pyx_cur_scope;
  PyObject *__pyx_v_c = NULL;
  PyObject *__pyx_v_deg = NULL;
  PyObject *__pyx_v_init_weights = 0;
  CYTHON_UNUSED PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__142)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_2__kind_of_model *)__pyx_tp_new_6gofast_5tools_6mathex___pyx_scope_struct_2__kind_of_model(__pyx_ptype_6gofast_5tools_6mathex___pyx_scope_struct_2__kind_of_model, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_2__kind_of_model *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 4907, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("_kind_of_model", __pyx_f[0], 4907, 0, <span class='error_goto'>__PYX_ERR(0, 4907, __pyx_L1_error)</span>);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._kind_of_model", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_c);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_deg);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_init_weights);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_x);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__234 = <span class='py_c_api'>PyTuple_Pack</span>(9, __pyx_n_s_degree, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_c, __pyx_n_s_deg, __pyx_n_s_w, __pyx_n_s_init_weights, __pyx_n_s_init_weights, __pyx_n_s_i);<span class='error_goto'> if (unlikely(!__pyx_tuple__234)) __PYX_ERR(0, 4907, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__234);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__234);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4907,0,<span class='error_goto'>__PYX_ERR(0, 4907, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_127_kind_of_model, 0, __pyx_n_s_kind_of_model, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__142));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4907, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_kind_of_model, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4907, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__142 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__234, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_kind_of_model, 4907, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__142)) __PYX_ERR(0, 4907, __pyx_L1_error)</span>
/* … */
struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_2__kind_of_model {
  PyObject_HEAD
  PyObject *__pyx_v_w;
};

</pre><pre class="cython line score-0">&#xA0;<span class="">4908</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">4909</span>:     An isolated part of gradient descent computing.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4910</span>:     Generate kind of model. If degree is``1`` The linear subset</pre>
<pre class="cython line score-0">&#xA0;<span class="">4911</span>:     function will use. If `degree` is greater than 2,  Matrix will</pre>
<pre class="cython line score-0">&#xA0;<span class="">4912</span>:     generate using the polynomail function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4913</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4914</span>:     :param x: X values must be the vertical nodes values</pre>
<pre class="cython line score-0">&#xA0;<span class="">4915</span>:     :param y: S values must be the resistivity of subblocks at node x</pre>
<pre class="cython line score-0">&#xA0;<span class="">4916</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4917</span>:     """</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4918</span>:     c= []</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4918,0,<span class='error_goto'>__PYX_ERR(0, 4918, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4918, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_c = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4919</span>:     deg = degree</pre>
<pre class='cython code score-1 '>  <span class='trace'>__Pyx_TraceLine</span>(4919,0,<span class='error_goto'>__PYX_ERR(0, 4919, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_degree);
  __pyx_v_deg = __pyx_v_degree;
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4920</span>:     w = np.zeros((degree+1, 1)) # initialize weights</pre>
<pre class='cython code score-32 '>  <span class='trace'>__Pyx_TraceLine</span>(4920,0,<span class='error_goto'>__PYX_ERR(0, 4920, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4920, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4920, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_v_degree, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4920, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4920, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4920, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 4920, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_5 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_5 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_4};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4920, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_cur_scope-&gt;__pyx_v_w = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4921</span>: </pre>
<pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4922</span>:     def init_weights (x, y):</pre>
<pre class='cython code score-70 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_14_kind_of_model_1init_weights(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_14_kind_of_model_init_weights, " Init weights by calculating the scope of the function along \n         the vertical nodes axis for each columns. ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_14_kind_of_model_1init_weights = {"init_weights", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_14_kind_of_model_1init_weights, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_14_kind_of_model_init_weights};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_14_kind_of_model_1init_weights(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_x = 0;
  PyObject *__pyx_v_y = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_weights (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_x,&amp;__pyx_n_s_y,0};
  PyObject* values[2] = {0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_x)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4922, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4922, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("init_weights", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 4922, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "init_weights") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4922, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
    }
    __pyx_v_x = values[0];
    __pyx_v_y = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("init_weights", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4922, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._kind_of_model.init_weights", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_14_kind_of_model_init_weights(__pyx_self, __pyx_v_x, __pyx_v_y);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_14_kind_of_model_init_weights(PyObject *__pyx_self, PyObject *__pyx_v_x, PyObject *__pyx_v_y) {
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_2__kind_of_model *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_2__kind_of_model *__pyx_outer_scope;
  PyObject *__pyx_v_j = NULL;
  PyObject *__pyx_v_a = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_2__kind_of_model *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("init_weights", __pyx_f[0], 4922, 0, <span class='error_goto'>__PYX_ERR(0, 4922, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._kind_of_model.init_weights", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_j);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_a);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__143 = <span class='py_c_api'>PyTuple_Pack</span>(4, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_j, __pyx_n_s_a);<span class='error_goto'> if (unlikely(!__pyx_tuple__143)) __PYX_ERR(0, 4922, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__143);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__143);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4922,0,<span class='error_goto'>__PYX_ERR(0, 4922, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_14_kind_of_model_1init_weights, 0, __pyx_n_s_kind_of_model_locals_init_weigh, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__144));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4922, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_init_weights = __pyx_t_1;
  __pyx_t_1 = 0;
  __pyx_codeobj__144 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__143, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_init_weights, 4922, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__144)) __PYX_ERR(0, 4922, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4923</span>:         """ Init weights by calculating the scope of the function along</pre>
<pre class="cython line score-0">&#xA0;<span class="">4924</span>:          the vertical nodes axis for each columns. """</pre>
<pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4925</span>:         with warnings.catch_warnings():</pre>
<pre class='cython code score-78 '>  <span class='trace'>__Pyx_TraceLine</span>(4925,0,<span class='error_goto'>__PYX_ERR(0, 4925, __pyx_L1_error)</span>)
  /*with:*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4925, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_catch_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4925, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4925, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 4925, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4925, __pyx_L3_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4925, __pyx_L3_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    /*try:*/ {
      {
        /*try:*/ {
/* … */
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        goto __pyx_L12_try_end;
        __pyx_L7_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex._kind_of_model.init_weights", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_2, &amp;__pyx_t_1, &amp;__pyx_t_12) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4925, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_12);
          __pyx_t_6 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_2, __pyx_t_1, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4925, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_6, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_14)) <span class='error_goto'>__PYX_ERR(0, 4925, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          if (__pyx_t_15 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4925, __pyx_L9_except_error)</span>
          __pyx_t_16 = (!__pyx_t_15);
          if (unlikely(__pyx_t_16)) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
            <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_2, __pyx_t_1, __pyx_t_12);
            __pyx_t_2 = 0; __pyx_t_1 = 0; __pyx_t_12 = 0; 
            <span class='error_goto'>__PYX_ERR(0, 4925, __pyx_L9_except_error)</span>
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
          goto __pyx_L8_exception_handled;
        }
        __pyx_L9_except_error:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        goto __pyx_L1_error;
        __pyx_L8_exception_handled:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_7);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_7, __pyx_t_8, __pyx_t_9);
        __pyx_L12_try_end:;
      }
    }
    /*finally:*/ {
      /*normal exit:*/{
        if (__pyx_t_5) {
          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__95, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 4925, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        }
        goto __pyx_L6;
      }
      __pyx_L6:;
    }
    goto __pyx_L19;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    goto __pyx_L1_error;
    __pyx_L19:;
  }
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4926</span>:             warnings.filterwarnings(action='ignore',</pre>
<pre class='cython code score-17 '>          <span class='trace'>__Pyx_TraceLine</span>(4926,0,<span class='error_goto'>__PYX_ERR(0, 4926, __pyx_L7_error)</span>)
          <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4926, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_filterwarnings);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4926, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4926, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_action, __pyx_n_u_ignore) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4926, __pyx_L7_error)</span>
/* … */
          <span class='trace'>__Pyx_TraceLine</span>(4926,0,<span class='error_goto'>__PYX_ERR(0, 4926, __pyx_L7_error)</span>)
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4926, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4927</span>:                                     category=RuntimeWarning)</pre>
<pre class='cython code score-5 '>          <span class='trace'>__Pyx_TraceLine</span>(4927,0,<span class='error_goto'>__PYX_ERR(0, 4927, __pyx_L7_error)</span>)
          if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_category, __pyx_builtin_RuntimeWarning) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4926, __pyx_L7_error)</span>
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4928</span>:             for j in range(x.shape[1]-1):</pre>
<pre class='cython code score-61 '>          <span class='trace'>__Pyx_TraceLine</span>(4928,0,<span class='error_goto'>__PYX_ERR(0, 4928, __pyx_L7_error)</span>)
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4928, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4928, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4928, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4928, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
            __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
            __pyx_t_10 = 0;
            __pyx_t_11 = NULL;
          } else {
            __pyx_t_10 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4928, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 4928, __pyx_L7_error)</span>
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          for (;;) {
            if (likely(!__pyx_t_11)) {
              if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
                {
                  Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
                  #if !CYTHON_ASSUME_SAFE_MACROS
                  if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4928, __pyx_L7_error)</span>
                  #endif
                  if (__pyx_t_10 &gt;= __pyx_temp) break;
                }
                #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
                __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4928, __pyx_L7_error)</span>
                #else
                __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4928, __pyx_L7_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                #endif
              } else {
                {
                  Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
                  #if !CYTHON_ASSUME_SAFE_MACROS
                  if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4928, __pyx_L7_error)</span>
                  #endif
                  if (__pyx_t_10 &gt;= __pyx_temp) break;
                }
                #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
                __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_10); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_10++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4928, __pyx_L7_error)</span>
                #else
                __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_10); __pyx_t_10++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4928, __pyx_L7_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                #endif
              }
            } else {
              __pyx_t_1 = __pyx_t_11(__pyx_t_2);
              if (unlikely(!__pyx_t_1)) {
                PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
                if (exc_type) {
                  if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
                  else <span class='error_goto'>__PYX_ERR(0, 4928, __pyx_L7_error)</span>
                }
                break;
              }
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            }
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_j, __pyx_t_1);
            __pyx_t_1 = 0;
/* … */
            <span class='trace'>__Pyx_TraceLine</span>(4928,0,<span class='error_goto'>__PYX_ERR(0, 4928, __pyx_L7_error)</span>)
          }
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-113" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4929</span>:                 a= (y.max()-y.min())/(x[:, j].max()-x[:, j].min())</pre>
<pre class='cython code score-113 '>            <span class='trace'>__Pyx_TraceLine</span>(4929,0,<span class='error_goto'>__PYX_ERR(0, 4929, __pyx_L7_error)</span>)
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4929, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
            __pyx_t_6 = NULL;
            __pyx_t_4 = 0;
            #if CYTHON_UNPACK_METHODS
            if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
              __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
              if (likely(__pyx_t_6)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
                __pyx_t_4 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
              __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
              if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4929, __pyx_L7_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            }
            __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4929, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            __pyx_t_12 = NULL;
            __pyx_t_4 = 0;
            #if CYTHON_UNPACK_METHODS
            if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
              __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
              if (likely(__pyx_t_12)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
                __pyx_t_4 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_12, NULL};
              __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
              if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4929, __pyx_L7_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            }
            __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4929, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4929, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
            if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 4929, __pyx_L7_error)</span>;
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j);
            if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_v_j)) <span class='error_goto'>__PYX_ERR(0, 4929, __pyx_L7_error)</span>;
            __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_x, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 4929, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_12, __pyx_n_s_max);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4929, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
            __pyx_t_12 = NULL;
            __pyx_t_4 = 0;
            #if CYTHON_UNPACK_METHODS
            if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
              __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
              if (likely(__pyx_t_12)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
                __pyx_t_4 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_12, NULL};
              __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
              if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4929, __pyx_L7_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            }
            __pyx_t_12 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 4929, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__9);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__9);
            if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_12, 0, __pyx_slice__9)) <span class='error_goto'>__PYX_ERR(0, 4929, __pyx_L7_error)</span>;
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_j);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_j);
            if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_12, 1, __pyx_v_j)) <span class='error_goto'>__PYX_ERR(0, 4929, __pyx_L7_error)</span>;
            __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_x, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 4929, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
            __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_13, __pyx_n_s_min);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 4929, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
            __pyx_t_13 = NULL;
            __pyx_t_4 = 0;
            #if CYTHON_UNPACK_METHODS
            if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_12))) {
              __pyx_t_13 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_12);
              if (likely(__pyx_t_13)) {
                PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_12);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_13);
                <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
                <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_12, function);
                __pyx_t_4 = 1;
              }
            }
            #endif
            {
              PyObject *__pyx_callargs[2] = {__pyx_t_13, NULL};
              __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_12, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
              if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4929, __pyx_L7_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
            }
            __pyx_t_12 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 4929, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Divide</span>(__pyx_t_6, __pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4929, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_a, __pyx_t_1);
            __pyx_t_1 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4930</span>:                 w[j]=a</pre>
<pre class='cython code score-7 '>            <span class='trace'>__Pyx_TraceLine</span>(4930,0,<span class='error_goto'>__PYX_ERR(0, 4930, __pyx_L7_error)</span>)
            if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_w)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("w"); <span class='error_goto'>__PYX_ERR(0, 4930, __pyx_L7_error)</span> }
            if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_cur_scope-&gt;__pyx_v_w, __pyx_v_j, __pyx_v_a) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4930, __pyx_L7_error)</span>
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4931</span>:             w[-1] = y.mean()</pre>
<pre class='cython code score-21 '>          <span class='trace'>__Pyx_TraceLine</span>(4931,0,<span class='error_goto'>__PYX_ERR(0, 4931, __pyx_L7_error)</span>)
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_y, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4931, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_12 = NULL;
          __pyx_t_4 = 0;
          #if CYTHON_UNPACK_METHODS
          if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
            __pyx_t_12 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
            if (likely(__pyx_t_12)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_12);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
              __pyx_t_4 = 1;
            }
          }
          #endif
          {
            PyObject *__pyx_callargs[2] = {__pyx_t_12, NULL};
            __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+1-__pyx_t_4, 0+__pyx_t_4);
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
            if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4931, __pyx_L7_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          }
          if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_w)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("w"); <span class='error_goto'>__PYX_ERR(0, 4931, __pyx_L7_error)</span> }
          if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_cur_scope-&gt;__pyx_v_w, -1L, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 1, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4931, __pyx_L7_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4932</span>:         return w   # return weights</pre>
<pre class='cython code score-4 '>  <span class='trace'>__Pyx_TraceLine</span>(4932,0,<span class='error_goto'>__PYX_ERR(0, 4932, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_w)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("w"); <span class='error_goto'>__PYX_ERR(0, 4932, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_w);
  __pyx_r = __pyx_cur_scope-&gt;__pyx_v_w;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4933</span>: </pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4934</span>:     for i in range(degree):</pre>
<pre class='cython code score-52 '>  <span class='trace'>__Pyx_TraceLine</span>(4934,0,<span class='error_goto'>__PYX_ERR(0, 4934, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_v_degree);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4934, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_3 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_6 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_6 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4934, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 4934, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4934, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_6 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4934, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4934, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4934, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_6 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_6); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_6++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4934, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_6); __pyx_t_6++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4934, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_7(__pyx_t_3);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 4934, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(4934,0,<span class='error_goto'>__PYX_ERR(0, 4934, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4935</span>:         c.append(x ** deg)</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(4935,0,<span class='error_goto'>__PYX_ERR(0, 4935, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Power</span>(__pyx_v_x, __pyx_v_deg, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4935, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_c, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((int)-1))) __PYX_ERR(0, 4935, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4936</span>:         deg= deg -1</pre>
<pre class='cython code score-3 '>    <span class='trace'>__Pyx_TraceLine</span>(4936,0,<span class='error_goto'>__PYX_ERR(0, 4936, __pyx_L1_error)</span>)
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_deg, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4936, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_deg, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4937</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4938</span>:     if len(c)&gt; 1:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4938,0,<span class='error_goto'>__PYX_ERR(0, 4938, __pyx_L1_error)</span>)
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_v_c);<span class='error_goto'> if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 4938, __pyx_L1_error)</span>
  __pyx_t_9 = (__pyx_t_6 &gt; 1);
  if (__pyx_t_9) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4939</span>:         x= concat_array_from_list(c, concat_axis=1)</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(4939,0,<span class='error_goto'>__PYX_ERR(0, 4939, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_concat_array_from_list);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4939, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4939, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_c);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_c);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_c)) <span class='error_goto'>__PYX_ERR(0, 4939, __pyx_L1_error)</span>;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4939, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_concat_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4939, __pyx_L1_error)</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_1, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4939, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4940</span>:         x= np.concatenate((x, np.ones((x.shape[0], 1))), axis =1)</pre>
<pre class='cython code score-70 '>    <span class='trace'>__Pyx_TraceLine</span>(4940,0,<span class='error_goto'>__PYX_ERR(0, 4940, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_concatenate);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 4940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_10)) <span class='error_goto'>__PYX_ERR(0, 4940, __pyx_L1_error)</span>;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 4940, __pyx_L1_error)</span>;
    __pyx_t_10 = 0;
    __pyx_t_10 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_10, __pyx_t_1};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4940, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4940, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4940, __pyx_L1_error)</span>;
    __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4940, __pyx_L1_error)</span>;
    __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_axis, __pyx_int_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4940, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_x, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4941</span>: </pre>
<pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4942</span>:     else: x= np.vstack((x, np.ones(x.shape)))._T # initialize z to V*2</pre>
<pre class='cython code score-56 '>  <span class='trace'>__Pyx_TraceLine</span>(4942,0,<span class='error_goto'>__PYX_ERR(0, 4942, __pyx_L1_error)</span>)
  /*else*/ {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4942, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_vstack);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4942, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4942, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_ones);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 4942, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_x, __pyx_n_s_shape);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4942, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_11 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_10))) {
      __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_10);
      if (likely(__pyx_t_11)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_10, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_11, __pyx_t_4};
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_10, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4942, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    }
    __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 4942, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4942, __pyx_L1_error)</span>;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 4942, __pyx_L1_error)</span>;
    __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_5 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_5 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_10};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_5, 1+__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4942, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4942, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_x, __pyx_t_2);
    __pyx_t_2 = 0;
  }
  __pyx_L6:;
</pre><pre class="cython line score-0">&#xA0;<span class="">4943</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4944</span>:     w= init_weights(x=x, y=y)</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(4944,0,<span class='error_goto'>__PYX_ERR(0, 4944, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4944, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_x, __pyx_v_x) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4944, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_y, __pyx_v_y) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4944, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v_init_weights, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4944, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_w);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_w, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4945</span>:     return x, w  # Return the matrix x and the weights vector w</pre>
<pre class='cython code score-12 '>  <span class='trace'>__Pyx_TraceLine</span>(4945,0,<span class='error_goto'>__PYX_ERR(0, 4945, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4945, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_x);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_x);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_v_x)) <span class='error_goto'>__PYX_ERR(0, 4945, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_w);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_w);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_cur_scope-&gt;__pyx_v_w)) <span class='error_goto'>__PYX_ERR(0, 4945, __pyx_L1_error)</span>;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4946</span>: </pre>
<pre class="cython line score-83" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4947</span>: def adaptive_moving_average(data,  window_size_factor=0.1):</pre>
<pre class='cython code score-83 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_129adaptive_moving_average(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_128adaptive_moving_average, " Adaptative moving average as  smoothing technique. \n \n    Parameters \n    -----------\n    data: Arraylike \n       Noise data for smoothing \n       \n    window_size_factor: float, default=0.1 \n      Parameter to control the adaptiveness of the moving average.\n       \n    Return \n    --------\n    result: Arraylike \n       Smoothed data \n    \n    Example \n    ---------\n    &gt;&gt;&gt; import matplotlib.pyplot as plt\n    &gt;&gt;&gt; from gofast.tools.mathex  import adaptive_moving_average \n    &gt;&gt;&gt; # Sample magnetotelluric data (replace this with your own data)\n    &gt;&gt;&gt; # Example data: a sine wave with noise\n    &gt;&gt;&gt; time = np.linspace(0, 10, 1000)  # Replace with your actual time values\n    &gt;&gt;&gt; mt_data = np.sin(2 * np.pi * 1 * time) + 0.2 * np.random.randn(1000)  # Example data\n    &gt;&gt;&gt; # Function to calculate the adaptive moving average\n    &gt;&gt;&gt; # Define the window size factor (adjust as needed)\n    &gt;&gt;&gt; window_size_factor = 0.1  # Adjust this value based on your data characteristics\n    &gt;&gt;&gt; # Apply adaptive moving average to the magnetotelluric data\n    &gt;&gt;&gt; smoothed_data = adaptive_moving_average(mt_data, window_size_factor)\n    &gt;&gt;&gt; # Plot the original and smoothed data\n    &gt;&gt;&gt; plt.figure(figsize=(10, 6))\n    &gt;&gt;&gt; plt.plot(time, mt_data, 'b-', label='Original Data')\n    &gt;&gt;&gt; plt.plot(time, smoothed_data, 'r-', label='Smoothed Data (AMA)')\n    &gt;&gt;&gt; plt.xlabel('Time')\n    &gt;&gt;&gt; plt.ylabel('Amplitude')\n    &gt;&gt;&gt; plt.title('Adaptive Moving Average (AMA) Smoothing')\n    &gt;&gt;&gt; plt.legend()\n    &gt;&gt;&gt; plt.grid(True)\n    &gt;&gt;&gt; plt.show()\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_129adaptive_moving_average = {"adaptive_moving_average", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_129adaptive_moving_average, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_128adaptive_moving_average};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_129adaptive_moving_average(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_data = 0;
  PyObject *__pyx_v_window_size_factor = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("adaptive_moving_average (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_data,&amp;__pyx_n_s_window_size_factor,0};
  PyObject* values[2] = {0,0};
    values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_1)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_data)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4947, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_window_size_factor);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4947, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "adaptive_moving_average") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4947, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_data = values[0];
    __pyx_v_window_size_factor = values[1];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("adaptive_moving_average", 0, 1, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4947, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.adaptive_moving_average", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_128adaptive_moving_average(__pyx_self, __pyx_v_data, __pyx_v_window_size_factor);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_128adaptive_moving_average(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_data, PyObject *__pyx_v_window_size_factor) {
  PyObject *__pyx_v_result = NULL;
  PyObject *__pyx_v_window_size = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_start = NULL;
  PyObject *__pyx_v_end = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__145)
  <span class='trace'>__Pyx_TraceCall</span>("adaptive_moving_average", __pyx_f[0], 4947, 0, <span class='error_goto'>__PYX_ERR(0, 4947, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.adaptive_moving_average", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_result);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_window_size);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_start);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_end);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__235 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_data, __pyx_n_s_window_size_factor, __pyx_n_s_result, __pyx_n_s_window_size, __pyx_n_s_i, __pyx_n_s_start, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_tuple__235)) __PYX_ERR(0, 4947, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__235);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__235);
  __pyx_codeobj__145 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__235, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_adaptive_moving_average, 4947, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__145)) __PYX_ERR(0, 4947, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4947,0,<span class='error_goto'>__PYX_ERR(0, 4947, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_129adaptive_moving_average, 0, __pyx_n_s_adaptive_moving_average, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__145));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4947, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__236);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_adaptive_moving_average, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4947, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_tuple__236 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject*)__pyx_float_0_1));<span class='error_goto'> if (unlikely(!__pyx_tuple__236)) __PYX_ERR(0, 4947, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__236);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__236);
</pre><pre class="cython line score-0">&#xA0;<span class="">4948</span>:     """ Adaptative moving average as  smoothing technique.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4949</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4950</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">4951</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4952</span>:     data: Arraylike</pre>
<pre class="cython line score-0">&#xA0;<span class="">4953</span>:        Noise data for smoothing</pre>
<pre class="cython line score-0">&#xA0;<span class="">4954</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4955</span>:     window_size_factor: float, default=0.1</pre>
<pre class="cython line score-0">&#xA0;<span class="">4956</span>:       Parameter to control the adaptiveness of the moving average.</pre>
<pre class="cython line score-0">&#xA0;<span class="">4957</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4958</span>:     Return</pre>
<pre class="cython line score-0">&#xA0;<span class="">4959</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4960</span>:     result: Arraylike</pre>
<pre class="cython line score-0">&#xA0;<span class="">4961</span>:        Smoothed data</pre>
<pre class="cython line score-0">&#xA0;<span class="">4962</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">4963</span>:     Example</pre>
<pre class="cython line score-0">&#xA0;<span class="">4964</span>:     ---------</pre>
<pre class="cython line score-0">&#xA0;<span class="">4965</span>:     &gt;&gt;&gt; import matplotlib.pyplot as plt</pre>
<pre class="cython line score-0">&#xA0;<span class="">4966</span>:     &gt;&gt;&gt; from gofast.tools.mathex  import adaptive_moving_average</pre>
<pre class="cython line score-0">&#xA0;<span class="">4967</span>:     &gt;&gt;&gt; # Sample magnetotelluric data (replace this with your own data)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4968</span>:     &gt;&gt;&gt; # Example data: a sine wave with noise</pre>
<pre class="cython line score-0">&#xA0;<span class="">4969</span>:     &gt;&gt;&gt; time = np.linspace(0, 10, 1000)  # Replace with your actual time values</pre>
<pre class="cython line score-0">&#xA0;<span class="">4970</span>:     &gt;&gt;&gt; mt_data = np.sin(2 * np.pi * 1 * time) + 0.2 * np.random.randn(1000)  # Example data</pre>
<pre class="cython line score-0">&#xA0;<span class="">4971</span>:     &gt;&gt;&gt; # Function to calculate the adaptive moving average</pre>
<pre class="cython line score-0">&#xA0;<span class="">4972</span>:     &gt;&gt;&gt; # Define the window size factor (adjust as needed)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4973</span>:     &gt;&gt;&gt; window_size_factor = 0.1  # Adjust this value based on your data characteristics</pre>
<pre class="cython line score-0">&#xA0;<span class="">4974</span>:     &gt;&gt;&gt; # Apply adaptive moving average to the magnetotelluric data</pre>
<pre class="cython line score-0">&#xA0;<span class="">4975</span>:     &gt;&gt;&gt; smoothed_data = adaptive_moving_average(mt_data, window_size_factor)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4976</span>:     &gt;&gt;&gt; # Plot the original and smoothed data</pre>
<pre class="cython line score-0">&#xA0;<span class="">4977</span>:     &gt;&gt;&gt; plt.figure(figsize=(10, 6))</pre>
<pre class="cython line score-0">&#xA0;<span class="">4978</span>:     &gt;&gt;&gt; plt.plot(time, mt_data, 'b-', label='Original Data')</pre>
<pre class="cython line score-0">&#xA0;<span class="">4979</span>:     &gt;&gt;&gt; plt.plot(time, smoothed_data, 'r-', label='Smoothed Data (AMA)')</pre>
<pre class="cython line score-0">&#xA0;<span class="">4980</span>:     &gt;&gt;&gt; plt.xlabel('Time')</pre>
<pre class="cython line score-0">&#xA0;<span class="">4981</span>:     &gt;&gt;&gt; plt.ylabel('Amplitude')</pre>
<pre class="cython line score-0">&#xA0;<span class="">4982</span>:     &gt;&gt;&gt; plt.title('Adaptive Moving Average (AMA) Smoothing')</pre>
<pre class="cython line score-0">&#xA0;<span class="">4983</span>:     &gt;&gt;&gt; plt.legend()</pre>
<pre class="cython line score-0">&#xA0;<span class="">4984</span>:     &gt;&gt;&gt; plt.grid(True)</pre>
<pre class="cython line score-0">&#xA0;<span class="">4985</span>:     &gt;&gt;&gt; plt.show()</pre>
<pre class="cython line score-0">&#xA0;<span class="">4986</span>:     """</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4987</span>:     result = np.zeros_like(data)</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(4987,0,<span class='error_goto'>__PYX_ERR(0, 4987, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4987, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_zeros_like);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4987, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  __pyx_t_4 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_4 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_data};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 4987, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_result = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4988</span>:     window_size = int(window_size_factor * len(data))</pre>
<pre class='cython code score-19 '>  <span class='trace'>__Pyx_TraceLine</span>(4988,0,<span class='error_goto'>__PYX_ERR(0, 4988, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 4988, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4988, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_window_size_factor, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4988, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4988, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_window_size = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4989</span>: </pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4990</span>:     for i in range(len(data)):</pre>
<pre class='cython code score-63 '>  <span class='trace'>__Pyx_TraceLine</span>(4990,0,<span class='error_goto'>__PYX_ERR(0, 4990, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 4990, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4990, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
    __pyx_t_1 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4990, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 4990, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4990, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_5 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4990, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4990, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4990, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_5 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4990, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4990, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_1);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 4990, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_3);
    __pyx_t_3 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(4990,0,<span class='error_goto'>__PYX_ERR(0, 4990, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4991</span>:         start = max(0, i - window_size)</pre>
<pre class='cython code score-23 '>    <span class='trace'>__Pyx_TraceLine</span>(4991,0,<span class='error_goto'>__PYX_ERR(0, 4991, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_i, __pyx_v_window_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4991, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4991, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_8, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 4991, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_9); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4991, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (__pyx_t_10) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_2 = __pyx_t_3;
    } else {
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 4991, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_2 = __pyx_t_9;
      __pyx_t_9 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __pyx_t_2;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_start, __pyx_t_3);
    __pyx_t_3 = 0;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4992</span>:         end = min(len(data), i + window_size + 1)</pre>
<pre class='cython code score-37 '>    <span class='trace'>__Pyx_TraceLine</span>(4992,0,<span class='error_goto'>__PYX_ERR(0, 4992, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_i, __pyx_v_window_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4992, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_3, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4992, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_11 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_data);<span class='error_goto'> if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 4992, __pyx_L1_error)</span>
    __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 4992, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_8 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_9, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4992, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_8); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4992, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (__pyx_t_10) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      __pyx_t_3 = __pyx_t_2;
    } else {
      __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4992, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_3 = __pyx_t_8;
      __pyx_t_8 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __pyx_t_3;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_end, __pyx_t_2);
    __pyx_t_2 = 0;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4993</span>:         result[i] = np.mean(data[start:end])</pre>
<pre class='cython code score-28 '>    <span class='trace'>__Pyx_TraceLine</span>(4993,0,<span class='error_goto'>__PYX_ERR(0, 4993, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4993, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_mean);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 4993, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_v_data, 0, 0, &amp;__pyx_v_start, &amp;__pyx_v_end, NULL, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4993, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_9 = NULL;
    __pyx_t_4 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_9)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        __pyx_t_4 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_3};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_8, __pyx_callargs+1-__pyx_t_4, 1+__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4993, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    }
    if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(__pyx_v_result, __pyx_v_i, __pyx_t_2) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 4993, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4994</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4995</span>:     return result</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(4995,0,<span class='error_goto'>__PYX_ERR(0, 4995, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_result);
  __pyx_r = __pyx_v_result;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">4996</span>: </pre>
<pre class="cython line score-85" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4997</span>: def torres_verdin_filter(</pre>
<pre class='cython code score-85 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_131torres_verdin_filter(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_130torres_verdin_filter, "\n    Calculates the adaptive moving average of a given data array from \n    Torres and Verdin algorithm [1]_. \n    \n    Parameters \n    -----------\n    arr: Arraylike 1d \n      List or array-like of data points.  If two-dimensional array \n      is passed, `axis` must be specified to apply the filter onto. \n       \n    weight_factor: float, default=.1\n      Base smoothing factor for window size which gets adjusted by a factor \n      dependent on the rate of change in the data. \n        \n    beta: float, default =1. \n       Scaling factor to adjust `weight_factor` during high volatility. \n       It controls how much the `weight_factor` is adjusted during \n       periods of high volatility.\n       \n    logify: bool, default=False, \n      By default , Torres uses exponential moving average. So if the \n      values can be logarithmized to ensure the weight be ranged between \n      0 and 1. This is important when data are resistivity or phase. \n      \n    axis: int, default=0 \n      Axis along which to apply the AMA filter.\n    Return \n    -------\n    ama: Adaptive moving average\n    \n    References \n    ------------\n    .. [1] Torres-Verdin and Bostick, 1992,  Principles of spatial surface \n        electric field filtering in magnetotellurics: electromagnetic array profiling\n        (EMAP), Geophysics, v57, p603-622.https://doi.org/10.1190/1.2400625\n\n    Example\n    --------\n    &gt;&gt;&gt; import matplotlib.pyplot as plt \n    &gt;&gt;&gt; from gofast.tools.mathex  import torres_verdin_filter \n    &gt;&gt;&gt; data = np.random.randn(100)  \n    &gt;&gt;&gt; ama = torres_verdin_filter(data)\n    &gt;&gt;&gt; plt.plot (range (len(data)), data, 'k', range(len(data)), ama, '-or')\n    &gt;&gt;&gt; # apply on two dimensional array \n    &gt;&gt;&gt; data2d = np.random.randn(7, 10) \n    &gt;&gt;&gt; ama2d = torres_verdin_filter ( data2d, axis =0)\n    &gt;&gt;&gt; fig, ax  = plt.subplots (nrows = 1, ncols = 2 , sharey= True,\n                             figsize = (7,7) )\n    &gt;&gt;&gt; ax[0].imshow(data2d , label ='Raw ""data', cmap = 'binary' )\n    &gt;&gt;&gt; ax[1].imshow (ama2d,  label = 'AMA data', cmap ='binary' )\n    &gt;&gt;&gt; ax[0].set_title ('Raw data') \n    &gt;&gt;&gt; ax[1].set_title ('AMA data') \n    &gt;&gt;&gt; plt.legend\n    &gt;&gt;&gt; plt.show () \n    \n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_131torres_verdin_filter = {"torres_verdin_filter", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_131torres_verdin_filter, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_130torres_verdin_filter};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_131torres_verdin_filter(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_arr = 0;
  double __pyx_v_weight_factor;
  double __pyx_v_beta;
  PyObject *__pyx_v_logify = 0;
  PyObject *__pyx_v_axis = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("torres_verdin_filter (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_arr,&amp;__pyx_n_s_weight_factor,&amp;__pyx_n_s_beta,&amp;__pyx_n_s_logify,&amp;__pyx_n_s_axis,0};
  PyObject* values[5] = {0,0,0,0,0};
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_6gofast_5tools_6mathex_130torres_verdin_filter(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_arr, double __pyx_v_weight_factor, double __pyx_v_beta, PyObject *__pyx_v_logify, PyObject *__pyx_v_axis) {
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_3_torres_verdin_filter *__pyx_cur_scope;
  PyObject *__pyx_v__filtering_1d_array = 0;
  Py_ssize_t __pyx_v_ii;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__146)
  __pyx_cur_scope = (struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_3_torres_verdin_filter *)__pyx_tp_new_6gofast_5tools_6mathex___pyx_scope_struct_3_torres_verdin_filter(__pyx_ptype_6gofast_5tools_6mathex___pyx_scope_struct_3_torres_verdin_filter, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_3_torres_verdin_filter *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_cur_scope);
  }
  <span class='trace'>__Pyx_TraceCall</span>("torres_verdin_filter", __pyx_f[0], 4997, 0, <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>);
  __pyx_cur_scope-&gt;__pyx_v_beta = __pyx_v_beta;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_logify);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_axis);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.torres_verdin_filter", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v__filtering_1d_array);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_arr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_logify);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_axis);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>((PyObject *)__pyx_cur_scope);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__237 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_arr, __pyx_n_s_weight_factor, __pyx_n_s_beta, __pyx_n_s_logify, __pyx_n_s_axis, __pyx_n_s_filtering_1d_array, __pyx_n_s_filtering_1d_array, __pyx_n_s_ii);<span class='error_goto'> if (unlikely(!__pyx_tuple__237)) __PYX_ERR(0, 4997, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__237);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__237);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(4997,0,<span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 4997, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)Py_False));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)Py_False));
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 2, ((PyObject *)Py_False))) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 3, Py_None)) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 4997, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_weight_factor, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_beta, __pyx_n_s_float) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_logify, __pyx_n_s_bool) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_axis, __pyx_n_s_int) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_131torres_verdin_filter, 0, __pyx_n_s_torres_verdin_filter, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__146));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4997, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetAnnotationsDict</span>(__pyx_t_2, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_torres_verdin_filter, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__146 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__237, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_torres_verdin_filter, 4997, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__146)) __PYX_ERR(0, 4997, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">4998</span>:     arr,</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">4999</span>:     weight_factor: float = 0.1,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(4999,0,<span class='error_goto'>__PYX_ERR(0, 4999, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)0.1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4999, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5000</span>:     beta: float = 1.0,</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(5000,0,<span class='error_goto'>__PYX_ERR(0, 5000, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((double)1.0));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5000, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5001</span>:     logify: bool = False,</pre>
<pre class='cython code score-2 '>    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)Py_False)));
</pre><pre class="cython line score-99" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5002</span>:     axis: int = None,</pre>
<pre class='cython code score-99 '>    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject*)Py_None));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_arr)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_weight_factor);
          if (value) { values[1] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_beta);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_logify);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_axis);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "torres_verdin_filter") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_arr = values[0];
    if (values[1]) {
      __pyx_v_weight_factor = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_weight_factor == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 4999, __pyx_L3_error)</span>
    } else {
      __pyx_v_weight_factor = ((double)((double)0.1));
    }
    if (values[2]) {
      __pyx_v_beta = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_beta == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 5000, __pyx_L3_error)</span>
    } else {
      __pyx_v_beta = ((double)((double)1.0));
    }
    __pyx_v_logify = values[3];
    __pyx_v_axis = ((PyObject*)values[4]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("torres_verdin_filter", 0, 1, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 4997, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.torres_verdin_filter", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_axis), (&amp;PyInt_Type), 1, "axis", 1))) <span class='error_goto'>__PYX_ERR(0, 5002, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_130torres_verdin_filter(__pyx_self, __pyx_v_arr, __pyx_v_weight_factor, __pyx_v_beta, __pyx_v_logify, __pyx_v_axis);
</pre><pre class="cython line score-0">&#xA0;<span class="">5003</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">5004</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">5005</span>:     Calculates the adaptive moving average of a given data array from</pre>
<pre class="cython line score-0">&#xA0;<span class="">5006</span>:     Torres and Verdin algorithm [1]_.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5008</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">5009</span>:     -----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">5010</span>:     arr: Arraylike 1d</pre>
<pre class="cython line score-0">&#xA0;<span class="">5011</span>:       List or array-like of data points.  If two-dimensional array</pre>
<pre class="cython line score-0">&#xA0;<span class="">5012</span>:       is passed, `axis` must be specified to apply the filter onto.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5013</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5014</span>:     weight_factor: float, default=.1</pre>
<pre class="cython line score-0">&#xA0;<span class="">5015</span>:       Base smoothing factor for window size which gets adjusted by a factor</pre>
<pre class="cython line score-0">&#xA0;<span class="">5016</span>:       dependent on the rate of change in the data.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5017</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5018</span>:     beta: float, default =1.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5019</span>:        Scaling factor to adjust `weight_factor` during high volatility.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5020</span>:        It controls how much the `weight_factor` is adjusted during</pre>
<pre class="cython line score-0">&#xA0;<span class="">5021</span>:        periods of high volatility.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5022</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5023</span>:     logify: bool, default=False,</pre>
<pre class="cython line score-0">&#xA0;<span class="">5024</span>:       By default , Torres uses exponential moving average. So if the</pre>
<pre class="cython line score-0">&#xA0;<span class="">5025</span>:       values can be logarithmized to ensure the weight be ranged between</pre>
<pre class="cython line score-0">&#xA0;<span class="">5026</span>:       0 and 1. This is important when data are resistivity or phase.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5027</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5028</span>:     axis: int, default=0</pre>
<pre class="cython line score-0">&#xA0;<span class="">5029</span>:       Axis along which to apply the AMA filter.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5030</span>:     Return</pre>
<pre class="cython line score-0">&#xA0;<span class="">5031</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">5032</span>:     ama: Adaptive moving average</pre>
<pre class="cython line score-0">&#xA0;<span class="">5033</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5034</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">5035</span>:     ------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">5036</span>:     .. [1] Torres-Verdin and Bostick, 1992,  Principles of spatial surface</pre>
<pre class="cython line score-0">&#xA0;<span class="">5037</span>:         electric field filtering in magnetotellurics: electromagnetic array profiling</pre>
<pre class="cython line score-0">&#xA0;<span class="">5038</span>:         (EMAP), Geophysics, v57, p603-622.https://doi.org/10.1190/1.2400625</pre>
<pre class="cython line score-0">&#xA0;<span class="">5039</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5040</span>:     Example</pre>
<pre class="cython line score-0">&#xA0;<span class="">5041</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">5042</span>:     &gt;&gt;&gt; import matplotlib.pyplot as plt</pre>
<pre class="cython line score-0">&#xA0;<span class="">5043</span>:     &gt;&gt;&gt; from gofast.tools.mathex  import torres_verdin_filter</pre>
<pre class="cython line score-0">&#xA0;<span class="">5044</span>:     &gt;&gt;&gt; data = np.random.randn(100)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5045</span>:     &gt;&gt;&gt; ama = torres_verdin_filter(data)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5046</span>:     &gt;&gt;&gt; plt.plot (range (len(data)), data, 'k', range(len(data)), ama, '-or')</pre>
<pre class="cython line score-0">&#xA0;<span class="">5047</span>:     &gt;&gt;&gt; # apply on two dimensional array</pre>
<pre class="cython line score-0">&#xA0;<span class="">5048</span>:     &gt;&gt;&gt; data2d = np.random.randn(7, 10)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5049</span>:     &gt;&gt;&gt; ama2d = torres_verdin_filter ( data2d, axis =0)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5050</span>:     &gt;&gt;&gt; fig, ax  = plt.subplots (nrows = 1, ncols = 2 , sharey= True,</pre>
<pre class="cython line score-0">&#xA0;<span class="">5051</span>:                              figsize = (7,7) )</pre>
<pre class="cython line score-0">&#xA0;<span class="">5052</span>:     &gt;&gt;&gt; ax[0].imshow(data2d , label ='Raw data', cmap = 'binary' )</pre>
<pre class="cython line score-0">&#xA0;<span class="">5053</span>:     &gt;&gt;&gt; ax[1].imshow (ama2d,  label = 'AMA data', cmap ='binary' )</pre>
<pre class="cython line score-0">&#xA0;<span class="">5054</span>:     &gt;&gt;&gt; ax[0].set_title ('Raw data')</pre>
<pre class="cython line score-0">&#xA0;<span class="">5055</span>:     &gt;&gt;&gt; ax[1].set_title ('AMA data')</pre>
<pre class="cython line score-0">&#xA0;<span class="">5056</span>:     &gt;&gt;&gt; plt.legend</pre>
<pre class="cython line score-0">&#xA0;<span class="">5057</span>:     &gt;&gt;&gt; plt.show ()</pre>
<pre class="cython line score-0">&#xA0;<span class="">5058</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5059</span>:     """</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5060</span>:     arr = is_iterable(arr, exclude_string=True, transform=True)</pre>
<pre class='cython code score-28 '>  <span class='trace'>__Pyx_TraceLine</span>(5060,0,<span class='error_goto'>__PYX_ERR(0, 5060, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_is_iterable);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5060, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5060, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_arr);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_arr)) <span class='error_goto'>__PYX_ERR(0, 5060, __pyx_L1_error)</span>;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5060, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_exclude_string, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5060, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_transform, Py_True) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5060, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5060, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5061</span>:     axis = 0 if axis is None else axis  # Set default axis to 0 if not specified</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(5061,0,<span class='error_goto'>__PYX_ERR(0, 5061, __pyx_L1_error)</span>)
  __pyx_t_5 = (__pyx_v_axis == ((PyObject*)Py_None));
  if (__pyx_t_5) {
    if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_0)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_0))) <span class='error_goto'>__PYX_ERR(0, 5061, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_t_4 = __pyx_int_0;
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_axis);
    __pyx_t_4 = __pyx_v_axis;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_axis, ((PyObject*)__pyx_t_4));
  __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5062</span>:     logify = bool(logify)</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(5062,0,<span class='error_goto'>__PYX_ERR(0, 5062, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_logify); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5062, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>((!(!__pyx_t_5)));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5062, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_logify, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5063</span>: </pre>
<pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5064</span>:     def _filtering_1d_array( ar, wf, b ):</pre>
<pre class='cython code score-86 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_20torres_verdin_filter_1_filtering_1d_array(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_20torres_verdin_filter_1_filtering_1d_array = {"_filtering_1d_array", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_20torres_verdin_filter_1_filtering_1d_array, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_20torres_verdin_filter_1_filtering_1d_array(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_ar = 0;
  PyObject *__pyx_v_wf = 0;
  CYTHON_UNUSED PyObject *__pyx_v_b = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_filtering_1d_array (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_ar,&amp;__pyx_n_s_wf,&amp;__pyx_n_s_b,0};
  PyObject* values[3] = {0,0,0};
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_ar)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 5064, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_wf)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 5064, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_filtering_1d_array", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 5064, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_b)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[2]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 5064, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_filtering_1d_array", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 5064, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "_filtering_1d_array") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 5064, __pyx_L3_error)</span>
      }
    } else if (unlikely(__pyx_nargs != 3)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
      values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
      values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
    }
    __pyx_v_ar = values[0];
    __pyx_v_wf = values[1];
    __pyx_v_b = values[2];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("_filtering_1d_array", 1, 3, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 5064, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.torres_verdin_filter._filtering_1d_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_20torres_verdin_filter__filtering_1d_array(__pyx_self, __pyx_v_ar, __pyx_v_wf, __pyx_v_b);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_20torres_verdin_filter__filtering_1d_array(PyObject *__pyx_self, PyObject *__pyx_v_ar, PyObject *__pyx_v_wf, CYTHON_UNUSED PyObject *__pyx_v_b) {
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_3_torres_verdin_filter *__pyx_cur_scope;
  struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_3_torres_verdin_filter *__pyx_outer_scope;
  PyObject *__pyx_v_ama = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_change = NULL;
  PyObject *__pyx_v_w = NULL;
  PyObject *__pyx_v_ama_value = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  __pyx_outer_scope = (struct __pyx_obj_6gofast_5tools_6mathex___pyx_scope_struct_3_torres_verdin_filter *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
  <span class='trace'>__Pyx_TraceCall</span>("_filtering_1d_array", __pyx_f[0], 5064, 0, <span class='error_goto'>__PYX_ERR(0, 5064, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.torres_verdin_filter._filtering_1d_array", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ama);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_change);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_w);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ama_value);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__147 = <span class='py_c_api'>PyTuple_Pack</span>(8, __pyx_n_s_ar, __pyx_n_s_wf, __pyx_n_s_b, __pyx_n_s_ama, __pyx_n_s_i, __pyx_n_s_change, __pyx_n_s_w, __pyx_n_s_ama_value);<span class='error_goto'> if (unlikely(!__pyx_tuple__147)) __PYX_ERR(0, 5064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__147);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__147);
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(5064,0,<span class='error_goto'>__PYX_ERR(0, 5064, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_20torres_verdin_filter_1_filtering_1d_array, 0, __pyx_n_s_torres_verdin_filter_locals__fil, ((PyObject*)__pyx_cur_scope), __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__148));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5064, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_v__filtering_1d_array = __pyx_t_4;
  __pyx_t_4 = 0;
  __pyx_codeobj__148 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(3, 0, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__147, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_filtering_1d_array, 5064, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__148)) __PYX_ERR(0, 5064, __pyx_L1_error)</span>
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5065</span>:         if len(ar) &lt; 2:</pre>
<pre class='cython code score-5 '>  <span class='trace'>__Pyx_TraceLine</span>(5065,0,<span class='error_goto'>__PYX_ERR(0, 5065, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_ar);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 5065, __pyx_L1_error)</span>
  __pyx_t_2 = (__pyx_t_1 &lt; 2);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5066</span>:             return ar</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(5066,0,<span class='error_goto'>__PYX_ERR(0, 5066, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_ar);
    __pyx_r = __pyx_v_ar;
    goto __pyx_L0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5067</span>:         ama = [ar[0]]  # Initialize the adaptive moving average array</pre>
<pre class='cython code score-9 '>  <span class='trace'>__Pyx_TraceLine</span>(5067,0,<span class='error_goto'>__PYX_ERR(0, 5067, __pyx_L1_error)</span>)
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_ar, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5067, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5067, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 5067, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_v_ama = ((PyObject*)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-73" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5068</span>:         for i in range(1, len(ar)):</pre>
<pre class='cython code score-73 '>  <span class='trace'>__Pyx_TraceLine</span>(5068,0,<span class='error_goto'>__PYX_ERR(0, 5068, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_ar);<span class='error_goto'> if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 5068, __pyx_L1_error)</span>
  __pyx_t_4 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5068, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5068, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_1);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_int_1)) <span class='error_goto'>__PYX_ERR(0, 5068, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 5068, __pyx_L1_error)</span>;
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_range, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5068, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_4)) {
    __pyx_t_3 = __pyx_t_4; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_1 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_1 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5068, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 5068, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5068, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_1 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_1); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_1++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5068, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_1); __pyx_t_1++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5068, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5068, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_1 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_4 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_1); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4); __pyx_t_1++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5068, __pyx_L1_error)</span>
        #else
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_1); __pyx_t_1++;<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5068, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        #endif
      }
    } else {
      __pyx_t_4 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_4)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 5068, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_4);
    __pyx_t_4 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(5068,0,<span class='error_goto'>__PYX_ERR(0, 5068, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5069</span>:             change = abs(ar[i] - ar[i-1])</pre>
<pre class='cython code score-18 '>    <span class='trace'>__Pyx_TraceLine</span>(5069,0,<span class='error_goto'>__PYX_ERR(0, 5069, __pyx_L1_error)</span>)
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_ar, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5069, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractObjC</span>(__pyx_v_i, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 5069, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_ar, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 5069, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_4, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 5069, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyNumber_Absolute</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 5069, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_change, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5070</span>:             w = wf * (1 + beta * change)</pre>
<pre class='cython code score-21 '>    <span class='trace'>__Pyx_TraceLine</span>(5070,0,<span class='error_goto'>__PYX_ERR(0, 5070, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope-&gt;__pyx_v_beta);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 5070, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_v_change);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 5070, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_AddCObj</span>(__pyx_int_1, __pyx_t_6, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 5070, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_wf, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 5070, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_w, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5071</span>:             w = min(w, 1)  # Ensure weight stays between 0 and 1</pre>
<pre class='cython code score-19 '>    <span class='trace'>__Pyx_TraceLine</span>(5071,0,<span class='error_goto'>__PYX_ERR(0, 5071, __pyx_L1_error)</span>)
    __pyx_t_8 = 1;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_w);
    __pyx_t_6 = __pyx_v_w;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5071, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_t_6, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5071, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_9); if (unlikely((__pyx_t_2 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5071, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (__pyx_t_2) {
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5071, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_7 = __pyx_t_9;
      __pyx_t_9 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      __pyx_t_7 = __pyx_t_6;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = __pyx_t_7;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_w, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5072</span>:             ama_value = w * ar[i] + (1 - w) * ama[-1]</pre>
<pre class='cython code score-27 '>    <span class='trace'>__Pyx_TraceLine</span>(5072,0,<span class='error_goto'>__PYX_ERR(0, 5072, __pyx_L1_error)</span>)
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_v_ar, __pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 5072, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_w, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 5072, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_SubtractCObj</span>(__pyx_int_1, __pyx_v_w, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 5072, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_GetItemInt_List</span>(__pyx_v_ama, -1L, long, 1, __Pyx_PyInt_From_long, 1, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5072, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_6, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5072, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5072, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ama_value, __pyx_t_9);
    __pyx_t_9 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5073</span>:             ama.append(ama_value)</pre>
<pre class='cython code score-2 '>    <span class='trace'>__Pyx_TraceLine</span>(5073,0,<span class='error_goto'>__PYX_ERR(0, 5073, __pyx_L1_error)</span>)
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_ama, __pyx_v_ama_value);<span class='error_goto'> if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 5073, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">5074</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5075</span>:         return np.array(ama)</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(5075,0,<span class='error_goto'>__PYX_ERR(0, 5075, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5075, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_9, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5075, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_t_9 = NULL;
  __pyx_t_11 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_11 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_v_ama};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+1-__pyx_t_11, 1+__pyx_t_11);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 5075, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5076</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5077</span>:     arr =np.array (arr )</pre>
<pre class='cython code score-20 '>  <span class='trace'>__Pyx_TraceLine</span>(5077,0,<span class='error_goto'>__PYX_ERR(0, 5077, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5077, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_array_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5077, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_v_arr};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 5077, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5078</span>:     #+++++++++++++++++++</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5079</span>:     if logify:</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(5079,0,<span class='error_goto'>__PYX_ERR(0, 5079, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_logify); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5079, __pyx_L1_error)</span>
  if (__pyx_t_5) {
/* … */
  }
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5080</span>:         arr = np.log10 ( arr )</pre>
<pre class='cython code score-20 '>    <span class='trace'>__Pyx_TraceLine</span>(5080,0,<span class='error_goto'>__PYX_ERR(0, 5080, __pyx_L1_error)</span>)
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5080, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_log10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5080, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_v_arr};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 5080, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_4);
    __pyx_t_4 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5081</span>:     if arr.ndim &gt;=2:</pre>
<pre class='cython code score-11 '>  <span class='trace'>__Pyx_TraceLine</span>(5081,0,<span class='error_goto'>__PYX_ERR(0, 5081, __pyx_L1_error)</span>)
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arr, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5081, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_4, __pyx_int_2, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5081, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5081, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (__pyx_t_5) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5082</span>:         if axis is None:</pre>
<pre class='cython code score-0 '>    <span class='trace'>__Pyx_TraceLine</span>(5082,0,<span class='error_goto'>__PYX_ERR(0, 5082, __pyx_L1_error)</span>)
    __pyx_t_5 = (__pyx_v_axis == ((PyObject*)Py_None));
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5083</span>:             warnings.warn (f"Array dimension is {arr.ndim}. Axis must be"</pre>
<pre class='cython code score-45 '>      <span class='trace'>__Pyx_TraceLine</span>(5083,0,<span class='error_goto'>__PYX_ERR(0, 5083, __pyx_L1_error)</span>)
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_warnings);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5083, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5083, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 5083, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_7 = 0;
      __pyx_t_8 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Array_dimension_is);
      __pyx_t_7 += 19;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Array_dimension_is);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_kp_u_Array_dimension_is);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arr, __pyx_n_s_ndim);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5083, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimple</span>(__pyx_t_1, __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5083, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_9) &gt; __pyx_t_8) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_9) : __pyx_t_8;
      __pyx_t_7 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 1, __pyx_t_9);
      __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_Axis_must_be_specified_Otherwis);
      __pyx_t_7 += 52;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_Axis_must_be_specified_Otherwis);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 2, __pyx_kp_u_Axis_must_be_specified_Otherwis);
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_4, 3, __pyx_t_7, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5083, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = NULL;
      __pyx_t_6 = 0;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_4)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
          __pyx_t_6 = 1;
        }
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_4, __pyx_t_9};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 5083, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5084</span>:                            " specified. Otherwise axis=0 is used .")</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5085</span>:             axis =0</pre>
<pre class='cython code score-4 '>      <span class='trace'>__Pyx_TraceLine</span>(5085,0,<span class='error_goto'>__PYX_ERR(0, 5085, __pyx_L1_error)</span>)
      if (!(likely(__Pyx_Py3Int_CheckExact(__pyx_int_0)) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("int", __pyx_int_0))) <span class='error_goto'>__PYX_ERR(0, 5085, __pyx_L1_error)</span>
      __pyx_t_3 = __pyx_int_0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_axis, ((PyObject*)__pyx_t_3));
      __pyx_t_3 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5086</span>:         if axis ==0:</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(5086,0,<span class='error_goto'>__PYX_ERR(0, 5086, __pyx_L1_error)</span>)
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_axis, __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5086, __pyx_L1_error)</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5086, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5087</span>:             arr = arr._T</pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(5087,0,<span class='error_goto'>__PYX_ERR(0, 5087, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arr, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5087, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_3);
      __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5088</span>:         for ii in range( len(arr )) :</pre>
<pre class='cython code score-5 '>    <span class='trace'>__Pyx_TraceLine</span>(5088,0,<span class='error_goto'>__PYX_ERR(0, 5088, __pyx_L1_error)</span>)
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_arr);<span class='error_goto'> if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 5088, __pyx_L1_error)</span>
    __pyx_t_10 = __pyx_t_7;
    for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
      __pyx_v_ii = __pyx_t_11;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5089</span>:             arr [ii] = _filtering_1d_array (</pre>
<pre class='cython code score-14 '>      <span class='trace'>__Pyx_TraceLine</span>(5089,0,<span class='error_goto'>__PYX_ERR(0, 5089, __pyx_L1_error)</span>)
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5089, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 5089, __pyx_L1_error)</span>;
      __pyx_t_3 = 0;
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(5089,0,<span class='error_goto'>__PYX_ERR(0, 5089, __pyx_L1_error)</span>)
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v__filtering_1d_array, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5089, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely((<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_v_arr, __pyx_v_ii, __pyx_t_9, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5089, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5090</span>:                 arr [ii ], wf = weight_factor, b = beta )</pre>
<pre class='cython code score-26 '>      <span class='trace'>__Pyx_TraceLine</span>(5090,0,<span class='error_goto'>__PYX_ERR(0, 5090, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_arr, __pyx_v_ii, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
/* … */
      <span class='trace'>__Pyx_TraceLine</span>(5090,0,<span class='error_goto'>__PYX_ERR(0, 5090, __pyx_L1_error)</span>)
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_weight_factor);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_wf, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5090, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      __pyx_t_9 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope-&gt;__pyx_v_beta);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5090, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_b, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5090, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5091</span>:         # then transpose again</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5092</span>:         if axis ==0:</pre>
<pre class='cython code score-8 '>    <span class='trace'>__Pyx_TraceLine</span>(5092,0,<span class='error_goto'>__PYX_ERR(0, 5092, __pyx_L1_error)</span>)
    __pyx_t_9 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_axis, __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5092, __pyx_L1_error)</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_9); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5092, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    if (__pyx_t_5) {
/* … */
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5093</span>:             arr = arr._T</pre>
<pre class='cython code score-3 '>      <span class='trace'>__Pyx_TraceLine</span>(5093,0,<span class='error_goto'>__PYX_ERR(0, 5093, __pyx_L1_error)</span>)
      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_arr, __pyx_n_s_T);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5093, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_9);
      __pyx_t_9 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5094</span>:     else:</pre>
<pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5095</span>:         arr = _filtering_1d_array ( arr, wf = weight_factor, b=beta  )</pre>
<pre class='cython code score-37 '>  <span class='trace'>__Pyx_TraceLine</span>(5095,0,<span class='error_goto'>__PYX_ERR(0, 5095, __pyx_L1_error)</span>)
  /*else*/ {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5095, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_arr);
    if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_v_arr)) <span class='error_goto'>__PYX_ERR(0, 5095, __pyx_L1_error)</span>;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5095, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_weight_factor);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5095, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_wf, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5095, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_cur_scope-&gt;__pyx_v_beta);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5095, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_b, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5095, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_v__filtering_1d_array, __pyx_t_9, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5095, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_2);
    __pyx_t_2 = 0;
  }
  __pyx_L4:;
</pre><pre class="cython line score-0">&#xA0;<span class="">5096</span>: </pre>
<pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5097</span>:     if logify: arr = np.power (10, arr )</pre>
<pre class='cython code score-22 '>  <span class='trace'>__Pyx_TraceLine</span>(5097,0,<span class='error_goto'>__PYX_ERR(0, 5097, __pyx_L1_error)</span>)
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_logify); if (unlikely((__pyx_t_5 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5097, __pyx_L1_error)</span>
  if (__pyx_t_5) {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5097, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_power);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 5097, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_3, __pyx_int_10, __pyx_v_arr};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 5097, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_arr, __pyx_t_2);
    __pyx_t_2 = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">5098</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5099</span>:     return arr</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(5099,0,<span class='error_goto'>__PYX_ERR(0, 5099, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_arr);
  __pyx_r = __pyx_v_arr;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5100</span>: </pre>
<pre class="cython line score-122" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5101</span>: def gradient_boosting_regressor(</pre>
<pre class='cython code score-122 '>/* Python wrapper */
static PyObject *__pyx_pw_6gofast_5tools_6mathex_133gradient_boosting_regressor(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_6gofast_5tools_6mathex_132gradient_boosting_regressor, "\n    Implement a simple version of Gradient Boosting Regressor.\n\n    Gradient Boosting builds an additive model in a forward stage-wise fashion. \n    At each stage, regression trees are fit on the negative gradient of the loss function.\n\n    Parameters\n    ----------\n    X : ndarray of shape (n_samples, n_features)\n        The input samples.\n    y : ndarray of shape (n_samples,)\n        The target values (real numbers).\n    n_estimators : int, default=100\n        The number of boosting stages to be run.\n    learning_rate : float, default=0.1\n        Learning rate shrinks the contribution of each tree by `learning_rate`.\n    max_depth : int, default=1\n        The maximum depth of the individual regression estimators.\n\n    Returns\n    -------\n    y_pred : ndarray of shape (n_samples,)\n        The predicted values.\n\n    Mathematical Formula\n    --------------------\n    Given a differentiable loss function L(y, F(x)), the general idea is \n    to iteratively construct additive models as follows:\n    \n    .. math:: \n        F_{m}(x) = F_{m-1}(x) + \\gamma_{m} h_{m}(x)\n\n    where F_{m} is the model at iteration m, \\gamma_{m} is the step size,\n    and h_{m} is the weak learner.\n\n    Notes\n    -----\n    Gradient Boosting is widely used in machine learning for regression and \n    classification problems. It's effective in scenarios where data is not \n    linearly separable.\n\n    References\n    ----------\n    - J. H. Friedman, \"Greedy Function Approximation: A Gradient Boosting Machine,\" 1999.\n    - T. Hastie, R. Tibshirani, and J. Friedman, \"The Elements of Statistical Learning,\" Springer, 2009.\n\n    Examples\n    --------\n    &gt;&gt;&gt; from sklearn.datasets import make_regression\n    &gt;&gt;&gt; X, y = make_regression(n_samples=100, n_features=1, noise=10)\n    &gt;&gt;&gt; y_pred = gradient_boosting_regressor(X, y, n_estimators=100,\n                                             learning_rate=0.1)\n    &gt;&gt;&gt; print(y_pred[:5])\n    ");
static PyMethodDef __pyx_mdef_6gofast_5tools_6mathex_133gradient_boosting_regressor = {"gradient_boosting_regressor", (PyCFunction)(void*)(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_6gofast_5tools_6mathex_133gradient_boosting_regressor, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_6gofast_5tools_6mathex_132gradient_boosting_regressor};
static PyObject *__pyx_pw_6gofast_5tools_6mathex_133gradient_boosting_regressor(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_X = 0;
  PyObject *__pyx_v_y = 0;
  PyObject *__pyx_v_n_estimators = 0;
  PyObject *__pyx_v_learning_rate = 0;
  CYTHON_UNUSED PyObject *__pyx_v_max_depth = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("gradient_boosting_regressor (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_MACROS
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_X,&amp;__pyx_n_s_y,&amp;__pyx_n_s_n_estimators,&amp;__pyx_n_s_learning_rate,&amp;__pyx_n_s_max_depth,0};
  PyObject* values[5] = {0,0,0,0,0};
    values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_100)));
    values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject*)__pyx_float_0_1)));
    values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(((PyObject *)((PyObject *)__pyx_int_1)));
    if (__pyx_kwds) {
      Py_ssize_t kw_args;
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds);
      switch (__pyx_nargs) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_X)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[0]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 5101, __pyx_L3_error)</span>
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_y)) != 0)) {
          (void)<span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(values[1]);
          kw_args--;
        }
        else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 5101, __pyx_L3_error)</span>
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gradient_boosting_regressor", 0, 2, 5, 1); <span class='error_goto'>__PYX_ERR(0, 5101, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_n_estimators);
          if (value) { values[2] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 5101, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_learning_rate);
          if (value) { values[3] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 5101, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_GetKwValue_FASTCALL</span>(__pyx_kwds, __pyx_kwvalues, __pyx_n_s_max_depth);
          if (value) { values[4] = <span class='pyx_c_api'>__Pyx_Arg_NewRef_FASTCALL</span>(value); kw_args--; }
          else if (unlikely(<span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 5101, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        const Py_ssize_t kwd_pos_args = __pyx_nargs;
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values + 0, kwd_pos_args, "gradient_boosting_regressor") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 5101, __pyx_L3_error)</span>
      }
    } else {
      switch (__pyx_nargs) {
        case  5: values[4] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 1);
        values[0] = <span class='pyx_c_api'>__Pyx_Arg_FASTCALL</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_X = values[0];
    __pyx_v_y = values[1];
    __pyx_v_n_estimators = values[2];
    __pyx_v_learning_rate = values[3];
    __pyx_v_max_depth = values[4];
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("gradient_boosting_regressor", 0, 2, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 5101, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.gradient_boosting_regressor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6gofast_5tools_6mathex_132gradient_boosting_regressor(__pyx_self, __pyx_v_X, __pyx_v_y, __pyx_v_n_estimators, __pyx_v_learning_rate, __pyx_v_max_depth);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  {
    Py_ssize_t __pyx_temp;
    for (__pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
      <span class='pyx_c_api'>__Pyx_Arg_XDECREF_FASTCALL</span>(values[__pyx_temp]);
    }
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6gofast_5tools_6mathex_132gradient_boosting_regressor(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_X, PyObject *__pyx_v_y, PyObject *__pyx_v_n_estimators, PyObject *__pyx_v_learning_rate, CYTHON_UNUSED PyObject *__pyx_v_max_depth) {
  PyObject *__pyx_v_DecisionStumpRegressor = NULL;
  PyObject *__pyx_v_F_m = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_m = NULL;
  PyObject *__pyx_v_residual = NULL;
  PyObject *__pyx_v_stump = NULL;
  PyObject *__pyx_r = NULL;
  <span class='trace'>__Pyx_TraceDeclarations</span>
  <span class='trace'>__Pyx_TraceFrameInit</span>(__pyx_codeobj__149)
  <span class='trace'>__Pyx_TraceCall</span>("gradient_boosting_regressor", __pyx_f[0], 5101, 0, <span class='error_goto'>__PYX_ERR(0, 5101, __pyx_L1_error)</span>);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("gofast.tools.mathex.gradient_boosting_regressor", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_DecisionStumpRegressor);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_F_m);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_m);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_residual);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_stump);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='trace'>__Pyx_TraceReturn</span>(__pyx_r, 0);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__238 = <span class='py_c_api'>PyTuple_Pack</span>(10, __pyx_n_s_X, __pyx_n_s_y, __pyx_n_s_n_estimators, __pyx_n_s_learning_rate, __pyx_n_s_max_depth, __pyx_n_s_DecisionStumpRegressor, __pyx_n_s_F_m, __pyx_n_s_m, __pyx_n_s_residual, __pyx_n_s_stump);<span class='error_goto'> if (unlikely(!__pyx_tuple__238)) __PYX_ERR(0, 5101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__238);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__238);
  __pyx_codeobj__149 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__238, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_gofast_tools_mathex_pyx, __pyx_n_s_gradient_boosting_regressor, 5101, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__149)) __PYX_ERR(0, 5101, __pyx_L1_error)</span>
/* … */
  <span class='trace'>__Pyx_TraceLine</span>(5101,0,<span class='error_goto'>__PYX_ERR(0, 5101, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_6gofast_5tools_6mathex_133gradient_boosting_regressor, 0, __pyx_n_s_gradient_boosting_regressor, NULL, __pyx_n_s_gofast_tools_mathex, __pyx_d, ((PyObject *)__pyx_codeobj__149));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__239);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_gradient_boosting_regressor, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5101, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5102</span>:         X, y, n_estimators=100, learning_rate=0.1, max_depth=1):</pre>
<pre class="cython line score-0">&#xA0;<span class="">5103</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">5104</span>:     Implement a simple version of Gradient Boosting Regressor.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5105</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5106</span>:     Gradient Boosting builds an additive model in a forward stage-wise fashion.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5107</span>:     At each stage, regression trees are fit on the negative gradient of the loss function.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5108</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5109</span>:     Parameters</pre>
<pre class="cython line score-0">&#xA0;<span class="">5110</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">5111</span>:     X : ndarray of shape (n_samples, n_features)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5112</span>:         The input samples.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5113</span>:     y : ndarray of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5114</span>:         The target values (real numbers).</pre>
<pre class="cython line score-0">&#xA0;<span class="">5115</span>:     n_estimators : int, default=100</pre>
<pre class="cython line score-0">&#xA0;<span class="">5116</span>:         The number of boosting stages to be run.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5117</span>:     learning_rate : float, default=0.1</pre>
<pre class="cython line score-0">&#xA0;<span class="">5118</span>:         Learning rate shrinks the contribution of each tree by `learning_rate`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5119</span>:     max_depth : int, default=1</pre>
<pre class="cython line score-0">&#xA0;<span class="">5120</span>:         The maximum depth of the individual regression estimators.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5121</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5122</span>:     Returns</pre>
<pre class="cython line score-0">&#xA0;<span class="">5123</span>:     -------</pre>
<pre class="cython line score-0">&#xA0;<span class="">5124</span>:     y_pred : ndarray of shape (n_samples,)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5125</span>:         The predicted values.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5126</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5127</span>:     Mathematical Formula</pre>
<pre class="cython line score-0">&#xA0;<span class="">5128</span>:     --------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">5129</span>:     Given a differentiable loss function L(y, F(x)), the general idea is</pre>
<pre class="cython line score-0">&#xA0;<span class="">5130</span>:     to iteratively construct additive models as follows:</pre>
<pre class="cython line score-0">&#xA0;<span class="">5131</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5132</span>:     .. math::</pre>
<pre class="cython line score-0">&#xA0;<span class="">5133</span>:         F_{m}(x) = F_{m-1}(x) + \\gamma_{m} h_{m}(x)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5134</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5135</span>:     where F_{m} is the model at iteration m, \\gamma_{m} is the step size,</pre>
<pre class="cython line score-0">&#xA0;<span class="">5136</span>:     and h_{m} is the weak learner.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5137</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5138</span>:     Notes</pre>
<pre class="cython line score-0">&#xA0;<span class="">5139</span>:     -----</pre>
<pre class="cython line score-0">&#xA0;<span class="">5140</span>:     Gradient Boosting is widely used in machine learning for regression and</pre>
<pre class="cython line score-0">&#xA0;<span class="">5141</span>:     classification problems. It's effective in scenarios where data is not</pre>
<pre class="cython line score-0">&#xA0;<span class="">5142</span>:     linearly separable.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5143</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5144</span>:     References</pre>
<pre class="cython line score-0">&#xA0;<span class="">5145</span>:     ----------</pre>
<pre class="cython line score-0">&#xA0;<span class="">5146</span>:     - J. H. Friedman, "Greedy Function Approximation: A Gradient Boosting Machine," 1999.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5147</span>:     - T. Hastie, R. Tibshirani, and J. Friedman, "The Elements of Statistical Learning," Springer, 2009.</pre>
<pre class="cython line score-0">&#xA0;<span class="">5148</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5149</span>:     Examples</pre>
<pre class="cython line score-0">&#xA0;<span class="">5150</span>:     --------</pre>
<pre class="cython line score-0">&#xA0;<span class="">5151</span>:     &gt;&gt;&gt; from sklearn.datasets import make_regression</pre>
<pre class="cython line score-0">&#xA0;<span class="">5152</span>:     &gt;&gt;&gt; X, y = make_regression(n_samples=100, n_features=1, noise=10)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5153</span>:     &gt;&gt;&gt; y_pred = gradient_boosting_regressor(X, y, n_estimators=100,</pre>
<pre class="cython line score-0">&#xA0;<span class="">5154</span>:                                              learning_rate=0.1)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5155</span>:     &gt;&gt;&gt; print(y_pred[:5])</pre>
<pre class="cython line score-0">&#xA0;<span class="">5156</span>:     """</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5157</span>:     from ..estimators import DecisionStumpRegressor</pre>
<pre class='cython code score-16 '>  <span class='trace'>__Pyx_TraceLine</span>(5157,0,<span class='error_goto'>__PYX_ERR(0, 5157, __pyx_L1_error)</span>)
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_DecisionStumpRegressor);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_DecisionStumpRegressor);
  if (<span class='pyx_c_api'>__Pyx_PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_DecisionStumpRegressor)) <span class='error_goto'>__PYX_ERR(0, 5157, __pyx_L1_error)</span>;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_estimators, __pyx_t_1, 2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_DecisionStumpRegressor);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5157, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_DecisionStumpRegressor = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5158</span>:     # Initialize model</pre>
<pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5159</span>:     F_m = np.zeros(len(y))</pre>
<pre class='cython code score-30 '>  <span class='trace'>__Pyx_TraceLine</span>(5159,0,<span class='error_goto'>__PYX_ERR(0, 5159, __pyx_L1_error)</span>)
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5159, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5159, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_y);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 5159, __pyx_L1_error)</span>
  __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5159, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_6 = 1;
    }
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_1};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 5159, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_v_F_m = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5160</span>:     # for m in range(n_estimators):</pre>
<pre class="cython line score-0">&#xA0;<span class="">5161</span>:         # Compute negative gradient</pre>
<pre class="cython line score-0">&#xA0;<span class="">5162</span>:         # residual = -(y - F_m)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5163</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5164</span>:         # # Fit a regression tree to the negative gradient</pre>
<pre class="cython line score-0">&#xA0;<span class="">5165</span>:         # tree = DecisionTreeRegressor(max_depth=max_depth)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5166</span>:         # tree.fit(X, residual)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5167</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5168</span>:         # # Update the model</pre>
<pre class="cython line score-0">&#xA0;<span class="">5169</span>:         # F_m += learning_rate * tree.predict(X)</pre>
<pre class="cython line score-0">&#xA0;<span class="">5170</span>: </pre>
<pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5171</span>:     for m in range(n_estimators):</pre>
<pre class='cython code score-52 '>  <span class='trace'>__Pyx_TraceLine</span>(5171,0,<span class='error_goto'>__PYX_ERR(0, 5171, __pyx_L1_error)</span>)
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_range, __pyx_v_n_estimators);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5171, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_2)) {
    __pyx_t_3 = __pyx_t_2; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_4 = 0;
    __pyx_t_7 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 5171, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 5171, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  for (;;) {
    if (likely(!__pyx_t_7)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5171, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_4 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5171, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5171, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_3);
          #if !CYTHON_ASSUME_SAFE_MACROS
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5171, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_4 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_2 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_4++; if (unlikely((0 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 5171, __pyx_L1_error)</span>
        #else
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5171, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        #endif
      }
    } else {
      __pyx_t_2 = __pyx_t_7(__pyx_t_3);
      if (unlikely(!__pyx_t_2)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 5171, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_m, __pyx_t_2);
    __pyx_t_2 = 0;
/* … */
    <span class='trace'>__Pyx_TraceLine</span>(5171,0,<span class='error_goto'>__PYX_ERR(0, 5171, __pyx_L1_error)</span>)
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5172</span>:         # Compute negative gradient</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5173</span>:         residual = -(y - F_m)</pre>
<pre class='cython code score-12 '>    <span class='trace'>__Pyx_TraceLine</span>(5173,0,<span class='error_goto'>__PYX_ERR(0, 5173, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_y, __pyx_v_F_m);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Negative</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5173, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_residual, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5174</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5175</span>:         # Fit a decision stump to the negative gradient</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5176</span>:         stump = DecisionStumpRegressor()</pre>
<pre class='cython code score-16 '>    <span class='trace'>__Pyx_TraceLine</span>(5176,0,<span class='error_goto'>__PYX_ERR(0, 5176, __pyx_L1_error)</span>)
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_DecisionStumpRegressor);
    __pyx_t_2 = __pyx_v_DecisionStumpRegressor; __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 0+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 5176, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_stump, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5177</span>:         stump.fit(X, residual)</pre>
<pre class='cython code score-17 '>    <span class='trace'>__Pyx_TraceLine</span>(5177,0,<span class='error_goto'>__PYX_ERR(0, 5177, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_stump, __pyx_n_s_fit);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5177, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_5, __pyx_v_X, __pyx_v_residual};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 2+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 5177, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5178</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5179</span>:         # Update the model</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5180</span>:         F_m += learning_rate * stump.predict(X)</pre>
<pre class='cython code score-29 '>    <span class='trace'>__Pyx_TraceLine</span>(5180,0,<span class='error_goto'>__PYX_ERR(0, 5180, __pyx_L1_error)</span>)
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_stump, __pyx_n_s_predict);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5180, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = NULL;
    __pyx_t_6 = 0;
    #if CYTHON_UNPACK_METHODS
    if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_5)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        __pyx_t_6 = 1;
      }
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_v_X};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+1-__pyx_t_6, 1+__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 5180, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    }
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_learning_rate, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5180, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_F_m, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5180, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_F_m, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5181</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5182</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">5183</span>:     return F_m</pre>
<pre class='cython code score-2 '>  <span class='trace'>__Pyx_TraceLine</span>(5183,0,<span class='error_goto'>__PYX_ERR(0, 5183, __pyx_L1_error)</span>)
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_F_m);
  __pyx_r = __pyx_v_F_m;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">5184</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5185</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5186</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5187</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5188</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5189</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5190</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5192</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5193</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5194</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5195</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5196</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5197</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5198</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5199</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5200</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5201</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5202</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5203</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5204</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5205</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5206</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5207</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5208</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5209</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5210</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5211</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5213</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">5214</span>: </pre>
</div></body></html>
